/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{createDeferred as n,onAbort as t,createAbortError as r,i as e,o}from"./promiseUtils.js";import{equals as u}from"./lang.js";import"./Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/Message.js";function c(n,t,r,e,o){const u=n.watch(t,((t,o,u,c)=>{r&&!r(t)||null==e||e.call(n,t,o,u,c)}),o);if(Array.isArray(t))for(const o of t){const u=n.get(o);r&&r(u)&&(null==e||e.call(n,u,u,t,n))}else{const o=n.get(t);r&&r(o)&&(null==e||e.call(n,o,o,t,n))}return u}function i(e,o,u,i,s){const f="function"==typeof i?i:null,l="object"==typeof i?i:null;"boolean"==typeof i&&(s=i);let a,m=!1;function p(){a&&(a.remove(),a=null)}const g=n();t(l,(()=>{p(),g.reject(r())}));const h={then:g.promise.then.bind(g.promise),catch:g.promise.catch.bind(g.promise),remove:p};return Object.freeze(h),a=c(e,o,u,((n,t,r,o)=>{m=!0,p(),f&&f.call(e,n,t,r,o),g.resolve({value:n,oldValue:t,propertyName:r,target:o})}),s),m&&p(),h}function s(n){return!!n}function f(n){return!n}function l(n){return!0===n}function a(n){return!1===n}function m(n){return void 0!==n}function p(n){return void 0===n}const g=/\?(\.|$)/g;function h(n,t,r,e){const o=Array.isArray(t)?t:t.indexOf(",")>-1?t.split(","):[t],u=j(n,t,r,e);for(const t of o){const e=t.trim().replace(g,"$1"),o=n.get(e);r.call(n,o,o,e,n)}return u}function j(n,t,r,e){return n.watch(t,r,e)}function v(n,t,r,e){return i(n,t,null,r,e)}function d(n,t,r,e){return c(n,t,s,r,e)}function y(n,t,r,e){return i(n,t,s,r,e)}function b(n,t,r,e){return c(n,t,f,r,e)}function k(n,t,r,e){return i(n,t,f,r,e)}function A(n,t,r,e){return c(n,t,l,r,e)}function w(n,t,r,e){return i(n,t,l,r,e)}function x(n,t,r,e){return c(n,t,a,r,e)}function O(n,t,r,e){return i(n,t,a,r,e)}function $(n,t,r,e){return c(n,t,m,r,e)}function z(n,t,r,e){return i(n,t,m,r,e)}function E(n,t,r,e){return c(n,t,p,r,e)}function L(n,t,r,e){return i(n,t,p,r,e)}function M(n,t,r,e,o){return c(n,t,(n=>u(r,n)),e,o)}function N(n,t,r,e,o){return i(n,t,(n=>u(r,n)),e,o)}function U(n,t,r,e){let o=!1;const u=n.watch(t,((t,e,u,c)=>{o||r.call(n,t,e,u,c)}),e);return{remove(){u.remove()},pause(){o=!0},resume(){o=!1}}}function V(n,t,r,u,c,i,s){const f={};function l(t){const e=f[t];e&&(i&&i(e.target,t,n,r),e.handle.remove(),delete f[t])}const a=h(n,t,((t,i,s)=>{l(s),e(t)&&(f[s]={handle:o(t,r,u),target:t},c&&c(t,s,n,r))}),s);return{remove(){a.remove();for(const n in f)l(n)}}}export{h as init,V as on,v as once,U as pausable,j as watch,d as when,$ as whenDefined,z as whenDefinedOnce,M as whenEqual,N as whenEqualOnce,x as whenFalse,O as whenFalseOnce,b as whenNot,k as whenNotOnce,y as whenOnce,A as whenTrue,w as whenTrueOnce,E as whenUndefined,L as whenUndefinedOnce,i as whenValidOnce};
