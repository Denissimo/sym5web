/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{_ as r}from"../chunks/tslib.es6.js";import{L as o}from"../chunks/Logger.js";import{i as t}from"../core/lang.js";import{isDataProtocol as e,isAbsolute as s,normalize as i,makeData as n}from"../core/urlUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import{e as a}from"../chunks/enumeration.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import p from"./Symbol3DLayer.js";import{w as h,i as m}from"../chunks/colors.js";import{s as u}from"../chunks/jsonMap.js";import{a as y}from"../chunks/JSONSupport.js";import{r as f}from"../chunks/reader.js";import{w as d}from"../chunks/writer.js";import{f as j,t as b}from"../chunks/persistableUrlUtils.js";import{s as k}from"../chunks/materialUtils.js";import v from"../core/Accessor.js";import{S as g}from"../chunks/Symbol3DMaterial.js";import{S as w}from"../chunks/Symbol3DOutline.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../core/Error.js";import"../chunks/Message.js";import"../chunks/metadata.js";import"../chunks/handleUtils.js";import"../Color.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/write.js";import"../chunks/arrayUtils.js";import"../chunks/screenUtils.js";import"../chunks/opacityUtils.js";import"../chunks/deprecate.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../core/promiseUtils.js";var S;const x=u()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let U=S=class extends y{constructor(r){super(r)}readHref(r,o,t){return r?j(r,t):o.dataURI}writeHref(r,o,t,n){r&&(e(r)?o.dataURI=r:(o.href=b(r,n),s(o.href)&&(o.href=i(o.href))))}clone(){return new S({href:this.href,primitive:this.primitive})}};r([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],U.prototype,"href",void 0),r([f("href")],U.prototype,"readHref",null),r([d("href",{href:{type:String},dataURI:{type:String}})],U.prototype,"writeHref",null),r([a(x)],U.prototype,"primitive",void 0),U=S=r([l("esri.symbols.support.IconSymbol3DLayerResource")],U);const P="circle";var z,I=U;let L=z=class extends v{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new z({x:this.x,y:this.y})}};r([c({type:Number})],L.prototype,"x",void 0),r([c({type:Number})],L.prototype,"y",void 0),L=z=r([l("esri.symbols.support.Symbol3DAnchorPosition2D")],L);var D,R=L;const M=o.getLogger("esri.symbols.IconSymbol3DLayer");let N=D=class extends p{constructor(r){super(r),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new D({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:t(this.material)?this.material.clone():null,outline:t(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(r){const o=r.color||h,t=q(r),e=r.outline&&r.outline.width>0?{size:r.outline.width,color:(r.outline.color||h).clone()}:null;return new D({size:r.size,resource:{primitive:A(r.style)},material:{color:o},outline:e,anchor:t?"relative":void 0,anchorPosition:t})}static fromPictureMarkerSymbol(r){const o=!r.color||m(r.color)?h:r.color,t=q(r);return new D({size:r.width<=r.height?r.height:r.width,resource:{href:r.url},material:{color:o.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(r){return new D({resource:{href:n({mediaType:"application/json",data:JSON.stringify(r.data)})}})}};function q(r){const o="width"in r?r.width:r.size,t="height"in r?r.height:r.size,e=H(r.xoffset),s=H(r.yoffset);return(e||s)&&o&&t?{x:-e/o,y:s/t}:null}function H(r){return isFinite(r)?r:0}r([c({type:g,json:{write:!0}})],N.prototype,"material",void 0),r([c({type:I,json:{write:!0}})],N.prototype,"resource",void 0),r([a({Icon:"icon"},{readOnly:!0})],N.prototype,"type",void 0),r([c(k)],N.prototype,"size",void 0),r([a({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),c({json:{default:"center"}})],N.prototype,"anchor",void 0),r([c({type:L,json:{type:[Number],read:{reader:r=>new L({x:r[0],y:r[1]})},write:{writer:(r,o)=>{o.anchorPosition=[r.x,r.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],N.prototype,"anchorPosition",void 0),r([c({type:w,json:{write:!0}})],N.prototype,"outline",void 0),N=D=r([l("esri.symbols.IconSymbol3DLayer")],N);const O={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function A(r){const o=O[r];return o||(M.warn(`${r} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}var C=N;export default C;export{R as S,P as d};
