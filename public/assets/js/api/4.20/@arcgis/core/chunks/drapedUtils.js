/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import"../geometry.js";import{i as e,b as t}from"../core/lang.js";import{a as n}from"./unitUtils.js";import r from"../geometry/Extent.js";function s(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function a(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){let t=0,n=0;for(let r=0;r<e.length;r++){const s=e[r].size;"number"==typeof s&&(t+=s,n++)}return t/n}(e.stops):t}function o(e){const t=e&&e.renderer,n="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return n;const r="visualVariables"in t?function(e,t){if(!t)return e;const n=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:n,minSize:r}=t;return(a(n,e)+a(r,e))/2}));let r=0;const s=n.length;if(0===s)return e;for(let e=0;e<s;e++)r+=n[e];const o=Math.floor(r/s);return Math.max(o,e)}(n,t.visualVariables):n;if("simple"===t.type)return s(r,t.symbol);if("unique-value"===t.type){let e=r;return t.uniqueValueInfos.forEach((t=>{e=s(e,t.symbol)})),e}if("class-breaks"===t.type){let e=r;return t.classBreakInfos.forEach((t=>{e=s(e,t.symbol)})),e}return t.type,r}function i(t,s,a,o=new r){let i;if("2d"===a.type)i=s*a.resolution;else if("3d"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;i=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):s*r}const f=t.x-i,l=t.y-i,u=t.x+i,c=t.y+i,{spatialReference:m}=a;return o.xmin=Math.min(f,u),o.ymin=Math.min(l,c),o.xmax=Math.max(f,u),o.ymax=Math.max(l,c),o.spatialReference=m,o}function f(e,n,r){const s=r.toMap(e);if(t(s))return!1;return i(s,o(),r,l).intersects(n)}const l=new r;export{i as a,o as c,f as i};
