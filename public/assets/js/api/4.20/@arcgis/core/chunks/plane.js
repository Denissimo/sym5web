/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
import{j as n,d as t,f as r,g as e,s as c,a as o,c as u,b as s,z as a,n as i}from"./mathUtils.js";import{i as f}from"../core/lang.js";import{g}from"./sphere.js";import{b as m,a as h}from"./vectorStacks.js";function p(n=R){return[n[0],n[1],n[2],n[3]]}function j(n,t,r,e){return d(n,t,r,e,h.get())}function b(n,t=p()){return d(n[0],n[1],n[2],n[3],t)}function d(n,t,r,e,c=p()){return c[0]=n,c[1]=t,c[2]=r,c[3]=e,c}function l(t,r,e){return n(e,t),e[3]=r,e}function y(e,c,o){n(o,c);const u=t(c,c);return Math.abs(u-1)>1e-5&&u>1e-12&&r(o,o,1/Math.sqrt(u)),S(o,e,o)}function v(n,t,r,e=p()){return A(c(m.get(),n,t),c(m.get(),r,t),n,e)}function M(n,r,e,o,u){if(n.count<3)return!1;n.getVec(e,V);let s=o,f=!1;for(;s<n.count-1&&!f;)n.getVec(s,k),s++,f=!a(V,k);if(!f)return!1;for(s=Math.max(s,u),f=!1;s<n.count&&!f;)n.getVec(s,q),s++,c(w,V,k),i(w,w),c(z,k,q),i(z,z),f=!a(V,q)&&!a(k,q)&&Math.abs(t(w,z))<x;return f?(v(V,k,q,r),!0):(0!==e||1!==o||2!==u)&&M(n,r,0,1,2)}const x=.99619469809,V=s(),k=s(),q=s(),w=s(),z=s();function S(n,r,e){return n!==e&&b(n,e),e[3]=-t(e,r),e}function U(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function A(n,t,r,e){return y(r,o(q,t,n),e)}function B(n,t,r,e){return P(n,t,c(m.get(),r,t),T,e)}function C(n,t,r){return!!f(t)&&P(n,t.origin,t.direction,W,r)}function D(n,t,r){return P(n,t.origin,t.vector,0,r)}function E(n,t,r){return P(n,t.origin,t.vector,1,r)}function F(n,t){return O(n,g(t))-t[3]>=0}function G(n,t){return O(n,t)>=0}function H(n,t){return O(n,t)<0}function I(n,t){const r=t[0],e=t[1],c=t[2],o=t[3],u=t[4],s=t[5];return n[0]*(n[0]>0?r:o)+n[1]*(n[1]>0?e:u)+n[2]*(n[2]>0?c:s)+n[3]>=0}function J(n,r){const e=t(n,r.ray.direction),c=-O(n,r.ray.origin);if(c<0&&e>=0)return!1;if(e>-1e-6&&e<1e-6)return c>0;if((c<0||e<0)&&!(c<0&&e<0))return!0;const o=c/e;return e>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function K(n,r){const e=t(n,r.ray.direction),c=-O(n,r.ray.origin);if(e>-1e-6&&e<1e-6)return c>0;const o=c/e;return e>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function L(n,t,o){const u=r(m.get(),n,-n[3]),s=N(n,c(m.get(),t,u),m.get());return e(o,s,u),o}function N(n,e,o){const u=r(m.get(),n,t(n,e));return c(o,e,u),o}function O(n,r){return t(n,r)+n[3]}function P(n,c,o,s,a){const i=t(n,o);if(0===i)return!1;let f=-(t(n,c)+n[3])/i;return 1&s&&(f=u(f,0,1)),!(!(4&s)&&f<0||!(8&s)&&f>1)&&(e(a,c,r(a,o,f)),!0)}function Q(n){return n}const R=[0,0,1,0],T=12,W=8;export{b as a,I as b,p as c,K as d,J as e,v as f,A as g,G as h,F as i,d as j,C as k,D as l,E as m,Q as n,S as o,L as p,l as q,y as r,O as s,U as t,N as u,H as v,j as w,M as x,B as y};
