// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/jsonMap ../../core/Logger ../../core/Warning ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ColorVariable ./OpacityVariable ./RotationVariable ./SizeVariable".split(" "),function(m,n,f,r,t,u,v,F,G,w,x,y,z,A){const B=t.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),C={color:x,size:A,
opacity:y,rotation:z},D=new r.JSONMap({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),E=/^\[([^\]]+)\]$/i;f=function(p){function g(){var a=p.apply(this,arguments)||this;a.colorVariables=null;a.opacityVariables=null;a.rotationVariables=null;a.sizeVariables=null;return a}m._inheritsLoose(g,p);var h=g.prototype;h.readVariables=function(a,b,c){const {rotationExpression:d,rotationType:k}=b;if(b=(b=d&&d.match(E))&&b[1])a||(a=[]),a.push({type:"rotationInfo",rotationType:k,
field:b});if(a)return a.map(l=>{var e=D.read(l.type);const q=C[e];q||(B.warn(`Unknown variable type: ${e}`),c&&c.messages&&c.messages.push(new u("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:l,context:c})));e=new q;e.read(l,c);return e})};h.writeVariables=function(a,b){const c=[];for(const d of a)(a=d.toJSON(b))&&c.push(a);return c};h._resetVariables=function(){this.colorVariables=[];this.opacityVariables=[];this.rotationVariables=[];this.sizeVariables=
[]};m._createClass(g,[{key:"visualVariables",set:function(a){this._resetVariables();if((a=a&&a.filter(c=>!!c))&&a.length){for(var b of a)switch(b.type){case "color":this.colorVariables.push(b);break;case "opacity":this.opacityVariables.push(b);break;case "rotation":this.rotationVariables.push(b);break;case "size":this.sizeVariables.push(b)}this.sizeVariables.length&&this.sizeVariables.some(c=>!!c.target)&&a.sort((c,d)=>{let k=null;return k=c.target===d.target?0:c.target?1:-1});for(b=0;b<a.length;b++)a[b].index=
b}this._set("visualVariables",a)}}]);return g}(f);n.__decorate([v.property()],f.prototype,"visualVariables",null);return f=n.__decorate([w.subclass("esri.renderers.visualVariables.VisualVariableFactory")],f)});