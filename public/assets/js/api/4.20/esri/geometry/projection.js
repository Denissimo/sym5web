// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils".split(" "),function(pa,m,qa,La,Q,k,Ma,Na,N,O,P,Oa,Pa,Z,ra,Qa,Ra,R,Sa,v,Ta,S,w){function sa(){return!!y&&
Z.isLoaded()}function aa(a){k.isNone(T)&&(T=Promise.all([Z.load(),(new Promise(function(c,b){pa(["../chunks/geometryEngineBase"],c,b)})).then(function(c){return c.geometryEngineBase}),new Promise(function(c,b){pa(["./geometryAdapters/hydrated"],c,b)})]));return T.then(([,c,{hydratedAdapter:b}])=>{Ma.throwIfAborted(a);J=b;y=c.default;y._enableProjection(Z.pe)})}function ba(a,c,b,d,e=null){if(k.isNone(b)||k.isNone(d))return c;if(U(b,d,e))return c.map(f=>Ua(f,b,d));if(k.isNone(e)){const f=S.cacheKey(b,
d);void 0!==V[f]?e=V[f]:(e=ta(b,d,null),k.isNone(e)&&(e=new S),V[f]=e)}if(k.isNone(y))throw new ca;return y._project(a,c,b,d,e)}function ta(a,c,b=null){if(k.isNone(y))throw new ca;if(k.isNone(a)||k.isNone(c))return null;a=y._getTransformation(J,a,c,b,null==b?void 0:b.spatialReference);return null!==a?S.fromGE(a):null}function U(a,c,b){return b?!1:w.equals(a,c)?!0:w.isValid(a)&&w.isValid(c)&&!!da(a,c,ea)}function fa(){fa=qa._asyncToGenerator(function*(a,c,b,d){if(!sa())if(Array.isArray(a))for(const {source:e,
dest:f,geographicTransformation:g}of a){if(!U(e,f,g))return aa(d)}else if(!U(a,c,b))return aa(d)});return fa.apply(this,arguments)}function Ua(a,c,b){if(!a)return a;if("x"in a){var d=new ra;return ua(a,c,d,b)?d:null}return"xmin"in a?(d=new Oa,va(a,c,d,b)?d:null):"rings"in a?(d=new Qa,wa(a,c,d,b)?d:null):"paths"in a?(d=new Ra,xa(a,c,d,b)?d:null):"points"in a?(d=new Pa,ya(a,c,d,b)?d:null):null}function ua(a,c,b,d,e=0){l[0]=a.x;l[1]=a.y;const f=a.z;l[2]=void 0!==f?f:e;if(!x(l,c,0,l,d,0,1))return!1;b.x=
l[0];b.y=l[1];b.spatialReference=d;void 0===f?(b.z=void 0,b.hasZ=!1):(b.z=l[2],b.hasZ=!0);void 0===a.m?(b.m=void 0,b.hasM=!1):(b.m=a.m,b.hasM=!0);return!0}function ya(a,c,b,d,e=0){const {points:f,hasZ:g,hasM:h}=a;a=[];const t=f.length,r=[];for(var q of f)r.push(q[0],q[1],g?q[2]:e);if(!x(r,c,0,r,d,0,t))return!1;for(c=0;c<t;++c){e=3*c;q=r[e];const u=r[e+1];g&&h?a.push([q,u,r[e+2],f[c][3]]):g?a.push([q,u,r[e+2]]):h?a.push([q,u,f[c][2]]):a.push([q,u])}b.points=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;
return!0}function xa(a,c,b,d,e=0){const {paths:f,hasZ:g,hasM:h}=a;a=[];if(!za(f,g,h,c,a,d,e))return!1;b.paths=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;return!0}function wa(a,c,b,d,e=0){const {rings:f,hasZ:g,hasM:h}=a;a=[];if(!za(f,g,h,c,a,d,e))return!1;b.rings=a;b.spatialReference=d;b.hasZ=g;b.hasM=h;return!0}function va(a,c,b,d,e=0){const {xmin:f,ymin:g,xmax:h,ymax:t,hasZ:r,hasM:q}=a;if(!ha(f,g,r?a.zmin:e,c,l,d))return!1;b.xmin=l[0];b.ymin=l[1];r&&(b.zmin=l[2]);if(!ha(h,t,r?a.zmax:e,c,l,d))return!1;
b.xmax=l[0];b.ymax=l[1];r&&(b.zmax=l[2]);q&&(b.mmin=a.mmin,b.mmax=a.mmax);b.spatialReference=d;return!0}function ha(a,c,b,d,e,f){p[0]=a;p[1]=c;p[2]=b;return x(p,d,0,e,f,0,1)}function ia(a,c,b,d){if(k.isNone(c)||k.isNone(d)||2>a.length)return!1;2===a.length&&(p[0]=a[0],p[1]=a[1],p[2]=0,a=p);return x(a,c,0,b,d,0,1)}function Aa(a,c,b){if(k.isNone(c))return!1;c=C(c,W);c=D[c][6];if(k.isNone(c))return!1;c(a,0,p,0);b!==p&&(b[0]=p[0],b[1]=p[1],2<b.length&&(b[2]=p[2]));return!0}function x(a,c,b,d,e,f,g=1){c=
da(c,e,ea);if(k.isNone(c))return!1;if(c===n){if(a===d&&b===f)return!0;g=b+3*g;for(let h=b,t=f;h<g;h++,t++)d[t]=a[h];return!0}g=b+3*g;for(let h=b,t=f;h<g;h+=3,t+=3)c(a,h,d,t);return!0}function za(a,c,b,d,e,f,g=0){const h=[];for(const t of a)for(const r of t)h.push(r[0],r[1],c?r[2]:g);if(!x(h,d,0,h,f,0,h.length/3))return!1;d=0;e.length=0;for(const t of a){a=[];for(const r of t)c&&b?a.push([h[d++],h[d++],h[d++],r[3]]):c?a.push([h[d++],h[d++],h[d++]]):(b?a.push([h[d++],h[d++],r[2]]):a.push([h[d++],h[d++]]),
d++);e.push(a)}return!0}function Ba(a,c,b){const d=Math.sin(c);c=Math.cos(c);const e=Math.sin(a);a=Math.cos(a);b[0]=-d;b[4]=-e*c;b[8]=a*c;b[12]=0;b[1]=c;b[5]=-e*d;b[9]=a*d;b[13]=0;b[2]=0;b[6]=a;b[10]=e;b[14]=0;b[3]=0;b[7]=0;b[11]=0;b[15]=1;return b}function C(a,c){if(c.spatialReference===a)return c.spatialReferenceId;c.spatialReference=a;"metersPerUnit"in c&&(c.metersPerUnit=Na.getMetersPerUnitForSR(a,1));return a.wkt===R.SphericalECEFSpatialReference.wkt?c.spatialReferenceId=1:w.isWGS84(a)?c.spatialReferenceId=
2:w.isWebMercator(a)?c.spatialReferenceId=3:a.wkt===R.WGS84ECEFSpatialReference.wkt?c.spatialReferenceId=4:4490===a.wkid?c.spatialReferenceId=5:a.wkt===R.SphericalPCPFMars.wkt?c.spatialReferenceId=7:a.wkt===R.SphericalPCPFMoon.wkt?c.spatialReferenceId=9:w.isMars(a)?c.spatialReferenceId=8:w.isMoon(a)?c.spatialReferenceId=10:c.spatialReferenceId=0}function n(a,c,b,d){a!==b&&(b[d++]=a[c++],b[d++]=a[c++],b[d]=a[c])}function K(a,c,b,d){b[d++]=L*(a[c++]/v.earth.radius);b[d++]=L*(Math.PI/2-2*Math.atan(Math.exp(-1*
a[c++]/v.earth.radius)));b[d]=a[c]}function Ca(a,c,b,d){K(a,c,b,d);E(b,d,b,d)}function Da(a,c,b,d){K(a,c,b,d);F(b,d,b,d)}function Ea(a,c,b,d,e){var f=.4999999*Math.PI;f=Q.clamp(z*a[c+1],-f,f);f=Math.sin(f);b[d++]=z*a[c]*e.radius;b[d++]=e.halfSemiMajorAxis*Math.log((1+f)/(1-f));b[d]=a[c+2]}function G(a,c,b,d){Ea(a,c,b,d,v.earth)}function ja(a,c,b,d,e){e+=a[c+2];const f=z*a[c+1];a=z*a[c];c=Math.cos(f);b[d++]=Math.cos(a)*c*e;b[d++]=Math.sin(a)*c*e;b[d]=Math.sin(f)*e}function ka(a,c,b,d){ja(a,c,b,d,v.moon.radius)}
function la(a,c,b,d){ja(a,c,b,d,v.mars.radius)}function E(a,c,b,d){ja(a,c,b,d,v.earth.radius)}function X(a,c,b,d,e){var f=a[c];const g=a[c+1];c=a[c+2];a=Math.sqrt(f*f+g*g+c*c);c=Q.asinClamped(c/(0===a?1:a));f=Math.atan2(g,f);b[d++]=L*f;b[d++]=L*c;b[d]=a-e}function ma(a,c,b,d){X(a,c,b,d,v.moon.radius)}function na(a,c,b,d){X(a,c,b,d,v.mars.radius)}function H(a,c,b,d){X(a,c,b,d,v.earth.radius)}function Fa(a,c,b,d){H(a,c,b,d);G(b,d,b,d)}function Ga(a,c,b,d){H(a,c,b,d);F(b,d,b,d)}function F(a,c,b,d){{var e=
v.earth;const g=z*a[c];var f=z*a[c+1];a=a[c+2];c=Math.sin(f);f=Math.cos(f);const h=e.radius/Math.sqrt(1-e.eccentricitySquared*c*c);b[d++]=(h+a)*f*Math.cos(g);b[d++]=(h+a)*f*Math.sin(g);b[d++]=(h*(1-e.eccentricitySquared)+a)*c}}function I(a,c,b,d){var e=Ta.earthEllipsoidConstants,f=a[c],g=a[c+1];a=a[c+2];let h;c=Math.abs(a);var t=f*f+g*g;var r=Math.sqrt(t);var q=t+a*a;var u=Math.sqrt(q);f=Math.atan2(g,f);var A=a*a/q;q=t/q;g=e.a2/u;t=e.a3-e.a4/u;.3<q?(A=c/u*(1+q*(e.a1+g+A*t)/u),u=Math.asin(A),g=A*A,
q=Math.sqrt(1-g)):(q=r/u*(1-A*(e.a5-g-q*t)/u),u=Math.acos(q),g=1-q*q,A=Math.sqrt(g));h=1-v.earth.eccentricitySquared*g;g=v.earth.radius/Math.sqrt(h);e=e.a6*g;g=r-g*q;t=c-e*A;c=q*g+A*t;r=q*t-A*g;e=r/(e/h+c);u+=e;0>a&&(u=-u);b[d++]=L*f;b[d++]=L*u;b[d]=c+r*e/2}function Ha(a,c,b,d){I(a,c,b,d);E(b,d,b,d)}function Ia(a,c,b,d){I(a,c,b,d);G(b,d,b,d)}function da(a,c,b=oa()){return k.isNone(a)||k.isNone(c)?null:Ja(a,c,b).projector}function Ja(a,c,b){if(k.isNone(a)||k.isNone(c)||b.source.spatialReference===
a&&b.dest.spatialReference===c)return b;const d=C(a,b.source),e=C(c,b.dest);0===d&&0===e?w.equals(a,c)?b.projector=n:b.projector=null:b.projector=D[d][e];return b}function oa(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:n}}let y=null,J=null,T=null,V={},ca=function(a){function c(){return a.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}qa._inheritsLoose(c,
a);return c}(La);const D={[2]:{[5]:null,[8]:null,[10]:null,[11]:n,[6]:n,[1]:E,[7]:null,[9]:null,[0]:null,[3]:G,[2]:n,[4]:F},[5]:{[5]:n,[8]:null,[10]:null,[11]:n,[6]:n,[1]:E,[7]:null,[9]:null,[0]:null,[3]:null,[2]:null,[4]:F},[8]:{[5]:null,[8]:n,[10]:null,[11]:n,[6]:null,[1]:null,[7]:la,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:n,[11]:n,[6]:null,[1]:null,[7]:null,[9]:ka,[0]:null,[3]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[11]:K,[6]:K,[1]:Ca,[7]:null,
[9]:null,[0]:null,[3]:n,[2]:K,[4]:Da},[4]:{[5]:I,[8]:null,[10]:null,[11]:I,[6]:I,[1]:Ha,[7]:null,[9]:null,[0]:null,[3]:Ia,[2]:I,[4]:n},[1]:{[5]:H,[8]:null,[10]:null,[11]:H,[6]:H,[1]:n,[7]:null,[9]:null,[0]:null,[3]:Fa,[2]:H,[4]:Ga},[7]:{[5]:null,[8]:na,[10]:null,[11]:na,[6]:null,[1]:null,[7]:n,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:ma,[11]:ma,[6]:null,[1]:null,[7]:null,[9]:n,[0]:null,[3]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[11]:null,[6]:null,
[1]:null,[7]:null,[9]:null,[0]:n,[3]:null,[2]:null,[4]:null},[11]:{[5]:n,[8]:n,[10]:n,[11]:n,[6]:n,[1]:E,[7]:la,[9]:ka,[0]:null,[3]:G,[2]:n,[4]:F},[6]:{[5]:null,[8]:null,[10]:null,[11]:n,[6]:n,[1]:E,[7]:null,[9]:null,[0]:null,[3]:null,[2]:n,[4]:F}},W={spatialReference:null,spatialReferenceId:0},Ka={spatialReference:null,spatialReferenceId:0},ea=oa(),Va=oa(),z=Q.deg2rad(1),L=Q.rad2deg(1),p=P.create(),B=P.create(),M=P.create(),l=P.create(),Y=P.create();m.canProjectToWGS84ComparableLonLat=function(a){if(k.isNone(a))return!1;
a=C(a,W);return!!D[a][6]};m.canProjectWithoutEngine=U;m.computeLatLonToENURotation=Ba;m.computeLinearTransformation=function(a,c,b,d){if(k.isNone(a)||k.isNone(d))return!1;var e=C(a,W),f=C(d,Ka);if(e===f&&1!==f&&7!==f&&9!==f&&(0!==e||w.equals(a,d)))return N.identity(b),N.translate(b,b,c),!0;if(1===f||7===f||9===f){d=a=0;e=D[e][11];f=D[11][f];if(k.isNone(e)||k.isNone(f))return!1;e(c,0,B,0);f(B,0,M,0);a=z*B[0];d=z*B[1];Ba(d,a,b);b[12]=M[0];b[13]=M[1];b[14]=M[2];return!0}if(3===f&&(2===e||1===e)){f=D[e][11];
if(k.isNone(f))return!1;f(c,0,B,0);c=z*B[1];G(B,0,M,0);N.identity(b);N.translate(b,b,M);c=1/Math.cos(c);N.scale(b,b,[c,c,1]);return!0}return!1};m.getProjectorName=function(a,c){switch(da(a,c,ea)){case n:return"copy3";case E:return"wgs84ToSphericalECEF";case G:return"wgs84ToWebMercator";case F:return"wgs84ToWGS84ECEF";case K:return"webMercatorToWGS84";case Ca:return"webMercatorToSphericalECEF";case Da:return"webMercatorToWGS84ECEF";case I:return"wgs84ECEFToWGS84";case Ha:return"wgs84ECEFToSphericalECEF";
case Ia:return"wgs84ECEFToWebMercator";case H:return"sphericalECEFToWGS84";case Fa:return"sphericalECEFToWebMercator";case na:return"sphericalMarsPCPFToMars2000";case ma:return"sphericalMoonPCPFToMoon2000";case Ga:return"sphericalECEFToWGS84ECEF";case la:return"mars2000ToSphericalPCPF";case ka:return"moon2000ToSphericalPCPF";default:return null}};m.getTransformation=ta;m.getTransformations=function(a,c,b=null){if(k.isNone(y))throw new ca;a=y._getTransformationBySuitability(J,a,c,b,null==b?void 0:
b.spatialReference);if(null!==a){c=[];for(const d of a)c.push(S.fromGE(d));return c}return[]};m.initializeProjection=function(a,c,b,d){return fa.apply(this,arguments)};m.isLoaded=sa;m.isSupported=function(){return!0};m.load=aa;m.localLinearScaleFactors=function(a,c,b,d){if(k.isNone(c)||k.isNone(d))return!1;const e=C(c,W);var f=C(d,Ka);if(e===f&&0!==e||w.equals(c,d))return b[0]=1,b[1]=1,b[2]=1,!0;if(1===e){c=O.length(a);a=c/Math.sqrt(a[0]*a[0]+a[1]*a[1]);c/=v.earth.radius;if(3===f)return b[0]=a*c,
b[1]=a*c,b[2]=1,!0;if(2===f||5===f)return f=180/(v.earth.radius*Math.PI),b[0]=f*a*c,b[1]=f*c,b[2]=1,!0}return!1};m.lonLatToSphericalPCPF=function(a,c,b,d,e=0){d+=e;e=Math.cos(b);a[0]=Math.cos(c)*e*d;a[1]=Math.sin(c)*e*d;a[2]=Math.sin(b)*d};m.lonLatToWebMercatorComparable=Ea;m.project=function(a,c,b=null){return Array.isArray(a)?0===a.length?[]:ba(J,a,a[0].spatialReference,c,b):ba(J,[a],a.spatialReference,c,b)[0]};m.projectBoundingRect=function(a,c,b,d){if(null==a)return!1;if(w.equals(c,d))return Sa.set(b,
a),!0;p[0]=a[0];p[1]=a[1];p[2]=0;if(!x(p,c,0,p,d,0,1))return!1;b[0]=p[0];b[1]=p[1];p[0]=a[2];p[1]=a[3];p[2]=0;if(!x(p,c,0,p,d,0,1))return!1;b[2]=p[0];b[3]=p[1];return!0};m.projectBoundingSphere=function(a,c,b,d){if(k.isNone(c)||k.isNone(d))return!1;c=Ja(c,d,Va);if(c.projector===n)return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],!0;if(k.isNone(c.projector))return!1;const {source:e,dest:f}=c;if(3===f.spatialReferenceId){c=D[e.spatialReferenceId][2];if(k.isNone(c))return!1;c(a,0,B,0);c=Math.abs(z*B[1])+
Math.asin(a[3]/(v.earth.radius+a[2]));G(B,0,b,0);b[3]=c>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(c)*a[3];return!0}c.projector(a,0,b,0);b[3]=a[3]*e.metersPerUnit/f.metersPerUnit;return!0};m.projectBuffer=x;m.projectDirection=function(a,c,b,d,e){O.copy(l,a);O.add(Y,a,c);ia(l,b,l,e);ia(Y,b,Y,e);O.subtract(d,Y,l);O.normalize(d,d)};m.projectExtent=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:va(a,a.spatialReference,c,b,d)};m.projectMany=ba;m.projectMultipoint=function(a,c,b=c.spatialReference,
d=0){return k.isNone(b)?!1:ya(a,a.spatialReference,c,b,d)};m.projectPoint=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:ua(a,a.spatialReference,c,b,d)};m.projectPointToVector=function(a,c,b,d=0){l[0]=a.x;l[1]=a.y;const e=a.z;l[2]=void 0!==e?e:d;return x(l,a.spatialReference,0,c,b,0,1)};m.projectPointToWGS84ComparableLonLat=function(a,c){l[0]=a.x;l[1]=a.y;const b=a.z;l[2]=void 0!==b?b:0;return Aa(l,a.spatialReference,c)};m.projectPolygon=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?
!1:wa(a,a.spatialReference,c,b,d)};m.projectPolyline=function(a,c,b=c.spatialReference,d=0){return k.isNone(b)?!1:xa(a,a.spatialReference,c,b,d)};m.projectVectorToDehydratedPoint=function(a,c,b){return x(a,c,0,l,b.spatialReference,0,1)?(b.x=l[0],b.y=l[1],b.z=l[2],b):null};m.projectVectorToPoint=function(a,c,b){if(k.isNone(c)||k.isNone(b))return null;const d=new ra({spatialReference:b});return x(a,c,0,l,b,0,1)?(d.x=l[0],d.y=l[1],d.z=l[2],d):null};m.projectVectorToVector=ia;m.projectVectorToWGS84ComparableLonLat=
function(a,c,b){return Aa(a,c,b)};m.projectXYZToVector=ha;m.sphericalPCPFtoLonLatElevation=X;m.unload=function(){T=J=y=null;V={}};Object.defineProperty(m,"__esModule",{value:!0})});