// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","./spatialReferenceUtils"],function(m,u){function p(a,b){const e=b[0]-a[0],c=b[1]-a[1];return 2<a.length&&2<b.length?(a=a[2]-b[2],Math.sqrt(e*e+c*c+a*a)):Math.sqrt(e*e+c*c)}function q(a,b,e){const c=a[0]+e*(b[0]-a[0]),g=a[1]+e*(b[1]-a[1]);return 2<a.length&&2<b.length?[c,g,a[2]+e*(b[2]-a[2])]:[c,g]}function r(a,b,e){const c=a.length;let g=0,d=0,k=0;for(let f=0;f<c;f++){const h=a[f],l=a[(f+1)%c];let n=2;g+=h[0]*l[1]-l[0]*h[1];2<h.length&&2<l.length&&e&&(d+=h[0]*l[2]-l[0]*h[2],n=3);
h.length>n&&l.length>n&&b&&(k+=h[0]*l[n]-l[0]*h[n])}return 0>=g&&0>=d&&0>=k}function t(a,b){if(b=u.getInfo(b)){var e=b.valid[0],c=b.valid[1],g=c-e;for(const d of a){let k=Infinity,f=-Infinity;d.forEach(h=>{let l=h[0];for(;l<e;)l+=g;for(;l>c;)l-=g;k=Math.min(k,l);f=Math.max(f,l);h[0]=l});a=f-k;g-a<a&&d.forEach(h=>{0>h[0]&&(h[0]+=g)})}}}m.closeRings=function(a){if("rings"in a)for(const b of a.rings)3>b.length||b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]||b.push([b[0][0],b[0][1]])};m.closeRingsAndFixWinding=
function(a){if("rings"in a){for(var b of a.rings)3>b.length||b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]||b.push([b[0][0],b[0][1]]);if(0<a.rings.length&&!r(a.rings[0],a.hasM,a.hasZ))for(b=0;b<a.rings.length;++b)a.rings[b]=a.rings[b].reverse()}};m.computeUnnormalizedVertexPositionsOnDateLineCrossing=function(a,b,e,c){let g=Infinity,d=-Infinity;a.forEach(f=>{let h=f.pos[0];for(;h<b;)h+=c;for(;h>e;)h-=c;g=Math.min(g,h);d=Math.max(d,h);f.unnormalizedPos[0]=h;f.unnormalizedPos[1]=f.pos[1];2<
f.pos.length&&(f.unnormalizedPos[2]=f.pos[2]);3<f.pos.length&&(f.unnormalizedPos[3]=f.pos[3])});const k=d-g;c-k<k&&a.forEach(f=>{0>f.unnormalizedPos[0]&&(f.unnormalizedPos[0]+=c)})};m.geometryToCoordinates=function(a){if(!a)return null;if(Array.isArray(a))return a;const b=a.hasZ,e=a.hasM;if("point"===a.type)return e&&b?[a.x,a.y,a.z,a.m]:b?[a.x,a.y,a.z]:e?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);
if("extent"===a.type){a=a.clone().normalize();if(!a)return null;let c=!1,g=!1;a.forEach(d=>{d.hasZ&&(c=!0);d.hasM&&(g=!0)});return a.map(d=>{const k=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];if(c&&d.hasZ){var f=.5*(d.zmax-d.zmin);for(let h=0;h<k.length;h++)k[h].push(f)}if(g&&d.hasM)for(d=.5*(d.mmax-d.mmin),f=0;f<k.length;f++)k[f].push(d);return k})}return null};m.getLength=p;m.getMidpoint=function(a,b){return q(a,b,.5)};m.getPathLength=function(a){const b=a.length;
let e=0;for(let c=0;c<b-1;++c)e+=p(a[c],a[c+1]);return e};m.getPointOnPath=function(a,b){if(0>=b)return a[0];const e=a.length;let c=0;for(let g=0;g<e-1;++g){const d=p(a[g],a[g+1]);if(b-c<d)return q(a[g],a[g+1],(b-c)/d);c+=d}return a[e-1]};m.getRingArea=function(a){const b=a.length;let e=0;for(let c=0;c<b;c++){const g=a[c],d=a[(c+1)%b];e+=g[0]*d[1]-d[0]*g[1]}return e};m.isClockwise=r;m.projectPointOnLine=function(a,b,e,c){const [g,d]=b,[k,f]=e[c],[h,l]=e[c+1];b=h-k;e=l-f;c=Math.min(1,Math.max(0,((g-
k)*b+(d-f)*e)/(b*b+e*e)));a[0]=k+b*c;a[1]=f+e*c;return a};m.unnormalizeGeometryOnDatelineCrossing=function(a){if("polygon"!==a.type&&"polyline"!==a.type)return a;t("polygon"===a.type?a.rings:a.paths,a.spatialReference);return a};m.unnormalizeVerticesOnDatelineCrossing=t;Object.defineProperty(m,"__esModule",{value:!0})});