// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/decorators/cast ../core/jsonMap ../core/accessorSupport/decorators/subclass".split(" "),function(p,l,d,b,q,r,e,m,h,y,t,z,u){const v=r.getLogger("esri.portal.PortalItemResource");b=function(n){function k(a){a=n.call(this,a)||this;a.portalItem=null;return a}l._inheritsLoose(k,
n);var f=k.prototype;f.normalizeCtorArgs=function(a){return a&&a.portalItem&&a.path?{...a,path:this.normalizePath(a.path,a.portalItem)}:a};f._castPath=function(a){return this.normalizePath(a,this.portalItem)};f.fetch=function(a="json",c){const g=this.url;if(e.isNone(g))throw new q("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(g,{responseType:a,query:{token:this.portalItem.apiKey},signal:e.get(c,"signal")})};f.update=
function(){var a=l._asyncToGenerator(function*(c,g){return(yield new Promise(function(w,x){p(["./support/resourceUtils"],w,x)})).addOrUpdateResource(this,"update",c,g)});return function(c,g){return a.apply(this,arguments)}}();f.hasPath=function(){return e.isSome(this.path)};f.normalizePath=function(a,c){if(e.isNone(a))return a;a=a.replace(/^\/+/,"");e.isSome(c)&&m.isAbsolute(a)&&(a=m.makeRelative(a,c.itemUrl));return a.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")};l._createClass(k,[{key:"path",
set:function(a){e.isSome(a)&&m.isAbsolute(a)?v.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",a)}},{key:"url",get:function(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}},{key:"itemRelativeUrl",get:function(){return this.portalItem&&this.path?`./resources/${this.path}`:null}}]);return k}(b);d.__decorate([h.property()],b.prototype,"portalItem",void 0);d.__decorate([h.property({type:String,value:null})],
b.prototype,"path",null);d.__decorate([t.cast("path")],b.prototype,"_castPath",null);d.__decorate([h.property({type:String,readOnly:!0})],b.prototype,"url",null);d.__decorate([h.property({type:String,readOnly:!0})],b.prototype,"itemRelativeUrl",null);return b=d.__decorate([u.subclass("esri.portal.PortalItemResource")],b)});