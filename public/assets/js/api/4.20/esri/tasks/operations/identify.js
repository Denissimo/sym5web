// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../core/maybe","../../geometry/support/jsonUtils","../../geometry/support/scaleUtils","../../layers/support/layerUtils"],function(t,y,z,A,u){t.identifyToIdentifyRESTParameters=function(b,a){const {dpi:B,dynamicLayers:m,gdbVersion:v,geometry:C,geometryPrecision:D,height:E,layerDefinitions:h,layerIds:n,layerOption:F,layerTimeOptions:p,mapExtent:d,maxAllowableOffset:G,returnFieldName:H,returnGeometry:I,returnUnformattedValues:J,returnZ:K,spatialReference:q,timeExtent:w,tolerance:L,
width:x}=b.toJSON();a=a&&y.isSome(a.geometry)?a.geometry:null;b={geometryPrecision:D,maxAllowableOffset:G,returnFieldName:H,returnGeometry:I,returnUnformattedValues:J,returnZ:K,tolerance:L};a=a&&a.toJSON()||C;b.imageDisplay=`${x},${E},${B}`;v&&(b.gdbVersion=v);a&&(delete a.spatialReference,b.geometry=JSON.stringify(a),b.geometryType=z.getJsonType(a));q?b.sr=q.wkid||JSON.stringify(q):a&&a.spatialReference?b.sr=a.spatialReference.wkid||JSON.stringify(a.spatialReference):d&&d.spatialReference&&(b.sr=
d.spatialReference.wkid||JSON.stringify(d.spatialReference));b.time=w?w.join(","):null;if(d){const {xmin:e,ymin:k,xmax:r,ymax:M}=d;b.mapExtent=`${e},${k},${r},${M}`}b.layers=F;n&&(b.layers+=`:${n.join(",")}`);if(h){a=[];for(var f=0;f<h.length;f++){var l=h[f];a[l.id]=l.definitionExpression}b.layerDefs=u.serializeLayerDefinitions(a)}if(m&&m.length){a=[];f=A.getScale({extent:d,width:x,spatialReference:d.spatialReference});f=u.getLayersForScale(f,m);for(l=0;l<m.length;l++){var c=m[l];const e=c.id;if(!c.subLayerIds&&
n&&-1!==n.indexOf(e)&&-1!==f.indexOf(e)){const k={id:e};k.source=c.source;c=null;h&&h.length&&(c=(c=h.filter(r=>r.id===e)[0])&&c.definitionExpression);c&&(k.definitionExpression=c);var g=void 0;p&&p[e]&&(g=p[e]);g&&(k.layerTimeOptions=g);a.push(k)}}g=JSON.stringify(a);"[]"===g&&(g="[{}]");b.dynamicLayers=g}return b};Object.defineProperty(t,"__esModule",{value:!0})});