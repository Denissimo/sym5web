// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ../shaders/ShadedColorMaterialTechnique".split(" "),function(r,t,k,l,u,C,D,E,v,F,w,x,m){let L=function(f){function d(a){a=f.call(this,a,G)||this;a.supportsEdges=
!0;a.techniqueConfig=new m.ShadedColorMaterialTechniqueConfiguration;a._vertexAttributeLocations=m.ShadedColorMaterialVertexAttrLocations;return a}t._inheritsLoose(d,f);var b=d.prototype;b.getTechniqueConfig=function(a,c){this.techniqueConfig.output=a;this.techniqueConfig.cullFace=this.params.cullFace;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.screenSizeEnabled=
this.params.screenSizeEnabled;this.techniqueConfig.shadingEnabled=this.params.shadingEnabled;this.techniqueConfig.transparencyPassType=c?c.transparencyPassType:3;this.techniqueConfig.multipassTerrainEnabled=c?c.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=c?c.cullAboveGround:!1;return this.techniqueConfig};b.getPassParameters=function(){return this.params};b.intersect=function(a,c,n,h,y,z,A){if(this.params.screenSizeEnabled){const p=a.vertexAttributes.get("offset");x.intersectTriangleGeometry(a,
c,h,y,z,{applyToVertex:(e,q,H,g)=>{g=k.set(B,p.data[3*g],p.data[3*g+1],p.data[3*g+2]);e=k.set(I,e,q,H);k.scale(g,g,this.params.screenSize*h.camera.computeRenderPixelSizeAt(g));k.add(e,e,g);return[e[0],e[1],e[2]]},applyToAabb:e=>{const q=u.center(e,B);return u.scale(e,this.params.screenSize*h.camera.computeRenderPixelSizeAt(q))}},A)}else x.intersectTriangleGeometry(a,c,h,y,z,void 0,A)};b.getGLMaterial=function(a){return 0===a.output||7===a.output||4===a.output?new J(a):void 0};b.createBufferWriter=
function(){return new K(this.params.screenSizeEnabled)};return d}(v.Material),J=function(f){function d(a){a=f.call(this,a)||this;a.updateParameters();return a}t._inheritsLoose(d,f);var b=d.prototype;b.updateParameters=function(a){this._technique=this._techniqueRep.releaseAndAcquire(m.ShadedColorMaterialTechnique,this._material.getTechniqueConfig(this._output,a),this._technique)};b.beginSlot=function(a){if(4===this._output)return 3===a;let c=3;this._technique.configuration.transparent&&(c=this._technique.configuration.writeDepth?
5:8);return a===c};b.ensureParameters=function(a){this.updateParameters(a)};b.bind=function(a){this._technique.bindPass(this._material.getPassParameters(),a)};return d}(E);const G={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:k.normalize(l.create(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...v.materialParametersDefaults};let K=function(){function f(b){this.screenSizeEnabled=b;b=D.newLayout().vec3f("position").vec3f("normal");
this.screenSizeEnabled&&b.vec3f("offset");this.vertexBufferLayout=b}var d=f.prototype;d.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};d.elementCount=function(b){return b.indices.get("position").length};d.write=function(b,a,c,n){w.writeDefaultAttributes(a,this.vertexBufferLayout,b.transformation,b.invTranspTransformation,c,n);if(this.screenSizeEnabled)if(a.vertexAttributes.has("offset")){const h=a.vertexAttributes.get("offset");a=a.indices.get("offset");F.assert(3===h.size);
if(c=c.getField("offset",C.BufferViewVec3f))w.writePosition(a,h.data,b.invTranspTransformation,c,n);else throw Error("unable to acquire view for offset");}else throw Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");};return f}();const B=l.create(),I=l.create();r.ShadedColorMaterial=L;Object.defineProperty(r,"__esModule",{value:!0})});