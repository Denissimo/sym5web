// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/ray ./common ../../support/intersectionUtils".split(" "),function(k,n,t,p,g,u,f,v){function l(b,d,c=f.defaultApplyOptions){var a=b.state.constraints.altitude;a=b.state.isGlobal&&a?2===c.interactionType&&f.hasConstraintType(c.selection,1)?!1:!0:!1;if(!a)return 0;var e=b.state.constraints.altitude;a=w;a.min=e.min;a.max=e.max;e=c.interactionType;if(0!==e){var {min:h,
max:x}=a,{interactionStartCamera:q,interactionFactor:y}=c;c=2===e||1===e;e=l(b,q);var r=0===e?0:b.renderCoordsHelper.getAltitude(q.eye);a.min=h;a.max=x;f.adjustRangeForInteraction(e,r,c,y,.05*r,a)}b=b.renderCoordsHelper.getAltitude(d.eye);b=n.clamp(b,a.min,a.max)-b;return 1E-6>=Math.abs(b)?0:b}function z(b,d,c,a){b.renderCoordsHelper.worldUpAtPosition(d.eye,a);p.scale(a,a,c);return a}const w={min:0,max:0},A=g.create(),B=g.create(),C=g.create(),m=g.create();k.applyAltitudeConstraint=function(b,d,c=
f.defaultApplyOptions){const a=l(b,d,c);if(0===a)return!1;const e=b.renderCoordsHelper,h=e.getAltitude(d.eye)+a;c=f.interactionDirectionTowardsConstraintMinimization(d,c.interactionDirection,z(b,d,n.sign(a),B),A);b=p.copy(C,d.viewForward);c=e.intersectInfiniteManifold(u.wrap(d.eye,c),h,m);d.eye=t.isSome(c)?c:e.setAltitude(m,h,d.eye);d.center=v.closestPointOnRay(m,d.eye,b,d.center);return!0};k.getAltitudeConstraintError=l;Object.defineProperty(k,"__esModule",{value:!0})});