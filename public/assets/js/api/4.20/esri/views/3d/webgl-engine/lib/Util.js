// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/mathUtils ../../../../chunks/mat4 ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64".split(" "),function(f,p,F,v,G,w,x,H){function y(a,b){if(!a)throw b=b||"assert",a=Error(b),a.stack&&console.log(a.stack),new z(b);}function A(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]}function B(a,b=0){let c=0;for(let d=0;4>d;d++)c+=a[b+d]*I[d];return c}function J(a){return a-Math.floor(a)}const l=H.create();
let z=function(){function a(b){this.message=b}a.prototype.toString=function(){return`AssertException: ${this.message}`};return a}();const K=[1,256,65536,16777216],I=[1/256,1/65536,1/16777216,1/4294967296],L=B(new Uint8ClampedArray([255,255,255,255]));f.AssertException=z;f.assert=y;f.createTranslationMatrix=function(a,b){a=F.identity(a);A(a,b);return a};f.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};f.encodeInt16=function(a){return p.clamp(Math.round(32767*a),-32767,
32767)};f.encodeNormal=function(a,b){const c=Math.abs(a[0]),d=Math.abs(a[1]),e=1/(c+d+Math.abs(a[2])),g=Math.min(a[2]*e,0);b[0]=(0>a[0]?-1:1)*(c*e-g);b[1]=(0>a[1]?-1:1)*(d*e-g)};f.fallbackIfUndefined=function(a,b){return void 0===a?b:a};f.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};f.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};f.fovx2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/b)};f.fovx2fovy=
function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};f.fovy2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};f.fovy2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};f.getFirstObjectKey=function(a){for(const b in a)return b};f.getMatrixTranslation=function(a,b=w.create()){b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};f.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};f.inverseProjectionInfo=function(a,b,c,d,e){0===a[11]?
(d[0]=2/(b*a[0]),d[1]=2/(c*a[5]),d[2]=(1+a[12])/a[0],d[3]=(1+a[13])/a[5],v.set(e,0,1)):(d[0]=-2/(b*a[0]),d[1]=-2/(c*a[5]),d[2]=(1-a[8])/a[0],d[3]=(1-a[9])/a[5],v.set(e,1,0))};f.isTranslationMatrix=function(a){return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&1===a[15]};f.logWithBase=function(a,b){return Math.log(a)/Math.log(b)};f.objectEmpty=function(a){for(const b in a)return!1;return!0};f.packFloatRGBA=function(a,b,c=
0){a=p.clamp(a,0,L);for(let d=0;4>d;d++)b[c+d]=Math.floor(256*J(a*K[d]))};f.project=function(a,b,c,d,e){e||(e=a);l[0]=a[0];l[1]=a[1];l[2]=a[2];l[3]=1;x.transformMat4(l,l,b);2<e.length&&(e[2]=-l[2]);x.transformMat4(l,l,c);y(0!==l[3]);e[0]=l[0]/l[3];e[1]=l[1]/l[3];e[2]=l[2]/l[3];e[0]=(.5*e[0]+.5)*d[2]+d[0];e[1]=(.5*e[1]+.5)*d[3]+d[1]};f.rayBoxTest=function(a,b,c,d){let e,g=(c[0]-a[0])/b[0],h=(d[0]-a[0])/b[0];g>h&&(e=g,g=h,h=e);let k=(c[1]-a[1])/b[1],m=(d[1]-a[1])/b[1];k>m&&(e=k,k=m,m=e);if(g>m||k>h)return!1;
k>g&&(g=k);m<h&&(h=m);c=(c[2]-a[2])/b[2];a=(d[2]-a[2])/b[2];c>a&&(e=c,c=a,a=e);if(g>a||c>h)return!1;a<h&&(h=a);return 0>h?!1:!0};f.rayRay2D=function(a,b,c,d,e,g=G.create()){const h=(d[e]-c[e])*(b[0]-a[0])-(d[0]-c[0])*(b[e]-a[e]);if(0===h)return!1;c=((d[0]-c[0])*(a[e]-c[e])-(d[e]-c[e])*(a[0]-c[0]))/h;g[0]=a[0]+c*(b[0]-a[0]);g[1]=a[e]+c*(b[e]-a[e]);return!0};f.rayTriangle3D=function(a,b,c,d,e,g,h,k,m=w.create()){var n=d[h]-c[g];const q=d[h+1]-c[g+1],r=d[h+2]-c[g+2];d=e[k]-c[g];h=e[k+1]-c[g+1];e=e[k+
2]-c[g+2];const C=b[1]*e-h*b[2],D=b[2]*d-e*b[0],E=b[0]*h-d*b[1];k=n*C+q*D+r*E;if(-1E-5<k&&1E-5>k)return!1;k=1/k;const t=a[0]-c[g],u=a[1]-c[g+1];a=a[2]-c[g+2];m[1]=k*(t*C+u*D+a*E);if(0>m[1]||1<m[1])return!1;c=u*r-q*a;a=a*n-r*t;n=t*q-n*u;m[2]=k*(b[0]*c+b[1]*a+b[2]*n);if(0>m[2]||1<m[1]+m[2])return!1;m[0]=k*(d*c+h*a+e*n);return!0};f.rgb2hex=function(a){const b=p.clamp(Math.round(255*a[0]),0,255),c=p.clamp(Math.round(255*a[1]),0,255);a=p.clamp(Math.round(255*a[2]),0,255);return"0x"+((b<<16)+(c<<8)+a).toString(16)};
f.setMatrixTranslation=A;f.setMatrixTranslation3=function(a,b,c,d){a[12]=b;a[13]=c;a[14]=d};f.unpackFloatRGBA=B;f.verify=function(a,b){a||console.warn("Verify failed: "+(b||"")+"\n"+Error("verify").stack)};Object.defineProperty(f,"__esModule",{value:!0})});