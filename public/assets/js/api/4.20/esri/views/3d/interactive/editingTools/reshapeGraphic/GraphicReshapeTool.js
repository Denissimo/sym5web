// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/Logger ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ./isSupportedGraphic ./ReshapeOperation ../../../../interactive/InteractiveToolBase".split(" "),
function(b,k,c,n,p,g,q,d,v,w,x,y,r,l,t,u){b.GraphicReshapeTool=function(m){function h(a){a=m.call(this,a)||this;a._handles=new p;a._reshapeOperation=null;a._internalGeometryUpdate=!1;a.enableZShape=!0;a.enableZVertex=!0;a.enableMoveGraphic=!0;a.enableMidpoints=!0;a.enableEdgeOffset=!1;a.type="reshape-3d";a.snappingManager=null;return a}k._inheritsLoose(h,m);var e=h.prototype;e.destroy=function(){this._handles.removeAll();this._reshapeOperation=g.destroyMaybe(this._reshapeOperation);this._set("view",
null);this._set("graphic",null)};e._updateGeometry=function(){const a=l.geometryOfSupportedGraphic(this.graphic);this._reshapeOperation.inputGeometry=g.isSome(a)?a.clone():null};e._updateGraphic=function(){this._handles.remove("onGraphicGeometryChange");this._updateGeometry();if(0===l.isSupportedGraphic(this.graphic)){var a=this.watch("graphic.geometry",()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()},!0);this._handles.add(a,"onGraphicGeometryChange")}};e.manipulatorSelectionChanged=
function(){this._reshapeOperation&&this._reshapeOperation.manipulatorSelectionChanged()};e._updateGeometryInternally=function(a){this._internalGeometryUpdate=!0;this.graphic.geometry=a;this._internalGeometryUpdate=!1};e._onReshapeGeometryChanged=function(){g.isNone(this.graphic)||this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())};e.initialize=function(){this._reshapeOperation=new t.ReshapeOperation({tool:this});this._handles.add([this._reshapeOperation.on("reshape",a=>
{"reshape"===a.type&&this._onReshapeGeometryChanged();this.emit("reshape",a)}),this._reshapeOperation.on("move",a=>{"move"===a.type&&this._onReshapeGeometryChanged();this.emit("move",a)}),this._reshapeOperation.on("vertex-add",a=>{this._onReshapeGeometryChanged();this.emit("vertex-add",a)}),this._reshapeOperation.on("vertex-remove",a=>{this._onReshapeGeometryChanged();this.emit("vertex-remove",a)}),this._reshapeOperation.on("immediate-click",a=>this.emit("immediate-click",a)),this.view.on("pointer-down",
["Shift"],a=>{a.stopPropagation()}),q.init(this,"graphic",()=>{this._updateGraphic()},!0)]);this.complete()};e.undo=function(){g.isSome(this.snappingManager)&&this.snappingManager.doneSnapping();g.isSome(this._reshapeOperation.undo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())};e.redo=function(){g.isSome(this.snappingManager)&&this.snappingManager.doneSnapping();g.isSome(this._reshapeOperation.redo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())};
e.onInputEvent=function(a){"key-down"!==a.type||"Delete"!==a.key&&"Backspace"!==a.key||this._reshapeOperation.removeSelectedVertices()};e.reset=function(){};k._createClass(h,[{key:"updating",get:function(){var a,f;return null!=(a=null==(f=this._reshapeOperation)?void 0:f.updating)?a:!1}},{key:"selectionManagementDisabled",get:function(){return!0}},{key:"canUndo",get:function(){var a,f;return null!=(a=null==(f=this._reshapeOperation)?void 0:f.canUndo)?a:!1}},{key:"canRedo",get:function(){var a,f;return null!=
(a=null==(f=this._reshapeOperation)?void 0:f.canRedo)?a:!1}},{key:"test",get:function(){return{snappingManager:this.snappingManager}}}]);return h}(n.EventedMixin(u.InteractiveToolBase));c.__decorate([d.property()],b.GraphicReshapeTool.prototype,"_reshapeOperation",void 0);c.__decorate([d.property({constructOnly:!0,nonNullable:!0})],b.GraphicReshapeTool.prototype,"view",void 0);c.__decorate([d.property({constructOnly:!0})],b.GraphicReshapeTool.prototype,"graphic",void 0);c.__decorate([d.property({constructOnly:!0,
nonNullable:!0})],b.GraphicReshapeTool.prototype,"enableZShape",void 0);c.__decorate([d.property({constructOnly:!0,nonNullable:!0})],b.GraphicReshapeTool.prototype,"enableZVertex",void 0);c.__decorate([d.property({constructOnly:!0,nonNullable:!0})],b.GraphicReshapeTool.prototype,"enableMoveGraphic",void 0);c.__decorate([d.property({constructOnly:!0,nonNullable:!0})],b.GraphicReshapeTool.prototype,"enableMidpoints",void 0);c.__decorate([d.property({constructOnly:!0,nonNullable:!0})],b.GraphicReshapeTool.prototype,
"enableEdgeOffset",void 0);c.__decorate([d.property({readOnly:!0})],b.GraphicReshapeTool.prototype,"type",void 0);c.__decorate([d.property({constructOnly:!0})],b.GraphicReshapeTool.prototype,"snappingManager",void 0);c.__decorate([d.property({readOnly:!0})],b.GraphicReshapeTool.prototype,"updating",null);b.GraphicReshapeTool=c.__decorate([r.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],b.GraphicReshapeTool);Object.defineProperty(b,"__esModule",{value:!0})});