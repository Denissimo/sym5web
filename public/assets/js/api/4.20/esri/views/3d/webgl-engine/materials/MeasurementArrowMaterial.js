// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../shaders/MeasurementArrowTechnique".split(" "),function(y,z,c,n,G,H,A,B){let L=function(g){function e(a){a=g.call(this,a,I)||this;a.techniqueConfig=new B.MeasurementArrowTechniqueConfiguration;return a}z._inheritsLoose(e,g);var b=e.prototype;b.getTechniqueConfig=function(){this.techniqueConfig.polygonOffsetEnabled=
this.params.polygonOffset;return this.techniqueConfig};b.dispose=function(){};b.getPassParameters=function(){return this.params};b.intersect=function(){};b.createBufferWriter=function(){return new J};b.getGLMaterial=function(a){return 0===a.output?new K(a):void 0};return e}(A.Material),K=function(g){function e(a){a=g.call(this,a)||this;a.updateParameters();return a}z._inheritsLoose(e,g);var b=e.prototype;b.updateParameters=function(){this._technique=this._techniqueRep.releaseAndAcquire(B.MeasurementArrowTechnique,
this._material.getTechniqueConfig(),this._technique)};b.beginSlot=function(a){return 3===a};b.bind=function(a){this._technique.bindPass(this._material.getPassParameters(),a)};return e}(H);const I={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1,...A.materialParametersDefaults},M=G.newLayout().vec3f("position").vec3f("normal").vec2f("uv0").f32("auxpos1"),h=n.create(),p=n.create(),t=n.create(),k=n.create(),u=n.create();
let J=function(){function g(){this.vertexBufferLayout=M}var e=g.prototype;e.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};e.elementCount=function(b){return 2*(b.indices.get("position").length/2+1)};e.write=function(b,a,m,C){var f=a.vertexAttributes.get("position").data;const x=a.vertexAttributes.get("normal").data,q=f.length/3;(a=a&&a.indices&&a.indices.get("position"))&&a.length!==2*(q-1)&&console.warn("MeasurementArrowMaterial does not support indices");a=b.transformation;
const D=b.invTranspTransformation,E=m.position,F=m.normal,v=m.uv0;b=0;for(let l=0;l<q;++l){var d=3*l;c.set(h,f[d],f[d+1],f[d+2]);l<q-1&&(d=3*(l+1),c.set(p,f[d],f[d+1],f[d+2]),c.set(u,x[d],x[d+1],x[d+2]),c.normalize(u,u),c.subtract(t,p,h),c.normalize(t,t),c.cross(k,u,t),c.normalize(k,k));d=c.distance(h,p);a&&D&&(c.transformMat4(h,h,a),c.transformMat4(p,p,a),c.transformMat4(k,k,D));const r=C+2*l,w=r+1;E.setVec(r,h);E.setVec(w,h);F.setVec(r,k);F.setVec(w,k);v.set(r,0,b);v.set(r,1,-1);v.set(w,0,b);v.set(w,
1,1);l<q-1&&(b+=d)}m=m.auxpos1;for(f=0;f<2*q;++f)m.set(C+f,b)};return g}();y.MeasurementArrowMaterial=L;Object.defineProperty(y,"__esModule",{value:!0})});