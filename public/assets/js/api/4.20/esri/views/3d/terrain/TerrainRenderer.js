// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/Accessor ../../../core/maybe ../../../core/ObjectPool ../../../core/PooledArray ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/vec4 ../../../chunks/vec4f64 ../../../geometry/support/aaBoundingBox ../../../geometry/support/buffer/BufferView ../../../support/requestImageUtils ./OverlayRenderer ./PatchGeometryFactory ./PatchRenderData ./TerrainConst ./TileRenderer ./tileUtils ../webgl-engine/core/shaderLibrary/Slice.glsl ../webgl-engine/core/shaderLibrary/shading/ScreenSpaceReflections.glsl ../webgl-engine/core/shaderLibrary/util/View.glsl ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/intersectorUtils ../webgl-engine/lib/screenSizePerspectiveUtils ../webgl-engine/lib/verticalOffsetUtils ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/TerrainTechnique".split(" "),
function(W,n,fa,m,x,X,I,q,Ba,Ca,Da,Ea,ha,ia,Y,u,A,Z,J,Q,ja,ka,aa,ba,la,ma,na,K,oa,pa,qa,ra,sa,ta,ca,R,S){function da(B,v,e){Z.set(e,B[0]*v[2]+v[0],B[1]*v[3]+v[1],B[2]*v[2],B[3]*v[3])}const L=Q.create(),M=J.create();let ua=function(){this.extent=J.create();this.maxLevel=this.minLevel=0;this.callback=null};m=function(B){function v(a){a=B.call(this,a)||this;a.type="Terrain";a.isGround=!0;a.tileSize=256;a.rctx=null;a._isTransparent=!1;a.renderDataPool=new X(la.PatchRenderData);a._patchGroups=new I({allocator:b=>
b||{root:null,origin:null,patches:new I},deallocator:b=>{b.root=null;b.origin=null;b.patches.clear();return b}});a.patchGroupsDirty=!0;a.patchGroupsMap=new Map;a.tileIterator=new K.IteratorPreorder;a.highestVisibleLODTile=null;a.visible=!0;a._opaque=!0;a._skirtScale=1;a._velvetOverground=!0;a.castShadows=!0;a._ssrEnabled=!1;a.emptyTex=null;a.tileRenderer=null;a.tileBackgroundInitialized=!1;a.tileBackgroundUpdating=!1;a.stencilEnabledLayerExtents=[];a.numTrianglesRendered=0;a.numTilesRendered=0;a.numTilesCulled=
0;a.numOriginsRendered=0;a.clippingExtent=null;a.overlayOpacity=1;a.needsHighlight=!1;a.renderOccludedFlags=1;a.visibleScaleRangeQueries=new I({initialSize:10});a.visibleScaleRangeQueriesInvPtr=0;a.visibleScaleRangeQueryQueue=new I({initialSize:30});a.visibleScaleRangeQueryPool=new X(ua);return a}W._inheritsLoose(v,B);var e=v.prototype;e.initialize=function(){this.stage.addRenderPlugin([2,7,9],this)};e.destroy=function(){this.stage.removeRenderPlugin(this);ba.clearCaches()};e.setDebugScreenSizePerspective=
function(a){this.shaderTechniqueConfig.screenSizePerspective!==a&&(this.shaderTechniqueConfig.screenSizePerspective=a,this.setNeedsRender())};e.setRootTiles=function(a){this.rootTiles=a;this.setNeedsRender()};e.setNeedsHighlight=function(a){this.needsHighlight=a;this.setNeedsRender()};e.setRenderOccludedOverlay=function(a){this.renderOccludedFlags=a?aa.overlayRenderOccludedFlag:1;this.setNeedsRender()};e.setStencilEnabledLayerExtents=function(a){this.stencilEnabledLayerExtents=a;this.setNeedsRender()};
e.setTileSize=function(a){this.tileSize=a;this.tileRenderer&&(this.tileRenderer.tileSize=a);this.setNeedsRender()};e.loadTile=function(a){a.renderData||(a.renderData=this.renderDataPool.acquire(),a.renderData.init(a),a.renderData.localOrigin=this._getLocalOriginOfTile(a));this.updateTileGeometry(a);this.updateTileTexture(a)};e.queryVisibleLevelRange=function(a,b,c,d){const f=this.visibleScaleRangeQueryPool.acquire();Z.copy(f.extent,a);f.minLevel=b?b:-Number.MAX_VALUE;f.maxLevel=null!=c?c:Number.MAX_VALUE;
f.callback=d;this.visibleScaleRangeQueryQueue.push(f);this.setNeedsRender()};e.updateTileTexture=function(a){this.tileRenderer&&this.tileBackgroundInitialized&&(this.tileRenderer.updateTileTexture(a),this.setNeedsRender(),a.resetPendingUpdate(64))};e.updateTileGeometry=function(a){for(const b of a.layerInfo[0])b.pendingUpdates&=-33;a.resetPendingUpdate(32);a.renderData.updateGeometry(this.rctx,this.wireframe)&&this.setNeedsRender()};e.unloadTile=function(a){a.renderData&&(a.renderData.releaseGeometry()&&
this.setNeedsRender(),this.renderDataPool.release(a.renderData),a.renderData.clear(),a.renderData=null,a.setMemoryDirty(),this.setNeedsRender())};e._getLocalOriginOfTile=function(a){const b=Math.max(0,7*Math.floor((a.lij[0]-3)/7));if(this.isGlobal&&0===b)return A.ZEROS;for(;a.parent&&a.lij[0]>b;)a=a.parent;return a.centerAtSeaLevel};e.setVisibility=function(a){this.visible=a;this.setNeedsRender()};e.getStats=function(){return{numTilesRendered:this.numTilesRendered,numTilesCulled:this.numTilesCulled,
numTrianglesRendered:this.numTrianglesRendered,numOriginsRendered:this.numOriginsRendered}};e.setNeedsRender=function(a=1){this.patchGroupsDirty=!0;this.context.requestRender(a)};e.setTileBackground=function(a){this.tileBackground=a;this._updateTileBackground()};e.initializeRenderContext=function(a){this.context=a;this.rctx=a.renderContext.rctx;this.shaderTechniques=a.shaderTechniqueRep;this.shaderTechniqueConfig=new S.TerrainTechniqueConfiguration;this.tileRenderer=new na.TileRenderer(this.rctx,
this.tileSize,this.shaderTechniques);this.tileBackground&&this._updateTileBackground();this.emptyTex=ra.createEmptyTexture(this.rctx)};e.uninitializeRenderContext=function(){null!=this.emptyTex&&(this.emptyTex.dispose(),this.emptyTex=null);this.tileRenderer&&(this.tileRenderer.dispose(),this.tileRenderer=null)};e.intersect=function(a,b,c,d){if(this.rootTiles&&(!a.options.selectOpaqueTerrainOnly||!a.options.selectionMode||this._opaque)){var f=va,l=wa;u.subtract(f,d,c);u.set(l,1/f[0],1/f[1],1/f[2]);
var h=a.results.min,r=a.results.max,C=a.results.ground,F=0===a.options.store,w=!!a.results.ground.target,p,y=ca.getVerticalOffsetTerrain(a.verticalOffset),G=this.clippingExtent;this.allTiles.forAll(g=>{if(!(null===g.renderData||w&&this._useStencilForTile(g))){if(a.options.invisibleTerrain){if(!g.visible&&G&&!g.intersectsExtent(G))return}else if(!g.visible)return;var t=g.renderData.geometryInfo;Q.set(L,t.boundingBox);var N=g.renderData.localOrigin;x.isSome(y)&&(y.localOrigin=N,y.applyToAabb(L));var D=
-this._skirtScale*t.skirtLength;if(0!==D){var E=g.up;Q.expandWithOffset(L,D*E[0],D*E[1],D*E[2])}u.subtract(O,c,N);if(R.intersectAabbInvDirBefore(L,O,l,a.tolerance,F&&null!=h.dist?h.dist:Infinity)){var H=(k,z,xa,ya)=>{k.set(void 0,K.tile2str(z),xa,ya,Y.IDENTITY,void 0);k.intersector="TerrainRenderer";k.target={type:"external",metadata:{tile:z}}};E=(k,z)=>{0<=k&&(a.options.backfacesTerrain||0>u.dot(z,f))&&(a.options.invisibleTerrain||!a.options.selectionMode||null==b||b(c,d,k))&&((null==C.dist||k<C.dist)&&
H(C,g,k,z),a.options.isFiltered||(2===a.options.store&&(x.isNone(p)?(p=new sa.IntersectorResult(a.ray),H(p,g,k,z),a.results.all.push(p)):k<p.dist&&H(p,g,k,z)),(null==h.dist||k<h.dist)&&H(h,g,k,z),0!==a.options.store&&(null==r.dist||k>r.dist)&&H(r,g,k,z)))};var T=za;u.subtract(T,d,N);var U=t.indices,V=t.vertexAttributes,Aa={data:V.getField("position",ja.BufferViewVec3f).typedBuffer,size:3,stride:V.stride/4};t=t.numWithoutSkirtIndices/3;R.intersectTriangles(O,T,0,t,U,Aa,null,y,E);0!==D&&ba.intersectSkirts(O,
T,t,U.length/3,U,V,this.isGlobal?k=>u.scale(k,k,D/u.length(u.add(k,k,N))):k=>u.set(k,0,0,D),y,E)}}})}};e.prepareRender=function(){1>this.overlayOpacity&&this.updateOverlayOpacity()};e.render=function(a){if(9===a.slot){if(0===(a.renderOccludedMask&aa.overlayRenderOccludedFlag))return!1}else if(a.slot!==(this.opaque?2:7))return!1;var b=a.pass;const c=1===a.scenelightingData.globalFactor,d=this._updatePatchGroups();switch(b){case 0:b=a.shadowMap&&a.shadowMap.enabled;this.shaderTechniqueConfig.receiveShadows!==
b&&(this.shaderTechniqueConfig.receiveShadows=b);b=this.overlayRenderer.isEmpty()?0:this.overlayRenderer.hasWater?2:1;this.shaderTechniqueConfig.overlayMode!==b&&(this.shaderTechniqueConfig.overlayMode=b);this._renderMaterialPass(a,0,d,9===a.slot?3:1);break;case 4:case 6:this.castShadows&&c&&this._renderAuxiliaryPass(a,3,d,0);break;case 2:this.isTransparent&&this.overlayRenderer.isEmpty()||this._renderAuxiliaryPass(a,1,d,0);break;case 3:this._renderAuxiliaryPass(a,2,d,0);break;case 5:this.needsHighlight&&
(this._renderAuxiliaryPass(a,4,d,2),a.rctx.clearSafe(256))}0!==this.visibleScaleRangeQueryQueue.length&&this.setNeedsRender();return!0};e._renderMaterialPass=function(a,b,c,d){const {rctx:f,camera:l}=a;this._ssrEnabled=a.ssrParams.ssrEnabled;this._setTerrainTechnique(b,3===d);const h=this.shaderTechnique.program;f.useProgram(h);0!==this.shaderTechniqueConfig.overlayMode&&1===d&&a.ssrParams&&pa.bindSSRUniforms(h,a.ssrParams);a.shadowMap.bind(h);a.ssaoHelper.bind(h);this._bindOverlayData(h,d);h.setUniformMatrix4fv("viewNormal",
l.viewInverseTransposeMatrix);qa.bindProjectionMatrix(h,l.projectionMatrix);a.scenelightingData.setUniforms(h,!0);b=l.viewMatrix;u.set(P,b[12],b[13],b[14]);u.normalize(P,P);h.setUniform3fv("viewDirection",P);this.numOriginsRendered=this.numTrianglesRendered=this.numTilesCulled=this.numTilesRendered=0;this._prepareScaleRangeQueries();this.opaque?this._renderPatchGroups(a,h,c,d):a.offscreenRenderingHelper.renderToTargets(()=>this._renderPatchGroups(a,h,c,d),a.offscreenRenderingHelper.tmpColor,a.offscreenRenderingHelper.mainDepth,
[0,0,0,0]);this._processScaleRangeQueries()};e._renderAuxiliaryPass=function(a,b,c,d){this._setTerrainTechnique(b,3===d);b=this.shaderTechnique.program;a.rctx.useProgram(b);if(5===a.pass){const f=a.offscreenRenderingHelper;b.bindTexture(f.depthTexture,"depthTex");b.setUniform4f("highlightViewportPixelSz",0,0,1/f.width,1/f.height)}else b.setUniformMatrix4fv("viewNormal",a.camera.viewInverseTransposeMatrix),2!==a.pass&&4!==a.pass&&6!==a.pass||b.setUniform2fv("nearFar",a.camera.nearFar);this._renderPatchGroupsAuxiliary(a,
b,c,d)};e._updateTileBackground=function(){if(this.tileRenderer){this.tileBackgroundUpdating=!0;var a=()=>{this.tileBackgroundInitialized=!0;this.tileBackgroundUpdating=!1;this.shaderTechniqueConfig.useGrid=this.tileRenderer.backgroundIsGrid;this.shaderTechniqueConfig.hasBackgroundColor=!this.tileRenderer.backgroundIsGrid&&!!x.isSome(this.tileRenderer.backgroundColor);this.allTiles.forAll(b=>this.tileRenderer.updateTileTexture(b));this.setNeedsRender()};if("string"===typeof this.tileBackground){const b=
this.tileBackground;ka.requestImage(b).then(c=>{b===this.tileBackground&&this.tileRenderer&&(this.tileRenderer.setBackground(c,this.tileBackground===ma.DEFAULT_TILE_BACKGROUND),a())})}else{const b=this.tileBackground?fa.toUnitRGBA(this.tileBackground):[0,0,0,0];this.tileRenderer.setBackground(b,!1);a()}}};e._updatePatchGroups=function(){const a=this._patchGroups;if(!this.patchGroupsDirty)return a;this.highestVisibleLODTile=null;this._renderCollectOrigins(a);if(0!==this.renderOrder){for(let b=0;b<
a.length;b++)K.sortTiles(this.renderOrder,a.data[b].patches);a.sort((b,c)=>{var d=this.renderOrder;b=0===b.patches.length?-d:0===c.patches.length?d:K.compareTiles(b.patches.data[0],c.patches.data[0],d);return b})}this.patchGroupsDirty=!1;return a};e._renderCollectOrigins=function(a){var b=this.rootTiles;const c=this.isGlobal;a.clear();for(const d of b)b=a.pushNew(),b.root=d,b.origin=c?A.ZEROS:d.centerAtSeaLevel,b.patches.clear(),this._renderCollectOriginsForRoot(a,b);a.filterInPlace(d=>0<d.patches.length)};
e._renderCollectOriginsForRoot=function(a,b){const c=this.tileIterator;c.resetOne(b.root);const d=this.patchGroupsMap;d.clear();for(d.set(b.origin,b);!c.done;){b=c.next();var f=b.renderData;if(f&&!b.visible)this.numTilesCulled++,c.skipSubtree();else{if(0===b.lij[0]%7){const l=a.pushNew();l.root=b;l.origin=b.centerAtSeaLevel;d.set(b.centerAtSeaLevel,l);l.patches.clear()}if(!b.rendered)this.numTilesCulled++;else if(f){(f=d.get(f.localOrigin))&&f.patches.push(b);if(!this.highestVisibleLODTile||b.vlevel>
this.highestVisibleLODTile.vlevel)this.highestVisibleLODTile=b;c.skipSubtree()}}}};e._scaleQueriesForTile=function(a){const b=a.extent;a=a.lij[0];let c=0;for(;c<this.visibleScaleRangeQueriesInvPtr;){const d=this.visibleScaleRangeQueries.data[c],f=d.extent;a>=d.minLevel&&a<=d.maxLevel&&f[0]<=b[2]&&f[2]>=b[0]&&f[1]<=b[3]&&f[3]>=b[1]?(this.visibleScaleRangeQueries.swapElements(c,this.visibleScaleRangeQueriesInvPtr-1),this.visibleScaleRangeQueriesInvPtr--):c++}};e._useStencilForTile=function(a){for(const b of this.stencilEnabledLayerExtents)if(a.intersectsExtent(b))return!0;
return!1};e._renderPatchGroupsAuxiliary=function(a,b,c,d){this.shaderTechnique.bindPipelineState(a.rctx);const f=0<this.stencilEnabledLayerExtents.length;b.setUniformMatrix4fv("proj",a.camera.projectionMatrix);b.setUniform1f("skirtScale",this._skirtScale);0!==d&&this._bindOverlayData(b,d);for(let l=0;l<c.length;l++){const h=c.data[l];this._bindPatchGroupData(b,h,a.camera.eye,a.camera.viewMatrix);for(let r=0;r<h.patches.length;r++)this._renderPatch(a.rctx,b,h.patches.data[r],4,f,d)}a.rctx.bindVAO(null)};
e._renderPatchGroups=function(a,b,c,d){const f=a.rctx,l=a.camera,h=l.viewMatrix;this.shaderTechnique.bindPipelineState(f);if(this.shaderTechniqueConfig.screenSizePerspective&&this.pointsOfInterest){var r=ta.getSettings(this.stage.viewingMode,this.ellipsoidRadius);r.update({distance:this.pointsOfInterest.centerOnSurfaceFrequent.distance,fovY:l.fovY});R.bindScreenSizePerspective(r,b,"screenSizePerspective")}r=0<this.stencilEnabledLayerExtents.length;const C=3===d;C&&(b.bindTexture(this.emptyTex,"tex"),
b.setUniform1f("blend",1),b.setUniform4fv("texOffsetAndScale",J.ZEROS));var F=x.isSome(this.tileRenderer.backgroundColor)?this.tileRenderer.backgroundColor:J.ZEROS;this.shaderTechniqueConfig.hasBackgroundColor&&b.setUniform4fv("backgroundColor",F);b.setUniform1f("skirtScale",C?0:this._skirtScale);F=this.wireframe?1:4;this.shaderTechniqueConfig.textureFadingEnabled&&b.bindTexture(this.emptyTex,"texNext");for(let y=0;y<c.length;y++){var w=c.data[y];const G=w.patches;this._bindPatchGroupData(b,w,l.eye,
h);oa.bindSliceUniforms(b,this.shaderTechnique.configuration,a.sliceHelper&&a.sliceHelper.plane,w.origin);a.shadowMap&&a.shadowMap.bindView(b,w.origin);this.numOriginsRendered++;for(w=0;w<G.length;w++){const g=G.data[w];var p=g.renderData.textureReference;if(!x.isNone(p)){if(!C){this._scaleQueriesForTile(g);da(g.renderData.geometryInfo.uvOffsetAndScale,p.offsetAndScale,M);b.setUniform4fv("texOffsetAndScale",M);b.bindTexture(p.texture.texture,"tex");p=g.renderData.textureFadeFactor;const t=1>p?g.renderData.nextTextureReference:
null;this.shaderTechniqueConfig.textureFadingEnabled&&x.isSome(t)&&1>p?(da(g.renderData.geometryInfo.uvOffsetAndScale,t.offsetAndScale,M),b.setUniform1f("textureFadeFactor",p),b.setUniform4fv("nextTexOffsetAndScale",M),b.bindTexture(t.texture.texture,"texNext")):b.setUniform1f("textureFadeFactor",1);g.renderData.textureIsFading&&this.setNeedsRender();b.setUniform1f("opacity",g.renderData.opacity);b.setUniform1i("compositeBackground",g.renderData.compositeBackgroundInShader?1:0);b.setUniform1f("textureOpacity",
g.renderData.layerOpacity);b.setUniform1f("baseOpacity",g.renderData.baseOpacity)}p=this._renderPatch(f,b,g,F,r,d);g.renderOrder=this.numTilesRendered;this.numTilesRendered++;this.numTrianglesRendered+=p/3}}}f.bindVAO(null)};e._renderPatch=function(a,b,c,d,f,l){if(x.isNone(c.renderData.vao.indexBuffer))return 0;0!==l&&this._bindOverlayPatchData(b,c.renderData.overlay);f&&(this._useStencilForTile(c)?this.stencilShaderTechnique.bindPipelineState(a):this.shaderTechnique.bindPipelineState(a));f=0===this._skirtScale?
c.renderData.geometryInfo.numWithoutSkirtIndices:c.renderData.vao.indexBuffer.size;a.bindVAO(c.renderData.vao);b.assertCompatibleVertexAttributeLocations(c.renderData.vao);a.drawElements(d,f,c.renderData.vao.indexBuffer.indexType,0);return f};e._bindPatchGroupData=function(a,b,c,d){a.setUniform3fv("origin",b.origin);ia.translate(ea,d,b.origin);a.setUniformMatrix4fv("view",ea);a.setUniform3f("camPos",c[0]-b.origin[0],c[1]-b.origin[1],c[2]-b.origin[2])};e._bindOverlayData=function(a,b){if(0!==this.shaderTechniqueConfig.overlayMode){a.setUniform1f("overlayOpacity",
this.overlayOpacity);var c=this.overlayRenderer.overlays;if(0<c.length){c=c[0];const d=c.getColorTexture(b);a.bindTexture(x.isSome(d)?d:this.emptyTex,"ovColorTex");2===this.shaderTechniqueConfig.overlayMode&&(b=c.getNormalTexture(b),a.bindTexture(x.isSome(b)?b:this.emptyTex,"ovWaterTex"))}}};e._bindOverlayPatchData=function(a,b){a.setUniform4fv("overlayTexOffset",b.offsets);a.setUniform4fv("overlayTexScale",b.scales)};e._setTerrainTechnique=function(a,b){this.shaderTechniqueConfig.output=a;0===a&&
(this.shaderTechniqueConfig.atmosphere=this.isGlobal&&this._velvetOverground,this.shaderTechniqueConfig.ssrEnabled=this._ssrEnabled);this.shaderTechniqueConfig.renderOccluded=b;this.shaderTechniqueConfig.stencilEnabled=!1;this.shaderTechnique=this.shaderTechniques.releaseAndAcquire(S.TerrainTechnique,this.shaderTechniqueConfig,this.shaderTechnique);this.shaderTechniqueConfig.stencilEnabled=!0;this.stencilShaderTechnique=this.shaderTechniques.releaseAndAcquire(S.TerrainTechnique,this.shaderTechniqueConfig,
this.stencilShaderTechnique)};e._prepareScaleRangeQueries=function(){const a=this.visibleScaleRangeQueries,b=this.visibleScaleRangeQueryQueue;for(;a.length<a.data.length&&0<b.length;){const c=b.pop();a.push(c)}this.visibleScaleRangeQueriesInvPtr=a.length};e._processScaleRangeQueries=function(){const a=this.visibleScaleRangeQueries,b=this.visibleScaleRangeQueryPool;for(let c=0;c<a.length;c++){const d=a.data[c];b.release(d);d.callback(c>=this.visibleScaleRangeQueriesInvPtr);d.callback=null}a.clear()};
W._createClass(v,[{key:"isGlobal",get:function(){return 1===this.stage.viewingMode}},{key:"updating",get:function(){return!this.tileBackgroundInitialized||this.tileBackgroundUpdating}},{key:"canRender",get:function(){return this.visible&&!!this.rootTiles&&this.tileBackgroundInitialized&&!this.renderingDisabled}},{key:"renderingDisabled",set:function(a){this._set("renderingDisabled",!!a);this.setNeedsRender()}},{key:"opaque",get:function(){return this._opaque&&!this.shaderTechniqueConfig.slicePlaneEnabled},
set:function(a){this._opaque!==a&&(this._opaque=a,this.setNeedsRender())}},{key:"needsLinearDepth",get:function(){return this.overlayRenderer.hasWater}},{key:"isTransparent",get:function(){return this._isTransparent},set:function(a){this._isTransparent!==a&&(this._isTransparent=a,this.setNeedsRender())}},{key:"skirtScale",get:function(){return this._skirtScale},set:function(a){a!==this._skirtScale&&(this._skirtScale=a,this.setNeedsRender())}},{key:"renderPatchBorders",get:function(){return!!this.shaderTechniqueConfig.tileBorders},
set:function(a){this.shaderTechniqueConfig.tileBorders!==a&&(this.shaderTechniqueConfig.tileBorders=a,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}},{key:"cullBackFaces",get:function(){return this.shaderTechniqueConfig.backfaceCullingEnabled},set:function(a){this.shaderTechniqueConfig.backfaceCullingEnabled!==a&&(this.shaderTechniqueConfig.backfaceCullingEnabled=a,this.notifyChange("cullBackFaces"),this.setNeedsRender())}},{key:"renderOrder",set:function(a){this._set("renderOrder",
a);this.setNeedsRender()}},{key:"velvetOverground",set:function(a){this._velvetOverground!==a&&(this._velvetOverground=a,this.setNeedsRender())}},{key:"intersectionHandlerId",get:function(){return ca.TERRAIN_ID}},{key:"slicePlane",get:function(){return this.shaderTechniqueConfig.slicePlaneEnabled},set:function(a){this.shaderTechniqueConfig.slicePlaneEnabled!==a&&(this.shaderTechniqueConfig.slicePlaneEnabled=a,this.setNeedsRender())}},{key:"textureFadingEnabled",set:function(a){this.shaderTechniqueConfig.textureFadingEnabled!==
a&&(this.shaderTechniqueConfig.textureFadingEnabled=a,this.setNeedsRender())}},{key:"wireframe",set:function(a){this._get("wireframe")!==a&&(this._set("wireframe",a),this.allTiles.forAll(b=>{var c;return null==(c=b.renderData)?void 0:c.updateGeometry(this.rctx,a)}),this.setNeedsRender())}},{key:"test",get:function(){return{tileRenderer:this.tileRenderer}}}]);return v}(m);n.__decorate([q.property()],m.prototype,"tileBackgroundInitialized",void 0);n.__decorate([q.property()],m.prototype,"tileBackgroundUpdating",
void 0);n.__decorate([q.property({constructOnly:!0})],m.prototype,"overlayRenderer",void 0);n.__decorate([q.property({constructOnly:!0})],m.prototype,"stage",void 0);n.__decorate([q.property({readOnly:!0})],m.prototype,"isGlobal",null);n.__decorate([q.property({constructOnly:!0})],m.prototype,"updateOverlayOpacity",void 0);n.__decorate([q.property({constructOnly:!0})],m.prototype,"allTiles",void 0);n.__decorate([q.property({constructOnly:!0})],m.prototype,"ellipsoidRadius",void 0);n.__decorate([q.property({readOnly:!0})],
m.prototype,"updating",null);n.__decorate([q.property({value:!1})],m.prototype,"renderingDisabled",null);n.__decorate([q.property()],m.prototype,"renderPatchBorders",null);n.__decorate([q.property()],m.prototype,"cullBackFaces",null);n.__decorate([q.property({value:1})],m.prototype,"renderOrder",null);n.__decorate([q.property()],m.prototype,"wireframe",null);n=m=n.__decorate([ha.subclass("esri.views.3d.terrain.TerrainRenderer")],m);const ea=Y.create(),P=A.create(),va=A.create(),wa=A.create(),O=A.create(),
za=A.create();return n});