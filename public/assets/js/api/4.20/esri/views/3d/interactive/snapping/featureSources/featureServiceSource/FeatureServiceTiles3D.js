// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/tslib.es6 ../../../../../../core/HandleOwner ../../../../../../core/maybe ../../../../../../core/watchUtils ../../../../../../core/accessorSupport/decorators/property ../../../../../../core/has ../../../../../../core/accessorSupport/ensureType ../../../../../../core/Logger ../../../../../../core/jsonMap ../../../../../../core/accessorSupport/decorators/subclass ../../../../../interactive/snapping/featureSources/featureServiceSource/tileUtils".split(" "),
function(c,p,d,q,l,r,e,x,y,z,A,t,m){function u({lij:[h,f,k],extent:a}){return{id:`${h}/${f}/${k}`,level:h,row:f,col:k,extent:a}}c.FeatureServiceTiles3D=function(h){function f(a){a=h.call(this,a)||this;a.pointOfInterest=null;return a}p._inheritsLoose(f,h);var k=f.prototype;k.initialize=function(){this.handles.add(r.init(this.view,"featureTiles",a=>{this.handles.remove("feature-tiles");a&&this.handles.add(a.addClient(),"feature-tiles")}))};k.filterTiles=function(a){return l.isNone(a)?[]:a.filter(b=>
50<Math.abs(b.measures.screenRect[3]-b.measures.screenRect[1])&&2===b.measures.visibility)};p._createClass(f,[{key:"tiles",get:function(){const a=this.tilesCoveringView,b=this.effectivePointOfInterest;if(l.isSome(b)){const n=a.map(g=>m.distanceToTile(b,g));for(let g=1;g<n.length;g++)if(n[g-1]>n[g])return a.sort((v,w)=>m.distanceToTile(b,v)-m.distanceToTile(b,w)),a.slice()}return a}},{key:"tilesCoveringView",get:function(){var a,b;return this.filterTiles(null==(a=this.view.featureTiles)?void 0:null==
(b=a.tiles)?void 0:b.toArray()).map(u)}},{key:"tileInfo",get:function(){var a,b;return null!=(a=null==(b=this.view.featureTiles)?void 0:b.tilingScheme.toTileInfo())?a:null}},{key:"tileSize",get:function(){var a,b;return null!=(a=null==(b=this.view.featureTiles)?void 0:b.tileSize)?a:256}},{key:"effectivePointOfInterest",get:function(){var a;const b=this.pointOfInterest;return l.isSome(b)?b:null==(a=this.view.pointsOfInterest)?void 0:a.focus.location}}]);return f}(q.HandleOwner);d.__decorate([e.property({readOnly:!0})],
c.FeatureServiceTiles3D.prototype,"tiles",null);d.__decorate([e.property({readOnly:!0})],c.FeatureServiceTiles3D.prototype,"tilesCoveringView",null);d.__decorate([e.property({readOnly:!0})],c.FeatureServiceTiles3D.prototype,"tileInfo",null);d.__decorate([e.property({readOnly:!0})],c.FeatureServiceTiles3D.prototype,"tileSize",null);d.__decorate([e.property({constructOnly:!0})],c.FeatureServiceTiles3D.prototype,"view",void 0);d.__decorate([e.property()],c.FeatureServiceTiles3D.prototype,"pointOfInterest",
void 0);d.__decorate([e.property()],c.FeatureServiceTiles3D.prototype,"effectivePointOfInterest",null);c.FeatureServiceTiles3D=d.__decorate([t.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],c.FeatureServiceTiles3D);Object.defineProperty(c,"__esModule",{value:!0})});