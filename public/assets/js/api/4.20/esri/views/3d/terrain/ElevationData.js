// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/mathUtils","../support/mathUtils","./TerrainConst"],function(v,w,q,x){let z=function(){function r(a,f,c){this.samplerData=null;this.level=a[0];this.i=a[1];this.j=a[2];this.extent=f;a=c.noDataValue;const d=c.values;let b=Infinity,e=-Infinity,h=!0,g=!1;for(let l=0;l<d.length;l++){const k=d[l];k!==a?(b=k<b?k:b,e=k>e?k:e,h=!1):g=!0}h&&(e=b=0);this.samplerData={pixelData:c.values,width:c.width,height:c.height,noDataValue:a,safeWidth:.99999999*(c.width-1),dx:(c.width-1)/
(f[2]-f[0]),dy:(c.width-1)/(f[3]-f[1]),x0:f[0],y1:f[3]};this.bounds=[b,-3E38<e?e:0];this.hasNoDataValues=g}var y=r.prototype;y.release=function(){this.bounds=this.samplerData=null};y.computeMinMaxValue=function(a,f,c,d){d.min=Infinity;d.max=-Infinity;d.hasNoDataValues=!1;a-=this.level;if(0>=a)return d;var b=2**a;if(Math.floor(f/b)!==this.i||Math.floor(c/b)!==this.j)return d;var e=Infinity,h=-Infinity,g=this.samplerData.width,l=this.samplerData.pixelData,k=.5*x.ELEVATION_NODATA_VALUE;a=(g-1)/b;c=(c-
this.j*b)*a;let n=(f-this.i*b)*a;if(1>a){const t=Math.floor(c),u=Math.floor(n);var m=t+u*g;f=l[m];b=l[m+1];var p=l[m+g];m=l[m+g+1];if(f+b+p+m<k)return e=c-t,k=n-u,h=q.bilerp(f,b,p,m,e,k),g=q.bilerp(f,b,p,m,e+a,k),l=q.bilerp(f,b,p,m,e,k+a),a=q.bilerp(f,b,p,m,e+a,k+a),d.min=Math.min(h,g,l,a),d.max=Math.max(h,g,l,a),d;c=t;n=u;a=1}else c=Math.floor(c),n=Math.floor(n),a=Math.ceil(a);for(f=c;f<=c+a;f++)for(b=n;b<=n+a;b++)p=l[f+b*g],p<k?(e=Math.min(e,p),h=Math.max(h,p)):d.hasNoDataValues=!0;d.min=e;d.max=
h;return d};r.sample=function(a,f,c){for(const g of c){if(!g)continue;var d=g.safeWidth,b=g.width,e=g.pixelData;c=w.clamp(g.dy*(g.y1-f),0,d);d=w.clamp(g.dx*(a-g.x0),0,d);const l=Math.floor(c),k=Math.floor(d);var h=l*b+k;const n=h+b,m=e[h];b=e[n];h=e[h+1];e=e[n+1];if(m+b+h+e<.5*x.ELEVATION_NODATA_VALUE)return c-=l,d-=k,a=m+(h-m)*d,a+(b+(e-b)*d-a)*c}return null};return r}();v.ElevationData=z;Object.defineProperty(v,"__esModule",{value:!0})});