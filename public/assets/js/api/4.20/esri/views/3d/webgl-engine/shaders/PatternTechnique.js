// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../../../../chunks/Pattern.glsl ../../../webgl/renderState".split(" "),
function(w,m,u,e,x,y,z,q,c,n,d,l,A,r,B,p){n=function(k){function h(){return k.apply(this,arguments)||this}u._inheritsLoose(h,k);var a=h.prototype;a.initializeProgram=function(f){var g=h.shader.get();const b=this.configuration;g=g.build({output:b.output,attributeColor:b.vertexColors,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,style:b.style,patternSpacing:b.patternSpacing,lineWidth:b.lineWidth,draped:b.draped,OITEnabled:0===b.transparencyPassType,
multipassTerrainEnabled:b.multipassTerrainEnabled,cullAboveGround:b.cullAboveGround});return new A.Program(f.rctx,g,v)};a.bindPass=function(f,g){q.bindProjectionMatrix(this.program,g.camera.projectionMatrix);this.program.setUniform4fv("matColor",f.color);this.configuration.draped?(this.program.setUniform1f("worldToScreenRatio",1/g.screenToWorldRatioGlobalWM),this.program.setUniform1f("texelSize",1/g.camera.pixelRatio)):this.program.setUniform1f("worldToScreenPerDistanceRatio",1/g.camera.perScreenPixelRatio);
4===this.configuration.output&&y.bindOutputHighlight(this.program,g);(1===this.configuration.output||g.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",g.camera.nearFar);g.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",g.inverseViewport),z.bindMultipassTerrainTexture(this.program,g))};a.bindDraw=function(f){q.bindView(this.program,f);q.bindCameraPosition(this.program,f.origin,f.camera.viewInverseTransposeMatrix);x.bindSliceUniformsWithOrigin(this.program,
this.configuration,f);this.program.rebindTextures()};a.setPipelineState=function(f,g){const b=this.configuration,t=3===f,C=2===f;return p.makePipelineState({blending:0===b.output||7===b.output?b.transparent&&t?l.blendingDefault:l.OITBlending(f):null,culling:p.cullingParams(b.cullFace),depthTest:{func:l.OITDepthTest(f)},depthWrite:t?b.writeDepth&&p.defaultDepthWriteParams:l.OITDepthWrite(f),colorWrite:p.defaultColorWriteParams,stencilWrite:b.sceneHasOcludees?r.stencilWriteMaskOn:null,stencilTest:b.sceneHasOcludees?
g?r.stencilToolMaskBaseParams:r.stencilBaseAllZerosParams:null,polygonOffset:t||C?b.polygonOffset&&D:l.getOITPolygonOffset(b.enableOffset)})};a.initializePipeline=function(){this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0);return this.setPipelineState(this.configuration.transparencyPassType,!1)};a.getPipelineState=function(f){return f?this._occludeePipelineState:this.pipeline};return h}(n.ShaderTechnique);n.shader=new c.ReloadableShaderModule(B.PatternShader,
()=>new Promise(function(k,h){w(["./Pattern.glsl"],k,h)}));const D={factor:1,units:1};c=function(k){function h(){var a=k.apply(this,arguments)||this;a.output=0;a.cullFace=0;a.slicePlaneEnabled=!1;a.vertexColors=!1;a.transparent=!0;a.polygonOffset=!1;a.writeDepth=!0;a.sceneHasOcludees=!1;a.enableOffset=!0;a.transparencyPassType=3;a.multipassTerrainEnabled=!1;a.cullAboveGround=!1;return a}u._inheritsLoose(h,k);return h}(d.ShaderTechniqueConfiguration);e.__decorate([d.parameter({count:8})],c.prototype,
"output",void 0);e.__decorate([d.parameter({count:3})],c.prototype,"cullFace",void 0);e.__decorate([d.parameter()],c.prototype,"slicePlaneEnabled",void 0);e.__decorate([d.parameter()],c.prototype,"vertexColors",void 0);e.__decorate([d.parameter()],c.prototype,"transparent",void 0);e.__decorate([d.parameter()],c.prototype,"polygonOffset",void 0);e.__decorate([d.parameter()],c.prototype,"writeDepth",void 0);e.__decorate([d.parameter()],c.prototype,"sceneHasOcludees",void 0);e.__decorate([d.parameter({count:6})],
c.prototype,"style",void 0);e.__decorate([d.parameter()],c.prototype,"patternSpacing",void 0);e.__decorate([d.parameter()],c.prototype,"lineWidth",void 0);e.__decorate([d.parameter()],c.prototype,"enableOffset",void 0);e.__decorate([d.parameter()],c.prototype,"draped",void 0);e.__decorate([d.parameter({count:4})],c.prototype,"transparencyPassType",void 0);e.__decorate([d.parameter()],c.prototype,"multipassTerrainEnabled",void 0);e.__decorate([d.parameter()],c.prototype,"cullAboveGround",void 0);const v=
new Map([["position",0],["color",3],["uvMapSpace",4],["boundingRect",5]]);m.PatternTechnique=n;m.PatternTechniqueConfiguration=c;m.patternVertexAttributeLocations=v;Object.defineProperty(m,"__esModule",{value:!0})});