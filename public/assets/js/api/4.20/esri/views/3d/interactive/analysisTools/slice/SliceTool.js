// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/clock ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/scheduling ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/Logger ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/mat4 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../chunks/boundedPlane ../../../../../geometry/support/plane ../../../../../geometry/support/ray ../../../../../geometry/support/vectorStacks ../../manipulatorUtils ./sliceToolConfig ./sliceToolUtils ./images/heading-rotate-png ./images/tilt-rotate-png ../../editingTools/dragEventPipeline3D ../../../support/geometryUtils/ray ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Texture ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils ../../../../support/screenUtils ../../../../../widgets/Slice/SlicePlane".split(" "),
function(E,q,K,H,e,L,y,r,n,X,Y,Z,M,z,l,A,g,t,N,p,O,m,k,P,Q,B,R,S,I,C,T,F,D,U){function J(u,w,d,a){d=k.createShiftPlane(d,g.normal(a),u.direction,t.create());a=A.create();return t.intersectRay(d,u,a)?{type:"shift",creatingPointerId:w,shiftPlane:d,depth:0,startPoint:a}:null}function G(u){return"mouse"!==u.pointerType||0===u.button}n=function(u){function w(a){var b=u.call(this,a)||this;b.clock=K["default"];b._previewPlaneOpacity=1;b.layerView=null;b.cursor=null;b.layersMode="none";b.tiltEnabled=!1;b.shiftManipulator=
null;b.rotateHeadingManipulator=null;b.rotateTiltManipulator=null;b.resizeManipulators=null;b.disableEngineLayers=!1;b._handles=new H;b._viewHandles=new H;b._frameTask=null;b._prevPointerMoveTimeout=null;b._previewPlaneGridVisualElement=null;b._previewPlaneOutlineVisualElement=null;b._startPlane=g.create();b._previewPlane=null;b._activeKeyModifiers={};b._lastCursorPosition=y.createScreenPoint();b._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,
0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}];b._intersector=new S.Intersector(a.view.state.viewingMode);b._intersector.options.store=0;return b}E._inheritsLoose(w,u);var d=w.prototype;d.onAttach=function(){this.created&&this.visible&&this._updateManipulators()};d.initialize=function(){this._initialize()};d._initialize=function(){var a=E._asyncToGenerator(function*(){var b=()=>{switch(this.toolState){case "created":case "creating":throw Error("unexpected toolState");case "destroyed":return!1}return!0};
if(b()&&(this.layerView=yield this.view.whenLayerView(this.analysis),b())){if(null==this.analysis)throw Error("SliceTool requires valid model, but null was provided.");if(e.isNone(this.layerView.layerViewData))throw Error("expected internal object to be defined.");this.layerViewData=this.layerView.layerViewData;this.rotateHeadingTexture=new I.Texture(P,{width:64,height:64,mipmap:!0,preMultiplyAlpha:!0});this.rotateTiltTexture=new I.Texture(Q,{width:64,height:64,mipmap:!0,preMultiplyAlpha:!0});this.view._stage&&
(this.view._stage.add(this.rotateHeadingTexture),this.view._stage.add(this.rotateTiltTexture));b=this.watch("state",f=>{switch(f){case "ready":case "slicing":this.finishToolCreation();break;case "sliced":this.complete()}},!0);"sliced"===this.state?this.complete():this.startToolCreation();this._handles.add([b,this.view.state.watch("camera",()=>this._onCameraChange())]);var c=f=>{this.updateManipulatorsInteractive(f);f.grabbing||(e.isSome(this.layerViewData.plane)&&g.copy(this.layerViewData.plane,this._startPlane),
this.inputState=null)};this.shiftManipulator=k.createShiftManipulator(this.view);this.manipulators.add(this.shiftManipulator);this.shiftManipulator.events.on("grab-changed",f=>{this._onShiftGrab(f);c(this.shiftManipulator)});this._handles.add(this._createShiftDragPipeline(this.shiftManipulator));this.rotateHeadingManipulator=k.createRotateManipulator(this.view,this.rotateHeadingTexture);this.manipulators.add(this.rotateHeadingManipulator);this.rotateHeadingManipulator.events.on("grab-changed",f=>
{this._onRotateHeadingGrab(f);c(this.rotateHeadingManipulator)});this._handles.add(this._createRotateHeadingDragPipeline(this.rotateHeadingManipulator));this.rotateTiltManipulator=k.createRotateManipulator(this.view,this.rotateTiltTexture);this.manipulators.add(this.rotateTiltManipulator);this.rotateTiltManipulator.events.on("grab-changed",f=>{this._onRotateTiltGrab(f);c(this.rotateTiltManipulator)});this._handles.add(this._createRotateTiltDragPipeline(this.rotateTiltManipulator));this.resizeManipulators=
this._resizeHandles.map((f,h)=>{const v=k.createResizeManipulator(this.view,f);v.events.on("grab-changed",x=>{this._onResizeGrab(x,h);c(v)});this._handles.add(this._createResizeDragPipeline(v));return v});this.manipulators.addMany(this.resizeManipulators);this._previewPlaneGridVisualElement=k.createGridVisualElement(this.view);this._previewPlaneOutlineVisualElement=k.createOutlineVisualElement(this.view);this._previewPlaneOutlineVisualElement.width=m.PLANE_PREVIEW_OUTLINE_WIDTH;this._handles.add(this.layerViewData.watch("plane",
()=>this._updateManipulators(),!0));this._updateManipulators();this._updateVisibility(this.visible)}});return function(){return a.apply(this,arguments)}}();d.destroy=function(){switch(this.toolState){case "pending":this._handles=e.destroyMaybe(this._handles);this._viewHandles=e.destroyMaybe(this._viewHandles);return;case "destroyed":return}this.view._stage&&(this.view._stage.remove(this.rotateHeadingTexture),this.view._stage.remove(this.rotateTiltTexture));this.detach();this._handles.destroy();this._handles=
null;this._viewHandles.destroy();this._viewHandles=null;this._removeFrameTask();this._clearPointerMoveTimeout();this._previewPlaneOutlineVisualElement=e.destroyMaybe(this._previewPlaneOutlineVisualElement);this._previewPlaneGridVisualElement=e.destroyMaybe(this._previewPlaneGridVisualElement)};d.enterExcludeLayerMode=function(){e.isNone(this.layerViewData.plane)||(this._set("layersMode","exclude"),F.setActive(this,!0))};d.exitExcludeLayerMode=function(){e.isNone(this.layerViewData.plane)||(this._set("layersMode",
"none"),F.setActive(this,!1))};d.deactivate=function(){this._updateMouseCursor();this._set("layersMode","none");this._updatePreviewPlane(null)};d.onDetach=function(){this.created&&this._set("layersMode","none")};d.onShow=function(){this._updateVisibility(!0)};d.onHide=function(){this._updateVisibility(!1)};d._updateVisibility=function(a){this.analysis.visible=a;this.created&&(this._updateMouseCursor(),this._updateManipulators(),this._updateVisualElementVisibility(),a||this._clearPointerMoveTimeout())};
d.onInputEvent=function(a){switch(a.type){case "pointer-drag":if(!G(a))break;this._isPlacingSlicePlane?this._onClickPlacePlane(a)&&(a.stopPropagation(),this._updateMouseCursor()):this._onPointerDrag(a)&&a.stopPropagation();break;case "pointer-move":this._onPointerMove(a);this._updateMouseCursor();break;case "pointer-up":this._onPointerUp(a)&&a.stopPropagation();break;case "immediate-click":if(!G(a))break;this._onClickPlacePlane(a)&&(a.stopPropagation(),this._updateMouseCursor());break;case "click":if(!G(a))break;
this._onClickExcludeLayer(a)&&a.stopPropagation();break;case "drag":this.inputState&&a.stopPropagation();break;case "key-down":this._onKeyDown(a)&&a.stopPropagation();break;case "key-up":this._onKeyUp(a)&&a.stopPropagation()}};d.onEditableChange=function(){this.layerView.editable=this.editable};d._onPointerDrag=function(a){if(a.pointerId===this._creatingPointerId){const b=D.createScreenPointFromEvent(a);this.shiftManipulator.events.emit("drag",{action:"start",pointerType:a.pointerType,start:b,screenPoint:b});
return!0}return!1};d._onPointerMove=function(a){this._lastCursorPosition.x=a.x;this._lastCursorPosition.y=a.y;this._resetPointerMoveTimeout();"touch"!==a.pointerType&&this._updatePreviewPlane(D.createScreenPointFromEvent(a),this._activeKeyModifiers)};d._onCameraChange=function(){this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers);this._updateManipulators()};d._onPointerUp=function(a){return a.pointerId===this._creatingPointerId&&e.isSome(this.layerViewData.plane)?(g.copy(this.layerViewData.plane,
this._startPlane),this.inputState=null,!0):!1};d._onClickPlacePlane=function(a){if("exclude"===this.layersMode)return!1;if(this._isPlacingSlicePlane){var b=D.createScreenPointFromEvent(a);const c=g.create();if(this._pickPlane(b,!1,this._activeKeyModifiers,c))return g.copy(c,this._startPlane),b=this._calculatePickRay(b),this.analysis.plane=k.planeToShape(c,this.view.renderCoordsHelper,this.view.spatialReference,new U),this.inputState=J(b,a.pointerId,c.origin,c),!0}return!1};d._onClickExcludeLayer=
function(a){if("exclude"!==this.layersMode||!this.created)return!1;this.view.hitTest(D.createScreenPointFromEvent(a)).then(b=>{b.results.length?(b=(b=b.results[0])&&b.graphic)&&(b=b.sourceLayer||b.layer)&&this.layerViewData.excludedLayers.push(b):b.ground.layer?this.layerViewData.excludedLayers.push(b.ground.layer):this.layerViewData.excludeGroundSurface=!0});this._set("layersMode","none");F.setActive(this,!1);return!0};d._onKeyDown=function(a){return a.key===m.forceVerticalModifier||a.key===m.forceHorizontalModifier?
(this._activeKeyModifiers[a.key]=!0,e.isSome(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0):!1};d._onKeyUp=function(a){return a.key!==m.forceVerticalModifier&&a.key!==m.forceHorizontalModifier||!this._activeKeyModifiers[a.key]?!1:(delete this._activeKeyModifiers[a.key],e.isSome(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)};d._onShiftGrab=function(a){"start"!==a.action||e.isNone(this.layerViewData.plane)||
(a=this._calculatePickRay(a.screenPoint),g.copy(this.layerViewData.plane,this._startPlane),this.inputState=J(a,null,this.shiftManipulator.renderLocation,this.layerViewData.plane))};d._createShiftDragPipeline=function(a){return C.createManipulatorDragEventPipeline(a,(b,c,f)=>{if((b=this.inputState)&&"shift"===b.type){var h=e.isSome(this.layerViewData.plane)?g.copy(this.layerViewData.plane,g.create()):null;c.next(B.screenToRenderPlane(this.view,b.shiftPlane)).next(this._shiftDragAdjustSensitivity(b)).next(this._shiftDragUpdatePlane(b));
f.next(()=>{e.isSome(h)&&this._updateBoundedPlane(h)})}})};d._shiftDragAdjustSensitivity=function(a){return b=>{if(e.isNone(this.layerViewData.plane))return null;const c=Math.min((1-Math.abs(l.dot(g.normal(this.layerViewData.plane),b.ray.direction)/l.length(b.ray.direction)))/.001,1),f=-t.signedDistance(this._startPlane.plane,b.renderEnd),h=-t.signedDistance(this._startPlane.plane,a.startPoint);a.depth=a.depth*(1-c)+f*c-h;return b}};d._shiftDragUpdatePlane=function(a){return()=>{if(!e.isNone(this.layerViewData.plane)){var b=
l.copy(p.sv3d.get(),this._startPlane.origin),c=l.copy(p.sv3d.get(),g.normal(this._startPlane));l.scale(c,c,-a.depth);l.add(c,c,b);b=g.fromValues(c,this.layerViewData.plane.basis1,this.layerViewData.plane.basis2,g.create());this._updateBoundedPlane(b)}}};d._onRotateHeadingGrab=function(a){if("start"===a.action&&!e.isNone(this.layerViewData.plane)){var b=k.createRotatePlane(this.layerViewData.plane,this.view.renderCoordsHelper,1,t.create());a=this._calculatePickRay(a.screenPoint);var c=A.create();t.intersectRay(b,
a,c)&&(g.copy(this.layerViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:b,startPoint:c})}};d._createRotateHeadingDragPipeline=function(a){return C.createManipulatorDragEventPipeline(a,(b,c,f)=>{if((b=this.inputState)&&"rotate"===b.type){var h=e.isSome(this.layerViewData.plane)?g.copy(this.layerViewData.plane,g.create()):null;c.next(B.screenToRenderPlane(this.view,b.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(b)).next(this._rotateDragUpdatePlaneFromRotate());
f.next(()=>{e.isSome(h)&&this._updateBoundedPlane(h)})}})};d._onRotateTiltGrab=function(a){if("start"===a.action&&!e.isNone(this.layerViewData.plane)){var b=k.createRotatePlane(this.layerViewData.plane,this.view.renderCoordsHelper,2,t.create());a=this._calculatePickRay(a.screenPoint);var c=A.create();t.intersectRay(b,a,c)&&(g.copy(this.layerViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:b,startPoint:c})}};d._createRotateTiltDragPipeline=function(a){return C.createManipulatorDragEventPipeline(a,
(b,c,f)=>{if((b=this.inputState)&&"rotate"===b.type){var h=e.isSome(this.layerViewData.plane)?g.copy(this.layerViewData.plane,g.create()):null;c.next(B.screenToRenderPlane(this.view,b.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(b)).next(this._rotateDragUpdatePlaneFromRotate());f.next(()=>{e.isSome(h)&&this._updateBoundedPlane(h)})}})};d._rotateDragRenderPlaneToRotate=function(a){return b=>{if(e.isNone(this.layerViewData.plane))return null;const c=t.normal(a.rotatePlane),f=O.calculateInputRotationTransform(this.inputState.startPoint,
b.renderEnd,this.layerViewData.plane.origin,c);return{...b,rotateAxis:c,rotateAngle:f}}};d._rotateDragUpdatePlaneFromRotate=function(){return a=>{if(!e.isNone(this.layerViewData.plane)){var b=z.identity(p.sm4d.get());z.rotate(b,b,a.rotateAngle,a.rotateAxis);a=l.transformMat4(p.sv3d.get(),this._startPlane.basis1,b);b=l.transformMat4(p.sv3d.get(),this._startPlane.basis2,b);b=g.fromValues(this.layerViewData.plane.origin,a,b,g.create());this._updateBoundedPlane(b)}}};d._onResizeGrab=function(a,b){if("start"===
a.action&&!e.isNone(this.layerViewData.plane)){a=this._calculatePickRay(a.screenPoint);var c=p.sv3d.get();t.intersectRay(this.layerViewData.plane.plane,a,c)&&(g.copy(this.layerViewData.plane,this._startPlane),this.inputState={type:"resize",activeHandleIdx:b,startPoint:A.clone(c)})}};d._createResizeDragPipeline=function(a){return C.createManipulatorDragEventPipeline(a,(b,c,f)=>{if((b=this.inputState)&&"resize"===b.type&&!e.isNone(this.layerViewData.plane)){var h=g.copy(this.layerViewData.plane,g.create());
c.next(B.screenToRenderPlane(this.view,this.layerViewData.plane.plane)).next(this._resizeDragUpdatePlane(b));f.next(()=>{this._updateBoundedPlane(h)})}})};d._resizeDragUpdatePlane=function(a){return b=>{e.isNone(this.layerViewData.plane)||(b=k.resizePlane(this._resizeHandles[a.activeHandleIdx],this.inputState.startPoint,b.renderEnd,this.view.state.camera,this._startPlane,g.copy(this.layerViewData.plane)),this._updateBoundedPlane(b))}};d._updateBoundedPlane=function(a){const b=this.layerViewData;if(e.isSome(b))b.plane=
a;else throw Error("valid internal object expected");};d._updatePreviewPlane=function(a,b={}){let c=this._previewPlane;this._previewPlane=null;if(e.isNone(a))this._removeFrameTask(),this._updateManipulators();else{if(!this.layerViewData.plane&&this.active){const f=e.isSome(c)?c:g.create();c=e.isSome(c)?g.copy(c,V):null;this._pickPlane(a,!0,b,f)&&(a=m.PREVIEW_FADE_DOT_THRESHOLD,b=!1,e.isSome(c)&&(b=l.dot(c.plane,f.plane)<a||l.dot(l.normalize(p.sv3d.get(),c.basis1),l.normalize(p.sv3d.get(),f.basis1))<
a),b&&(this._previewPlaneOpacity=0),this._previewPlane=f)}e.isSome(this._previewPlane)&&e.isNone(this._frameTask)&&0===this._previewPlaneOpacity?this._frameTask=L.addFrameTask({update:({deltaTime:f})=>{this._previewPlaneOpacity=Math.min(this._previewPlaneOpacity+f/(1E3*m.PREVIEW_FADE_DURATION_SECONDS),1);this._updateManipulators();1===this._previewPlaneOpacity&&this._removeFrameTask()}}):e.isNone(this._previewPlane)&&e.isSome(this._frameTask)?this._removeFrameTask():e.isSome(this._previewPlane)&&
this._updateManipulators()}};d._removeFrameTask=function(){e.isSome(this._frameTask)&&(this._frameTask.remove(),this._frameTask=null)};d._calculatePickRay=function(a){const b=N.create();a=y.screenPointObjectToArray(a,W);R.fromScreen(this.view.state.camera,a,b);l.normalize(b.direction,b.direction);return b};d._pickMinResult=function(a){a=y.screenPointObjectToArray(a,p.sv2d.get());this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(a,this._intersector);return this._intersector.results.min};
d._pickPlane=function(a,b,c,f){var h=this._pickMinResult(a);a=p.sv3d.get();if(!h.getIntersectionPoint(a))return!1;h=h.getTransformedNormal(p.sv3d.get());const v=this.view.state.camera;0<l.dot(h,v.viewForward)&&l.scale(h,h,-1);const x=k.calculatePlaneHalfSize(a,v);b=(b?1:-1)*x*m.INITIAL_DEPTH_OFFSET_FRAC;b=l.scale(p.sv3d.get(),h,b);l.add(b,b,a);a=this.tiltEnabled?3:0;k.createPlane(b,h,x,x,v,c[m.forceVerticalModifier]?2:c[m.forceHorizontalModifier]?1:a,this.view.renderCoordsHelper,f);return!0};d._updateMouseCursor=
function(){this._set("cursor",null);this._isPlacingSlicePlane||"exclude"===this.layersMode?this._set("cursor","crosshair"):e.isSome(this._creatingPointerId)&&this._set("cursor","grabbing")};d._clearPointerMoveTimeout=function(){this._prevPointerMoveTimeout&&(this._prevPointerMoveTimeout.remove(),this._prevPointerMoveTimeout=null)};d._resetPointerMoveTimeout=function(){this._clearPointerMoveTimeout();this.shiftManipulator.state|=k.DidPointerMoveRecentlyFlag;this.rotateHeadingManipulator.state|=k.DidPointerMoveRecentlyFlag;
this.rotateTiltManipulator.state|=k.DidPointerMoveRecentlyFlag;this._prevPointerMoveTimeout=this.clock.setTimeout(()=>{this.shiftManipulator.state&=~k.DidPointerMoveRecentlyFlag;this.rotateHeadingManipulator.state&=~k.DidPointerMoveRecentlyFlag;this.rotateTiltManipulator.state&=~k.DidPointerMoveRecentlyFlag},m.POINTER_MOVE_TIMER_MS)};d._updateManipulators=function(){if(!this.disableEngineLayers){var a=null,b=!1;if(e.isSome(this.layerViewData.plane))a=this.layerViewData.plane,b=!1;else if(e.isSome(this._previewPlane))a=
this._previewPlane,b=!0;else{this.shiftManipulator.available=!1;this.rotateHeadingManipulator.available=!1;this.rotateTiltManipulator.available=!1;this.resizeManipulators.forEach(f=>f.available=!1);this._previewPlaneOutlineVisualElement.visible=!1;this._previewPlaneGridVisualElement.visible=!1;return}var c=k.calculateBoundedPlaneTranslateRotate(a,p.sm4d.get());b?(this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach(f=>
f.available=!1),this._previewPlaneOutlineVisualElement.visible=!0,this._previewPlaneGridVisualElement.visible=!0):(this.shiftManipulator.available=!0,this.rotateHeadingManipulator.available=!0,this.rotateTiltManipulator.available=this.tiltEnabled,this.resizeManipulators.forEach(f=>f.available=!0),k.updateShiftRestartHandle(this.shiftManipulator,c,a,this.view.state.camera),k.updateRotateHeadingHandle(this.rotateHeadingManipulator,c,a,this.view.renderCoordsHelper),k.updateRotateTiltHandle(this.rotateTiltManipulator,
c,a),this.resizeManipulators.forEach((f,h)=>k.updateResizeHandle(f,this._resizeHandles[h],c,a)),this._previewPlaneOutlineVisualElement.visible=!1,this._previewPlaneGridVisualElement.visible=!1);b=l.set(p.sv3d.get(),l.length(a.basis1),l.length(a.basis2),1);b=z.fromScaling(p.sm4d.get(),b);b=z.multiply(b,c,b);this._previewPlaneOutlineVisualElement.transform=b;this._previewPlaneGridVisualElement.transform=b;this._updateMaterials()}};d._updateVisualElementVisibility=function(){};d._updateMaterials=function(){this._previewPlaneOutlineVisualElement.color=
[m.PLANE_OUTLINE_COLOR[0],m.PLANE_OUTLINE_COLOR[1],m.PLANE_OUTLINE_COLOR[2],m.PLANE_OUTLINE_COLOR[3]*this._previewPlaneOpacity];this._previewPlaneGridVisualElement.backgroundColor=[m.PLANE_BACKGROUND_COLOR[0],m.PLANE_BACKGROUND_COLOR[1],m.PLANE_BACKGROUND_COLOR[2],m.PLANE_BACKGROUND_COLOR[3]*this._previewPlaneOpacity];this._previewPlaneGridVisualElement.gridColor=[0,0,0,0]};d.updateManipulatorsInteractive=function(a){a.grabbing?(this.shiftManipulator.interactive=this.shiftManipulator===a,this.rotateHeadingManipulator.interactive=
this.rotateHeadingManipulator===a,this.rotateTiltManipulator.interactive=this.rotateTiltManipulator===a,this.resizeManipulators.forEach(b=>{b.interactive=b===a})):(this.shiftManipulator.interactive=!0,this.rotateHeadingManipulator.interactive=!0,this.rotateTiltManipulator.interactive=!0,this.resizeManipulators.forEach(b=>{b.interactive=!0}))};d.testData=function(){return{plane:e.isSome(this.layerViewData.plane)?this.layerViewData.plane:null}};E._createClass(w,[{key:"state",get:function(){const a=
!!this.layerViewData.plane,b=!!this.inputState;return a?a&&b?"slicing":a&&!b?"sliced":"ready":"ready"}},{key:"isSupported",get:function(){return"3d"===this.get("view.type")}},{key:"analysis",set:function(a){if(null==a)throw Error("SliceTool requires valid model, but null was provided.");this._handles.remove("analysis");this._set("analysis",a)}},{key:"inputState",get:function(){return this._get("inputState")},set:function(a){this._set("inputState",a);this.layerView.showGrid=a&&"resize"===a.type;this._updateMaterials()}},
{key:"_isPlacingSlicePlane",get:function(){return!this.inputState&&!this.layerViewData.plane&&this.active}},{key:"_creatingPointerId",get:function(){return this.inputState&&"shift"===this.inputState.type?this.inputState.creatingPointerId:null}}]);return w}(T.InteractiveToolBase);q.__decorate([r.property()],n.prototype,"clock",void 0);q.__decorate([r.property({constructOnly:!0})],n.prototype,"view",void 0);q.__decorate([r.property()],n.prototype,"layerView",void 0);q.__decorate([r.property()],n.prototype,
"layerViewData",void 0);q.__decorate([r.property({readOnly:!0})],n.prototype,"state",null);q.__decorate([r.property({readOnly:!0})],n.prototype,"isSupported",null);q.__decorate([r.property({readOnly:!0})],n.prototype,"cursor",void 0);q.__decorate([r.property()],n.prototype,"analysis",null);q.__decorate([r.property({readOnly:!0})],n.prototype,"layersMode",void 0);q.__decorate([r.property({aliasOf:"analysis.tiltEnabled"})],n.prototype,"tiltEnabled",void 0);q.__decorate([r.property({value:null})],n.prototype,
"inputState",null);n=q.__decorate([M.subclass("esri.views.3d.interactive.analysisTools.slice.SliceTool")],n);const V=g.create(),W=y.createScreenPointArray();return n});