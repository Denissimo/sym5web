// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f64 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/quat ../../../../chunks/quatf64 ../../../../chunks/vec3 ../../../../chunks/vec3f32 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../chunks/sphere".split(" "),function(l,u,v,D,E,n,p,F,G,q,H,r,I,J){let K=function(){function e(){this._transform=p.create();this._transformInverse=new t({value:this._transform},
n.invert,p.create);this._transformInverseTranspose=new t(this._transformInverse,n.transpose,p.create);this._transformTranspose=new t({value:this._transform},n.transpose,p.create);this._transformInverseRotation=new t({value:this._transform},D.normalFromMat4Legacy,E.create)}var g=e.prototype;g.invalidateLazyTransforms=function(){this._transformInverse.invalidate();this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate()};g.setTransformMatrix=
function(a){n.copy(this._transform,a)};g.multiplyTransform=function(a){n.multiply(this._transform,this._transform,a)};g.set=function(a){n.copy(this._transform,a);this.invalidateLazyTransforms()};g.setAndInvalidateLazyTransforms=function(a,b){this.setTransformMatrix(a);this.multiplyTransform(b);this.invalidateLazyTransforms()};u._createClass(e,[{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},
{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}}]);return e}(),t=function(){function e(g,a,b){this.original=g;this.update=a;this.dirty=!0;this.transform=b()}e.prototype.invalidate=function(){this.dirty=!0};u._createClass(e,[{key:"value",get:function(){this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1);return this.transform}}]);return e}(),w=function(){function e(a=0){this.offset=
a;this.tmpVertex=r.create()}var g=e.prototype;g.applyToVertex=function(a,b,c){const d=a+this.localOrigin[0],f=b+this.localOrigin[1],h=c+this.localOrigin[2],k=this.offset/Math.sqrt(d*d+f*f+h*h);this.tmpVertex[0]=a+d*k;this.tmpVertex[1]=b+f*k;this.tmpVertex[2]=c+h*k;return this.tmpVertex};g.applyToAabb=function(a){var b=a[0]+this.localOrigin[0];const c=a[1]+this.localOrigin[1],d=a[2]+this.localOrigin[2],f=a[3]+this.localOrigin[0],h=a[4]+this.localOrigin[1],k=a[5]+this.localOrigin[2],m=this.offset/Math.sqrt(b*
b+c*c+d*d);a[0]+=b*m;a[1]+=c*m;a[2]+=d*m;b=this.offset/Math.sqrt(f*f+h*h+k*k);a[3]+=f*b;a[4]+=h*b;a[5]+=k*b;return a};return e}(),y=function(){function e(a=0){this.offset=a;this.componentLocalOriginLength=0;this.tmpVertex=r.create();this.mbs=I.create();this.obb={center:r.create(),halfSize:H.create(),quaternion:null}}var g=e.prototype;g.applyToVertex=function(a,b,c){const d=c+this.componentLocalOriginLength,f=this.offset/Math.sqrt(a*a+b*b+d*d);this.tmpVertex[0]=a+a*f;this.tmpVertex[1]=b+b*f;this.tmpVertex[2]=
c+d*f;return this.tmpVertex};g.applyToAabb=function(a){var b=a[0];const c=a[1],d=a[2]+this.componentLocalOriginLength,f=a[3],h=a[4],k=a[5]+this.componentLocalOriginLength,m=this.offset/Math.sqrt(b*b+c*c+d*d);a[0]+=b*m;a[1]+=c*m;a[2]+=d*m;b=this.offset/Math.sqrt(f*f+h*h+k*k);a[3]+=f*b;a[4]+=h*b;a[5]+=k*b;return a};g.applyToMbs=function(a){const b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),c=this.offset/b;this.mbs[0]=a[0]+a[0]*c;this.mbs[1]=a[1]+a[1]*c;this.mbs[2]=a[2]+a[2]*c;this.mbs[3]=a[3]+a[3]*this.offset/
b;return this.mbs};g.applyToObb=function(a){var b=a.center;const c=this.offset/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);this.obb.center[0]=b[0]+b[0]*c;this.obb.center[1]=b[1]+b[1]*c;this.obb.center[2]=b[2]+b[2]*c;q.transformQuat(this.obb.halfSize,a.halfSize,a.quaternion);q.add(this.obb.halfSize,this.obb.halfSize,a.center);b=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);this.obb.halfSize[0]+=this.obb.halfSize[0]*
b;this.obb.halfSize[1]+=this.obb.halfSize[1]*b;this.obb.halfSize[2]+=this.obb.halfSize[2]*b;q.subtract(this.obb.halfSize,this.obb.halfSize,a.center);F.conjugate(x,a.quaternion);q.transformQuat(this.obb.halfSize,this.obb.halfSize,x);this.obb.halfSize[0]*=0>this.obb.halfSize[0]?-1:1;this.obb.halfSize[1]*=0>this.obb.halfSize[1]?-1:1;this.obb.halfSize[2]*=0>this.obb.halfSize[2]?-1:1;this.obb.quaternion=a.quaternion;return this.obb};u._createClass(e,[{key:"localOrigin",set:function(a){this.componentLocalOriginLength=
Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}}]);return e}(),z=function(){function e(a=0){this.offset=a;this.sphere=J.create();this.tmpVertex=r.create()}var g=e.prototype;g.applyToVertex=function(a,b,c){const d=this.objectTransform.transform;let f=d[0]*a+d[4]*b+d[8]*c+d[12],h=d[1]*a+d[5]*b+d[9]*c+d[13];a=d[2]*a+d[6]*b+d[10]*c+d[14];b=this.offset/Math.sqrt(f*f+h*h+a*a);f+=f*b;h+=h*b;a+=a*b;b=this.objectTransform.inverse;this.tmpVertex[0]=b[0]*f+b[4]*h+b[8]*a+b[12];this.tmpVertex[1]=b[1]*f+b[5]*h+b[9]*
a+b[13];this.tmpVertex[2]=b[2]*f+b[6]*h+b[10]*a+b[14];return this.tmpVertex};g.applyToMinMax=function(a,b){const c=this.offset/Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*c;a[1]+=a[1]*c;a[2]+=a[2]*c;a=this.offset/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]+=b[0]*a;b[1]+=b[1]*a;b[2]+=b[2]*a};g.applyToAabb=function(a){var b=this.offset/Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*b;a[1]+=a[1]*b;a[2]+=a[2]*b;b=this.offset/Math.sqrt(a[3]*a[3]+a[4]*a[4]+a[5]*a[5]);a[3]+=a[3]*b;a[4]+=a[4]*
b;a[5]+=a[5]*b;return a};g.applyToBoundingSphere=function(a){const b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),c=this.offset/b;this.sphere[0]=a[0]+a[0]*c;this.sphere[1]=a[1]+a[1]*c;this.sphere[2]=a[2]+a[2]*c;this.sphere[3]=a[3]+a[3]*this.offset/b;return this.sphere};return e}();const A=new z,B=new y,C=new w,x=G.create();l.I3SVerticalOffsetGlobalViewingMode=y;l.IntersectorTransform=K;l.Object3DVerticalOffsetGlobalViewingMode=z;l.TERRAIN_ID="terrain";l.TerrainVerticalOffsetGlobalViewingMode=w;l.getVerticalOffsetI3S=
function(e){return v.isSome(e)?(B.offset=e,B):null};l.getVerticalOffsetObject3D=function(e){return v.isSome(e)?(A.offset=e,A):null};l.getVerticalOffsetTerrain=function(e){return v.isSome(e)?(C.offset=e,C):null};Object.defineProperty(l,"__esModule",{value:!0})});