// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),function(l,g,m,q,r,t,u,v,w,p,x){m=function(){function n(a){this._rctx=a;this.cache=new Map}var f=n.prototype;f.dispose=function(){this.cache.forEach(a=>a.texture=g.disposeMaybe(a.texture));this.cache.clear()};
f.acquire=function(a){if(g.isNone(a))return null;const b=this.patternId(a),d=this.cache.get(b);if(d)return d.refCount++,d.bind;const e=this.patternToTextureData(a,2),h=e.length/2,c={refCount:1,texture:null,bind:k=>{g.isNone(c.texture)&&(c.texture=new p(this._rctx,{width:e.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},e));k.bindTexture(c.texture,"stipplePatternTexture");return h}};this.cache.set(b,c);return c.bind};f.release=function(a){if(!g.isNone(a)){a=this.patternId(a);
var b=this.cache.get(a);b&&(b.refCount--,0===b.refCount&&(g.isSome(b.texture)&&b.texture.dispose(),this.cache.delete(a)))}};f.swap=function(a,b){b=this.acquire(b);this.release(a);return b};f.patternId=function(a){return a.join(",")};f.patternToTextureData=function(a,b){var d=a.reduce((c,k)=>c+k)*b;d=new Uint8Array(d);let e=!0,h=0;for(const c of a){for(a=0;a<c*b;a++)d[h++]=e?255:0;e=!e}return d};return n}();l.StippleTextureRepository=m;Object.defineProperty(l,"__esModule",{value:!0})});