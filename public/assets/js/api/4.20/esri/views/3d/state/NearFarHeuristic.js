// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../core/mathUtils ../../../core/unitUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projectionEllipsoid".split(" "),function(q,p,v,n,r,t){function u(e,b,d,a){d=2/d;e/b>d?(a.far=e,a.near=a.far/b):(a.near=d,a.far=a.near*b);return a}let w=function(){function e(b,d){this.elevationProvider=b;this._referenceEllipsoid=t.getReferenceEllipsoid(d);this.unitInMeters=v.getMetersPerUnitForSR(d,this._referenceEllipsoid.metersPerDegree)}e.prototype.compute=function(b,d,
a,f,g){g||(g={near:0,far:0});var c=b[2]*this.unitInMeters,k=c;f=c-f;var l=this.elevationProvider?this.elevationProvider.elevationBounds:null;l&&(c=0<=f?k-this.unitInMeters*l.min:this.unitInMeters*l.max-k);k=Math.max(a.xmax-a.xmin,a.ymax-a.ymin,4*Math.max(a.xmax-a.xmin,a.ymax-a.ymin));n.subtract(h,d,b);m[0]=0<h[0]?a.xmax:a.xmin;m[1]=0<h[1]?a.ymax:a.ymin;m[2]=0<h[2]?k/2:-k/2;n.subtract(m,m,b);n.normalize(h,h);b=1.1*n.dot(m,h)*this.unitInMeters;d=Math.sqrt(c*(c+2*this._referenceEllipsoid.radius));a=
Math.max(a.xmax-a.xmin,a.ymax-a.ymin);l=1E-4*a*this.unitInMeters;c=p.clamp((c-l)/(.001*a*this.unitInMeters-l),0,1);c=p.lerp(d,b,c*c*c);c*=Math.max(Math.log(Math.abs(f)),1);c=Math.min(c,Math.max(34064E4,k));c/=this.unitInMeters;return u(c,2E4,this.unitInMeters,g)};return e}(),x=function(){function e(b){this._referenceEllipsoid=t.getReferenceEllipsoid(b)}e.prototype.compute=function(b,d,a,f,g){g||(g={near:0,far:0});b=n.length(b)-this._referenceEllipsoid.radius;b=Math.max(Math.abs(b-f),Math.abs(b));
f=Math.sqrt(b*(b+2*(this._referenceEllipsoid.radius+Math.min(0,f))));b=p.clamp(2E4-(Math.log(b)-7.983)/9.011*19E3,1E3,2E4);return u(1.2*f,b,1,g)};return e}();const m=r.create(),h=r.create();q.createNearFarHeuristic=function(e,b,d){return 1===e?new x(d):new w(b,d)};Object.defineProperty(q,"__esModule",{value:!0})});