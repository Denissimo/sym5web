// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/screenUtils ./InputHandler ./InputManager".split(" "),function(u,z,v,A,w,B,C){function x(q){return!!y[q]}function D(q){for(const n of q)if(!x(n))return!1;return!0}v="click double-click immediate-click immediate-double-click hold drag key-down key-up pointer-down pointer-move pointer-up pointer-drag mouse-wheel pointer-enter pointer-leave gamepad focus blur".split(" ");const y={};v.forEach(q=>{y[q]=
!0});let F=function(){function q(h){this.handlers=new Map;this.counter=0;this.handlerCounts=new Map;this.view=h;this.inputManager=null}var n=q.prototype;n.connect=function(h){h&&this.disconnect();this.inputManager=h;this.handlers.forEach(({handler:a,priority:d},e)=>this.inputManager.installHandlers(e,[a],d))};n.disconnect=function(){this.inputManager&&this.handlers.forEach((h,a)=>this.inputManager.uninstallHandlers(a));this.inputManager=null};n.destroy=function(){this.disconnect();this.handlers.clear();
this.view=null};n.on=function(h,a,d,e){const f=Array.isArray(h)?h:h.split(",");if(!D(f))return f.some(x)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;if(Array.isArray(a))h=a;else{var b=a;h=[]}"function"===typeof d?b=d:e=d;e=null!=e?e:C.ViewEventPriorities.DEFAULT;const g=this.createUniqueGroupName();d=new E(this.view,f,h,b);this.handlers.set(g,{handler:d,priority:e});for(const c of f)b=this.handlerCounts.get(c)||0,this.handlerCounts.set(c,
b+1);this.inputManager&&this.inputManager.installHandlers(g,[d],e);return{remove:()=>this.removeHandler(g,f)}};n.hasHandler=function(h){return!!this.handlerCounts.get(h)};n.removeHandler=function(h,a){if(this.handlers.has(h)){this.handlers.delete(h);for(const d of a)a=this.handlerCounts.get(d),void 0===a?console.error("Trying to remove handler for event that has no handlers registered: ",d):1===a?this.handlerCounts.delete(d):this.handlerCounts.set(d,a-1)}this.inputManager&&this.inputManager.uninstallHandlers(h)};
n.createUniqueGroupName=function(){this.counter+=1;return`viewEvents_${this.counter}`};return q}(),E=function(q){function n(a,d,e,f){var b=q.call(this,!0)||this;b.view=a;for(const g of d)switch(g){case "click":b.registerIncoming("click",e,c=>f(b.wrapClick(c)));break;case "double-click":b.registerIncoming("double-click",e,c=>f(b.wrapDoubleClick(c)));break;case "immediate-click":b.registerIncoming("immediate-click",e,c=>f(b.wrapImmediateClick(c)));break;case "immediate-double-click":b.registerIncoming("immediate-double-click",
e,c=>f(b.wrapImmediateDoubleClick(c)));break;case "hold":b.registerIncoming("hold",e,c=>f(b.wrapHold(c)));break;case "drag":b.registerIncoming("drag",e,c=>{(c=b.wrapDrag(c))&&f(c)});break;case "key-down":b.registerIncoming("key-down",e,c=>f(b.wrapKeyDown(c)));break;case "key-up":b.registerIncoming("key-up",e,c=>f(b.wrapKeyUp(c)));break;case "pointer-down":b.registerIncoming("pointer-down",e,c=>f(b.wrapPointer(c,"pointer-down")));break;case "pointer-move":b.registerIncoming("pointer-move",e,c=>f(b.wrapPointer(c,
"pointer-move")));break;case "pointer-up":b.registerIncoming("pointer-up",e,c=>f(b.wrapPointer(c,"pointer-up")));break;case "pointer-drag":b.registerIncoming("pointer-drag",e,c=>f(b.wrapPointerDrag(c)));break;case "mouse-wheel":b.registerIncoming("mouse-wheel",e,c=>f(b.wrapMouseWheel(c)));break;case "pointer-enter":b.registerIncoming("pointer-enter",e,c=>f(b.wrapPointer(c,"pointer-enter")));break;case "pointer-leave":b.registerIncoming("pointer-leave",e,c=>f(b.wrapPointer(c,"pointer-leave")));break;
case "gamepad":b.registerIncoming("gamepad",e,c=>{f(b.wrapGamepad(c))});break;case "focus":b.registerIncoming("focus",e,c=>{f(b.wrapFocus(c))});break;case "blur":b.registerIncoming("blur",e,c=>{f(b.wrapBlur(c))})}return b}z._inheritsLoose(n,q);var h=n.prototype;h.wrapFocus=function(a){return{type:"focus",timestamp:a.timestamp,native:a.data.native,cancelable:a.cancelable,stopPropagation:()=>a.stopPropagation(),async:d=>a.async(d),preventDefault:()=>a.preventDefault()}};h.wrapBlur=function(a){return{type:"blur",
timestamp:a.timestamp,native:a.data.native,cancelable:a.cancelable,stopPropagation:()=>a.stopPropagation(),async:d=>a.async(d),preventDefault:()=>a.preventDefault()}};h.wrapClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:k}=a.data,{cancelable:l,timestamp:m}=a,p=w.createScreenPoint(b,g),r=this.getMapPoint(b,g);return{type:"click",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:m,screenPoint:p,mapPoint:r,eventId:k,cancelable:l,stopPropagation:()=>a.stopPropagation(),
async:t=>a.async(t),preventDefault:()=>a.preventDefault()}};h.wrapDoubleClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:k}=a.data,{cancelable:l,timestamp:m}=a;return{type:"double-click",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:m,mapPoint:this.getMapPoint(b,g),eventId:k,cancelable:l,stopPropagation:()=>a.stopPropagation(),async:p=>a.async(p),preventDefault:()=>a.preventDefault()}};h.wrapImmediateClick=function(a){const {pointerType:d,button:e,buttons:f,
x:b,y:g,native:c,eventId:k}=a.data,l=c.pointerId,{cancelable:m,timestamp:p}=a;return{type:"immediate-click",pointerId:l,pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:p,mapPoint:this.getMapPoint(b,g),eventId:k,cancelable:m,stopPropagation:()=>a.stopPropagation(),async:r=>a.async(r),preventDefault:()=>a.preventDefault()}};h.wrapImmediateDoubleClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:k}=a.data,l=c.pointerId,{cancelable:m,timestamp:p}=a;return{type:"immediate-double-click",
pointerId:l,pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:p,mapPoint:this.getMapPoint(b,g),eventId:k,cancelable:m,stopPropagation:()=>a.stopPropagation(),async:r=>a.async(r),preventDefault:()=>a.preventDefault()}};h.wrapHold=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c}=a.data,{cancelable:k,timestamp:l}=a;return{type:"hold",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:l,mapPoint:this.getMapPoint(b,g),cancelable:k,stopPropagation:()=>a.stopPropagation(),
async:m=>a.async(m),preventDefault:()=>a.preventDefault()}};h.getMapPoint=function(a,d){return this.view.toMap(w.createScreenPoint(a,d),{exclude:[]})};h.wrapDrag=function(a){const d=a.data,{x:e,y:f}=d.center,{action:b,pointerType:g,button:c}=d;"start"===b&&(this.latestDragStart=d);if(this.latestDragStart){var k=d.pointer.native,l=d.buttons,{cancelable:m,timestamp:p}=a,r={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};"end"===b&&(this.latestDragStart=void 0);return{type:"drag",action:b,
x:e,y:f,origin:r,pointerType:g,button:c,buttons:l,radius:d.radius,angle:A.rad2deg(d.angle),native:k,timestamp:p,cancelable:m,stopPropagation:()=>a.stopPropagation(),async:t=>a.async(t),preventDefault:()=>a.preventDefault()}}};h.wrapKeyDown=function(a){const {key:d,repeat:e,native:f}=a.data,{cancelable:b,timestamp:g}=a;return{type:"key-down",key:d,repeat:e,native:f,timestamp:g,cancelable:b,stopPropagation:()=>a.stopPropagation(),async:c=>a.async(c),preventDefault:()=>a.preventDefault()}};h.wrapKeyUp=
function(a){const {key:d,native:e}=a.data,{cancelable:f,timestamp:b}=a;return{type:"key-up",key:d,native:e,timestamp:b,cancelable:f,stopPropagation:()=>a.stopPropagation(),async:g=>a.async(g),preventDefault:()=>a.preventDefault()}};h.wrapPointer=function(a,d){const {x:e,y:f,button:b,buttons:g,native:c,eventId:k}=a.data,l=c.pointerId,m=c.pointerType,{cancelable:p,timestamp:r}=a;return{type:d,x:e,y:f,pointerId:l,pointerType:m,button:b,buttons:g,native:c,timestamp:r,eventId:k,cancelable:p,stopPropagation:()=>
a.stopPropagation(),async:t=>a.async(t),preventDefault:()=>a.preventDefault()}};h.wrapPointerDrag=function(a){const {x:d,y:e,buttons:f,native:b,eventId:g}=a.data.currentEvent,{button:c}=a.data.startEvent,k=a.data.startEvent.native.pointerId,l=a.data.startEvent.native.pointerType,m=a.data.action,p={x:a.data.startEvent.x,y:a.data.startEvent.y},{cancelable:r,timestamp:t}=a;return{type:"pointer-drag",x:d,y:e,pointerId:k,pointerType:l,button:c,buttons:f,action:m,origin:p,native:b,timestamp:t,eventId:g,
cancelable:r,stopPropagation:()=>a.stopPropagation(),async:G=>a.async(G),preventDefault:()=>a.preventDefault()}};h.wrapMouseWheel=function(a){const {cancelable:d,data:e,timestamp:f}=a,{x:b,y:g,deltaY:c,native:k}=e;return{type:"mouse-wheel",x:b,y:g,deltaY:c,native:k,timestamp:f,cancelable:d,stopPropagation:()=>a.stopPropagation(),async:l=>a.async(l),preventDefault:()=>a.preventDefault()}};h.wrapGamepad=function(a){const {action:d,state:e,device:f}=a.data,{cancelable:b,timestamp:g}=a,{buttons:c,axes:k}=
e;return{type:"gamepad",device:f,timestamp:g,action:d,buttons:c,axes:k,cancelable:b,stopPropagation:()=>a.stopPropagation(),async:l=>a.async(l),preventDefault:()=>a.preventDefault()}};return n}(B.InputHandler);u.ViewEvents=F;u.eventTypes=v;Object.defineProperty(u,"__esModule",{value:!0})});