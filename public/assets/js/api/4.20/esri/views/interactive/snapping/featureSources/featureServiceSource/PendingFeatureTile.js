// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/asyncUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../geometry/support/aaBoundingRect".split(" "),function(l,f,m,q,n,g){let r=function(){function h(a,b){this.data=a;this.resolution=b;this.state={type:0};this.alive=!0}var e=h.prototype;e.process=function(a){switch(this.state.type){case 0:return this.state=this.gotoFetchCount(this.state,a),this.state.task.promise.then(a.resume,a.resume);
case 2:return this.state=this.gotoFetchFeatures(this.state,a),this.state.task.promise.then(a.resume,a.resume);case 4:this.state=this.goToDone(this.state,a)}return null};e.gotoFetchCount=function(a,b){var c=this;return{type:1,previous:a,task:n.createTask(function(){var k=f._asyncToGenerator(function*(d){d=yield m.resultOrAbort(b.fetchCount(c,d));1===c.state.type&&(c.state=c.gotoFetchedCount(c.state,d.ok?d.value:Infinity))});return function(d){return k.apply(this,arguments)}}())}};e.gotoFetchedCount=
function(a,b){return{type:2,featureCount:b,previous:a}};e.gotoFetchFeatures=function(a,b){var c=this;return{type:3,previous:a,task:n.createTask(function(){var k=f._asyncToGenerator(function*(d){d=yield m.resultOrAbort(b.fetchFeatures(c,a.featureCount,d));3===c.state.type&&(c.state=c.gotoFetchedFeatures(c.state,d.ok?d.value:[]))});return function(d){return k.apply(this,arguments)}}())}};e.gotoFetchedFeatures=function(a,b){return{type:4,previous:a,features:b}};e.goToDone=function(a,b){b.finish(this,
a.features);return{type:5,previous:a}};e.reset=function(){const a=this.state;this.state={type:0};switch(a.type){case 1:case 3:a.task.abort()}};e.intersects=function(a){if(q.isNone(a)||!this.data.extent)return!0;g.fromExtent(a,p);return g.intersects(this.data.extent,p)};f._createClass(h,[{key:"debugInfo",get:function(){return{data:this.data,featureCount:this.featureCount,state:this.stateToString}}},{key:"featureCount",get:function(){switch(this.state.type){case 0:case 1:return 0;case 2:return this.state.featureCount;
case 3:return this.state.previous.featureCount;case 4:return this.state.features.length;case 5:return this.state.previous.features.length}}},{key:"stateToString",get:function(){switch(this.state.type){case 0:return"created";case 1:return"fetch-count";case 2:return"fetched-count";case 3:return"fetch-features";case 4:return"fetched-features";case 5:return"done"}}}]);return h}();const p=g.create();l.PendingFeatureTile=r;Object.defineProperty(l,"__esModule",{value:!0})});