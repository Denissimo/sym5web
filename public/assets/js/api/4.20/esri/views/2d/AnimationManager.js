// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../Viewpoint ../../core/Accessor ../../core/scheduling ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../ViewAnimation ./unitBezier ./viewpointUtils ../../geometry/Point".split(" "),function(m,g,f,q,r,t,h,y,z,A,B,u,n,l,v,w){let x=function(){function k(e,c,a,b){const d=e.targetGeometry,
p=c.targetGeometry;b?"string"===typeof b&&(b=l.parse(b)||l.easingFunctions.ease):b=l.easingFunctions.ease;this.easing=b;this.duration=a;this.sCenterX=d.x;this.sCenterY=d.y;this.sScale=e.scale;this.sRotation=e.rotation;this.tCenterX=p.x;this.tCenterY=p.y;this.tScale=c.scale;this.tRotation=c.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:
-180>this.dRotation&&(this.dRotation+=360)}k.prototype.applyRatio=function(e,c){var a=this.easing(c);let b,d;1<=c?(c=this.tCenterX,b=this.tCenterY,d=this.tRotation,a=this.tScale):(c=this.sCenterX+a*this.dCenterX,b=this.sCenterY+a*this.dCenterY,d=this.sRotation+a*this.dRotation,a=this.sScale+a*this.dScale);e.targetGeometry.x=c;e.targetGeometry.y=b;e.scale=a;e.rotation=d};return k}();f=function(k){function e(a){a=k.call(this,a)||this;a.duration=200;a.transition=null;a.easing=l.easingFunctions.ease;
a.view=null;a.viewpoint=null;a.viewpoint=new q({targetGeometry:new w,scale:0,rotation:0});a._updateTask=t.addFrameTask({postRender:a._postRender.bind(m._assertThisInitialized(a))});a._updateTask.pause();return a}m._inheritsLoose(e,k);var c=e.prototype;c.destroy=function(){this._updateTask.remove();this._updateTask=null};c.animate=function(a,b,d){this.stop();v.copy(this.viewpoint,b);this.transition=new x(this.viewpoint,a.target,d&&d.duration||this.duration,d&&d.easing||this.easing);b=()=>{this.animation===
a&&this._updateTask&&("finished"===a.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.updateFunction=this.animation=null)};a.when(b,b);this._startTime=performance.now();this._updateTask.resume();return this.animation=a};c.animateContinous=function(a,b){this.stop();this.updateFunction=b;this.viewpoint=a;const d=new n({target:a.clone()});a=()=>{this.animation===d&&this._updateTask&&(this.updateFunction=this.animation=null)};
d.when(a,a);this._startTime=performance.now();this._updateTask.resume();return this.animation=d};c.stop=function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)};c._postRender=function(a){var b=this.animation;b&&b.state!==n.State.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,a.deltaTime):(a=(performance.now()-this._startTime)/this.transition.duration,b=1<=a,this.transition.applyRatio(this.viewpoint,a),b&&this.animation.finish()),this.view.state&&
(this.view.state.viewpoint=this.viewpoint.clone())):this._updateTask.pause()};return e}(r);g.__decorate([h.property()],f.prototype,"animation",void 0);g.__decorate([h.property()],f.prototype,"duration",void 0);g.__decorate([h.property()],f.prototype,"transition",void 0);g.__decorate([h.property()],f.prototype,"easing",void 0);g.__decorate([h.property()],f.prototype,"view",void 0);g.__decorate([h.property()],f.prototype,"viewpoint",void 0);return f=g.__decorate([u.subclass("esri.views.2d.AnimationManager")],
f)});