// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(F,G,l,H,I,v,w,r,J,t,K,L){return function(E){function p(a,b,k,e,h,d,m,f,n,y,z,A,B,C,g,D,x,u,q,M,N,O,P){var c=E.call(this)||this;c.angle=e;c.height=m;c.width=d;c.xOffset=
b*q;c.yOffset=k*q;c._markerPlacement=M;c._effects=N;c._anchorX=.5-(.5+D)*g.width/g.width;c._anchorY=.5-(.5+x)*g.height/g.height;c._minMaxZoom=r.i1616to32(Math.round(O*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(P*w.MIN_MAX_ZOOM_PRECISION_FACTOR));b=(1===C?1:0)|(z?1:0)<<1|(B?1:0)<<2|(A?1:0)<<3;k=g&&g.sdf;a=J.MarkerMaterialKey.load(a);a.sdf=k;a.pattern=!0;a.textureBinding=g.textureBinding;c._materialKey=a.data;c._fillColor=h;c._outlineColor=n;c._sizeOutlineWidth=r.i8888to32(Math.round(Math.min(Math.sqrt(128*
d),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*f),255)));h=g.rect.x+w.SPRITE_PADDING;f=g.rect.y+w.SPRITE_PADDING;n=h+g.width;g=f+g.height;c._offsets.xUpperLeft=h;c._offsets.yUpperLeft=f;c._offsets.xUpperRight=n;c._offsets.yUpperRight=f;c._offsets.xBottomLeft=h;c._offsets.yBottomLeft=g;c._offsets.xBottomRight=n;c._offsets.yBottomRight=g;c._texUpperLeft=r.i1616to32(h,f);c._texUpperRight=r.i1616to32(n,f);c._texBottomLeft=
r.i1616to32(h,g);c._texBottomRight=r.i1616to32(n,g);d=d*u*q;m=m*u*q;c._bitestAndDistRatio=r.i1616to32(b,Math.round(64*u));c._computedWidth=d;c._computedHeight=m;d=I.create();m=H.create();c._applyTransformation(m,d);return c}F._inheritsLoose(p,E);p.fromCIMMarker=function(a,b,k){const e=a.size,h=(b&&b.width||1)/(b&&b.height||1)*a.scaleX;var d=a.scaleSymbolsProportionally&&a.frameHeight?e/a.frameHeight:1;const m=v.premultiplyAlphaRGBA(a.color),f=v.premultiplyAlphaRGBA(a.outlineColor),n=l.pt2px(e),y=
n*h,z=l.pt2px(a.offsetX||0),A=l.pt2px(a.offsetY||0);d*=l.pt2px(a.outlineWidth||0);const B=a.alignment||0,C=l.pt2px(a.referenceSize),[g,D]=t.getMinMaxZoom(a.scaleInfo,k);k=a.rotation||0;a.rotateClockwise||(k=-k);let x=0,u=0;const q=a.anchorPoint;q&&(a.isAbsoluteAnchorPoint?e&&(x=-q.x/(e*h),u=q.y/e):(x=q.x,u=q.y));b=new p(a.materialKey,z,A,k,m,y,n,C,f,d,a.colorLocked,a.scaleSymbolsProportionally,!1,B,b,x,u,a.sizeRatio,G.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects,g,D);b._vertexBoundsScaleX=
a.maxVVSize?a.maxVVSize/y:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/n:1;return b};p.fromPictureMarker=function(a,b){const k=Math.round(l.pt2px(a.width)),e=Math.round(l.pt2px(a.height)),h=w.PICTURE_FILL_COLOR,d=Math.round(l.pt2px(a.xoffset||0)),m=Math.round(l.pt2px(a.yoffset||0));b=new p(a.materialKey,d,m,a.angle,h,k,e,e,0,0,!1,!1,!1,0,b,0,0,1,1,null,null,t.DEFAULT_MIN_ZOOM,t.DEFAULT_MAX_ZOOM);b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/
a.height:1;return b};p.fromSimpleMarker=function(a,b){const k=v.premultiplyAlphaRGBAArray(a.color),e=Math.round(l.pt2px(a.size)),h=Math.round(l.pt2px(a.xoffset||0)),d=Math.round(l.pt2px(a.yoffset||0)),m=a.style;var f=a.outline;const n=(f&&f.color&&v.premultiplyAlphaRGBAArray(f.color))|0;f=(f&&f.width&&Math.round(l.pt2px(f.width)))|0;b=new p(a.materialKey,h,d,a.angle,k,e,e,e,n,f,!1,!1,"esriSMSCross"===m||"esriSMSX"===m,0,b,0,0,1.96875,1,null,null,t.DEFAULT_MIN_ZOOM,t.DEFAULT_MAX_ZOOM);b.boundsType=
"esriSMSCircle"===m?"circle":"square";b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.size:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return b};p.fromLineSymbolMarker=function(a,b){const k=v.premultiplyAlphaRGBAArray(a.color),e=Math.round(l.pt2px(6*a.lineWidth)),h="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var d="Both";break;case "begin":d="JustBegin";break;case "end":d="JustEnd";break;default:d="None"}d={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,
offset:0,extremityPlacement:d,offsetAlongLine:0};b=new p(a.materialKey,0,0,0,k,e,e,e/6,k,h?Math.round(l.pt2px(a.lineWidth)):0,!1,!1,h,1,b,0,0,1.96875,1,d,null,t.DEFAULT_MIN_ZOOM,t.DEFAULT_MAX_ZOOM);b.boundsType="circle"===a.style?"circle":"square";return b};return p}(K(L))});