// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(p,r,t,u,l,m,v){const d=l("esri-2d-profiler");l=function(){function n(a,f){this._events=new u;this._entries=new Map;this._timings=new t(10);if(d){this._ext=v.createDisjointTimerQuery(a.gl,{});this._debugOutput=f;var c=a.gl;if(this.enableCommandLogging)for(const e in c)if("function"===
typeof c[e]){const g=c[e],b=-1!==e.indexOf("draw");c[e]=(...k)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:e,args:k,isDrawCommand:b});this._currentSummary&&(this._currentSummary.commands++,b&&this._currentSummary.drawCommands++);return g.apply(c,k)}}}}var h=n.prototype;h.recordContainerStart=function(a){d&&(this._currentContainer=a)};h.recordContainerEnd=function(){d&&(this._currentContainer=null)};h.recordPassStart=function(a){d&&
(this._currentPass=a,this._initSummary())};h.recordPassEnd=function(){d&&(this._currentPass=null,this._emitSummary())};h.recordBrushStart=function(a){d&&(this._currentBrush=a)};h.recordBrushEnd=function(){d&&(this._currentBrush=null)};h.recordStart=function(a){if(d&&m.isSome(this._ext)){if(this._entries.has(a)){const b=this._entries.get(a);var f=this._ext.resultAvailable(b.query),c=this._ext.disjoint();if(f&&!c){f=this._ext.getResult(b.query)/1E6;c=0;if(m.isSome(this._timings.enqueue(f))){c=this._timings.entries;
const k=c.length;let q=0;for(var e of c)q+=e;c=q/k}e=f.toFixed(2);f=c?c.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${a}, ${e} ms (${f} last 10 avg)
${b.commandsLen} Commands (${b.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log(`Frame report for ${a}, ${e} ms (${f} last 10 avg)`);this._debugOutput.innerHTML=`${e} (${f})`}for(const k of b.handles)k.remove();this._entries.delete(a)}const g={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(g.handles.push(this._events.on("command",
b=>{g.commandsLen++;g.commands.push(b);b.isDrawCommand&&g.drawCommands++})),g.handles.push(this._events.on("summary",b=>{g.summaries.push(b)})));this._ext.beginTimeElapsed(g.query);this._entries.set(a,g)}};h.recordEnd=function(a){d&&m.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};h._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};h._emitSummary=function(){this.enableCommandLogging&&
this._events.emit("summary",this._currentSummary)};r._createClass(n,[{key:"enableCommandLogging",get:function(){return!("object"===typeof d&&d.disableCommands)}}]);return n}();p.Profiler=l;Object.defineProperty(p,"__esModule",{value:!0})});