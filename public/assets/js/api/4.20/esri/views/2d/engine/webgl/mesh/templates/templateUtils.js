// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/earcut ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),function(r,D,E,x,B,F,G){function y(b,a,d){let g=0;for(let c=1;c<d;c++)g+=(b[2*(a+c)]-b[2*(a+c-1)])*(b[2*(a+c)+1]+b[2*(a+c-1)+1]);return g}function C(b,a,d,g,c){let k=0;for(;d<g;d+=3){const e=2*(b.getValue(d)-c),f=2*(b.getValue(d+1)-c),h=2*(b.getValue(d+2)-c);k+=Math.abs((a[e]-a[h])*(a[f+1]-a[e+1])-(a[e]-a[f])*(a[h+1]-a[e+1]))}return k}
function z(b,a,d,g,c,k,e,f){c=((b-c)*(k-f)-(a-f)*(c-e))/((b-d)*(k-f)-(a-g)*(c-e));return 0>c||1<c?null:{x:Math.round(b+c*(d-b)),y:Math.round(a+c*(g-a))}}const w=new G,t=new B.TileClipper(0,0,0,1,0),u=new B.TileClipper(0,0,0,1,0);t.setExtent(x.TILE_SIZE);u.setExtent(x.TILE_SIZE);r.area=y;r.clip=function(b,a,d=0){const g=-d;a+=d;let c=d=0,k=0;for(let f=0;f<b.lengths.length;f++){const h=b.lengths[f],l=k+h;let m=0,p=null;for(;d!==l;){let n=b.coords[2*d],q=b.coords[2*d++ +1],v=n<g||n>=a||q<g||q>=a;for(var e=
v;d!==l&&v===e;)v||(b.coords[2*c]=n,b.coords[2*c++ +1]=q,m++),n=b.coords[2*d],q=b.coords[2*d++ +1],v=n<g||n>=a||q<g||q>=a;if(d===l){v?p&&(b.coords[2*c]=p.x,b.coords[2*c++ +1]=p.y,m++):(b.coords[2*c]=n,b.coords[2*c++ +1]=q,m++);continue}e=b.coords[2*(d-2)];const A=b.coords[2*(d-2)+1];if(e=z(e,A,n,q,g,g,a,g)||z(e,A,n,q,a,g,a,a)||z(e,A,n,q,a,a,g,a)||z(e,A,n,q,g,g,g,a))b.coords[2*c]=e.x,b.coords[2*c++ +1]=e.y,m++,p||(p=e);v||(b.coords[2*c]=n,b.coords[2*c++ +1]=q,m++)}b.lengths[f]=m;k+=h}};r.clipLinesMarshall=
function(b,a){u.setPixelMargin(a);const d=-a;a=x.TILE_SIZE+a;let g=[];var c=!1;let k=0;for(;k<b.length;){const e=[],f=b[k];u.reset(2);let [h,l]=f[0];if(c)u.moveTo(h,l);else{if(h<d||h>a||l<d||l>a){c=!0;continue}e.push({x:h,y:l})}let m=!1;const p=f.length;for(let n=1;n<p;++n)if(h+=f[n][0],l+=f[n][1],c)u.lineTo(h,l);else{if(h<d||h>a||l<d||l>a){m=!0;break}e.push({x:h,y:l})}if(m)c=!0;else{if(c){if(c=u.resultWithStarts())for(const n of c)g.push(n)}else g.push({line:e,start:0});k++;c=!1}}g=g.filter(e=>1<
e.line.length);return 0===g.length?null:g};r.clipMarshall=function(b,a){a:{var d=x.TILE_SIZE+128;var g=0;for(var c=0;c<b.lengths.length;c++){var k=b.lengths[c];for(var e=0;e<k;e++){const f=b.coords[2*(e+g)],h=b.coords[2*(e+g)+1];if(-128>f||f>d||-128>h||h>d){d=!0;break a}}g+=k}d=!1}if(!d)return b;t.setPixelMargin(a);t.reset(3);a=0;for(d=0;d<b.lengths.length;d++){g=b.lengths[d];c=b.coords[2*(0+a)];k=b.coords[2*(0+a)+1];t.moveTo(c,k);for(e=1;e<g;e++)c=b.coords[2*(e+a)],k=b.coords[2*(e+a)+1],t.lineTo(c,
k);t.close();a+=g}d=t.result(!1);if(!d)return null;b=[];a=[];for(const f of d){d=0;for(const h of f)a.push(h.x),a.push(h.y),d++;b.push(d)}return new E(b,a)};r.triangleArea=C;r.triangulate=function(b,a){const {coords:d,lengths:g,hasIndeterminateRingOrder:c}=a;a=b.indexWriter();b=b.vertexCount();if(c)return!1;const k=a.length;let e=0;for(var f=0;f<g.length;){let m=f,p=g[f];f=y(d,e,p);for(var h=[];++m<g.length;){var l=g[m];const n=y(d,e+p,l);if(!(0<n))break;f+=n;h.push(e+p);p+=l}l=a.length;F.bufcut(a,
d,e,e+p,h,2,b);h=C(a,d,l,a.length,b);f=Math.abs(f);if(1E-5<Math.abs((h-f)/Math.max(1E-7,f)))return a.seek(k),!1;f=m;e+=p}return!0};r.triangulateEarcut=function(b,a,d){const {coords:g,lengths:c,hasIndeterminateRingOrder:k}=a;if(k)return!1;let e=0;for(var f=0;f<c.length;){let l=f,m=c[f];for(f=[];++l<c.length;){var h=c[l];if(!(0<y(g,e+m,h)))break;f.push(e+m-e);m+=h}h=a.coords.slice(2*e,2*(e+m));f=D.earcut(h,f,2);for(const p of f)b.push(p+d+e);f=l;e+=m}return!0};r.triangulateLibtess=function(b,a){const d=
[],g=[],c=b.indexWriter();b=b.vertexCount();const {coords:k,lengths:e}=a;w.beginPolygon(d,g);let f=0;for(let h=0;h<e.length;h++){const l=a.lengths[h];w.beginContour();for(let m=0;m<l;m++){const p=[k[2*(f+m)],k[2*(f+m)+1],0];w.addVertex(p,p)}w.endContour();f+=l}w.endPolygon();for(a=0;a<g.length;a++)c.push(g[a]+b);return d};Object.defineProperty(r,"__esModule",{value:!0})});