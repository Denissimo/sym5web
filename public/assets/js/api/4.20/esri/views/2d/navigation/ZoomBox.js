// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),function(m,n,h,t,p,v,w,x,y,u,q){h=function(r){function k(a){a=r.call(this,a)||this;a._container=null;a._overlay=null;a._backgroundShape=null;
a._boxShape=null;a._box={x:0,y:0,width:0,height:0};a._redraw=a._redraw.bind(m._assertThisInitialized(a));return a}m._inheritsLoose(k,r);var g=k.prototype;g.destroy=function(){this.view=null};g._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};g._update=function(a,c,b,d){this._box.x=a;this._box.y=c;this._box.width=b;this._box.height=d;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};g._end=function(a,c,b,d,e){const f=this.view;a=f.toMap(t.createScreenPoint(a+
.5*b,c+.5*d));b=Math.max(b/f.width,d/f.height);-1===e&&(b=1/b);this._destroyOverlay();this.navigation.end();f.goTo({center:a,scale:f.scale*b})};g._updateBox=function(a,c,b,d){const e=this._boxShape;e.setAttributeNS(null,"x",""+a);e.setAttributeNS(null,"y",""+c);e.setAttributeNS(null,"width",""+b);e.setAttributeNS(null,"height",""+d);e.setAttributeNS(null,"class","esri-zoom-box__outline")};g._updateBackground=function(a,c,b,d){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,c,b,d,this.view.width,
this.view.height))};g._createContainer=function(){const a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a};g._createOverlay=function(){var a=this.view.width,c=this.view.height;const b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+c+" L 0 "+c+" Z");b.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg",
"rect");c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");c.setAttributeNS(null,"class","esri-zoom-box__overlay");c.appendChild(b);c.appendChild(a);this._container.appendChild(c);this._backgroundShape=b;this._boxShape=a;this._overlay=c};g._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=
this._boxShape=this._overlay=null};g._toSVGPath=function(a,c,b,d,e,f){b=a+b;d=c+d;return"M 0 0 L "+e+" 0 L "+e+" "+f+" L 0 "+f+" ZM "+a+" "+c+" L "+a+" "+d+" L "+b+" "+d+" L "+b+" "+c+" Z"};g._handleDrag=function(a,c){var b=a.x,d=a.y,e=a.origin.x;const f=a.origin.y;let l;b>e?(l=e,e=b-e):(l=b,e-=b);d>f?(b=f,d-=f):(b=d,d=f-d);switch(a.action){case "start":this._start();break;case "update":this._update(l,b,e,d);break;case "end":this._end(l,b,e,d,c)}a.stopPropagation()};g._redraw=function(){if(this._rafId&&
(this._rafId=null,this._overlay)){var {x:a,y:c,width:b,height:d}=this._box;this._updateBox(a,c,b,d);this._updateBackground(a,c,b,d);this._rafId=requestAnimationFrame(this._redraw)}};m._createClass(k,[{key:"view",set:function(a){this._handles&&this._handles.forEach(c=>{c.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],c=>this._handleDrag(c,1),q.ViewEventPriorities.INTERNAL),a.on("drag",["Shift","Ctrl"],c=>this._handleDrag(c,-1),q.ViewEventPriorities.INTERNAL))}}]);
return k}(h);n.__decorate([p.property()],h.prototype,"navigation",void 0);n.__decorate([p.property()],h.prototype,"view",null);return h=n.__decorate([u.subclass("esri.views.2d.navigation.ZoomBox")],h)});