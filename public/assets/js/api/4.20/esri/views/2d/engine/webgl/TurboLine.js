// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","./definitions"],function(fa,ja){function ha(f,l){return f.x===l.x&&f.y===l.y}function N(f,l){f.x=l.y;f.y=-l.x;return f}function K(f,l){f.x=-l.y;f.y=l.x;return f}function ia(f,l){f.x=l.x;f.y=l.y;return f}function ca(f,l){f.x=-l.x;f.y=-l.y;return f}function da(f){return Math.sqrt(f.x*f.x+f.y*f.y)}function V(f,l,e,c){f.x=l.x*e+l.y*c;f.y=l.x*c-l.y*e;return f}let ma=function(){function f(e,c,t){this.writeVertex=e;this.writeTriangle=c;this.canUseThinTessellation=t;this.prevNormal={x:void 0,
y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd=
{x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var l=f.prototype;l.tessellate=function(e,c){if(e){var t=e.length;if(!(1>=t)){var I=0;for(let B=1;B<t;B++)ha(e[B],e[I])||++I===B||(e[I]=e[B]);e.length=I+1}}this.canUseThinTessellation&&c.halfWidth<ja.THIN_LINE_HALF_WIDTH_THRESHOLD&&!c.offset?this.tessellateThin_(e,c):this.tessellate_(e,c)};l.tessellateThin_=function(e,c){if(!(2>e.length)){var t=c.wrapDistance||65535;c=c.initialDistance||0;var I=!1,B=e[0].x,E=e[0].y,Z=e.length;for(let L=1;L<
Z;++L){I&&(I=!1,c=0);let A=e[L].x,d=e[L].y;var C=A-B;let b=d-E;var O=Math.sqrt(C*C+b*b);C/=O;b/=O;if(c+O>t){I=!0;var R=(t-c)/O;O=t-c;A=(1-R)*B+R*A;d=(1-R)*E+R*d;--L}R=this.writeVertex(B,E,0,0,C,b,b,-C,0,-1,c);B=this.writeVertex(B,E,0,0,C,b,-b,C,0,1,c);c+=O;O=this.writeVertex(A,d,0,0,C,b,b,-C,0,-1,c);C=this.writeVertex(A,d,0,0,C,b,-b,C,0,1,c);this.writeTriangle(R,B,O);this.writeTriangle(B,O,C);B=A;E=d}}};l.tessellate_=function(e,c){var t=e[e.length-1];const I=ha(e[0],t);if(!(e.length<(I?3:2))){var B=
c.pixelCoordRatio,E=null!=c.capType?c.capType:0,Z=null!=c.joinType?c.joinType:2,C=null!=c.miterLimit?Math.min(c.miterLimit,4):2,O=null!=c.roundLimit?Math.min(c.roundLimit,1.05):1.05,R=null!=c.halfWidth?c.halfWidth:2,L=!!c.textured,A=null,d=null,b=this.prevNormal,a=this.nextNormal,W=-1,S=-1,h=this.joinNormal,aa=this.textureNormalLeft,ba=this.textureNormalRight,x=this.textureNormal,q=-1,r=-1,ea=c.wrapDistance||65535,n=c.initialDistance||0,ka=this.writeVertex,la=this.writeTriangle;c=function(D,P,Q,X,
T,U){D=ka(y,z,u,v,Q,X,D,P,T,U,n);0<=q&&0<=r&&0<=D&&la(q,r,D);q=r;return r=D};I&&(A=e[e.length-2],a.x=t.x-A.x,a.y=t.y-A.y,S=da(a),a.x/=S,a.y/=S);t=!1;for(let D=0;D<e.length;++D){t&&(t=!1,n=0);A&&(b.x=-a.x,b.y=-a.y,W=S,n+W>ea&&(t=!0));t?(d=(ea-n)/W,W=ea-n,A={x:(1-d)*A.x+d*e[D].x,y:(1-d)*A.y+d*e[D].y},--D):A=e[D];var y=A.x;var z=A.y;var g=0>=D&&!t,p=D===e.length-1;g||(n+=W);(d=p?I?e[1]:null:e[D+1])?(a.x=d.x-y,a.y=d.y-z,S=da(a),a.x/=S,a.y/=S):(a.x=void 0,a.y=void 0);if(!I){if(g){K(h,a);var u=h.x;var v=
h.y;2===E&&(c(-a.y-a.x,a.x-a.y,a.x,a.y,0,-1),c(a.y-a.x,-a.x-a.y,a.x,a.y,0,1));1===E&&(c(-a.y-a.x,a.x-a.y,a.x,a.y,-1,-1),c(a.y-a.x,-a.x-a.y,a.x,a.y,-1,1));if(1===E||0===E)c(-a.y,a.x,a.x,a.y,0,-1),c(a.y,-a.x,a.x,a.y,0,1);continue}if(p){N(h,b);u=h.x;v=h.y;if(1===E||0===E)c(b.y,-b.x,-b.x,-b.y,0,-1),c(-b.y,b.x,-b.x,-b.y,0,1);2===E&&(c(b.y-b.x,-b.x-b.y,-b.x,-b.y,0,-1),c(-b.y-b.x,b.x-b.y,-b.x,-b.y,0,1));1===E&&(c(b.y-b.x,-b.x-b.y,-b.x,-b.y,1,-1),c(-b.y-b.x,b.x-b.y,-b.x,-b.y,1,1));continue}}var m=void 0;
g=-(b.x*a.y-b.y*a.x);.01>Math.abs(g)?0<b.x*a.x+b.y*a.y?(h.x=b.x,h.y=b.y,g=1,m=Number.MAX_VALUE,d=!0):(K(h,a),m=g=1,d=!1):(h.x=(b.x+a.x)/g,h.y=(b.y+a.y)/g,m=da(h),d=(m-1)*R*B,d=4<m||d>W&&d>S);u=h.x;v=h.y;var k=Z;switch(Z){case 0:1.05>m&&(k=2);break;case 1:m<O&&(k=2);break;case 2:m>C&&(k=0)}switch(k){case 2:c(h.x,h.y,-b.x,-b.y,0,-1);c(-h.x,-h.y,-b.x,-b.y,0,1);if(p)break;L&&(d=t?0:n,q=this.writeVertex(y,z,u,v,a.x,a.y,h.x,h.y,0,-1,d),r=this.writeVertex(y,z,u,v,a.x,a.y,-h.x,-h.y,0,1,d));break;case 0:g=
0>g;var F=void 0;g?(k=q,q=r,r=k,F=aa,k=ba):(F=ba,k=aa);var G=void 0,M=void 0;d?(G=g?K(this.innerPrev,b):N(this.innerPrev,b),M=g?N(this.innerNext,a):K(this.innerNext,a)):G=M=g?ca(this.inner,h):ia(this.inner,h);m=g?N(this.bevelStart,b):K(this.bevelStart,b);c(G.x,G.y,-b.x,-b.y,F.x,F.y);G=c(m.x,m.y,-b.x,-b.y,k.x,k.y);if(p)break;p=g?K(this.bevelEnd,a):N(this.bevelEnd,a);d?(d=this.writeVertex(y,z,u,v,-b.x,-b.y,0,0,0,0,n),q=this.writeVertex(y,z,u,v,a.x,a.y,M.x,M.y,F.x,F.y,n),r=this.writeVertex(y,z,u,v,a.x,
a.y,p.x,p.y,k.x,k.y,n),this.writeTriangle(G,d,r)):(L?(d=this.bevelMiddle,d.x=(m.x+p.x)/2,d.y=(m.y+p.y)/2,V(x,d,-b.x,-b.y),c(d.x,d.y,-b.x,-b.y,x.x,x.y),V(x,d,a.x,a.y),q=this.writeVertex(y,z,u,v,a.x,a.y,d.x,d.y,x.x,x.y,n),r=this.writeVertex(y,z,u,v,a.x,a.y,M.x,M.y,F.x,F.y,n)):(d=q,q=r,r=d),c(p.x,p.y,a.x,a.y,k.x,k.y));g&&(d=q,q=r,r=d);break;case 1:{g=0>g;var J=void 0;g?(k=q,q=r,r=k,k=aa,J=ba):(k=ba,J=aa);var w=g?ca(this.inner,h):ia(this.inner,h);d?(M=g?K(this.innerPrev,b):N(this.innerPrev,b),F=g?N(this.innerNext,
a):K(this.innerNext,a)):F=M=w;G=g?N(this.roundStart,b):K(this.roundStart,b);var Y=g?K(this.roundEnd,a):N(this.roundEnd,a);M=c(M.x,M.y,-b.x,-b.y,k.x,k.y);G=c(G.x,G.y,-b.x,-b.y,J.x,J.y);if(p)break;p=this.writeVertex(y,z,u,v,-b.x,-b.y,0,0,0,0,n);d||this.writeTriangle(q,r,p);w=ca(this.outer,w);J=this.writeVertex(y,z,u,v,a.x,a.y,Y.x,Y.y,J.x,J.y,n);let P,Q;if(Y=2<m){var H=void 0;m!==Number.MAX_VALUE?(w.x/=m,w.y/=m,H=b.x*w.x+b.y*w.y,H=(m*(H*H-1)+1)/H):H=-1;P=g?N(this.startBreak,b):K(this.startBreak,b);P.x+=
b.x*H;P.y+=b.y*H;Q=g?K(this.endBreak,a):N(this.endBreak,a);Q.x+=a.x*H;Q.y+=a.y*H}V(x,w,-b.x,-b.y);m=this.writeVertex(y,z,u,v,-b.x,-b.y,w.x,w.y,x.x,x.y,n);V(x,w,a.x,a.y);w=L?this.writeVertex(y,z,u,v,a.x,a.y,w.x,w.y,x.x,x.y,n):m;H=p;const X=L?this.writeVertex(y,z,u,v,a.x,a.y,0,0,0,0,n):p;let T=-1,U=-1;Y&&(V(x,P,-b.x,-b.y),T=this.writeVertex(y,z,u,v,-b.x,-b.y,P.x,P.y,x.x,x.y,n),V(x,Q,a.x,a.y),U=this.writeVertex(y,z,u,v,a.x,a.y,Q.x,Q.y,x.x,x.y,n));L?Y?(this.writeTriangle(H,G,T),this.writeTriangle(H,T,
m),this.writeTriangle(X,w,U),this.writeTriangle(X,U,J)):(this.writeTriangle(H,G,m),this.writeTriangle(X,w,J)):Y?(this.writeTriangle(p,G,T),this.writeTriangle(p,T,U),this.writeTriangle(p,U,J)):(this.writeTriangle(p,G,m),this.writeTriangle(p,w,J));d?q=this.writeVertex(y,z,u,v,a.x,a.y,F.x,F.y,k.x,k.y,n):(q=L?this.writeVertex(y,z,u,v,a.x,a.y,F.x,F.y,k.x,k.y,n):M,this.writeTriangle(q,X,J));r=J;g&&(d=q,q=r,r=d)}}}}};return f}();fa.LineTessellation=ma;Object.defineProperty(fa,"__esModule",{value:!0})});