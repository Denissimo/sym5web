// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/programUtils ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(r,t,k,w,x,
y,z,A,B,u,l,m,v,n,p){return function(q){function h(){var a=q.apply(this,arguments)||this;a._color=t.fromValues(1,0,0,1);return a}r._inheritsLoose(h,q);var f=h.prototype;f.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};f.prepareState=function({context:a}){a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};f.draw=function(a,b){({context:a}=a);if(b.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
b.coordRange[0],b.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var d=this._getTexture(a,b);d&&(a.bindVAO(this._tileInfoVertexArrayObject),a.useProgram(this._tileInfoProgram),a.bindTexture(d,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",b.coordRange[0]/b.size[0],b.coordRange[1]/
b.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",d.descriptor.width,d.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};f._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var b=m.createProgram(a,n.background),d=m.createProgram(a,p.tileInfo),g={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},e=new Int8Array([0,0,1,0,1,1,0,1]);e=k.createVertex(a,35044,e);e=new l(a,
n.background.attributes,g,{geometry:e});var c=new Int8Array([0,0,1,0,0,1,1,1]);c=k.createVertex(a,35044,c);a=new l(a,p.tileInfo.attributes,g,{geometry:c});this._outlineProgram=b;this._tileInfoProgram=d;this._outlineVertexArrayObject=e;this._tileInfoVertexArrayObject=a}};f._getTexture=function(a,b){if(b.texture&&b.triangleCountReportedInDebug===b.triangleCount)return b.texture;b.triangleCountReportedInDebug=b.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id",
"canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const d=b.triangleCount;let g=b.key.id;0<b.triangleCount&&(g+=`, ${d}`);const e=this._canvas,c=e.getContext("2d");c.font="24px sans-serif";c.textAlign="left";c.textBaseline="top";c.clearRect(0,0,300,32);1E5<d?(c.fillStyle="red",c.fillRect(0,0,300,32),c.fillStyle="black"):(c.clearRect(0,0,300,32),c.fillStyle="blue");c.fillText(g,0,0);b.texture=new u(a,{target:3553,
pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},e);return b.texture};return h}(v)});