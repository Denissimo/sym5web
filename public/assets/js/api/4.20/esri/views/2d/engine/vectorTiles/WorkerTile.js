// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ./Placement ./TileParser ../../tiling/enums".split(" "),function(l,n,p,q,r,e){return function(){function m(g,a,c,b){this.status=e.TileStatus.INITIALIZED;this.placementEngine=new q.PlacementEngine;this.tileKey=g;this.refKeys=a;this._workerTileHandler=c;this._styleRepository=b}var f=m.prototype;f.release=function(){this.tileKey="";this.refKeys=null;this.status=e.TileStatus.INITIALIZED;this._workerTileHandler=
null};f.parse=function(){var g=l._asyncToGenerator(function*(a,c,b){const h=b&&b.signal;if(n.isSome(h)){const d=()=>{h.removeEventListener("abort",d);this.status=e.TileStatus.INVALID};h.addEventListener("abort",d)}try{var k=yield this._parse(a,b)}catch(d){if(p.isAbortError(d))throw d;return{result:[],transferList:[]}}this.status=e.TileStatus.READY;a=[];for(const d of k)k=d.serialize(),a.push(k);return{result:a,transferList:a.length<=c&&a}});return function(a,c,b){return g.apply(this,arguments)}}();
f.setObsolete=function(){this.status=e.TileStatus.INVALID};f.getLayers=function(){return this._workerTileHandler.getLayers()};f.getWorkerTileHandler=function(){return this._workerTileHandler};f._parse=function(){var g=l._asyncToGenerator(function*(a,c){const b=a.sourceName2DataAndRefKey;if(0===Object.keys(b).length)return[];this.status=e.TileStatus.MODIFIED;return(new r(b,this,c.client,this._styleRepository,a.styleLayerUIDs)).parse(c)});return function(a,c){return g.apply(this,arguments)}}();return m}()});