// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ./FeatureLayerView2D ../../layers/support/FeatureFilter".split(" "),function(k,l,m,n,g,t,u,v,w,p,q,r){g=function(e){function h(){return e.apply(this,arguments)||this}k._inheritsLoose(h,
e);var f=h.prototype;f.initialize=function(){this.handles.add([n.init(this.view,"viewpoint",()=>this._update())])};f._injectOverrides=function(b){b=e.prototype._injectOverrides.call(this,b);const d=this.view.scale;var c=this.layer.sublayers.filter(a=>!a.visible||0!==a.minScale&&d>a.minScale||0!==a.maxScale&&d<a.maxScale).map(a=>a.subtypeCode);if(!c.length)return b;c=`NOT ${this.layer.subtypeField} IN (${c.join(",")})`;if(m.isNone(b))return new r({where:c});b=b.clone();b.where+=` AND ${c}`;return b};
f._setLayersForFeature=function(b){var d=this.layer.fieldsIndex.get(this.layer.subtypeField);const c=b.attributes[d.name];d=this.layer.sublayers.find(a=>a.subtypeCode===c);b.layer=d;b.sourceLayer=this.layer};f._createSchemaConfig=function(){const b={subtypeField:this.layer.subtypeField,sublayers:Array.from(this.layer.sublayers).map(a=>({featureReduction:null,geometryType:this.layer.geometryType,labelingInfo:a.labelingInfo,labelsVisible:a.labelsVisible,renderer:a.renderer,subtypeCode:a.subtypeCode}))},
d=this.layer.sublayers.map(a=>a.subtypeCode).join(",");let c=this.layer.definitionExpression?this.layer.definitionExpression+" AND ":"";c+=this.layer.sublayers.length?`${this.layer.subtypeField} IN (${d})`:"1\x3d2";return{...e.prototype._createSchemaConfig.call(this),...b,definitionExpression:c}};return h}(q);return g=l.__decorate([p.subclass("esri.views.2d.layers.SubtypeGroupLayerView2D")],g)});