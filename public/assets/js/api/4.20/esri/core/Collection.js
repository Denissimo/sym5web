// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./scheduling ./accessorSupport/ensureType ./accessorSupport/tracking ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./accessorSupport/tracking/SimpleObservable".split(" "),function(z,A,x,K,L,E,M,N,F,f,G,H,O){function B(g){return g?g instanceof y?g.toArray():g.length?Array.prototype.slice.apply(g):[]:[]}function C(g){if(g&&g.length)return g[0]}function I(g,
m,c,a){m&&m.forEach((b,d,h)=>{g.push(b);I(g,c.call(a,b,d,h),c,a)})}var t;let P=function(){function g(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var m=g.prototype;m.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};m.reset=function(c){this.defaultPrevented=!1;this.item=c};return g}();const r=new M(P,void 0,g=>{g.item=null;g.target=null;g.defaultPrevented=!1;g.cancellable=!1}),Q=()=>{},u=new Set,v=new Set,w=new Set,D=new Map;let R=0,
y=t=function(g){function m(a){a=g.call(this,a)||this;a._chgListeners=[];a._notifications=null;a._timer=null;a._observable=new O.SimpleObservable;a.length=0;a._items=[];Object.defineProperty(z._assertThisInitialized(a),"uid",{value:R++});return a}z._inheritsLoose(m,g);m.isCollection=function(a){return null!=a&&a instanceof t};var c=m.prototype;c.normalizeCtorArgs=function(a){return a?Array.isArray(a)||a instanceof t?{items:a}:a:{}};c[Symbol.iterator]=function*(){yield*this.items};c.hasEventListener=
function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};c.on=function(a,b){if("change"===a){const d=this._chgListeners,h={removed:!1,callback:b};d.push(h);this._notifications&&this._notifications.push({listeners:d.slice(),items:this._items.slice(),changes:[]});return{remove(){this.remove=Q;h.removed=!0;d.splice(d.indexOf(h),1)}}}return this._emitter.on(a,b)};c.once=function(a,b){const d=this.on(a,b);return{remove(){d.remove()}}};c.add=function(a,b){f.trackAccess(this._observable);
if(this._emitBeforeChanges(1))return this;b=this.getNextIndex(null!=b?b:null);this._splice(b,0,a);this._emitAfterChanges(1);return this};c.addMany=function(a,b=this._items.length){f.trackAccess(this._observable);if(!a||!a.length||this._emitBeforeChanges(1))return this;b=this.getNextIndex(b);this._splice(b,0,...B(a));this._emitAfterChanges(1);return this};c.removeAll=function(){f.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(2))return[];const a=this._splice(0,this.length)||
[];this._emitAfterChanges(2);return a};c.clone=function(){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(L.clone)})};c.concat=function(...a){f.trackAccess(this._observable);a=a.map(B);return this._createNewInstance({items:this._items.concat(...a)})};c.drain=function(a,b){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var d=E.assumeNonNull(this._splice(0,this.length)),h=d.length;for(let p=0;p<h;p++)a.call(b,d[p],p,d);this._emitAfterChanges(2)}};
c.every=function(a,b){f.trackAccess(this._observable);return this._items.every(a,b)};c.filter=function(a,b){f.trackAccess(this._observable);let d;d=2===arguments.length?this._items.filter(a,b):this._items.filter(a);return this._createNewInstance({items:d})};c.find=function(a,b){f.trackAccess(this._observable);return this._items.find(a,b)};c.findIndex=function(a,b){f.trackAccess(this._observable);return this._items.findIndex(a,b)};c.flatten=function(a,b){f.trackAccess(this._observable);const d=[];
I(d,this,a,b);return new t(d)};c.forEach=function(a,b){f.trackAccess(this._observable);return this._items.forEach(a,b)};c.getItemAt=function(a){f.trackAccess(this._observable);return this._items[a]};c.getNextIndex=function(a){f.trackAccess(this._observable);const b=this.length;a=null==a?b:a;0>a?a=0:a>b&&(a=b);return a};c.includes=function(a,b=0){f.trackAccess(this._observable);return this._items.includes(a,b)};c.indexOf=function(a,b=0){f.trackAccess(this._observable);return this._items.indexOf(a,
b)};c.join=function(a=","){f.trackAccess(this._observable);return this._items.join(a)};c.lastIndexOf=function(a,b=this.length-1){f.trackAccess(this._observable);return this._items.lastIndexOf(a,b)};c.map=function(a,b){f.trackAccess(this._observable);a=this._items.map(a,b);return new t({items:a})};c.reorder=function(a,b=this.length-1){f.trackAccess(this._observable);const d=this.indexOf(a);if(-1!==d){0>b?b=0:b>=this.length&&(b=this.length-1);if(d!==b){if(this._emitBeforeChanges(4))return a;this._splice(d,
1);this._splice(b,0,a);this._emitAfterChanges(4)}return a}};c.pop=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var a=C(this._splice(this.length-1,1));this._emitAfterChanges(2);return a}};c.push=function(...a){f.trackAccess(this._observable);if(this._emitBeforeChanges(1))return this.length;this._splice(this.length,0,...a);this._emitAfterChanges(1);return this.length};c.reduce=function(a,b){f.trackAccess(this._observable);const d=this._items;return 2===arguments.length?
d.reduce(a,b):d.reduce(a)};c.reduceRight=function(a,b){f.trackAccess(this._observable);const d=this._items;return 2===arguments.length?d.reduceRight(a,b):d.reduceRight(a)};c.remove=function(a){f.trackAccess(this._observable);return this.removeAt(this.indexOf(a))};c.removeAt=function(a){f.trackAccess(this._observable);if(!(0>a||a>=this.length||this._emitBeforeChanges(2)))return a=C(this._splice(a,1)),this._emitAfterChanges(2),a};c.removeMany=function(a){f.trackAccess(this._observable);if(!a||!a.length||
this._emitBeforeChanges(2))return[];a=a instanceof t?a.toArray():a;const b=this._items,d=[],h=a.length;for(let k=0;k<h;k++){var p=b.indexOf(a[k]);if(-1<p){{var n=k+1;var l=p+1;const q=Math.min(a.length-n,b.length-l);let e=0;for(;e<q&&a[n+e]===b[l+e];)e++;n=e}n=1+n;(p=this._splice(p,n))&&0<p.length&&d.push.apply(d,p);k+=n-1}}this._emitAfterChanges(2);return d};c.reverse=function(){f.trackAccess(this._observable);if(this._emitBeforeChanges(4))return this;const a=this._splice(0,this.length);a&&(a.reverse(),
this._splice(0,0,...a));this._emitAfterChanges(4);return this};c.shift=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var a=C(this._splice(0,1));this._emitAfterChanges(2);return a}};c.slice=function(a=0,b=this.length){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(a,b)})};c.some=function(a,b){f.trackAccess(this._observable);return this._items.some(a,b)};c.sort=function(a){f.trackAccess(this._observable);if(!this.length||
this._emitBeforeChanges(4))return this;const b=E.assumeNonNull(this._splice(0,this.length));arguments.length?b.sort(a):b.sort();this._splice(0,0,...b);this._emitAfterChanges(4);return this};c.splice=function(a,b,...d){f.trackAccess(this._observable);const h=(b?2:0)|(d.length?1:0);if(this._emitBeforeChanges(h))return[];a=this._splice(a,b,...d)||[];this._emitAfterChanges(h);return a};c.toArray=function(){f.trackAccess(this._observable);return this._items.slice()};c.toJSON=function(){f.trackAccess(this._observable);
return this.toArray()};c.toLocaleString=function(){f.trackAccess(this._observable);return this._items.toLocaleString()};c.toString=function(){f.trackAccess(this._observable);return this._items.toString()};c.unshift=function(...a){f.trackAccess(this._observable);if(!a.length||this._emitBeforeChanges(1))return this.length;this._splice(0,0,...a);this._emitAfterChanges(1);return this.length};c._createNewInstance=function(a){return new this.constructor(a)};c._splice=function(a,b,...d){const h=this._items;
var p=this.constructor.prototype.itemType;let n=void 0;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=N.schedule(()=>this._dispatchChange()));if(b){n=h.splice(a,b);if(this.hasEventListener("before-remove")){var l=r.acquire();l.target=this;l.cancellable=!0;for(let e=0,J=n.length;e<J;e++)b=n[e],l.reset(b),this.emit("before-remove",l),l.defaultPrevented&&
(n.splice(e,1),h.splice(a,0,b),a+=1,--e,--J);r.release(l)}this.length=this._items.length;if(this.hasEventListener("after-remove")){b=r.acquire();b.target=this;b.cancellable=!1;l=n.length;for(let e=0;e<l;e++)b.reset(n[e]),this.emit("after-remove",b);r.release(b)}}if(d&&d.length){if(p){b=[];for(var k of d)d=p.ensureType(k),null==d&&null!=k||b.push(d);d=b}p=this.hasEventListener("before-add");k=this.hasEventListener("after-add");b=a===this.length;if(p||k){var q=r.acquire();q.target=this;q.cancellable=
!0;l=r.acquire();l.target=this;l.cancellable=!1;for(const e of d)p?(q.reset(e),this.emit("before-add",q),q.defaultPrevented||(b?h.push(e):h.splice(a++,0,e),this._set("length",h.length),k&&(l.reset(e),this.emit("after-add",l)))):(b?h.push(e):h.splice(a++,0,e),this._set("length",h.length),l.reset(e),this.emit("after-add",l));r.release(l);r.release(q)}else{if(b)for(q of d)h.push(q);else h.splice(a,0,...d);this._set("length",h.length)}}(d&&d.length||n&&n.length)&&this._notifyChangeEvent(d,n);return n};
c._emitBeforeChanges=function(a){let b=!1;if(this.hasEventListener("before-changes")){const d=r.acquire();d.target=this;d.cancellable=!0;d.type=a;this.emit("before-changes",d);b=d.defaultPrevented;r.release(d)}return b};c._emitAfterChanges=function(a){if(this.hasEventListener("after-changes")){const b=r.acquire();b.target=this;b.cancellable=!1;b.type=a;this.emit("after-changes",b);r.release(b)}this._observable.notify()};c._notifyChangeEvent=function(a,b){this.hasEventListener("change")&&this._notifications&&
this._notifications[this._notifications.length-1].changes.push({added:a,removed:b})};c._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(const b of a){a=b.changes;u.clear();v.clear();w.clear();for(const {added:k,removed:q}of a){if(k)if(0===w.size&&0===v.size)for(const e of k)u.add(e);else for(const e of k)v.has(e)?(w.add(e),v.delete(e)):w.has(e)||u.add(e);if(q)if(0===w.size&&0===u.size)for(const e of q)v.add(e);
else for(const e of q)u.has(e)?u.delete(e):(w.delete(e),v.add(e))}const d=x.acquire();u.forEach(k=>{d.push(k)});const h=x.acquire();v.forEach(k=>{h.push(k)});const p=this._items,n=b.items,l=x.acquire();w.forEach(k=>{n.indexOf(k)!==p.indexOf(k)&&l.push(k)});if(b.listeners&&(d.length||h.length||l.length)){a={target:this,added:d,removed:h,moved:l};const k=b.listeners.length;for(let q=0;q<k;q++){const e=b.listeners[q];e.removed||e.callback.call(this,a)}}x.release(d);x.release(h);x.release(l)}u.clear();
v.clear();w.clear()}};z._createClass(m,[{key:"items",get:function(){f.trackAccess(this._observable);return this._items},set:function(a){this._emitBeforeChanges(1)||(this._splice(0,this.length,...B(a)),this._emitAfterChanges(1))}}]);return m}(K.EventedAccessor);y.ofType=g=>{if(!g)return t;if(D.has(g))return D.get(g);var m=null;if("function"===typeof g)m=g.prototype.declaredClass;else if(g.base)m=g.base.prototype.declaredClass;else for(var c in g.typeMap){const a=g.typeMap[c].prototype.declaredClass;
m=m?m+` | ${a}`:a}c=function(a){function b(){return a.apply(this,arguments)||this}z._inheritsLoose(b,a);return b}(t);c=A.__decorate([H.subclass(`esri.core.Collection<${m}>`)],c);m={Type:g,ensureType:"function"===typeof g?F.ensureType(g):F.ensureOneOfType(g)};Object.defineProperty(c.prototype,"itemType",{value:m});D.set(g,c);return c};A.__decorate([G.property()],y.prototype,"length",void 0);A.__decorate([G.property()],y.prototype,"items",null);return y=t=A.__decorate([H.subclass("esri.core.Collection")],
y)});