// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../arrayUtils ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(m,u,v,w,p,k,q){function x(a,g,b,d,e){var f,c;const h={};null==(f=g.write)?void 0:null==(c=f.writer)?void 0:c.call(a,d,h,b,e);return h}function r(a,g,b,d,e,f){if(!d||!d.write)return!1;var c=a.get(b);if(!e&&d.write.overridePolicy){var h=d.write.overridePolicy.call(a,c,b,f);void 0!==h&&(e=h)}e||(e=d.write);if(!e||!1===e.enabled)return!1;if((null===c&&!e.allowNull||void 0===
c)&&e.isRequired)return(g=new v("web-document-write:property-required",`Missing value for required property '${b}' on '${a.declaredClass}'`,{propertyName:b,target:a}),f)&&f.messages?f.messages.push(g):g&&!f&&y.error(g.name,g.message),!1;if(void 0===c||null===c&&!e.allowNull)return!1;h=d.default;void 0===h?c=!1:null!=d.defaultEquals?c=d.defaultEquals(c):"function"===typeof h?Array.isArray(c)?(a=h.call(a,b,f),c=u.equals(a,c)):c=!1:c=h===c;return c?!1:void 0!==d.default?!0:!e.ignoreOrigin&&f&&f.origin&&
g.store.originOf(b)<p.nameToId(f.origin)?!1:!0}function t(a,g,b){if(a&&"function"===typeof a.toJSON&&(!a.toJSON.isDefaultToJSON||!a.write))return k.merge(g,a.toJSON());const d=k.getProperties(a),e=d.metadatas;for(const h in e){const l=q.originSpecificWritePropertyDefinition(e[h],b);if(!r(a,d,h,l,void 0,b))continue;const z=a.get(h),n=x(a,l,l.write&&"string"===typeof l.write.target?l.write.target:h,z,b);if(0<Object.keys(n).length){var f,c;g=k.merge(g,n);null!=b&&null!=(f=b.resources)&&null!=(c=f.pendingOperations)&&
c.length&&Promise.all(b.resources.pendingOperations).then(()=>k.merge(g,n));b&&b.writtenProperties&&b.writtenProperties.push({target:a,propName:h,oldOrigin:p.idToReadableName(d.store.originOf(h)),newOrigin:b.origin})}}return g}const y=w.getLogger("esri.core.accessorSupport.write");m.default=t;m.willPropertyWrite=function(a,g,b,d){const e=k.getProperties(a),f=q.originSpecificWritePropertyDefinition(e.metadatas[g],d);return f?r(a,e,g,f,b,d):!1};m.write=t;Object.defineProperty(m,"__esModule",{value:!0})});