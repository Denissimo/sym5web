// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","./tracking","./tracking/ObservationHandle"],function(g,e,l){let m=function(){function h(a,b,c){this.properties=a;this.propertyName=b;this.metadata=c;this._handles=this._accessed=this._observers=null;this.flags=1|(c.nonNullable?8:0)|(c.hasOwnProperty("value")?16:0)|(void 0===c.get?32:0)|(void 0===c.dependsOn?64:0)}var d=h.prototype;d.destroy=function(){this._observers=this._accessed=null;this._clearObservationHandles()};d.getComputed=function(){e.trackAccess(this);var a=this.properties.store;
const b=this.propertyName;var c=this.flags;const k=a.get(b);if(c&4||~c&1&&a.has(b))return k;this.flags|=4;const f=this.properties.host;c&64?c=e.runTracked(this,this.metadata.get,f):(e.trackExplicitDependencies(f,this),c=this.metadata.get.call(f));a.set(b,c,1);a=a.get(b);a===k?this.flags&=-2:this.commit();this.flags&=-5;return a};d.onObservableAccessed=function(a){a!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(a)||this._accessed.push(a))};d.onTrackingEnd=function(){this._clearObservationHandles();
this.flags|=32;const a=this._accessed;if(null!==a){var b=this._handles;null===b&&(b=this._handles=[]);for(let c=0;c<a.length;++c)b.push(a[c].observe(this));a.length=0}};d.observe=function(a){null===this._observers&&(this._observers=[]);this._observers.includes(a)||this._observers.push(a);return new l.ObservationHandle(this._observers,a)};d.notifyChange=function(){this.onInvalidated();this.onCommitted()};d.invalidate=function(){this.onInvalidated()};d.onInvalidated=function(){~this.flags&2&&(this.flags|=
1);const a=this._observers;if(null!==a)for(let b=0;b<a.length;++b)a[b].onInvalidated()};d.commit=function(){this.flags&=-2;this.onCommitted()};d.onCommitted=function(){if(null!==this._observers){var a=this._observers.slice();for(let b=0;b<a.length;++b)a[b].onCommitted()}};d._clearObservationHandles=function(){const a=this._handles;if(null!==a){for(let b=0;b<a.length;++b)a[b].remove();a.length=0}};return h}();g.Property=m;Object.defineProperty(g,"__esModule",{value:!0})});