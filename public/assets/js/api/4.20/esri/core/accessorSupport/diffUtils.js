// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../Accessor","../Collection","../maybe","./utils"],function(g,t,u,p,y){function v(a){return a instanceof u?Object.keys(a.items):a instanceof t?y.getProperties(a).keys():a?Object.keys(a):[]}function q(a,b){return a instanceof u?a.items[b]:a[b]}function z(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function h(a){return a?a.declaredClass:null}function w(a,b){const e=a.diff;if(e&&"function"===typeof e)return e(a,b);const k=v(a),l=v(b);if(0!==k.length||0!==
l.length){if(!k.length||!l.length||z(a,b))return{type:"complete",oldValue:a,newValue:b};var m=l.filter(d=>-1===k.indexOf(d)),c=k.filter(d=>-1===l.indexOf(d));c=k.filter(d=>-1<l.indexOf(d)&&q(a,d)!==q(b,d)).concat(m,c).sort();if((m=h(a))&&-1<A.indexOf(m)&&c.length)return{type:"complete",oldValue:a,newValue:b};var r;m=a instanceof t&&b instanceof t;for(const d of c){c=q(a,d);const f=q(b,d);!(m||"function"!==typeof c&&"function"!==typeof f)||c===f||null==c&&null==f||(c=e&&e[d]&&"function"===typeof e[d]?
e[d](c,f):"object"===typeof c&&"object"===typeof f&&h(c)===h(f)?w(c,f):{type:"complete",oldValue:c,newValue:f},p.isSome(c)&&(p.isSome(r)?r.diff[d]=c:r={type:"partial",diff:{[d]:c}}))}return r}}function x(a,b){if(p.isNone(a))return!1;b=b.split(".");for(const e of b){if("complete"===a.type)break;if("partial"===a.type){if(a=a.diff[e],!a)return!1}else return!1}return!0}function n(a){if(p.isNone(a))return!0;switch(a.type){case "complete":return!1;case "collection":for(const b of a.added)if(!n(b))return!1;
for(const b of a.removed)if(!n(b))return!1;for(const b of a.changed)if(!n(b))return!1;return!0;case "partial":for(const b in a.diff)if(!n(a.diff[b]))return!1;return!0}}const A=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];g.diff=function(a,b){if("function"!==typeof a&&"function"!==typeof b&&(a||b))return!a||!b||"object"===typeof a&&"object"===typeof b&&h(a)!==h(b)?{type:"complete",oldValue:a,newValue:b}:w(a,b)};
g.hasDiff=x;g.hasDiffAny=function(a,b){for(const e of b)if(x(a,e))return!0;return!1};g.isEmpty=n;Object.defineProperty(g,"__esModule",{value:!0})});