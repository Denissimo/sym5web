// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../renderers/PointCloudClassBreaksRenderer ../../renderers/PointCloudRenderer ../../renderers/PointCloudRGBRenderer ../../renderers/PointCloudStretchRenderer ../../renderers/PointCloudUniqueValueRenderer ../../renderers/ClassBreaksRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/HeatmapRenderer ../../renderers/Renderer ../../renderers/SimpleRenderer ../../renderers/UniqueValueRenderer ../../renderers/support/jsonUtils ../../core/Error ../../core/lang ../../core/maybe ../../intl/messages ../../renderers/support/LegendOptions ../../renderers/support/utils ../heuristics/outline ../heuristics/sizeRange ./support/utils ../statistics/uniqueValues ../support/utils ../support/adapters/support/layerUtils ../../chunks/type".split(" "),
function(A,p,ha,ia,ja,ka,U,la,ma,na,oa,pa,qa,V,ra,n,N,w,W,X,B,Y,Z,g,O,P,x,C){function aa(a){return D.apply(this,arguments)}function D(){D=p._asyncToGenerator(function*(a){if(!a||!a.layer||!a.field&&!a.valueExpression)throw new n("type-renderer:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");if(a.valueExpression&&!a.view)throw new n("type-renderer:missing-parameters","View is required when 'valueExpression' is specified");a={...a};a.symbolType=a.symbolType||
"2d";a.numTypes=null==a.numTypes?10:a.numTypes;a.defaultSymbolEnabled=null==a.defaultSymbolEnabled?!0:a.defaultSymbolEnabled;a.sortBy=null==a.sortBy?"count":a.sortBy;a.sortEnabled=null==a.sortEnabled?!0:a.sortEnabled;a.statistics=N.clone(a.statistics);var b=[0,2,1,3,5],c=x.createLayerAdapter(a.layer,b);a.layer=c;if(!c)throw new n("type-renderer:invalid-parameters","'layer' must be one of these types: "+x.getLayerTypeLabels(b).join(", "));b=w.isSome(a.signal)?{signal:a.signal}:null;yield c.load(b);
b=c.geometryType;a.outlineOptimizationEnabled="polygon"===b?a.outlineOptimizationEnabled:!1;a.sizeOptimizationEnabled="point"===b||"multipoint"===b||"polyline"===b?a.sizeOptimizationEnabled:!1;if("mesh"===b)a.symbolType="3d-volumetric",a.colorMixMode=a.colorMixMode||"replace",a.edgesType=a.edgesType||"none";else{if("3d-volumetric-uniform"===a.symbolType&&"point"!==b)throw new n("type-renderer:not-supported","3d-volumetric-uniform symbols are supported for point layers only");if(-1<a.symbolType.indexOf("3d-volumetric")&&
(!a.view||"3d"!==a.view.type))throw new n("type-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or '3d-volumetric-uniform'");}b=yield P.getFieldsList({field:a.field,valueExpression:a.valueExpression});if(c=g.verifyBasicFieldValidity(c,b,"type-renderer:invalid-parameters"))throw c;return a});return D.apply(this,arguments)}function ba(a){return E.apply(this,arguments)}function E(){E=p._asyncToGenerator(function*(a){if(!(a&&
a.layer&&a.field))throw new n("type-point-cloud-class-renderer:missing-parameters","'layer' and 'field' parameters are required");a={...a};a.statistics=N.clone(a.statistics);var b=[4],c=x.createLayerAdapter(a.layer,b);a.layer=c;a.density=a.density||25;a.size=a.size||"100%";if(!g.isValidPointSize(a.size))throw new n("type-point-cloud-class-renderer:invalid-parameters","Invalid 'size' parameter. It should be a string of the form '100%'");if(!c)throw new n("type-point-cloud-class-renderer:invalid-parameters",
"'layer' must be one of these types: "+x.getLayerTypeLabels(b).join(", "));b=w.isSome(a.signal)?{signal:a.signal}:null;yield c.load(b);b=yield P.getFieldsList({field:a.field});if(c=g.verifyBasicFieldValidity(c,b,"type-point-cloud-class-renderer:invalid-parameters"))throw c;return a});return E.apply(this,arguments)}function Q(a){return F.apply(this,arguments)}function F(){F=p._asyncToGenerator(function*(a){let b=a.typeScheme,c=null;var d=null;d=yield g.getBasemapInfo(a.basemap,a.view);c=w.isSome(d.basemapId)?
d.basemapId:null;d=w.isSome(d.basemapTheme)?d.basemapTheme:null;if(b)return{scheme:C.cloneScheme(b),basemapId:c,basemapTheme:d};if(a=C.getSchemes({basemap:c,basemapTheme:d,geometryType:a.geometryType,theme:a.theme,worldScale:a.worldScale,view:a.view}))b=a.primaryScheme,c=a.basemapId,d=a.basemapTheme;return{scheme:b,basemapId:c,basemapTheme:d}});return F.apply(this,arguments)}function R(a,b){return a.label<b.label?-1:a.label>b.label?1:0}function S(a,b){return a.value<b.value?-1:a.value>b.value?1:0}
function ca(a,b){let c=b.count-a.count;0===c&&(c=R(a,b));return c}function da(a,b){let c=b.count-a.count;0===c&&(c=S(a,b));return c}function T(a,b,c){let d;"count"===b?(d=da,c&&c.codedValues&&(d=ca)):"value"===b&&(d=S,c&&c.codedValues&&(d=R));d&&a.sort(d)}function ea(a,b,c,d){return G.apply(this,arguments)}function G(){G=p._asyncToGenerator(function*(a,b,c,d){var l=yield W.fetchMessageBundle("esri/smartMapping/t9n/smartMapping");a=a.uniqueValueInfos;var k=b.layer,e=b.field,f=e?k.getField(e):null,
t=f?k.getFieldDomain(f.name):null;const H=-1===b.numTypes?a.length:b.numTypes,q=k.geometryType;k=yield Q({basemap:b.basemap,geometryType:q,typeScheme:b.typeScheme,worldScale:-1<b.symbolType.indexOf("3d-volumetric"),view:b.view});const r=k.scheme;e=new V({field:e});let I=-1;var m;const u={value:null,domain:t,fieldInfo:f};a.forEach((h,v)=>{u.value=h.value;h.label=B.createUniqueValueLabel(u);null===h.value&&(I=v)});-1<I&&(m=a.splice(I,1)[0]);!1!==b.sortEnabled&&T(a,b.sortBy,t);f&&"date"===f.type&&(f=
a.filter((h,v)=>v<H).map(h=>h.value),u.dateFormatInterval=B.calculateDateFormatInterval(f));f=c&&c.opacity;let J=g.createColors(r.colors,a.length);const y=g.getSymbolSizeFromScheme(r,q),z=g.getSymbolOutlineFromScheme(r,q,f);a.forEach((h,v)=>{u.value=h.value;h.label=B.createUniqueValueLabel(u);h.symbol=g.createSymbol(q,{type:b.symbolType,color:J[v],size:y,outline:z,meshInfo:{colorMixMode:b.colorMixMode,edgesType:b.edgesType}})});b.valueExpression&&(e.valueExpression=b.valueExpression,e.valueExpressionTitle=
b.valueExpressionTitle);b.legendOptions&&(e.legendOptions=new X.LegendOptions(b.legendOptions));J=g.createColors(r.colors,H);for(f=0;f<H;f++)(t=a[f])&&e.addUniqueValueInfo({value:t.value,label:t.label,symbol:g.createSymbol(q,{type:b.symbolType,color:J[f],size:y,outline:z,meshInfo:{colorMixMode:b.colorMixMode,edgesType:b.edgesType}})});b.defaultSymbolEnabled&&(e.defaultSymbol=g.createSymbol(q,{type:b.symbolType,color:r.noDataColor,size:y,outline:z,meshInfo:{colorMixMode:b.colorMixMode,edgesType:b.edgesType}}),
e.defaultLabel=l.other);m&&(m.symbol=g.createSymbol(q,{type:b.symbolType,color:r.noDataColor,size:y,outline:z,meshInfo:{colorMixMode:b.colorMixMode,edgesType:b.edgesType}}),a.push(m));l=[];m=e.uniqueValueInfos.length===a.length?-1:e.uniqueValueInfos.length;if(-1<m)for(;m<a.length;m++)l.push({...a[m]});c&&c.visualVariables&&c.visualVariables.length&&(e.visualVariables=c.visualVariables.map(h=>h.clone()));d&&d.minSize&&(e.visualVariables?e.visualVariables.push(d.minSize):e.visualVariables=[d.minSize]);
return{renderer:e,uniqueValueInfos:a,excludedUniqueValueInfos:l,typeScheme:C.cloneScheme(r),basemapId:k.basemapId,basemapTheme:k.basemapTheme}});return G.apply(this,arguments)}function fa(a,b){return K.apply(this,arguments)}function K(){K=p._asyncToGenerator(function*(a,b){a=a.uniqueValueInfos;b=(b=yield Q({basemap:"gray",theme:"point-cloud-class",geometryType:"point",typeScheme:b}))&&b.scheme;const c="point-cloud-class"===b.theme,d=c?b.colors:g.createColors(b.colors,a.length);T(a,"value");return a.map((l,
k)=>{const e=l.value;let f=null;c?(f=d[e])||(f=d[d.length-1]):f=d[k];return{values:[e],color:f,label:l.label}})});return K.apply(this,arguments)}function L(){L=p._asyncToGenerator(function*(a){a=yield aa(a);const {layer:b,view:c,signal:d}=a,l={layer:b,field:a.field,valueExpression:a.valueExpression,returnAllCodedValues:a.returnAllCodedValues,view:c,signal:d},[k,e,f]=yield Promise.all([null!=a.statistics?a.statistics:O(l),a.outlineOptimizationEnabled?Y({layer:b,view:c,signal:d}):null,a.sizeOptimizationEnabled?
Z({layer:b,view:c,signal:d}):null]);return ea(k,a,e,f)});return L.apply(this,arguments)}function M(){M=p._asyncToGenerator(function*(a){a=yield ba(a);const b=null!=a.statistics?a.statistics:yield O({layer:a.layer,field:a.field,signal:a.signal});return{renderer:new U({field:a.field,pointsPerInch:a.density,pointSizeAlgorithm:g.getPointSizeAlgorithm(a.size),colorUniqueValueInfos:yield fa(b,a.typeScheme)})}});return M.apply(this,arguments)}A.createPCClassRenderer=function(a){return M.apply(this,arguments)};
A.createRenderer=function(a){return L.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0})});