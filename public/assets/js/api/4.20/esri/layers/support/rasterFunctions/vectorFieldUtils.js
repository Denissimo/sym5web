// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/maybe","../PixelBlock"],function(p,x,r){function y(a,b="geographic"){const [c,e]=a;a=Math.sqrt(c*c+e*e);let d=Math.atan2(e,c)*t;d=(360+d)%360;"geographic"===b&&(d=(450-d)%360);return[a,d]}function z(a,b="geographic"){let c=a[1];"geographic"===b&&(c=(450-c)%360);c%=360;a=a[0];return[a*Math.cos(c/t),a*Math.sin(c/t)]}const t=180/Math.PI,u=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length},m=new Map;m.set("meter-per-second",
1);m.set("kilometer-per-hour",.277778);m.set("knots",.514444);m.set("feet-per-second",.3048);m.set("mile-per-hour",.44704);p.convertVectorFieldData=function(a,b,c="geographic",e=1){if(!u(a))return a;const {pixels:d,width:l,height:n}=a;var g=l*n;const h=d[0],q=d[1],k=r.createEmptyBand(a.pixelType,g);g=r.createEmptyBand(a.pixelType,g);let f=0;for(let v=0;v<n;v++)for(let w=0;w<l;w++)"vector-uv"===b?([k[f],g[f]]=y([h[f],q[f]],c),k[f]*=e):([k[f],g[f]]=z([h[f],q[f]],c),k[f]*=e,g[f]*=e),f++;a=new r({pixelType:a.pixelType,
width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:[k,g]});a.updateStatistics();return a};p.convertVectorFieldUnit=function(a,b,c=1){if(1===c||!u(a))return a;a=a.clone();const {pixels:e,width:d,height:l}=a,n=e[0],g=e[1];let h=0;for(let q=0;q<l;q++)for(let k=0;k<d;k++)"vector-uv"===b?(n[h]*=c,g[h]*=c):n[h]*=c,h++;a.updateStatistics();return a};p.getUnitConversionFactor=function(a,b){return m.get(a)/m.get(b)||1};p.isValidPixelBlock=u;p.snapImageToSymbolTile=
function(a,b,c,e,d){if(!x.isSome(d)||!d.spatialReference.equals(a.spatialReference))return{extent:a,width:b,height:c,resolution:a.width/b};const l=d.xmin;d=d.ymax;e=Math.max(e||0,30);b=((a.xmax-a.xmin)/Math.ceil(1/e*b)+(a.ymax-a.ymin)/Math.ceil(1/e*c))/2;a.xmin=l+Math.floor((a.xmin-l)/b)*b;a.xmax=l+Math.ceil((a.xmax-l)/b)*b;a.ymin=d+Math.floor((a.ymin-d)/b)*b;a.ymax=d+Math.ceil((a.ymax-d)/b)*b;return{extent:a,width:Math.round(a.width/b),height:Math.round(a.height/b),resolution:b}};Object.defineProperty(p,
"__esModule",{value:!0})});