// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils".split(" "),function(t,w,x,u,y,z,F,A,B){function C(d,f,c){return d?x(d,{responseType:"image"}).then(g=>{g=g.data;const m=g.width,a=g.height,l=m/a;let h=f;c&&(h=Math.min(h,Math.max(m,a)));return{image:g,width:1>=l?Math.ceil(h*l):h,height:1>=l?h:Math.ceil(h/l)}}):Promise.reject(new y("renderUtils: imageDataSize","href not provided."))}
const D=A.createProjector();t.renderSymbol=function(d,f,c){const g=Math.ceil(f[0]);f=Math.ceil(f[1]);if(!d.some(a=>!!a.length))return null;const m=c&&c.node||document.createElement("div");null!=c.opacity&&(m.style.opacity=c.opacity.toString());D.append(m,B.renderSVG.bind(null,d,g,f,c));return m};t.tintImageWithColor=function(d,f,c,g,m){return C(d,f,m).then(a=>{const l=a.width?a.width:f,h=a.height?a.height:f;var e;if(e=a.image)e=c&&"ignore"!==g?"multiply"===g&&255===c.r&&255===c.g&&255===c.b&&1===
c.a?!1:!0:!1;if(e){var b=a.image.width,n=a.image.height;z("edge")&&/\.svg$/i.test(d)&&(--b,--n);e=Math.ceil(l);var p=Math.ceil(h);var k=document.createElement("canvas");k.width=e;k.height=p;k.style.width=e+"px";k.style.height=p+"px";k=k.getContext("2d");k.clearRect(0,0,e,p);e=k;e.drawImage(a.image,0,0,b,n,0,0,l,h);p=e.getImageData(0,0,l,h);k=[c.r/255,c.g/255,c.b/255,c.a];const E=u.toHSV(c);for(let v=0;v<p.data.length;v+=4){a=p.data;b=v;n=k;var q=E;switch(g){case "multiply":a[b+0]*=n[0];a[b+1]*=n[1];
a[b+2]*=n[2];a[b+3]*=n[3];break;default:{const r=u.toHSV({r:a[b+0],g:a[b+1],b:a[b+2]});r.h=q.h;r.s=q.s;r.v=r.v/100*q.v;q=u.toRGB(r);a[b+0]=q.r;a[b+1]=q.g;a[b+2]=q.b;a[b+3]*=n[3]}}}e.putImageData(p,0,0);d=e.canvas.toDataURL("image/png")}else(e=w.id&&w.id.findCredential(d))&&e.token&&(a=-1===d.indexOf("?")?"?":"\x26",d=`${d}${a}token=${e.token}`);return{url:d,width:l,height:h}}).catch(function(){return{url:d,width:f,height:f}})};Object.defineProperty(t,"__esModule",{value:!0})});