// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(d,r,e,t){function h(a){if(a){var b=a.length;for(--b;0<b;--b)a[b][0]-=a[b-1][0],a[b][1]-=a[b-1][1]}}function k(a){if(a)for(const b of a)h(b)}function l(a){if(a){const b=a.length;for(let c=1;c<b;++c)a[c][0]+=a[c-1][0],a[c][1]+=a[c-1][1]}}function m(a){if(a)for(const b of a)l(b)}function n(a){a&&(e.isPolygon(a)?m(a.rings):e.isPolyline(a)?m(a.paths):e.isMultipoint(a)&&l(a.points))}function p(a){a&&a.reverse()}
function q(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}let u=function(){function a(b,c,f,g){this.acceptPolygon=c;this.acceptPolyline=f;this.geomUnitsPerPoint=g;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;b&&(e.isPolygon(b)?c&&(this.multiPath=b.rings,this.isClosed=!0):e.isPolyline(b)?f&&(this.multiPath=b.paths,this.isClosed=!1):e.isExtent(b)&&c&&(this.multiPath=q(b).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));
this.internalPlacement=new t.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const b=this.processPath(this.multiPath[this.pathIndex]);if(b)return b}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}(),v=function(){function a(b,c,f,g){this.inputGeometries=b;this.acceptPolygon=c;this.acceptPolyline=f;this.geomUnitsPerPoint=g;this.pathIndex=this.pathCount=-1;this.iteratePath=
!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var b=this.inputGeometries.next();b;)if(e.isPolygon(b)?this.acceptPolygon&&(this.multiPath=b.rings,this.isClosed=!0):e.isPolyline(b)?this.acceptPolyline&&(this.multiPath=b.paths,this.isClosed=!1):e.isExtent(b)&&this.acceptPolygon&&(this.multiPath=q(b).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else b=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||
this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,b=this.processPath(this.multiPath[this.pathIndex]))return b;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();d.PathGeometryCursor=v;d.PathTransformationCursor=u;d.cloneAndDecodeGeometry=function(a){a=r.clone(a);n(a);return a};d.deltaDecodeGeometry=n;d.deltaEncodeGeometry=function(a){a&&(e.isPolygon(a)?k(a.rings):e.isPolyline(a)?k(a.paths):e.isMultipoint(a)&&h(a.points))};d.getCoord2D=function(a,b,c){return[a[0]+
(b[0]-a[0])*c,a[1]+(b[1]-a[1])*c]};d.getId=function(a){return a[4]};d.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};d.reverseMultipath=function(a){if(a)for(const b of a)p(b)};d.reversePath=p;d.setId=function(a,b){a[4]=b};Object.defineProperty(d,"__esModule",{value:!0})});