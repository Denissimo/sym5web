// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(p,q,n,r){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(h,b,a){return new w(h,b,a)};return g}();t.instance=null;let w=function(){function g(b,a,d){this._inputGeometries=b;this._height=(void 0!==a.amplitude?a.amplitude:2)*d;this._period=(void 0!==a.period?a.period:3)*d;this._style=a.waveform;0>=this._height&&
(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new r.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new r.GeometryWalker;this._walker.updateTolerance(d)}var h=g.prototype;h.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(q.isPolyline(b)){const a=this._processGeom(b.paths);if(a.length)return{paths:a}}if(q.isPolygon(b)&&(b=this._processGeom(b.rings),
b.length))return{rings:b};b=this._inputGeometries.next()}return null};h._processGeom=function(b){const a=[];for(const d of b)if(this._walker.init(d,this._pattern))switch(this._style){default:a.push(this._constructCurve(d,!1));break;case "Square":a.push(this._constructSquare(d));break;case "Triangle":a.push(this._constructTriangle(d));break;case "Random":a.push(this._constructCurve(d,!0))}else a.push(d);return a};h._constructCurve=function(b,a){const d=new n.PathHelper;var e=this._walker.calculatePathLength(b),
c=Math.round(e/this._period);0===c&&(c=1);const f=this._period/16,x=1/(16*c+1);e=2*Math.PI*e/(e/c);c=2*Math.PI*Math.random();const y=2*Math.PI*Math.random(),z=2*Math.PI*Math.random(),A=.75-Math.random()/2,B=.75-Math.random()/2,k={};this._walker.curPointAndAngle(k);d.startPath(k.pt);let u=0;for(;;)if(this._walker.nextPointAndAngle(f,k)){const m=u;u+=x;let l;if(a){const v=this._height/2*(1+.3*Math.sin(A*e*m+c));l=v*Math.sin(e*m+y);l+=v*Math.sin(B*e*m+z);l/=2}else l=.5*this._height*Math.sin(.5*e*m);
d.lineTo([k.pt[0]-l*k.sa,k.pt[1]+l*k.ca])}else{d.lineTo(b[b.length-1]);break}return d.path()};h._constructSquare=function(b){const a=new n.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const e={};this._walker.curPointAndAngle(e);const c={};if(this._walker.nextPointAndAngle(this._period,c)){const f={};this._walker.nextPointAndAngle(this._period,f)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),a.lineTo([e.pt[0]-this._height/
2*e.sa,e.pt[1]+this._height/2*e.ca]),a.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),a.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca]),a.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca]),d=!0)}}if(!d){a.lineTo(this._walker.getPathEnd());break}}return a.path()};h._constructTriangle=function(b){const a=new n.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const e=
{};this._walker.curPointAndAngle(e);const c={};if(this._walker.nextPointAndAngle(this._period/2,c)){const f={};this._walker.nextPointAndAngle(this._period,f)&&(this._walker.nextPosition(this._period/2)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),a.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),a.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca])),d=!0)}}if(!d){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return g}();p.EffectWave=t;Object.defineProperty(p,
"__esModule",{value:!0})});