// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(l,p,m,n){let q=function(){function h(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var e=h.prototype;e.isEmpty=function(){return 0===this._values.length};e.size=function(){return this._values.length};e.init=function(c,a,b=!0){this._setEmpty();if(!c||0===c.length)return!1;for(let d=0;d<c.length;d++){let g=Math.abs(c[d]);b&&1E-7>g&&(g=1E-7);this._values.push(g);this._length+=
g}a&&c.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};e.scale=function(c){const a=this._values?this._values.length:0;for(let b=0;b<a;++b)this._values[b]*=c;this._length*=c;this.extPtGap*=c;this.ctrlPtGap*=c};e.addValue=function(c){this._length+=c;this._values.push(c)};e.firstValue=function(){return this._values[0]};e.lastValue=function(){return this._values[this._values.length-1]};e.nextValue=function(){this._currentValue++;
this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};e.reset=function(){this._currentValue=-1};e.length=function(){return this._length};e._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return h}(),k=function(){function h(){this.reset()}var e=h.prototype;e.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};e.isValid=function(){return-1!==
this.segment};e.copyTo=function(c){c.segment=this.segment;c.segmentLength=this.segmentLength;c.abscissa=this.abscissa;c.isPathEnd=this.isPathEnd;c.isPartEnd=this.isPartEnd};return h}(),t=function(h){function e(a=0,b=!1){a=h.call(this,a,b)||this;a._tolerance=n.PIXEL_TOLERANCE;a._currentPosition=new k;return a}p._inheritsLoose(e,h);var c=e.prototype;c.updateTolerance=function(a){this._tolerance=n.PIXEL_TOLERANCE*a};c.init=function(a,b,d=!0){d?(this._patternLength=b.length(),this._partExtPtGap=b.extPtGap,
this._partCtrlPtGap=b.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this.setPosAtNextPart()};c.curPositionIsValid=function(){return this._currentPosition.isValid()};c.nextPosition=function(a,b=0){const d=new k;if(!this._nextPosition(a,d,null,b))return!1;d.copyTo(this._currentPosition);return!0};c.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);const [b,d]=this._getAngle(this._currentPosition);
a.ca=b;a.sa=d};c.nextPointAndAngle=function(a,b,d=0){const g=new k;if(!this._nextPosition(a,g,null,d))return!1;g.copyTo(this._currentPosition);b.pt=this._getPoint(g);const [f,r]=this._getAngle(g);b.ca=f;b.sa=r;return!0};c.nextCurve=function(a){if(0===a)return null;const b=[],d=new k;if(!this._nextPosition(a,d,b,1))return null;d.copyTo(this._currentPosition);return b};c.isPathEnd=function(){return this._currentPosition.isPathEnd};c.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");
return this._path[this._currentPosition.segment+1]};c._nextPosition=function(a,b,d,g){if(this._currentPosition.isPathEnd)return!1;var f=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(f/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(b);b.abscissa+a*this._partLengthRatio>b.segmentLength+this._tolerance;)if(d&&(0===d.length&&(0===f?(f=this._path[b.segment],d.push([f[0],f[1]])):d.push(this.getSegCoord2D(this._path,b.segment,f))),f=this._path[b.segment+1],
d.push([f[0],f[1]])),f=0,a-=(b.segmentLength-b.abscissa)/this._partLengthRatio,this._partSegCount)b.segment=this.nextSegment(),b.segmentLength=this.calculateSegLength(this._path,b.segment),b.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===g)return!1;b.segmentLength=this.calculateSegLength(this._path,b.segment);b.isPartEnd=!0;1===g?(b.abscissa=b.segmentLength,b.isPathEnd=!0):b.abscissa=b.segmentLength+a;return!0}this._currentPosition.copyTo(b)}b.abscissa+=a*this._partLengthRatio;
d&&(0===d.length&&(0===f?(a=this._path[b.segment],d.push([a[0],a[1]])):d.push(this.getSegCoord2D(this._path,b.segment,f))),a=b.abscissa/b.segmentLength,1===a?(a=this._path[b.segment+1],d.push([a[0],a[1]])):d.push(this.getSegCoord2D(this._path,b.segment,a)));!this._partSegCount&&Math.abs(b.abscissa-b.segmentLength)<this._tolerance&&(b.isPathEnd=this._partIsLast,b.isPartEnd=!0);return!0};c._getPoint=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,
0>=a.segmentLength?0:a.abscissa/a.segmentLength)};c._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};c.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,
this.nextSegment()),this._partSegCount++,1===m.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var a=this._partSegCount;a;)this.previousSegment(),--a;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this.getStartPointIndex();this._ctrlPtBegin=
1===m.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===m.getId(this._path[a]);if(0<this._patternLength){a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const b=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let d=Math.round((this._partLength-(a+b))/this._patternLength);0>=d&&(d=0<a+b?0:1);this._partLengthRatio=this._partLength/(a+b+d*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=
1;return!0};c.hasNextSegment=function(){return this._seg<this._path.length-2};c.previousSegment=function(){return--this._seg};c.nextSegment=function(){return++this._seg};c.getStartPointIndex=function(){return this._seg};c.getEndPointIndex=function(){return this._seg+1};return e}(n.CurveHelper);l.DashPattern=q;l.GeometryWalker=t;Object.defineProperty(l,"__esModule",{value:!0})});