// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(p,r,n,m){let q=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(l,h,a){return new t(l,h,a)};return g}();q.instance=null;let t=function(g){function l(a,d,b){a=g.call(this,a,!1,!0)||this;a._curveHelper=new m.CurveHelper;a._width=(void 0!==d.width?d.width:5)*b;a._arrowType=void 0!==d.geometricEffectArrowType?d.geometricEffectArrowType:
"OpenEnded";a._offsetFlattenError=m.PIXEL_TOLERANCE*b;return a}r._inheritsLoose(l,g);var h=l.prototype;h.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};h._constructSimpleArrow=function(a,d){var b=this._curveHelper.calculatePathLength(a),e=this._width;b<2*e&&(e=b/2);b=this._curveHelper.getSubCurve(a,0,b-e);if(!b)return null;var f=e/2;if(this._curveHelper.isEmpty(b,
!1))return null;e=this._constructOffset(b,-f);if(!e)return null;b=this._constructOffset(b,f);if(!b)return null;const k=this._constructArrowBasePoint(e,-f/2);if(!k)return null;f=this._constructArrowBasePoint(b,f/2);if(!f)return null;a=a[a.length-1];d||(this._makeControlPoint(b,!0),this._makeControlPoint(e,!0));const c=new m.PathHelper;c.addPath(b,!0);c.lineTo(f);this._makeControlPoint(c.path());c.lineTo(a);this._makeControlPoint(c.path());c.lineTo(k);this._makeControlPoint(c.path());c.addPath(e,!1);
return d?{paths:[c.path()]}:(c.close(),{rings:[c.path()]})};h._constructCrossedArrow=function(a){var d=this._curveHelper.calculatePathLength(a),b=this._width;d<3.732050807568877*b&&(b=d/3.732050807568877);var e=this._curveHelper.getSubCurve(a,0,d-2.732050807568877*b);if(!e)return null;var f=b/2;if(this._curveHelper.isEmpty(e,!1))return null;const k=this._constructOffset(e,f);if(!k)return null;e=this._constructOffset(e,-f);if(!e)return null;d=this._curveHelper.getSubCurve(a,0,d-b);if(!d||this._curveHelper.isEmpty(d,
!1))return null;b=this._constructOffset(d,f);if(!b)return null;var c=this._constructOffset(d,-f);if(!c)return null;d=b[b.length-1];b=this._constructArrowBasePoint(b,f/2);if(!b)return null;const u=c[c.length-1];f=this._constructArrowBasePoint(c,-f/2);if(!f)return null;a=a[a.length-1];this._makeControlPoint(k,!1);this._makeControlPoint(e,!1);c=new m.PathHelper;c.addPath(k,!0);this._makeControlPoint(c.path());c.lineTo(u);c.lineTo(f);this._makeControlPoint(c.path());c.lineTo(a);this._makeControlPoint(c.path());
c.lineTo(b);this._makeControlPoint(c.path());c.lineTo(d);this._makeControlPoint(c.path());c.addPath(e,!1);return{paths:[c.path()]}};h._constructOffset=function(a,d){return this._curveHelper.offset(a,d,"Rounded",4,this._offsetFlattenError)};h._constructArrowBasePoint=function(a,d){if(!a||2>a.length)return null;var b=a[a.length-2];a=a[a.length-1];b=[a[0]-b[0],a[1]-b[1]];this._curveHelper.normalize(b);return[a[0]+b[1]*d,a[1]-b[0]*d]};h._makeControlPoint=function(a,d=!1){d?n.setId(a[0],1):n.setId(a[a.length-
1],1)};return l}(n.PathGeometryCursor);p.EffectArrow=q;Object.defineProperty(p,"__esModule",{value:!0})});