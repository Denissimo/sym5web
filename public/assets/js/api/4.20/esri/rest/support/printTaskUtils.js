// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../core/screenUtils","../../renderers/visualVariables/support/visualVariableUtils"],function(c,m,n){function p(a){return a&&"esri.views.2d.layers.GroupLayerView2D"===a.declaredClass}c.applyVisualVariables=function(a,d){const {graphic:g,renderer:b,symbol:f}=d;d=f.type;if("text"!==d&&"shield-label-symbol"!==d&&"visualVariables"in b&&b.visualVariables){var e=b.getVisualVariablesForType("size"),l=b.getVisualVariablesForType("color"),k=b.getVisualVariablesForType("opacity"),h=b.getVisualVariablesForType("rotation");
e=e&&e[0];l=l&&l[0];k=k&&k[0];h=h&&h[0];e&&(e=n.getSize(e,g,{shape:"simple-marker"===d?f.style:null}),null!=e&&("simple-marker"===d?a.size=m.px2pt(e):"picture-marker"===d?(a.width=m.px2pt(e),a.height=m.px2pt(e)):"simple-line"===d?a.width=m.px2pt(e):a.outline&&(a.outline.width=m.px2pt(e))));l&&((e=n.getColor(l,g))&&"simple-marker"===d||"simple-line"===d||"simple-fill"===d)&&(a.color=e?e.toJSON():void 0);k&&(d=n.getOpacity(k,g),null!=d&&a.color&&(a.color[3]=Math.round(255*d)));h&&(a.angle=-n.getRotationAngle(b,
g))}};c.createMultipointLayer=function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}};c.createPointLayer=function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}};c.createPolygonLayer=function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",
drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}};c.createPolylineLayer=function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}};c.getContextBoundingBox=function(a,d=15){const g=a.canvas.width;var b=a.canvas.height;a=a.getImageData(0,0,g,b).data;let f,e,l,k,h;f=b;a:for(;f--;)for(b=g;b--;)if(a[4*(g*f+b)+3]>d){h=f;break a}if(!h)return null;
b=g;a:for(;b--;)for(f=h+1;f--;)if(a[4*(g*f+b)+3]>d){k=b;break a}b=0;a:for(;b<=k;++b)for(f=h+1;f--;)if(a[4*(g*f+b)+3]>d){e=b;break a}f=0;a:for(;f<=h;++f)for(b=e;b<=k;++b)if(a[4*(g*f+b)+3]>d){l=f;break a}return{x:e,y:l,width:k-e,height:h-l}};c.getVisibleLayerViews=function(a,d){const g=a.allLayerViews.items;if(d===a.scale)return g.filter(b=>!b.suspended);a=[];for(const b of g)if(!p(b.parent)||a.includes(b.parent))!b.visible||d&&"isVisibleAtScale"in b&&!b.isVisibleAtScale(d)||a.push(b);return a};c.isBingMapsLayer=
function(a){return a&&"bing-maps"===a.type};c.isCSVLayer=function(a){return a&&"csv"===a.type};c.isFeatureLayer=function(a){return a&&"feature"===a.type};c.isGeoJSONLayer=function(a){return a&&"geojson"===a.type};c.isGraphicsLayer=function(a){return a&&"graphics"===a.type};c.isGroupLayer=function(a){return a&&"group"===a.type};c.isImageryLayer=function(a){return a&&"imagery"===a.type};c.isKMLLayer=function(a){return a&&"kml"===a.type};c.isMapImageLayer=function(a){return a&&"map-image"===a.type};
c.isMapNotesLayer=function(a){return a&&"map-notes"===a.type};c.isOpenStreetMapLayer=function(a){return a&&"open-street-map"===a.type};c.isStreamLayer=function(a){return a&&"stream"===a.type};c.isTileLayer=function(a){return a&&"tile"===a.type};c.isVectorTileLayer=function(a){return a&&"vector-tile"===a.type};c.isWMSLayer=function(a){return a&&"wms"===a.type};c.isWMTSLayer=function(a){return a&&"wmts"===a.type};c.isWebTileLayer=function(a){return a&&"web-tile"===a.type};Object.defineProperty(c,"__esModule",
{value:!0})});