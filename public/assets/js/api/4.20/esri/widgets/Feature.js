// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureViewModel ./Feature/support/FeatureContentMixin ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(w,f,e,x,m,H,y,I,J,n,z,A,B,p,C,D,r,E,F,K,t,g,G){const u={title:!0,content:!0,lastEditedInfo:!0};e=function(v){function q(a,b){a=v.call(this,a,b)||this;a._contentWidgets=[];a.graphic=null;a.defaultPopupTemplateEnabled=!1;a.headingLevel=2;a.label=void 0;a.messages=null;a.messagesURIUtils=null;a.spatialReference=null;a.title=null;a.visibleElements={...u};a.map=null;a.view=null;a.viewModel=new r;return a}w._inheritsLoose(q,v);var d=q.prototype;d.initialize=function(){this.own(x.init(this,"viewModel.contentViewModels",
()=>this._setupContentWidgets()))};d.destroy=function(){this._destroyContentWidgets()};d.castVisibleElements=function(a){return{...u,...a}};d.render=function(){const {waitingForContent:a}=this.viewModel;return g.tsx("div",{class:this.classes("esri-feature","esri-widget")},g.tsx("div",{class:"esri-feature__size-container"},this.renderTitle(),a?this.renderLoading():this.renderContentContainer()))};d.setActiveMedia=function(a,b){this.viewModel.setActiveMedia(a,b)};d.nextMedia=function(a){this.viewModel.nextMedia(a)};
d.previousMedia=function(a){this.viewModel.previousMedia(a)};d.renderLoading=function(){return g.tsx("div",{key:"loading-container",class:"esri-feature__loading-container"},g.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))};d.renderContentContainer=function(){const {visibleElements:a}=this;return a.content?g.tsx("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null};d.renderTitle=function(){const {visibleElements:a,
title:b}=this;return a.title?g.tsx(F.Heading,{level:this.headingLevel,class:"esri-feature__title",innerHTML:b}):null};d.renderContent=function(){var a=this.viewModel.content;return a?Array.isArray(a)?a.length?g.tsx("div",{key:"content-content-elements"},a.map(this.renderContentElement,this)):null:"string"===typeof a?(a=this._contentWidgets[0],!a||a.destroyed?null:g.tsx("div",{key:"content-content"},a.render())):this.renderNodeContent(a):null};d.renderContentElement=function(a,b){const {visibleElements:c}=
this;if("boolean"!==typeof c.content&&!c.content[a.type])return null;switch(a.type){case "attachments":return this.renderAttachments(b);case "custom":return this.renderCustom(a,b);case "fields":return this.renderFields(b);case "media":return this.renderMedia(b);case "text":return this.renderText(a,b);default:return null}};d.renderAttachments=function(a){const b=this._contentWidgets[a];if(!b||b.destroyed)return null;const {state:c,attachmentInfos:h}=b.viewModel;return"loading"===c||0<h.length?g.tsx("div",
{key:this._buildKey("attachments-element",a),class:this.classes("esri-feature__content-element")},b.render()):null};d.renderCustom=function(a,b){({creator:a}=a);const c=this._contentWidgets[b];return!c||c.destroyed?null:a?g.tsx("div",{key:this._buildKey("custom-element",b),class:"esri-feature__content-element"},c.render()):null};d.renderFields=function(a){const b=this._contentWidgets[a];return!b||b.destroyed?null:g.tsx("div",{key:this._buildKey("fields-element",a),class:"esri-feature__content-element"},
b.render())};d.renderMedia=function(a){const b=this._contentWidgets[a];return!b||b.destroyed?null:g.tsx("div",{key:this._buildKey("media-element",a),class:"esri-feature__content-element"},b.render())};d.renderLastEditInfo=function(){const {visibleElements:a,messages:b}=this;var {lastEditInfo:c}=this.viewModel;if(!c||!a.lastEditedInfo)return null;const {date:h,user:k}=c;c=G.substitute("edit"===c.type?k?b.lastEditedByUser:b.lastEdited:k?b.lastCreatedByUser:b.lastCreated,{date:h,user:k});return g.tsx("div",
{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info","esri-feature__content-element")},c)};d.renderText=function(a,b){const c=this._contentWidgets[b];return!c||c.destroyed?null:a.text?g.tsx("div",{key:this._buildKey("text-element",b),class:this.classes("esri-feature__content-element","esri-feature__text")},c.render()):null};d._buildKey=function(a,...b){const c=this.get("viewModel.graphic.uid")||"0";b=b.join("-");return`${a}__${c}-${b}`};d._destroyContentWidgets=function(){this._contentWidgets.forEach(a=>
{a.viewModel=null;a&&!a.destroyed&&a.destroy()});this._contentWidgets=[]};d._setupContentWidgets=function(){this._destroyContentWidgets();const {headingLevel:a,visibleElements:b}=this;var c=this.get("viewModel.content");const {contentViewModels:h}=this.viewModel;Array.isArray(c)?c.forEach((k,l)=>{"attachments"===k.type&&(this._contentWidgets[l]=new B({displayType:k.displayType,headingLevel:b.title?a+1:a,viewModel:h[l]}));"fields"===k.type&&(this._contentWidgets[l]=new C({viewModel:h[l]}));"media"===
k.type&&(this._contentWidgets[l]=new D({viewModel:h[l]}));"text"===k.type&&(this._contentWidgets[l]=new p({viewModel:h[l]}));"custom"===k.type&&(this._contentWidgets[l]=new p({viewModel:h[l]}))},this):(c=h[0])&&!c.destroyed&&(this._contentWidgets[0]=new p({viewModel:c}));this.scheduleRender()};return q}(E.FeatureContentMixin(A));f.__decorate([m.aliasOf("viewModel.graphic")],e.prototype,"graphic",void 0);f.__decorate([m.aliasOf("viewModel.defaultPopupTemplateEnabled")],e.prototype,"defaultPopupTemplateEnabled",
void 0);f.__decorate([n.property()],e.prototype,"headingLevel",void 0);f.__decorate([n.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],e.prototype,"label",void 0);f.__decorate([n.property(),t.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);f.__decorate([n.property(),t.messageBundle("esri/widgets/support/t9n/uriUtils")],e.prototype,"messagesURIUtils",void 0);f.__decorate([m.aliasOf("viewModel.spatialReference")],e.prototype,"spatialReference",void 0);
f.__decorate([m.aliasOf("viewModel.title")],e.prototype,"title",void 0);f.__decorate([n.property()],e.prototype,"visibleElements",void 0);f.__decorate([y.cast("visibleElements")],e.prototype,"castVisibleElements",null);f.__decorate([m.aliasOf("viewModel.map")],e.prototype,"map",void 0);f.__decorate([m.aliasOf("viewModel.view")],e.prototype,"view",void 0);f.__decorate([n.property({type:r})],e.prototype,"viewModel",void 0);return e=f.__decorate([z.subclass("esri.widgets.Feature")],e)});