// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/promiseUtils ../core/accessorSupport/decorators/aliasOf ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Measurement/MeasurementViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(p,u,e,c,y,q,D,E,F,k,z,A,x,G,B,C){function r(t){return Object.freeze({__proto__:null,
"default":t})}c=function(t){function v(a,b){a=t.call(this,a,b)||this;a._widgets=new Map;a.activeTool=null;a.activeWidget=null;a.areaUnit=null;a.iconClass="esri-icon-measure";a.label=void 0;a.linearUnit=null;a.messages=null;a.view=null;a.viewModel=new x;return a}u._inheritsLoose(v,t);var f=v.prototype;f.initialize=function(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel);this.view&&this.activeTool&&this._getActiveWidget().then(a=>{this._set("activeWidget",a)});
this.own([this.watch(["view","activeTool"],()=>{this._getActiveWidget().then(a=>{this._set("activeWidget",a)})}),this.watch("activeWidget",(a,b)=>{this.viewModel.set("activeViewModel",a?a.viewModel:null);b&&(b.visible=!1)}),this.watch(["areaUnit","linearUnit","localeStrings"],()=>this._updateSubWidgetProperties())])};f.destroy=function(){this._destroyWidgets()};f.render=function(){var {activeWidget:a}=this;a=a&&!a.destroyed?a.render():null;return C.tsx("div",{class:"esri-measurement"},a)};f.clear=
function(){this.activeTool=null;this._destroyWidgets()};f.startMeasurement=function(){const {activeViewModel:a}=this.viewModel;a&&y.ignoreAbortErrors(a.start())};f._createWidget=function(){var a=u._asyncToGenerator(function*(b){const {areaUnit:l,linearUnit:d,view:m}=this;switch(b){case "area":{const {type:n}=m;switch(n){case "2d":return new (yield new Promise(function(g,h){p(["./AreaMeasurement2D"],function(w){g(r(w))},h)})).default({view:m,unit:l,localeStrings:this._createLocaleStringsForWidget(b)});
case "3d":return new (yield new Promise(function(g,h){p(["./AreaMeasurement3D"],function(w){g(r(w))},h)})).default({view:m,unit:l,localeStrings:this._createLocaleStringsForWidget(b)});default:return null}}case "distance":return new (yield new Promise(function(n,g){p(["./DistanceMeasurement2D"],function(h){n(r(h))},g)})).default({view:m,unit:d,localeStrings:this._createLocaleStringsForWidget(b)});case "direct-line":return new (yield new Promise(function(n,g){p(["./DirectLineMeasurement3D"],function(h){n(r(h))},
g)})).default({view:m,unit:d,localeStrings:this._createLocaleStringsForWidget(b)});default:return null}});return function(b){return a.apply(this,arguments)}}();f._destroyWidgets=function(){this._widgets.forEach(a=>a.destroy());this._widgets.clear()};f._getActiveWidget=function(){var a=u._asyncToGenerator(function*(){const {activeTool:b,view:l}=this;if(!l||!b)return null;let d=null;if(this._widgets.has(b))d=this._widgets.get(b),d.visible=!0;else{d=yield this._createWidget(b);if(!d)return null;yield d.viewModel.start();
this._widgets.set(b,d)}return d});return function(){return a.apply(this,arguments)}}();f._createLocaleStringsForWidget=function(a){return this.localeStrings?this.localeStrings[a+"-"+this.view.type]:null};f._updateSubWidgetProperties=function(){this._widgets.forEach((a,b)=>{const {areaUnit:l,linearUnit:d}=this;a.unit=!a||"esri.widgets.AreaMeasurement2D"!==a.declaredClass&&"esri.widgets.AreaMeasurement3D"!==a.declaredClass?d:l;a.localeStrings=this._createLocaleStringsForWidget(b)})};return v}(A);e.__decorate([q.aliasOf("viewModel.activeTool")],
c.prototype,"activeTool",void 0);e.__decorate([k.property({readOnly:!0})],c.prototype,"activeWidget",void 0);e.__decorate([q.aliasOf("viewModel.areaUnit")],c.prototype,"areaUnit",void 0);e.__decorate([k.property()],c.prototype,"iconClass",void 0);e.__decorate([k.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);e.__decorate([q.aliasOf("viewModel.linearUnit")],c.prototype,"linearUnit",void 0);e.__decorate([k.property()],c.prototype,"localeStrings",void 0);
e.__decorate([k.property(),B.messageBundle("esri/widgets/Measurement/t9n/Measurement")],c.prototype,"messages",void 0);e.__decorate([q.aliasOf("viewModel.view")],c.prototype,"view",void 0);e.__decorate([k.property({type:x})],c.prototype,"viewModel",void 0);return c=e.__decorate([z.subclass("esri.widgets.Measurement")],c)});