// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(D,w,u,x,N,O,P,Q,E,F,G,n,m,H,R,I,b,J){const B={display:"flex",alignItems:"flex-start"},y={marginLeft:"3px"},v={display:"table-cell",verticalAlign:"middle"};u=function(C){function z(a,c){a=C.call(this,a,c)||this;a.activeLayerInfos=null;a.headingLevel=3;a.messages=null;a.type="classic";return a}D._inheritsLoose(z,C);var q=z.prototype;q.render=function(){var a=this.activeLayerInfos;a=a&&a.toArray().map(c=>this._renderLegendForLayer(c)).filter(c=>!!c);return b.tsx("div",null,a&&a.length?a:b.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};q._renderLegendForLayer=function(a){if(!a.ready)return null;var c=!!a.children.length;const e=`${"esri-legend__"}${a.layer.uid}-version-${a.version}`,f=a.title?H.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(c)return c=a.children.map(d=>this._renderLegendForLayer(d)).toArray(),b.tsx("div",{key:e,class:this.classes("esri-legend__service","esri-legend__group-layer")},
f,c);if((c=a.legendElements)&&!c.length)return null;c=c.map(d=>this._renderLegendForElement(d,a.layer)).filter(d=>!!d);return c.length?b.tsx("div",{key:e,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!a.parent}),tabIndex:0},f,b.tsx("div",{class:"esri-legend__layer"},c)):null};q._renderLegendForElement=function(a,c,e){var f="color-ramp"===a.type,d="opacity-ramp"===a.type;const g="size-ramp"===a.type;let h=null;if("symbol-table"===a.type||g){var k=a.infos.map(r=>this._renderLegendForElementInfo(r,
c,g,a.legendType)).filter(r=>!!r);k.length&&(h=b.tsx("div",{class:"esri-legend__layer-body"},k))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?h=this._renderLegendForRamp(a,c.opacity):"relationship-ramp"===a.type?h=G.renderRelationshipRamp(a,this.id,c.opacity):"univariate-above-and-below-ramp"===a.type?h=this._renderUnivariateAboveAndBelowRamp(a,c.opacity):"univariate-color-size-ramp"===a.type&&(h=this._renderUnivariateColorSizeRamp(a,c.opacity));
if(!h)return null;k=a.title;var l=null;"string"===typeof k?l=k:k&&(l=m.getTitle(this.messages,k,f||d),l=m.isRendererTitle(k,f||d)&&k.title?`${k.title} (${l})`:l);f=e?"esri-legend__layer-child-table":"esri-legend__layer-table";d=l?b.tsx("div",{class:"esri-legend__layer-caption"},l):null;return b.tsx("div",{class:this.classes(f,{["esri-legend__layer-table--size-ramp"]:g||!e})},d,h)};q._renderUnivariateAboveAndBelowRamp=function(a,c){const {sizeRampElement:e,colorRampElement:f}=n.getUnivariateAboveAndBelowRampElements(a,
c);var d=n.getUnivariateColorRampSize(e,"above",!0);a=n.getUnivariateColorRampSize(e,"below",!0);const g=n.getUnivariateColorRampPreview(f,{width:12,height:d,rampAlignment:"vertical",opacity:c,type:"above"});c=n.getUnivariateColorRampPreview(f,{width:12,height:a,rampAlignment:"vertical",opacity:c,type:"below"});var h=n.getUnivariateColorRampMargin(e);const k=e.infos.map(t=>t.label),l=k.map((t,p)=>{const A=2===p;return 0===p?b.tsx("div",{key:p,class:t?g?"esri-univariate-above-and-below-ramp__label":
"esri-legend__ramp-label":null},t):A?b.tsx("div",null):null}),r=k.length-1,K=Math.floor(k.length/2),L=k.map((t,p)=>{const A=p===r;return p===K||A?b.tsx("div",{key:p,class:t?g?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},t):null}),M={display:"table-cell",verticalAlign:"middle"};h={marginTop:`${h}px`};d={height:`${d}px`};a={height:`${a}px`};return b.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:B},b.tsx("div",{class:"esri-legend__layer-body"},e.infos.map((t,
p)=>b.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},b.tsx("div",{class:"esri-legend__symbol",styles:M,bind:t.preview,afterCreate:m.attachToNode}),g||0!==p%2?null:b.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},k[p])))),g?b.tsx("div",{styles:h,key:"color-ramp-preview"},b.tsx("div",{styles:y},b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramps",bind:g,afterCreate:m.attachToNode})),b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramp-labels",
styles:d},l))),b.tsx("div",{styles:y},b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramps",bind:c,afterCreate:m.attachToNode})),b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramp-labels",styles:a},L)))):null)};q._renderUnivariateColorSizeRamp=function(a,c){const {sizeRampElement:e,colorRampElement:f}=n.getUnivariateColorSizeRampElements(a);var d=n.getUnivariateColorRampMargin(e);a=n.getUnivariateColorRampSize(e,"full",!1);c=n.getUnivariateColorRampPreview(f,{width:12,height:a,
rampAlignment:"vertical",opacity:c,type:"full"});const g=e.infos.length-1,h=e.infos.map((l,r)=>0===r||r===g?b.tsx("div",{key:r,class:l.label?f?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},l.label):null),k={display:"table-cell",verticalAlign:"middle"};d={marginTop:`${d}px`};a={height:`${a}px`};return b.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:B},b.tsx("div",{class:"esri-legend__layer-body"},e.infos.map(l=>b.tsx("div",{class:this.classes("esri-legend__layer-row",
"esri-legend__size-ramp")},b.tsx("div",{class:"esri-legend__symbol",styles:k,bind:l.preview,afterCreate:m.attachToNode})))),b.tsx("div",{styles:d,key:"color-ramp-preview"},b.tsx("div",{styles:y},b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramps",bind:c,afterCreate:m.attachToNode})),b.tsx("div",{styles:v},b.tsx("div",{class:"esri-legend__ramp-labels",styles:a},h)))))};q._renderLegendForRamp=function(a,c){const e=a.infos,f="heatmap-ramp"===a.type,d="stretch-ramp"===a.type,g=a.preview;g.className=
`${"esri-legend__color-ramp"} ${"opacity-ramp"===a.type?"esri-legend__opacity-ramp":""}`;null!=c&&(g.style.opacity=c.toString());a=e.map(h=>b.tsx("div",{class:h.label?"esri-legend__ramp-label":null},f?this.messages[h.label]:d?this._getStretchStopLabel(h):h.label));c={height:g.style.height};return b.tsx("div",{class:"esri-legend__layer-row"},b.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},b.tsx("div",{class:"esri-legend__ramps",bind:g,afterCreate:m.attachToNode})),
b.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},b.tsx("div",{class:"esri-legend__ramp-labels",styles:c},a)))};q._getStretchStopLabel=function(a){return a.label?this.messages[a.label]+": "+("string"===typeof a.value?a.value:J.formatNumber(a.value,{style:"decimal",notation:-1<a.value.toString().indexOf("e")?"scientific":"standard"})):""};q._renderLegendForElementInfo=function(a,c,e,f){if(a.type)return this._renderLegendForElement(a,c,!0);let d=null;f=m.isImageryStretchedLegend(c,
f);a.preview?d=b.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:m.attachToNode}):a.src&&(d=this._renderImage(a,c,f));if(!d)return null;c={["esri-legend__imagery-layer-info--stretched"]:f};return b.tsx("div",{class:"esri-legend__layer-row"},b.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:f,["esri-legend__size-ramp"]:!f&&e})},d),b.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",
c)},m.getTitle(this.messages,a.label,!1)||""))};q._renderImage=function(a,c,e){const {label:f,src:d,opacity:g}=a;e={["esri-legend__imagery-layer-image--stretched"]:e,["esri-legend__symbol"]:!e};c={opacity:`${null!=g?g:c.opacity}`};return b.tsx("img",{alt:m.getTitle(this.messages,f,!1),src:d,border:0,width:a.width,height:a.height,class:this.classes(e),styles:c})};return z}(F);w.__decorate([x.property()],u.prototype,"activeLayerInfos",void 0);w.__decorate([x.property()],u.prototype,"headingLevel",void 0);
w.__decorate([x.property(),I.messageBundle("esri/widgets/Legend/t9n/Legend")],u.prototype,"messages",void 0);w.__decorate([x.property({readOnly:!0})],u.prototype,"type",void 0);return u=w.__decorate([E.subclass("esri.widgets.Legend.styles.Classic")],u)});