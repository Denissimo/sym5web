// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../layers/support/ElevationQuery ../../support/elevationInfoUtils ./ElevationProfileLine".split(" "),function(n,d,t,w,e,x,y,h,c,E,F,G,z,A,B,C){c=function(p){function m(a){a=
p.call(this,a)||this;a.type="input";a.color=new t("#00c8c8");a.viewVisualizationEnabled=!1;a.numSamplesForPreview=50;a.numSamplesPerChunk=500;a.chartFillEnabled=!1;a.chartStrokeOffsetY=-1;a._getQueryElevationDependencies=x.memoize((b,f,k,g,l)=>e.applySome(b,q=>({elevationInfo:q,visibleLayers:f,view:k,stationary:g,spatialReference:l})));return a}n._inheritsLoose(m,p);var u=m.prototype;u.queryElevation=function(){var a=n._asyncToGenerator(function*(b,{noDataValue:f,signal:k}){const g=this.queryElevationDependencies;
if(e.isNone(g))throw Error("ElevationProfileLineInput: no dependencies");const {view:l,elevationInfo:q,spatialReference:v}=g;if("on-the-ground"===q.mode&&"3d"===l.type){b=yield A.GeometryDescriptor.fromGeometry(b).project(v,k);const D=l.elevationProvider;b.coordinates.forEach(r=>{r.z=e.unwrapOr(D.getElevation(r.x,r.y,0,v,"ground"),0)});return{geometry:b.export(),noDataValue:f}}return{geometry:b,noDataValue:f}});return function(b,f){return a.apply(this,arguments)}}();u.attach=function(a){const b=()=>
this._onChange();return w.handlesGroup([p.prototype.attach.call(this,a),this.watch("queryElevationDependencies",b),y.on(a,"view.elevationProvider","elevation-change",b)])};n._createClass(m,[{key:"queryElevationDependencies",get:function(){const a=this._viewModel.view;return e.isNone(a)?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,a,a.stationary,a.spatialReference)}},{key:"available",get:function(){return!this._viewModel.inputIsSketched}},{key:"_elevationInfo",get:function(){return e.applySome(this._viewModel.input,
B.getGraphicEffectiveElevationInfo)}},{key:"_visibleLayers",get:function(){var a;const b=null==(a=this._viewModel)?void 0:a.view;a=e.applySome(b,f=>{var k,g;return null==(k=f.map)?void 0:null==(g=k.allLayers)?void 0:g.filter(l=>l.visible).toArray()});return e.unwrapOr(a,[])}}]);return m}(C.ElevationProfileLine);d.__decorate([h.property({type:t,nonNullable:!0})],c.prototype,"color",void 0);d.__decorate([h.property()],c.prototype,"viewVisualizationEnabled",void 0);d.__decorate([h.property()],c.prototype,
"queryElevationDependencies",null);d.__decorate([h.property()],c.prototype,"available",null);d.__decorate([h.property()],c.prototype,"_elevationInfo",null);d.__decorate([h.property()],c.prototype,"_visibleLayers",null);return c=d.__decorate([z.subclass("esri.widgets.ElevationProfile.ElevationProfileLineInput")],c)});