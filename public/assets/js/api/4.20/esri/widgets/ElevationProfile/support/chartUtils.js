// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/arrayUtils ../../../core/handleUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/unitFormatUtils ../../../core/unitUtils ../css ./constants ./intlUtils ./niceScale ../../support/chartUtils ../../support/widgetUtils ../../../core/has ../../../core/Logger ../../../intl/substitute ../../../intl/number".split(" "),function(x,K,ka,L,v,m,M,y,A,N,t,O,P,Q,w,la,ma,R,S){function z(){z=K._asyncToGenerator(function*(a){const c=
yield Q.loadChartsModule();M.throwIfAborted(a.abortOptions);const {am4core:b,am4charts:e}=c;b.options.minPolylineStep=.5;b.options.autoSetClassName=!0;b.options.animationsEnabled=!1;var d=w.isDarkTheme();const f=d?T:B;d&&b.useTheme(c.am4themes_dark);const g=b.create(a.container,e.XYChart);g.arrangeTooltips=!1;g.preloader.disabled=!0;g.zoomOutButton.disabled=!0;d=w.isRTL();g.rtl=d;g.padding(f.paddingTop,d?f.paddingLeft:f.paddingRight,f.paddingBottom,d?f.paddingRight:f.paddingLeft);d=g.plotContainer.background;
d.strokeWidth=0;d.strokeOpacity=0;d.stroke=null;d=g.xAxes.push(new e.ValueAxis);const k=g.yAxes.push(new e.ValueAxis),h={params:a,amCharts4Index:c,amChart:g,xAxis:d,yAxis:k,series:new Map,data:null,messages:null,theme:f,zooming:!1,pointerIsOver:!1};g.cursor=U(h);V(h);W(h);X(h);const n=[Y(h,a.onRangeChange),Z(h,a.onCursorPositionChange),aa(h)];let l=null,q=!1;const p=()=>{m.isNone(l)||("undefined"!==typeof window&&"cancelIdleCallback"in window?window.cancelIdleCallback(l):clearTimeout(l),l=null)};
return{...h,destroy(){q=!0;p();v.handlesGroup(n).remove();g.dispose()},update(u){if(u.data!==h.data||u.messages!==h.messages)if(p(),!q){var C=()=>{q||(l=null,ba(h,u))};l="undefined"!==typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(C,{timeout:30}):setTimeout(C,30)}},zoomOut(){q||(h.yAxis.zoom({start:0,end:1},!1,!0),h.xAxis.zoom({start:0,end:1},!1,!0))}}});return z.apply(this,arguments)}function U(a){a=new a.amCharts4Index.am4charts.XYCursor;a.trackable=!0;a.lineY.disabled=
!0;a.behavior="zoomXY";return a}function V(a){const c=a.theme,b=a.amChart.tooltip;({am4core:a}=a.amCharts4Index);b.id="series-tooltip";b.fitPointerToBounds=!0;b.pointerOrientation="vertical";b.zIndex=-1;b.getFillFromObject=!1;b.label.fontSize=c.seriesTooltipFontSize;b.label.fill=a.color(c.seriesTooltipLabelColor);b.label.padding(c.seriesTooltipPaddingVertical,c.seriesTooltipPaddingHorizontal,c.seriesTooltipPaddingVertical,c.seriesTooltipPaddingHorizontal);b.background.cornerRadius=c.tooltipBorderRadius;
b.background.stroke=null;b.background.fill=a.color(c.seriesTooltipBackgroundColor);b.background.padding(0,0,0,0);b.adapter.add("dy",()=>c.seriesTooltipSpacing*(0>=b.background.pointerY?1:-1));w.isRTL()&&(b.label.textAlign="middle")}function W(a){const {xAxis:c,theme:b}=a,{am4core:e}=a.amCharts4Index;c.numberFormatter=D(a,"distance");c.strictMinMax=!0;c.cursorTooltipEnabled=!1;c.title.visible=!1;a=c.renderer;a.line.visible=!1;a.minGridDistance=b.xAxisMinGridDistance;a.minLabelPosition=b.xAxisMinLabelPosition;
a.maxLabelPosition=b.xAxisMaxLabelPosition;a.fontWeight=b.axisFontWeight;a.fontSize=b.axisFontSize;a.baseGrid.disabled=!0;var d=a.labels.template;d.fontSize=b.axisLabelsFontSize;d.fontWeight=b.axisLabelsFontWeight;d.fill=e.color(b.axisLabelsColor);d.paddingTop=b.xAxisLabelsSpacing;d.horizontalCenter="left";d.paddingLeft=0;d=c.tooltip;d.id="axis-tooltip";d.background.fill=e.color(b.axisTooltipBackgroundColor);d.background.stroke=null;d.background.padding(0,0,0,0);d.label.fontSize=b.axisTooltipFontSize;
d.label.fill=e.color(b.axisTooltipLabelColor);d.label.padding(b.axisTooltipPaddingTop,b.axisTooltipPaddingHorizontal,b.axisTooltipPaddingBottom,b.axisTooltipPaddingHorizontal);a=a.grid.template;a.strokeOpacity=1;a.stroke=e.color(b.axisGridStroke)}function X(a){const {yAxis:c,theme:b}=a,{am4core:e}=a.amCharts4Index;c.numberFormatter=D(a,"elevation");c.title.visible=!1;c.cursorTooltipEnabled=!1;c.strictMinMax=!0;c.baseValue=t.NO_DATA_VALUE;a=c.renderer;a.inside=!0;a.line.opacity=0;a.line.visible=!1;
a.minGridDistance=b.yAxisMinGridDistance;a.minLabelPosition=b.yAxisMinLabelPosition;a.maxLabelPosition=b.yAxisMaxLabelPosition;a.fontWeight=b.axisFontWeight;a.fontSize=b.axisFontSize;a.baseGrid.disabled=!0;const d=a.labels.template;d.fontSize=b.axisLabelsFontSize;d.fontWeight=b.axisLabelsFontWeight;d.fill=e.color(b.axisLabelsColor);d.verticalCenter="bottom";d.paddingLeft=b.yAxisLabelSpacing;d.paddingBottom=0;const f=a.grid.template;f.strokeOpacity=1;f.stroke=e.color(b.axisGridStroke);w.isRTL()&&(a.opposite=
!0,d.textAlign="middle",d.paddingLeft=0,d.paddingRight=b.yAxisLabelSpacing)}function ba(a,{data:c,messages:b}){var e=m.isSome(c)&&c.refined;a.amChart.cursor.disabled=!e;a.amChart.htmlContainer.classList.toggle(N.CHART_CSS.cursorEnabled,e);e=a.data!==c;const d=m.applySome(a.data,f=>f.effectiveUnits)!==m.applySome(c,f=>f.effectiveUnits);a.data=c;a.messages=b;e&&(ca(a),da(a));d&&(a.yAxis.invalidateLabels(),a.xAxis.invalidateLabels());r(a)}function ca(a){const {xAxis:c,yAxis:b}=a,{minX:e,maxX:d,minY:f,
maxY:g}=E({data:a.data,pixelWidth:c.pixelWidth,pixelHeight:b.pixelHeight});c.min=e;c.max=d;b.min=f;b.max=g}function E({data:a,pixelWidth:c,pixelHeight:b}){if(m.isNone(a))return F;var e=a.statistics;const d=m.applySome(e,h=>h.maxDistance);let f=m.applySome(e,h=>h.minElevation);var g=m.applySome(e,h=>h.maxElevation);if(m.isNone(d)||m.isNone(f)||m.isNone(g))return F;e=Math.max(d-0,.001);let k=Math.max(g-f,.001);g=a.effectiveUnits;a.dynamicElevationRange&&(g=A.convertUnit(e,g.distance,g.elevation),k=
Math.max(k,g/t.MAX_CHART_RATIO));f-=.02*k;g=f+k+.02*k;[f,g]=P.niceScale(f,g,10);k=g-f;return a.uniformScaling?G({data:a,bounds:{minX:0,maxX:d,minY:f,maxY:g},pixelWidth:c,pixelHeight:b,centered:!0}):{minX:0,maxX:0+e,minY:f,maxY:f+k}}function G({data:a,bounds:c,pixelWidth:b,pixelHeight:e,centered:d}){if(m.isNone(a))return c;let {minX:f,maxX:g,minY:k,maxY:h}=c;c=g-f;a=a.effectiveUnits;b=A.convertUnit(h-k,a.elevation,a.distance)/e/(c/b);1<=b?[f,g]=H([f,g],b,d):[k,h]=H([k,h],1/b,d);return{minX:f,maxX:g,
minY:k,maxY:h}}function H([a,c],b,e){b*=c-a;return e?(a=(a+c)/2-b/2,[a,a+b]):[a,a+b]}function da(a){const {amChart:c,data:b}=a;if(m.isNone(b)||0===b.lines.length)c.series.clear();else{var e=new Map,d=new Set(c.series.values),f=b.lines.length;for(let g=0;g<f;g++){const k=b.lines[g];let h=a.series.get(k.id);h?(m.applySome(h.fill,l=>d.delete(l)),d.delete(h.line)):(h=ea(a,k),m.applySome(h.fill,l=>c.series.push(l)),c.series.push(h.line));e.set(h.id,h);const n=f-g-1;m.applySome(h.fill,l=>l.zIndex=n);h.line.zIndex=
f+n;fa(a,h,k)}a.series=e;for(const g of d)c.series.removeValue(g)}}function fa(a,{line:c,fill:b},e){const {theme:d}=a;({am4core:a}=a.amCharts4Index);const {r:f,g,b:k,a:h}=e.color,n=a.color({r:f,g,b:k,a:h}),l=m.unwrapOr(e.samples,[]),q=0<l.length;c.stroke=n;c.visible=q;m.applySome(b,p=>{p.visible=q;p.fill=n.lighten(d.seriesFillLighten)});e=l.length;a=c.data;if(a.length===e){for(let p=0;p<e;++p)ha(a[p],l[p]);c.invalidateRawData();m.applySome(b,p=>p.invalidateRawData())}else c.data=l,m.applySome(b,p=>
p.data=l)}function ha(a,c){a.x=c.x;a.y=c.y;a.z=c.z;a.distance=c.distance;a.elevation=c.elevation}function ea(a,c){const {id:b}=c,e=I(a,`${"line"}-${b}`);e.strokeWidth=c.chartStrokeWidth;e.dy=c.chartStrokeOffsetY;let d=null;c.chartFillEnabled&&(d=I(a,`${"fill"}-${b}`),d.fillOpacity=1);return{id:b,line:e,fill:d}}function I(a,c){a=new a.amCharts4Index.am4charts.LineSeries;a.id=c;a.showOnInit=!1;a.simplifiedProcessing=!0;a.minDistance=.5;a.excludeFromTotal=!0;a.clickable=!1;a.contextMenuDisabled=!0;a.cursorHoverEnabled=
!1;a.cursorTooltipEnabled=!1;a.connect=!1;a.fill=null;a.stroke=null;a.dataFields.valueX="distance";a.dataFields.valueY="elevation";return a}function Y(a,c){const {amChart:b,xAxis:e,yAxis:d}=a;let f=!1;const g=()=>{const {data:n}=a;if(f&&!m.isNone(n)&&n.uniformScaling){f=!1;var {minX:l,maxX:q,minY:p,maxY:u}=G({data:a.data,bounds:{minX:e.minZoomed,maxX:e.maxZoomed,minY:d.minZoomed,maxY:d.maxZoomed},pixelWidth:e.pixelWidth,pixelHeight:d.pixelHeight,centered:!0});e.zoomToValues(l,q,!0);d.zoomToValues(p,
u,!0);b.validate();r(a)}},k=()=>{c(a.xAxis.zoomFactor,a.yAxis.zoomFactor)},h=[b.events.on("down",()=>{a.zooming=!0;r(a)}),b.events.on("up",()=>{a.zooming=!1;r(a)}),b.cursor.events.on("zoomended",()=>{f=!0}),e.events.on("startendchanged",g),d.events.on("startendchanged",g),e.events.on("rangechangeended",k),d.events.on("rangechangeended",k)];return v.makeHandle(()=>{h.forEach(n=>n.dispose())})}function aa({xAxis:a,yAxis:c}){const b=d=>()=>{d.renderer.grid.each(f=>{f.visible="none"!==f.dataItem.label.dom.getAttribute("display")})},
e=[a.events.on("rangechangeended",b(a)),a.events.on("validated",b(a)),c.events.on("rangechangeended",b(c)),c.events.on("validated",b(c))];return v.makeHandle(()=>{e.forEach(d=>d.dispose())})}function Z(a,c){const {amChart:b,xAxis:e,yAxis:d}=a,{cursor:f,events:g}=b,k=()=>{a.pointerIsOver=!1;r(a);c(null,null)},h=[f.events.on("cursorpositionchanged",()=>{if(a.pointerIsOver){r(a);var n=e.toAxisPosition(f.xPosition),l=d.toAxisPosition(f.yPosition);c(n,l)}}),g.on("over",()=>{a.pointerIsOver=!0;r(a)}),g.on("out",
k),g.on("blur",k)];return v.makeHandle(()=>{h.forEach(n=>n.dispose())})}function r(a){const {amChart:c,xAxis:b,data:e,theme:d,zooming:f,pointerIsOver:g}=a;a.amChart.tooltip.hide();a.xAxis.hideTooltip();if(g&&!f&&!m.isNone(e)&&e.refined){var k=ia(a);if(m.isSome(k)){const {cursor:n,tooltip:l}=c;n.show(0);n.validate();l.text=k.text;l.show(0);l.validate();l.pointerOrientation=30>k.y-l.contentHeight-d.seriesTooltipSpacing?"up":"down";l.pointTo(k,!0);l.validate();k=b.tooltip;{const {data:q,messages:p}=
a;if(m.isNone(q)||m.isNone(p))a="";else{var h=q.lines[0];a=h?J(a,h):null;a=m.isSome(a)?y.formatDecimal(p,a.distance,q.effectiveUnits.distance,t.FORMAT_PRECISION):"-"}}k.text=a;k.show(0);k.validate()}}}function ia(a){const {amChart:c,yAxis:b,data:e}=a;if(m.isNone(e))return null;const d=e.lines.map(n=>({line:n,y:m.applySome(J(a,n),l=>l.elevation)})).sort(ja),f=d.length?d[0].y:null;if(m.isNone(f))return null;const g=c.cursor,k=b.measuredHeight,h=k+c.pixelPaddingTop;return{text:d.map(({y:n,line:l})=>
{{const {data:q,messages:p}=a;m.isNone(q)||m.isNone(p)?l="":(n=R.substitute(p.chartTooltip,{name:O.getTranslatedLineTitle(l,p),elevation:m.isSome(n)?y.formatDecimal(p,n,q.effectiveUnits.elevation,t.FORMAT_PRECISION):t.NOT_AVAILABLE}),l=`[${l.color.toHex()}]\u25cf[/] ${n}`)}return l}).join("\n"),x:g.point.x+g.parent.pixelX+c.pixelPaddingLeft,y:h-b.valueToPosition(f)*k}}function ja({y:a},{y:c}){return m.isNone(a)?1:m.isNone(c)?-1:c-a}function D(a,c){const b=a.xAxis.numberFormatter.clone();b.format=
(e,d,f)=>{const {messages:g,data:k}=a;return m.isNone(g)||m.isNone(k)||"string"===typeof e?"":`${S.formatNumber(e,{maximumFractionDigits:f})} ${y.unitName(g,k.effectiveUnits[c],"abbr")}`};return b}function J({amChart:a,xAxis:c},b){b=m.unwrapOr(b.samples,[]);if(0===b.length)return null;a=c.toAxisPosition(a.cursor.xPosition);c=c.positionToValue(a);return L.binaryFindClosest(b,c,e=>e.distance)}const B={sideSpacing:15,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,axisFontSize:9,axisFontWeight:"400",
axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:"#a9a9a9",axisTooltipFontSize:12,axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",axisTooltipPaddingTop:3,axisTooltipPaddingBottom:3,axisTooltipPaddingHorizontal:4,xAxisMinGridDistance:50,xAxisLabelsSpacing:6,xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:4,yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:"#f8f8f8",
seriesTooltipLabelColor:"#323232",seriesFillLighten:.9,seriesTooltipSpacing:6,seriesTooltipPaddingVertical:4,seriesTooltipPaddingHorizontal:4,tooltipBorderRadius:0},T={...B,axisGridStroke:"#323232",axisLabelsColor:"#a9a9a9",axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",seriesTooltipBackgroundColor:"#323232",seriesTooltipLabelColor:"#f8f8f8",seriesFillLighten:-.75},F={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};x.createChart=function(a){return z.apply(this,arguments)};x.getAdjustedBounds=
E;Object.defineProperty(x,"__esModule",{value:!0})});