// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ShadowAccumulation/components/DiscreteConfigurator ../intl ../core/Handles ../core/maybe ../core/timeUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../core/accessorSupport/trackingUtils ../intl/substitute ./Slider ./Widget ./ShadowAccumulation/css ./ShadowAccumulation/ShadowAccumulationViewModel ./ShadowAccumulation/ShadowAccumulationVisibleElements ./ShadowAccumulation/components/DurationConfigurator ./ShadowAccumulation/components/ShadowTooltip ./ShadowAccumulation/components/ThresholdConfigurator ./ShadowAccumulation/components/TimezonePicker ./support/DatePicker ./support/Heading ./support/timeWidgetUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/date".split(" "),
function(v,l,A,g,B,m,w,x,S,T,U,V,n,C,u,D,E,F,f,G,y,H,I,J,K,L,z,M,W,N,d,O){const P={hour:"2-digit",minute:"2-digit",timeZone:"UTC"},Q={labelFormatFunction:M.formatSliderLabel,min:0,max:1439,steps:5,rangeLabelInputsEnabled:!1,visibleElements:{labels:!1,rangeLabels:!1},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(r,p,e)=>{p.classList.add(f.CSS.timeRangePrimaryTick);e.classList.add(f.CSS.timeRangePrimaryTickLabel);r=e.innerText;-1!==r.indexOf(" ")&&
(e.innerHTML=r.replace(/(.*) (.*)/,`$1<br><div class="${f.CSS.timeRangeAMPMLabel}">$2</div>`))}},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(r,p)=>{p.classList.add(f.CSS.timeRangeSecondaryTick)}}]};g=function(r){function p(a,c){var b=r.call(this,a,c)||this;b.viewModel=null;b.view=null;b.headingLevel=4;b.iconClass=f.CSS.widgetIcon;b.label=void 0;b.visibleElements=new y;b._handles=new B;b._defaultViewModel=null;b._timeSlider=new E({...Q,container:document.createElement("div")});
b._tooltip=null;b._onTimezoneChange=h=>{b.viewModel.utcOffset=h};b._onDateChange=h=>{b.viewModel.date=h};null!=a&&a.viewModel||(b._defaultViewModel=new G({view:null==a?void 0:a.view}),b.viewModel=b._defaultViewModel);return b}v._inheritsLoose(p,r);var e=p.prototype;e.initialize=function(){this._handles.add([u.reactionInit(()=>({viewModel:this.viewModel,slider:this._timeSlider}),a=>this._connectTimeSlider(a)),u.reactionInit(()=>({container:m.applySome(this.view,a=>a.surface),viewModel:this.viewModel,
tooltipVisible:this.visibleElements.tooltip}),({container:a,viewModel:c,tooltipVisible:b})=>{this._tooltip=m.destroyMaybe(this._tooltip);!m.isNone(a)&&b&&(this._tooltip=new I.ShadowTooltip({viewModel:c,container:a}))}),u.reactionInit(()=>({viewModel:this.viewModel,visible:this.visible}),({viewModel:a,visible:c})=>a.setRunning(c))])};e.destroy=function(){this._handles=m.destroyMaybe(this._handles);this._timeSlider=m.destroyMaybe(this._timeSlider);m.isSome(this._defaultViewModel)&&this.viewModel!==
this._defaultViewModel&&this._defaultViewModel.destroy()};e.render=function(){const {visibleElements:a,viewModel:c}=this;return d.tsx("div",{key:this,class:this.classes(f.CSS.base,f.CSS.esriWidget,{[f.CSS.esriWidgetDisabled]:"disabled"===c.state})},this._renderTimeRangeSection(),a.visualizationOptions&&this._renderVisualizationOptionsSection())};e._connectTimeSlider=function({viewModel:a,slider:c}){this._handles.remove("slider");if(!m.isNone(c)){var b=k=>w.convertTime(k,"milliseconds","minutes"),
h=k=>w.convertTime(k,"minutes","milliseconds"),q=({index:k,value:t})=>{0===k?a.startTimeOfDay=h(t):a.endTimeOfDay=h(t)};this._handles.add([u.reactionInit(()=>[a.startTimeOfDay,a.endTimeOfDay],k=>{c.values=k.map(b)}),c.on("thumb-change",q),c.on("thumb-drag",q),c.on("segment-drag",()=>{[a.startTimeOfDay,a.endTimeOfDay]=c.values.map(h)})],"slider")}};e._renderTimeRangeSection=function(){const {visibleElements:a}=this;return a.timeRangeSlider||a.datePicker?d.tsx("section",{key:"time-range",class:f.CSS.timeRange},
d.tsx(z.Heading,{level:this.headingLevel},this.messages.timeLabel),a.timeRangeSlider&&this._renderTimeRange(),a.datePicker&&this._renderDatePicker()):null};e._renderTimeRange=function(){const {messages:a,viewModel:c,visibleElements:b}=this,{startTimeOfDay:h,endTimeOfDay:q}=c,[k,t]=[h,q].map(R=>O.formatDate(new Date(R),P));return[d.tsx("div",{key:"time-range-indicator",class:f.CSS.timeRangeIndicator},D.substitute(a.timeRange,{start:k,end:t}),b.timezone&&d.tsx(K.TimezonePicker,{value:c.utcOffset,onChange:this._onTimezoneChange})),
d.tsx("div",{key:"time-slider-container",bind:this,afterCreate:this._timeSliderContainerAfterCreate,afterRemoved:this._timeSliderContainerAfterRemoved})]};e._timeSliderContainerAfterCreate=function(a){m.applySome(this._timeSlider,c=>{a.appendChild(c.container)})};e._timeSliderContainerAfterRemoved=function(a){m.applySome(this._timeSlider,c=>{a.removeChild(c.container)})};e._renderDatePicker=function(){return d.tsx("div",{key:"date-picker",class:f.CSS.datePickerContainer},d.tsx(L,{value:this.viewModel.date,
onChange:this._onDateChange}))};e._renderVisualizationOptionsSection=function(){const {headingLevel:a,messages:c,viewModel:b,visibleElements:h}=this,q=h.colorPicker,k=t=>this.classes(b.visualizationType===t?null:f.CSS.visualizationConfigHidden);return d.tsx("section",{key:"visualization",class:f.CSS.visualization},d.tsx(z.Heading,{level:a},c.visualizationLabel),this._renderVisualizationSelect(),d.tsx("div",{key:"threshold-configurator",class:k("threshold")},d.tsx(J.ThresholdConfigurator,{options:b.thresholdOptions,
colorPickerVisible:q})),d.tsx("div",{key:"duration-configurator",class:k("duration")},d.tsx(H.DurationConfigurator,{options:b.durationOptions,colorPickerVisible:q})),d.tsx("div",{key:"discrete-configurator",class:k("discrete")},d.tsx(A.DiscreteConfigurator,{options:b.discreteOptions,colorPickerVisible:q})))};e._renderVisualizationSelect=function(){const a=this.messages,c=this.viewModel.visualizationType;return d.tsx("calcite-select",{class:f.CSS.visualizationSelect,key:"visualization-select",label:a.visualizationLabel,
bind:this,onCalciteSelectChange:this._onVisualizationTypeChange},[{type:"threshold",label:a.threshold.label},{type:"duration",label:a.duration.label},{type:"discrete",label:a.discrete.label}].map(({type:b,label:h})=>d.tsx("calcite-option",{value:b,selected:b===c},h)))};e._onVisualizationTypeChange=function(a){var c;a=null==(c=a.target.selectedOption)?void 0:c.value;this.viewModel.visualizationType=null!=a?a:"threshold"};v._createClass(p,[{key:"testData",get:function(){return{tooltip:this._tooltip}}}]);
return p}(F);l.__decorate([n.property()],g.prototype,"viewModel",void 0);l.__decorate([x.aliasOf("viewModel.view")],g.prototype,"view",void 0);l.__decorate([n.property()],g.prototype,"headingLevel",void 0);l.__decorate([n.property()],g.prototype,"iconClass",void 0);l.__decorate([x.aliasOf("messages.widgetLabel",{overridable:!0})],g.prototype,"label",void 0);l.__decorate([n.property({type:y,nonNullable:!0})],g.prototype,"visibleElements",void 0);l.__decorate([n.property(),N.messageBundle("esri/widgets/ShadowAccumulation/t9n/ShadowAccumulation")],
g.prototype,"messages",void 0);l.__decorate([n.property()],g.prototype,"_defaultViewModel",void 0);l.__decorate([n.property()],g.prototype,"_timeSlider",void 0);l.__decorate([n.property()],g.prototype,"_tooltip",void 0);return g=l.__decorate([C.subclass("esri.widgets.ShadowAccumulation")],g)});