// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),function(n,l,g,v,e,w,x,h,A,B,C,D,y,z){function p(m){return Object.freeze({__proto__:null,"default":m})}var q;e=q=function(m){function r(b){b=
m.call(this,b)||this;b._activeFetchInfo={id:null,request:null};b.description=null;b.label=null;b.layer=null;b.template=null;b.thumbnail=null;return b}l._inheritsLoose(r,m);var k=r.prototype;k.initialize=function(){this.handles.add(x.init(this,["layer.renderer","template"],()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",null)}))};k.clone=function(){const b=this.thumbnail?this.thumbnail.cloneNode(!0):null,a=new q({layer:this.layer,template:this.template});
a._set("thumbnail",b);return a};k.fetchThumbnail=function(){var b=l._asyncToGenerator(function*(){var a=this;const {_activeFetchInfo:c}=this;if(`${this.label}-${this.layer.id}`===c.id)return c.request;c.id=`${this.label}-${this.layer.id}`;c.request=this._getPreviewSymbol().then(function(){var d=l._asyncToGenerator(function*(f){var u;if(`${a.label}-${a.layer.id}`===c.id){var t={maxSize:36};"dictionary"===(null==(u=a.layer.renderer)?void 0:u.type)&&(t.fieldMap=a.layer.renderer.fieldMap,t.feature={attributes:a.template.prototype.attributes});
f=yield z.renderPreviewHTML(f,t);`${a.label}-${a.layer.id}`===c.id&&a._set("thumbnail",f)}});return function(f){return d.apply(this,arguments)}}());return c.request});return function(){return b.apply(this,arguments)}}();k._getPreviewSymbol=function(){var b=l._asyncToGenerator(function*(){const {layer:a,template:c,layer:{renderer:d}}=this;if(d){var f=new v({attributes:c.prototype.attributes});if(f=yield d.getSymbolAsync(f))return f}return this._getFallbackSymbolFromGeometry(a)});return function(){return b.apply(this,
arguments)}}();k._getFallbackSymbolFromGeometry=function(b){({geometryType:b}=b);if("point"===b||"multipoint"===b)return(new Promise(function(a,c){n(["../../symbols/SimpleMarkerSymbol"],function(d){a(p(d))},c)})).then(a=>new a.default);if("polyline"===b)return(new Promise(function(a,c){n(["../../symbols/SimpleLineSymbol"],function(d){a(p(d))},c)})).then(a=>new a.default);if("polygon"===b||"mesh"===b||"multipatch"===b)return(new Promise(function(a,c){n(["../../symbols/SimpleFillSymbol"],function(d){a(p(d))},
c)})).then(a=>new a.default)};return r}(w.HandleOwnerMixin(e));g.__decorate([h.property({aliasOf:"template.description"})],e.prototype,"description",void 0);g.__decorate([h.property({aliasOf:"template.name"})],e.prototype,"label",void 0);g.__decorate([h.property()],e.prototype,"layer",void 0);g.__decorate([h.property()],e.prototype,"template",void 0);g.__decorate([h.property({readOnly:!0})],e.prototype,"thumbnail",void 0);return e=q=g.__decorate([y.subclass("esri.widgets.FeatureTemplates.TemplateItem")],
e)});