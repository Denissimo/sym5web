// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),function(b,l,m,z,C,A,g,k,w,u,x,y){m=function(t){function p(q){q=
t.call(this,q)||this;q.enabled=!1;q.enabledToggled=!1;q.selfEnabled=!0;q.featureEnabled=!0;q.featureSources=new z;q.distance=y.defaults.distance;q.touchSensitivityMultiplier=y.defaults.touchSensitivityMultiplier;return q}b._inheritsLoose(p,t);b._createClass(p,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&
this.featureEnabled}}]);return p}(m);l.__decorate([C.property()],m.prototype,"enabled",void 0);l.__decorate([C.property()],m.prototype,"enabledToggled",void 0);l.__decorate([C.property()],m.prototype,"selfEnabled",void 0);l.__decorate([C.property()],m.prototype,"featureEnabled",void 0);l.__decorate([C.property({type:z.ofType(x)})],m.prototype,"featureSources",void 0);l.__decorate([C.property()],m.prototype,"distance",void 0);l.__decorate([C.property()],m.prototype,"touchSensitivityMultiplier",void 0);
l.__decorate([C.property({readOnly:!0})],m.prototype,"effectiveEnabled",null);l.__decorate([C.property({readOnly:!0})],m.prototype,"effectiveSelfEnabled",null);l.__decorate([C.property({readOnly:!0})],m.prototype,"effectiveFeatureEnabled",null);return m=l.__decorate([u.subclass("esri.views.interactive.snapping.SnappingOptions")],m)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w){m=function(u){function x(y){y=u.call(this,y)||this;y.layer=null;y.enabled=!0;y.updating=!1;y.availability=1;return y}b._inheritsLoose(x,u);return x}(m);l.__decorate([z.property({constructOnly:!0})],m.prototype,"layer",void 0);l.__decorate([z.property()],m.prototype,"enabled",void 0);l.__decorate([z.property()],m.prototype,"updating",void 0);l.__decorate([z.property()],m.prototype,"availability",void 0);return m=l.__decorate([w.subclass("esri.views.interactive.snapping.SnappingLayerSource")],
m)})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,l,m,z,C,A,g){let k=function(w){function u(){var x=w.apply(this,arguments)||this;x.enabled=!0;return x}l._inheritsLoose(u,w);return u}(C.JSONSupport);m.__decorate([A.property({type:Boolean})],k.prototype,
"enabled",void 0);k=m.__decorate([g.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],k);C=function(w){function u(x){x=w.call(this,x)||this;x.lineSnapper=new k;x.parallelLineSnapper=new k;x.rightAngleSnapper=new k;x.rightAngleTriangleSnapper=new k;x.shortLineThreshold=15;x.distance=5;x.pointThreshold=1E-6;x.intersectionParallelLineThreshold=1E-6;x.parallelLineThreshold=1E-6;x.touchSensitivityMultiplier=1.5;x.pointOnLineThreshold=1E-6;x.orange=new z([255,127,0]);x.lineHintWidthReference=
3;x.lineHintWidthTarget=3;x.lineHintFadedExtensions=.3;x.parallelLineHintWidth=2;x.parallelLineHintLength=24;x.parallelLineHintOffset=1.5;x.rightAngleHintSize=24;x.rightAngleHintOutlineSize=1.5;return x}l._inheritsLoose(u,w);return u}(C.JSONSupport);m.__decorate([A.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],C.prototype,"lineSnapper",void 0);m.__decorate([A.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],C.prototype,"parallelLineSnapper",void 0);m.__decorate([A.property({type:k,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],C.prototype,"rightAngleSnapper",void 0);m.__decorate([A.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],C.prototype,"rightAngleTriangleSnapper",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],C.prototype,"shortLineThreshold",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],C.prototype,"distance",void 0);m.__decorate([A.property({type:Number,
nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],C.prototype,"pointThreshold",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],C.prototype,"intersectionParallelLineThreshold",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],C.prototype,"parallelLineThreshold",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],C.prototype,"touchSensitivityMultiplier",
void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],C.prototype,"pointOnLineThreshold",void 0);m.__decorate([A.property({type:z,nonNullable:!0})],C.prototype,"orange",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],C.prototype,"lineHintWidthReference",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],C.prototype,"lineHintWidthTarget",void 0);m.__decorate([A.property({type:Number,
nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],C.prototype,"lineHintFadedExtensions",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],C.prototype,"parallelLineHintWidth",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],C.prototype,"parallelLineHintLength",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],C.prototype,"parallelLineHintOffset",
void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],C.prototype,"rightAngleHintSize",void 0);m.__decorate([A.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],C.prototype,"rightAngleHintOutlineSize",void 0);C=m.__decorate([g.subclass("esri.views.interactive.snapping.Settings.Defaults")],C);m=new C;b.defaults=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/FeatureForm":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../chunks/switch ../intl ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../intl/moment ../layers/support/domains ../layers/support/fieldUtils ./Widget ./FeatureForm/FeatureFormViewModel ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/locale".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v){m=function(E){function n(f,D){var H=E.call(this,f,D)||this;H._activeDateEdit=null;H._activeInputName=null;H._fieldFocusNeeded=!1;H._fieldToInitialIncompatibleDomainValue=new Map;H._switchFieldsWithInitialIncompatibleValue=new Set;H._moment=null;H._userUpdatedInputFieldNames=new Set;H.description=null;H.feature=null;H.fieldConfig=null;H.formTemplate=null;H.groupDisplay="all";H.headingLevel=2;H.label=void 0;H.layer=null;H.messages=null;H.strict=
null;H.title=null;H.viewModel=new d;H._handleRadioInputChange=P=>{H._updateFieldValue(P.target)};H._handleFormKeyDown=H._handleFormKeyDown.bind(b._assertThisInitialized(H));H._handleInputBlur=H._handleInputBlur.bind(b._assertThisInitialized(H));H._handleInputFocus=H._handleInputFocus.bind(b._assertThisInitialized(H));H._handleNumberInputMouseDown=H._handleNumberInputMouseDown.bind(b._assertThisInitialized(H));H._handleInputKeyDown=H._handleInputKeyDown.bind(b._assertThisInitialized(H));H._handleOptionChange=
H._handleOptionChange.bind(b._assertThisInitialized(H));H._handleGroupClick=H._handleGroupClick.bind(b._assertThisInitialized(H));H._handleSubmit=H._handleSubmit.bind(b._assertThisInitialized(H));H._afterInputCreateOrUpdate=H._afterInputCreateOrUpdate.bind(b._assertThisInitialized(H));return H}b._inheritsLoose(n,E);var B=n.prototype;B.loadLocale=function(){var f=b._asyncToGenerator(function*(){this._moment=yield y.loadMoment()});return function(){return f.apply(this,arguments)}}();B.initialize=function(){this.own(this.watch("feature",
()=>{const f=this._getFocusableInput("forward");this._activeInputName=f&&f.name;this._userUpdatedInputFieldNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();this._switchFieldsWithInitialIncompatibleValue.clear();this._fieldFocusNeeded=!0}),this.on("submit",f=>{if(0<f.invalid.length){const [D]=f.invalid;f.invalid.forEach(H=>this._userUpdatedInputFieldNames.add(H));this._activeInputName=D;this._fieldFocusNeeded=!0;this.scheduleRender()}}))};B.destroy=function(){this._userUpdatedInputFieldNames.clear();
this._userUpdatedInputFieldNames=null};B.getValues=function(){return null};B.submit=function(){return null};B.render=function(){const {state:f}=this.viewModel;return h.tsx("div",{class:this.classes("esri-feature-form","esri-widget","esri-widget--panel")},"ready"===f?this.renderForm():null)};B.renderForm=function(){var f=this.title?h.tsx(a.Heading,{key:"title",level:this.headingLevel},this.title):null;const D=this.description?h.tsx("p",{class:"esri-feature-form__description-text",key:"description"},
this.description):null;f=f||D?h.tsx("div",{class:"esri-feature-form__form-header"},f,D):null;return h.tsx("form",{class:"esri-feature-form__form",novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},f,this.renderFields())};B.renderFields=function(){const {viewModel:{inputFields:f}}=this;return f.map((D,H)=>D&&D.inputFields?this.renderGroup(D,H):this.renderLabeledField(D))};B.renderGroup=function(f,D){const {description:H,inputFields:P,label:R,state:K}=f;var J=this.viewModel.findField(this._activeInputName);
J=!(!J||J.group!==f);const Q=`${this.id}_group_${D}`,F=`${this.id}_group-label_${D}`,O=`${this.id}_group-description_${D}`,V=H?h.tsx("p",{class:this.classes("esri-feature-form__group-description","esri-feature-form__description-text"),id:O},H):null,M="sequential"===this.groupDisplay,T=M?J:"expanded"===K,S=T?"esri-icon-up":"esri-icon-down";return h.tsx("fieldset",{"aria-expanded":T.toString(),"aria-labelledby":F,"aria-describedby":H?O:"",class:this.classes("esri-feature-form__group",M?"esri-feature-form__group--sequential":
null,T?null:"esri-feature-form__group--collapsed",J?"esri-feature-form__group--active":null),"data-group":f,id:Q,key:D,onclick:this._handleGroupClick},h.tsx("button",{role:M?"presentation":void 0,class:"esri-feature-form__group-header",type:"button",tabIndex:M?-1:0},h.tsx("div",{class:"esri-feature-form__group-title"},h.tsx(a.Heading,{class:"esri-feature-form__group-label",id:F,level:this.headingLevel+(this.title?1:0)},R),V),M?null:h.tsx("span",{class:this.classes(S,"esri-feature-form__group-toggle-icon")})),
P.map(L=>this.renderLabeledField(L)))};B._getFocusableInput=function(f,D){var H=this.viewModel._allInputFields;H="forward"===f?H:H.slice().reverse();D?D&&D.inputFields?f=H.indexOf(D.inputFields[0]):(this._isFieldInClosedCollapsibleGroup(D)?({inputFields:D}=D.group,f="forward"===f?D[D.length-1]:D[0]):f=D,f=H.indexOf(f)+1):f=0;for(;f<H.length;f++)if(D=H[f],D.visible&&D.editable)return D;return null};B.renderLabeledField=function(f){const {label:D,layer:H,type:P}=f;return h.tsx("label",{key:`${H.id}-${f.name}`,
class:"esri-feature-form__label"},[D,"unsupported"!==P?this.renderInputField(f):this.renderUnsupportedField(f),this.renderAuxiliaryText(f)])};B.renderInputField=function(f){var {viewModel:D}=this;const {domain:H,editable:P,name:R,type:K}=f;D=D.getValue(R);const J=!P,Q=this.getCommonInputProps(f);if("coded-value"===(null==H?void 0:H.type)&&!J){if("switch"===f.editorType)if(this._switchFieldsWithInitialIncompatibleValue.has(R)||null==D||f.config.onValue!==D&&f.config.offValue!==D)this._switchFieldsWithInitialIncompatibleValue.add(R);
else return this.renderSwitchInputField(D,Q);return"radio-buttons"===f.editorType?this.renderRadioButtonsInputField(D,H.codedValues.map(({code:F,name:O})=>({value:F,name:O})),Q):this.renderSelectInputField(D,H.codedValues.map(({code:F,name:O})=>({value:F,name:O})),Q)}return"text"===K&&"text-area"===f.editorType||"rich-text"===f.editorType?h.tsx("textarea",{...Q}):"datetime-picker"===f.editorType||"date"===K?this.renderDateInputField(D,Q):h.tsx("input",{type:"text"===K?"text":"number",...Q})};B.renderDateInputField=
function(f,D){const {date:H,time:P}=this._formatDate(0);var R=`${this.id}-${D.key}`;const K=`${R}-date`;R=`${R}-time`;const J=D["data-field"],{includeTime:Q}=J,{date:F,time:O}=this._formatDate(f);return h.tsx("div",{key:`${D.key}-date`,class:"esri-feature-form__date-input-container"},h.tsx("div",{class:this.classes("esri-feature-form__date-input-part",Q?null:"esri-feature-form__date-input-part--lone")},h.tsx("input",{"aria-label":J.label,"aria-describedby":K,type:"text",...D,"data-date-part":"date",
class:this.classes(D.class,"esri-feature-form__input--date"),value:F}),h.tsx("div",{class:"esri-feature-form__date-format-hint",id:K},H)),Q?h.tsx("div",{class:"esri-feature-form__date-input-part",key:"time-input"},h.tsx("input",{"aria-describedby":R,"aria-label":J.label,type:"text",...D,"data-date-part":"time",class:this.classes(D.class,"esri-feature-form__input--time"),value:O}),h.tsx("div",{class:"esri-feature-form__date-format-hint",id:R},P)):null)};B.renderUnsupportedField=function(f){f=this.viewModel.getValue(f.name);
return h.tsx("input",{class:this.classes("esri-input","esri-feature-form__input","esri-feature-form__input--disabled"),disabled:!0,type:"text",value:`${f}`})};B.renderSelectInputField=function(f,D,H){const P=D.map(J=>h.tsx("option",{value:`${J.value}`,key:J.name},J.name)),R=H["data-field"];this.registerIncompatibleValue(f,D,R,J=>{P.unshift(h.tsx("option",{value:`${J}`,key:"incompatible-option",disabled:!0},J))});if(!R.required&&("combo-box"!==R.editorType||R.config.showNoValueOption)){var K;f=(null==
(K=R.config)?void 0:K.noValueOptionLabel)||this.messages.empty;P.unshift(h.tsx("option",{value:"",key:"empty-option"},f))}return h.tsx("select",{...H,class:this.classes(H.class,"esri-select"),onchange:this._handleOptionChange},P)};B.registerIncompatibleValue=function(f,D,H,P){const R=this._fieldToInitialIncompatibleDomainValue,K=R.has(H.name);if(K||null!=f&&""!==f&&!D.find(J=>J.value===f)||K)K||R.set(H.name,f),null==P?void 0:P(R.get(H.name))};B.renderRadioButtonsInputField=function(f,D,H){const P=
H["data-field"],R=D.map(J=>this.renderRadioButton({key:J.name,label:J.name,name:P.name,value:J.value,selected:J.value===f,props:H}));this.registerIncompatibleValue(f,D,P);if(!P.required&&(!P.config||P.config.showNoValueOption)){var K;D=(null==(K=P.config)?void 0:K.noValueOptionLabel)||this.messages.empty;R.unshift(this.renderRadioButton({key:"empty-option",label:D,name:P.name,value:"",selected:""===f||null===f,props:H}))}return h.tsx("div",{key:`${H.key}-radio`,class:"esri-feature-form__input--radio-group"},
R)};B.renderSwitchInputField=function(f,D){return h.tsx("calcite-switch",{...D,class:"esri-feature-form__input--switch",switched:f===D["data-field"].config.onValue,onCalciteSwitchChange:H=>{this._parseValue(H.currentTarget)}})};B.renderRadioButton=function({key:f,name:D,value:H,selected:P,label:R,props:K}){return h.tsx("label",{key:f,class:"esri-feature-form__input--radio-label"},h.tsx("input",{...K,class:"esri-feature-form__input--radio",name:D,type:"radio",value:H,checked:P,onchange:this._handleRadioInputChange}),
R)};B.renderAuxiliaryText=function(f){if(this._userUpdatedInputFieldNames.has(f.name)&&!f.valid)return h.tsx("div",{key:"error-message"},h.tsx("span",{class:this.classes("esri-feature-form__input-icon--invalid","esri-icon-notice-triangle")}),h.tsx("div",{class:"esri-feature-form__field-error-message"},f.errorMessage));if(f.description)return h.tsx("div",{key:"description",class:"esri-feature-form__description-text"},f.description)};B.getCommonInputProps=function(f){const {groupDisplay:D,viewModel:H}=
this,{editable:P,group:R,hint:K,maxLength:J,minLength:Q,name:F,required:O,type:V,valid:M}=f,T=H.getValue(F),S=this._userUpdatedInputFieldNames.has(F),L=!P,N="all"===D&&"collapsed"===(null==R?void 0:R.state);return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":M?"false":"true","class":this.classes("esri-input","esri-feature-form__input",L?"esri-feature-form__input--disabled":null,S&&!M?"esri-feature-form__input--invalid":null),key:F,minlength:-1<
Q?`${Q}`:"",maxlength:-1<J?`${J}`:"",...this._getNumberFieldConstraints(f),disabled:L,value:null==T?"":`${T}`,"data-field":f,onfocus:this._handleInputFocus,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===V?this._handleNumberInputMouseDown:null,placeholder:"number"===V||"text"===V?K:"",required:O,tabIndex:N?-1:0}};B._isFieldInClosedCollapsibleGroup=function(f){var D;return"all"===this.groupDisplay&&!(f&&f.inputFields)&&"collapsed"===(null==f?void 0:null==(D=f.group)?
void 0:D.state)};B._handleNumberInputMouseDown=function({target:f}){f.disabled||f.focus();this.scheduleRender()};B._getNumberFieldConstraints=function(f){return(f=t.getDomainRange(f.domain)||p.getFieldRange(f.field))&&f.max!==Number.MAX_VALUE&&f.min!==Number.MIN_VALUE?f:{min:null,max:null}};B._afterInputCreateOrUpdate=function(f){const D=f["data-field"],H=this.viewModel.findField(this._activeInputName),P=this._fieldToInitialIncompatibleDomainValue.get(D.name)===D.value;D.editable&&this._fieldFocusNeeded&&
H===D&&("radio-buttons"!==D.editorType||P||f.checked)&&(this._fieldFocusNeeded=!1,f.focus())};B._handleInputFocus=function(f){this._activeInputName=f.target["data-field"].name};B._handleInputBlur=function(f){var D=f.target;const H=D["data-field"],P=(f=f.relatedTarget)&&f["data-field"];this._syncDateEditsBeforeValueCommit(D);if(P&&"date"===H.type&&"date"===P.type&&H.field===P.field)""!==D.value&&""===f.value&&(D=f.getAttribute("data-date-part"),f.value=this._formatDate(Date.now())[D]);else if("radio-buttons"!==
H.editorType||D.checked)this._commitValue(D),this.scheduleRender()};B._commitValue=function(f){var D=f["data-field"];if(this._activeDateEdit){const {date:P,time:R}=this._activeDateEdit;var H=this._getDateEditValue(D,"date");D=this._getDateEditValue(D,"time");const K=""===H||""===D;if(P){const {input:J}=P;J.value=K?"":H}R&&({input:H}=R,H.value=K?"":D);this._activeDateEdit=null;if(P&&R){this._updateDateFieldValue(P.input,R.input);return}}this._updateFieldValue(f)};B._getDateEditValue=function(f,D){var H=
this._activeDateEdit[D];if(H){var {value:P}=H;return""===P?"":(H=this._parseDate(H.value,D))?this._formatDate(H.getTime())[D]:this._formatDate(f.value)[D]}};B._handleInputKeyDown=function(f){const {key:D,altKey:H,ctrlKey:P,metaKey:R,shiftKey:K}=f;var J=f.target,Q=J["data-field"];if("Tab"===D){var F=K?"backward":"forward",O=J.getAttribute("data-date-part");this._syncDateEditsBeforeValueCommit(J);"backward"===F&&"time"===O||"forward"===F&&"date"===O&&Q.includeTime||(this._commitValue(J),J=this.viewModel.findField(Q.name),
F=this._getFocusableInput(F,J),J=J.group===(null==F?void 0:F.group),this._activeInputName=null==F?void 0:F.name,F&&("sequential"===this.groupDisplay||J)?(f.preventDefault(),this._fieldFocusNeeded=!0):this.renderNow())}else"Enter"!==D?({type:J}=Q.field,F="single"===J||"double"===J,"integer"!==J&&"small-integer"!==J&&!F||H||P||R||1!==D.length||(J=Number(D),Q=["-","+"],O=["e","."],F=F?[...Q,...O]:Q,isNaN(J)&&-1===F.indexOf(D)&&f.preventDefault())):this._isFieldInClosedCollapsibleGroup(Q)?Q.group.state=
"expanded":(this._updateFieldValue(f.target),this.scheduleRender())};B._syncDateEditsBeforeValueCommit=function(f){if("date"===f["data-field"].type){var D=f.getAttribute("data-date-part");this._activeDateEdit={...this._activeDateEdit,[D]:{value:f.value,input:f}}}};B._updateFieldValue=function(f){const D=f["data-field"];this.viewModel.setValue(D.name,this._parseValue(f));this._userUpdatedInputFieldNames.add(D.name)};B._updateDateFieldValue=function(f,D){const H=f["data-field"];this.viewModel.setValue(H.name,
this._parseDateTimeValue(f,D));this._userUpdatedInputFieldNames.add(H.name)};B._parseValue=function(f){var D=f["data-field"],H=f.value;if("switch"===D.editorType&&!(f instanceof HTMLSelectElement))return f.switched?D.config.onValue:D.config.offValue;if("radio-buttons"===D.editorType&&"radio"===f.type&&!f.checked)return D.value;var {type:P}=D;if("number"===P)return H?parseFloat(H):null;if("date"===P){if(!H)return null;P=Number(H);if(!isNaN(P))return P;f=f.getAttribute("data-date-part");P=this._parseDate(H,
f);if(!P)return null;H=this._moment;P=H(P);var R=D.domain;const K=H();let J=K;R&&"range"===R.type&&(R=H(R.maxValue),K.isAfter(R)||(J=R));D=this.viewModel.getValue(D.name);D=H(null!=D?D:J);"date"===f?(P.hour(D.hour()),P.minutes(D.minutes()),P.seconds(D.seconds())):(P.date(D.date()),P.month(D.month()),P.year(D.year()));return P.valueOf()}return H};B._parseDateTimeValue=function(f,D){f=f.value;D=D.value;if(!f||!D)return null;f=this._parseDate(f,"date");D=this._parseDate(D,"time");if(!f||!D)return null;
f=this._moment(f);D=this._moment(D);f.hour(D.hour());f.minutes(D.minutes());f.seconds(D.seconds());return f.valueOf()};B._handleOptionChange=function(f){this._updateFieldValue(f.target);this.scheduleRender()};B._handleGroupClick=function(f){var D;const H=f.currentTarget["data-group"],P="expanded"===H.state,R="sequential"===this.groupDisplay;if(!P||f.target.closest(".esri-feature-form__group-header")){this._activeInputName=null==(D=this._getFocusableInput("forward",H))?void 0:D.name;if(R){f=f.target.closest(".esri-feature-form__group-header");
if(P&&!f)return;this.viewModel.inputFields.forEach(K=>{K&&K.inputFields&&K!==H&&(K.state="collapsed")})}H.state=P?"collapsed":"expanded";this._fieldFocusNeeded=R;this.scheduleRender()}};B._handleSubmit=function(f){f.preventDefault()};B._handleFormKeyDown=function(f){"Enter"===f.key&&this.viewModel.submit()};B._formatDate=function(f){if(null==f)return{date:"",time:""};f=this._moment(f);return{date:f.format("L"),time:f.format("LTS")}};B._parseDate=function(f,D){if(null==f||""===f)return null;f=this._moment(f,
"date"===D?"L":"LTS",v.getLocale(),!1);return f.isValid()?f.toDate():null};return n}(q);l.__decorate([C.aliasOf("viewModel.description")],m.prototype,"description",void 0);l.__decorate([C.aliasOf("viewModel.feature")],m.prototype,"feature",void 0);l.__decorate([C.aliasOf("viewModel.fieldConfig")],m.prototype,"fieldConfig",void 0);l.__decorate([C.aliasOf("viewModel.formTemplate")],m.prototype,"formTemplate",void 0);l.__decorate([u.property()],m.prototype,"groupDisplay",void 0);l.__decorate([u.property()],
m.prototype,"headingLevel",void 0);l.__decorate([u.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],m.prototype,"label",void 0);l.__decorate([C.aliasOf("viewModel.layer")],m.prototype,"layer",void 0);l.__decorate([u.property(),r.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],m.prototype,"messages",void 0);l.__decorate([C.aliasOf("viewModel.strict")],m.prototype,"strict",void 0);l.__decorate([C.aliasOf("viewModel.title")],m.prototype,"title",void 0);l.__decorate([u.property(),
e.vmEvent(["value-change","submit"])],m.prototype,"viewModel",void 0);l.__decorate([C.aliasOf("viewModel.getValues")],m.prototype,"getValues",null);l.__decorate([C.aliasOf("viewModel.submit")],m.prototype,"submit",null);return m=l.__decorate([x.subclass("esri.widgets.FeatureForm")],m)})},"esri/chunks/switch":function(){define(["./utils"],function(b){b.register({"calcite-switch":b.CalciteSwitch})})},"esri/intl/moment":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","./locale"],
function(b,l,m,z){function C(){C=m._asyncToGenerator(function*(g=z.getLocale()){const k=(yield(new Promise(function(u,x){b(["../chunks/moment"],u,x)})).then(function(u){return u.moment})).default;g=g.toLowerCase();let w=A.has(g);if(!w){const u=g.split("-");1<u.length&&A.has(u[0])&&(g=u[0],w=!0)}w?yield A.get(g)():g="en";g!==k.locale()&&k.locale(g);return k});return C.apply(this,arguments)}const A=new Map([["ar",()=>(new Promise(function(g,k){b(["../chunks/ar"],g,k)})).then(function(g){return g.ar})],
["ar-dz",()=>(new Promise(function(g,k){b(["../chunks/ar-dz"],g,k)})).then(function(g){return g.arDz})],["ar-kw",()=>(new Promise(function(g,k){b(["../chunks/ar-kw"],g,k)})).then(function(g){return g.arKw})],["ar-ly",()=>(new Promise(function(g,k){b(["../chunks/ar-ly"],g,k)})).then(function(g){return g.arLy})],["ar-ma",()=>(new Promise(function(g,k){b(["../chunks/ar-ma"],g,k)})).then(function(g){return g.arMa})],["ar-sa",()=>(new Promise(function(g,k){b(["../chunks/ar-sa"],g,k)})).then(function(g){return g.arSa})],
["ar-tn",()=>(new Promise(function(g,k){b(["../chunks/ar-tn"],g,k)})).then(function(g){return g.arTn})],["bs",()=>(new Promise(function(g,k){b(["../chunks/bs"],g,k)})).then(function(g){return g.bs})],["ca",()=>(new Promise(function(g,k){b(["../chunks/ca"],g,k)})).then(function(g){return g.ca})],["cs",()=>(new Promise(function(g,k){b(["../chunks/cs"],g,k)})).then(function(g){return g.cs})],["da",()=>(new Promise(function(g,k){b(["../chunks/da"],g,k)})).then(function(g){return g.da})],["de",()=>(new Promise(function(g,
k){b(["../chunks/de"],g,k)})).then(function(g){return g.de})],["de-at",()=>(new Promise(function(g,k){b(["../chunks/de-at"],g,k)})).then(function(g){return g.deAt})],["de-ch",()=>(new Promise(function(g,k){b(["../chunks/de-ch"],g,k)})).then(function(g){return g.deCh})],["el",()=>(new Promise(function(g,k){b(["../chunks/el"],g,k)})).then(function(g){return g.el})],["en-au",()=>(new Promise(function(g,k){b(["../chunks/en-au"],g,k)})).then(function(g){return g.enAu})],["en-ca",()=>(new Promise(function(g,
k){b(["../chunks/en-ca"],g,k)})).then(function(g){return g.enCa})],["en-gb",()=>(new Promise(function(g,k){b(["../chunks/en-gb"],g,k)})).then(function(g){return g.enGb})],["en-ie",()=>(new Promise(function(g,k){b(["../chunks/en-ie"],g,k)})).then(function(g){return g.enIe})],["en-il",()=>(new Promise(function(g,k){b(["../chunks/en-il"],g,k)})).then(function(g){return g.enIl})],["en-in",()=>(new Promise(function(g,k){b(["../chunks/en-in"],g,k)})).then(function(g){return g.enIn})],["en-nz",()=>(new Promise(function(g,
k){b(["../chunks/en-nz"],g,k)})).then(function(g){return g.enNz})],["en-sg",()=>(new Promise(function(g,k){b(["../chunks/en-sg"],g,k)})).then(function(g){return g.enSg})],["es",()=>(new Promise(function(g,k){b(["../chunks/es"],g,k)})).then(function(g){return g.es})],["es-do",()=>(new Promise(function(g,k){b(["../chunks/es-do"],g,k)})).then(function(g){return g.esDo})],["es-mx",()=>(new Promise(function(g,k){b(["../chunks/es-mx"],g,k)})).then(function(g){return g.esMx})],["es-us",()=>(new Promise(function(g,
k){b(["../chunks/es-us"],g,k)})).then(function(g){return g.esUs})],["et",()=>(new Promise(function(g,k){b(["../chunks/et"],g,k)})).then(function(g){return g.et})],["fi",()=>(new Promise(function(g,k){b(["../chunks/fi"],g,k)})).then(function(g){return g.fi})],["fr",()=>(new Promise(function(g,k){b(["../chunks/fr"],g,k)})).then(function(g){return g.fr})],["fr-ca",()=>(new Promise(function(g,k){b(["../chunks/fr-ca"],g,k)})).then(function(g){return g.frCa})],["fr-ch",()=>(new Promise(function(g,k){b(["../chunks/fr-ch"],
g,k)})).then(function(g){return g.frCh})],["he",()=>(new Promise(function(g,k){b(["../chunks/he"],g,k)})).then(function(g){return g.he})],["hr",()=>(new Promise(function(g,k){b(["../chunks/hr"],g,k)})).then(function(g){return g.hr})],["hu",()=>(new Promise(function(g,k){b(["../chunks/hu"],g,k)})).then(function(g){return g.hu})],["id",()=>(new Promise(function(g,k){b(["../chunks/id"],g,k)})).then(function(g){return g.id})],["it",()=>(new Promise(function(g,k){b(["../chunks/it"],g,k)})).then(function(g){return g.it})],
["it-ch",()=>(new Promise(function(g,k){b(["../chunks/it-ch"],g,k)})).then(function(g){return g.itCh})],["ja",()=>(new Promise(function(g,k){b(["../chunks/ja"],g,k)})).then(function(g){return g.ja})],["ko",()=>(new Promise(function(g,k){b(["../chunks/ko"],g,k)})).then(function(g){return g.ko})],["lt",()=>(new Promise(function(g,k){b(["../chunks/lt"],g,k)})).then(function(g){return g.lt})],["lv",()=>(new Promise(function(g,k){b(["../chunks/lv"],g,k)})).then(function(g){return g.lv})],["nb",()=>(new Promise(function(g,
k){b(["../chunks/nb"],g,k)})).then(function(g){return g.nb})],["nl",()=>(new Promise(function(g,k){b(["../chunks/nl"],g,k)})).then(function(g){return g.nl})],["nl-be",()=>(new Promise(function(g,k){b(["../chunks/nl-be"],g,k)})).then(function(g){return g.nlBe})],["pl",()=>(new Promise(function(g,k){b(["../chunks/pl"],g,k)})).then(function(g){return g.pl})],["pt",()=>(new Promise(function(g,k){b(["../chunks/pt"],g,k)})).then(function(g){return g.pt})],["pt-br",()=>(new Promise(function(g,k){b(["../chunks/pt-br"],
g,k)})).then(function(g){return g.ptBr})],["ro",()=>(new Promise(function(g,k){b(["../chunks/ro"],g,k)})).then(function(g){return g.ro})],["ru",()=>(new Promise(function(g,k){b(["../chunks/ru"],g,k)})).then(function(g){return g.ru})],["sk",()=>(new Promise(function(g,k){b(["../chunks/sk"],g,k)})).then(function(g){return g.sk})],["sl",()=>(new Promise(function(g,k){b(["../chunks/sl"],g,k)})).then(function(g){return g.sl})],["sr",()=>(new Promise(function(g,k){b(["../chunks/sr"],g,k)})).then(function(g){return g.sr})],
["sr-cyrl",()=>(new Promise(function(g,k){b(["../chunks/sr-cyrl"],g,k)})).then(function(g){return g.srCyrl})],["sv",()=>(new Promise(function(g,k){b(["../chunks/sv"],g,k)})).then(function(g){return g.sv})],["th",()=>(new Promise(function(g,k){b(["../chunks/th"],g,k)})).then(function(g){return g.th})],["tr",()=>(new Promise(function(g,k){b(["../chunks/tr"],g,k)})).then(function(g){return g.tr})],["uk",()=>(new Promise(function(g,k){b(["../chunks/uk"],g,k)})).then(function(g){return g.uk})],["vi",()=>
(new Promise(function(g,k){b(["../chunks/vi"],g,k)})).then(function(g){return g.vi})],["zh-cn",()=>(new Promise(function(g,k){b(["../chunks/zh-cn"],g,k)})).then(function(g){return g.zhCn})],["zh-hk",()=>(new Promise(function(g,k){b(["../chunks/zh-hk"],g,k)})).then(function(g){return g.zhHk})],["zh-mo",()=>(new Promise(function(g,k){b(["../chunks/zh-mo"],g,k)})).then(function(g){return g.zhMo})],["zh-tw",()=>(new Promise(function(g,k){b(["../chunks/zh-tw"],g,k)})).then(function(g){return g.zhTw})]]);
l.loadMoment=function(){return C.apply(this,arguments)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../intl ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/ReentrantObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../form/FormTemplate ../../support/arcadeOnDemand ./FieldConfig ./FieldGroupConfig ./InputField ./InputFieldGroup ./support/formTemplateUtils ../../intl/locale ../../intl/messages".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E){function n(D){return!!D.fieldConfig}const B=new m({attributes:{}}),f=g.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel");m=function(D){function H(R){R=D.call(this,R)||this;R._arcade=null;R._fieldPool=new k.ReentrantObjectPool(r);R._fieldGroupPool=new k.ReentrantObjectPool(e);R._featureClone=B.clone();R._initialFeature=B.clone();R._needsArcade=!1;R.messages=null;R.strict=!1;return R}b._inheritsLoose(H,D);var P=H.prototype;P.initialize=
function(){var R=this;const K=function(){var Q=b._asyncToGenerator(function*(){return R.messages=yield E.fetchMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")});return function(){return Q.apply(this,arguments)}}();K();this.handles.add(v.onLocaleChange(K));const J=w.init(this,"fieldConfig",function(){var Q=b._asyncToGenerator(function*(F){const O=[];F&&F.forEach(M=>{O.push(M.visibilityExpression);M.fieldConfig?M.fieldConfig.forEach(({requiredExpression:T,visibilityExpression:S})=>{O.push(T,
S)}):O.push(M.requiredExpression)});F=O.filter(M=>!!M);const V=0<F.length;if(V){const M=yield d.loadArcade(),{arcadeUtils:T}=M;F.some(S=>T.hasGeometryOperations(S))&&(yield T.enableGeometryOperations(),J.remove());R._arcade=M;R.notifyChange("inputFields")}R._needsArcade=V});return function(F){return Q.apply(this,arguments)}}());this.handles.add(J)};P.destroy=function(){this.layer=this.feature=this.fieldConfig=null;this._fieldPool.destroy();this._fieldGroupPool.destroy()};P.castFieldConfig=function(R){return R?
R.map(K=>K instanceof a||K instanceof c?K:K.fieldConfig?new c(K):new a(K)):null};P.findField=function(R){return this._allInputFields.find(K=>K.name===R)};P.getValue=function(R){var K;const {_featureClone:J,layer:Q}=this,F=!(null==Q||!Q.getField(R));return null!=(K=J.getAttribute(R))?K:F?null:void 0};P.setValue=function(R,K){const {_featureClone:J,strict:Q}=this,F=this.findField(R);K=""===K?null:K;if(F&&J.getAttribute(R)!==K){F.value=K;if(this.get("layer.typeIdField")===F.name&&"types"in this.layer){const O=
new Set;this.layer.types.forEach(V=>Object.keys(V.domains).forEach(M=>O.add(M)));O.forEach(V=>{(V=this.findField(V))&&V.notifyChange("domain")})}if(!Q||F.valid)J.setAttribute(R,K),this.notifyChange("inputFields"),this._emitChangeEvent(F)}};P.getValues=function(){return{...this._featureClone.attributes}};P.submit=function(){var R=this._allInputFields;const K=R.filter(Q=>Q.valid).map(({name:Q})=>Q);R=R.filter(Q=>!Q.valid).map(({name:Q})=>Q);const J=this.getValues();this.emit("submit",{valid:K,invalid:R,
values:J})};P._disposeInputOrGroup=function(R){R.inputFields?this._disposeGroup(R):this._disposeInput(R)};P._disposeGroup=function(R){R.inputFields.forEach(K=>this._disposeInput(K));this._fieldGroupPool.release(R)};P._disposeInput=function(R){this._fieldPool.release(R)};P._emitChangeEvent=function({name:R,valid:K,value:J}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:R,value:J,valid:K})};b._createClass(H,[{key:"_allInputFields",get:function(){return this.inputFields.reduce((R,
K)=>K.inputFields?[...R,...K.inputFields]:[...R,K],[])}},{key:"_inputFieldCache",get:function(){const R=this._get("_inputFieldCache")||new Map;R.forEach(K=>this._disposeInputOrGroup(K));R.clear();(this.get("layer.fields")||[]).forEach(K=>R.set(K,this._fieldPool.acquire()));return R}},{key:"_inputFieldGroupCache",get:function(){const R=this._get("_inputFieldGroupCache")||new Map;R.forEach(K=>this._disposeInputOrGroup(K));R.clear();(this.fieldConfig||[]).filter(n).forEach(K=>R.set(K,this._fieldGroupPool.acquire()));
return R}},{key:"description",get:function(){var R;return null==(R=this.formTemplate)?void 0:R.description},set:function(R){void 0===R?this._clearOverride("description"):this._override("description",R)}},{key:"feature",get:function(){return this._get("feature")},set:function(R){this._featureClone=R?R.clone():B.clone();this._initialFeature=this._featureClone.clone();this._set("feature",R)}},{key:"fieldConfig",get:function(){const {formTemplate:R}=this;if(!R)return null;const {config:K,encounteredUnsupportedTypes:J}=
h.fieldConfigsFromFormTemplate(R);0<J.length&&f.warn("form-info::unsupported-type","encountered unsupported elements/types when parsing form info",J);return K},set:function(R){R?this._override("fieldConfig",R):this._clearOverride("fieldConfig")}},{key:"formTemplate",get:function(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null},set:function(R){void 0===R?this._clearOverride("formTemplate"):this._override("formTemplate",R)}},{key:"inputFields",get:function(){const {_arcade:R,
_inputFieldCache:K,_inputFieldGroupCache:J,_featureClone:Q,messages:F,_needsArcade:O,layer:V,state:M}=this,T=Q.clone();if("ready"!==M||O&&!R)return[];const S=this.get("layer.fields")||[],L=this.fieldConfig||[];return(0!==L.length?L.map(N=>{if(N.fieldConfig){const ka=J.get(N);var U=N.fieldConfig.map(wa=>{const ya=S.find(G=>G.name===wa.name),oa=K.get(ya);oa.set({arcade:R,field:ya,config:wa,feature:T,group:ka,initialFeature:this._initialFeature,layer:V,messages:F,value:this.getValue(ya.name)});return oa}).filter(wa=>
wa.visible);ka.set({arcade:R,config:N,feature:T,inputFields:U});return ka}U=S.find(ka=>ka.name===N.name);const fa=K.get(U);fa.set({arcade:R,field:U,config:N,feature:T,group:null,initialFeature:this._initialFeature,layer:V,messages:F,value:this.getValue(U.name)});return fa}):S.map(N=>{const U=K.get(N);U.set({arcade:R,config:null,field:N,feature:T,group:null,initialFeature:this._initialFeature,layer:V,messages:F,value:this.getValue(N.name)});return U})).filter(N=>N.visible)}},{key:"layer",get:function(){var R;
return null!=(R=this.feature)&&R.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null},set:function(R){R?this._override("layer",R):this._clearOverride("layer")}},{key:"state",get:function(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}},{key:"title",get:function(){var R;return null==(R=this.formTemplate)?void 0:R.title},set:function(R){void 0===R?this._clearOverride("title"):this._override("title",R)}},{key:"valid",get:function(){const R=this._allInputFields;
return 0<R.length&&R.every(({valid:K})=>K)}}]);return H}(A.HandleOwnerMixin(C.EventedAccessor));l.__decorate([u.property({readOnly:!0})],m.prototype,"_allInputFields",null);l.__decorate([u.property({readOnly:!0})],m.prototype,"_inputFieldCache",null);l.__decorate([u.property({readOnly:!0})],m.prototype,"_inputFieldGroupCache",null);l.__decorate([u.property()],m.prototype,"description",null);l.__decorate([u.property()],m.prototype,"feature",null);l.__decorate([u.property()],m.prototype,"fieldConfig",
null);l.__decorate([y.cast("fieldConfig")],m.prototype,"castFieldConfig",null);l.__decorate([u.property({type:q})],m.prototype,"formTemplate",null);l.__decorate([u.property({readOnly:!0,dependsOn:"messages feature fieldConfig layer.fields layer.loaded state".split(" ")})],m.prototype,"inputFields",null);l.__decorate([u.property()],m.prototype,"layer",null);l.__decorate([u.property()],m.prototype,"messages",void 0);l.__decorate([u.property()],m.prototype,"state",null);l.__decorate([u.property()],m.prototype,
"strict",void 0);l.__decorate([u.property()],m.prototype,"title",null);l.__decorate([u.property()],m.prototype,"valid",null);l.__decorate([u.property()],m.prototype,"getValues",null);l.__decorate([u.property()],m.prototype,"submit",null);return m=l.__decorate([p.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],m)})},"esri/widgets/FeatureForm/FieldConfig":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./Format".split(" "),
function(b,l,m,z,C,A,g,k,w,u){m=function(x){function y(t){t=x.call(this,t)||this;t.description=null;t.domain=null;t.editable=!0;t.editorType=null;t.format=null;t.hint=null;t.includeTime=!0;t.label=null;t.maxLength=-1;t.minLength=-1;t.name=null;t.noValueOptionLabel=null;t.offValue=null;t.onValue=null;t.required=!1;t.requiredExpression=null;t.showNoValueOption=!1;t.visibilityExpression=null;return t}b._inheritsLoose(y,x);return y}(m);l.__decorate([z.property()],m.prototype,"description",void 0);l.__decorate([z.property()],
m.prototype,"domain",void 0);l.__decorate([z.property()],m.prototype,"editable",void 0);l.__decorate([z.property()],m.prototype,"editorType",void 0);l.__decorate([z.property({type:u})],m.prototype,"format",void 0);l.__decorate([z.property()],m.prototype,"hint",void 0);l.__decorate([z.property()],m.prototype,"includeTime",void 0);l.__decorate([z.property()],m.prototype,"label",void 0);l.__decorate([z.property()],m.prototype,"maxLength",void 0);l.__decorate([z.property()],m.prototype,"minLength",void 0);
l.__decorate([z.property()],m.prototype,"name",void 0);l.__decorate([z.property()],m.prototype,"noValueOptionLabel",void 0);l.__decorate([z.property()],m.prototype,"offValue",void 0);l.__decorate([z.property()],m.prototype,"onValue",void 0);l.__decorate([z.property()],m.prototype,"required",void 0);l.__decorate([z.property()],m.prototype,"requiredExpression",void 0);l.__decorate([z.property()],m.prototype,"showNoValueOption",void 0);l.__decorate([z.property()],m.prototype,"visibilityExpression",void 0);
return m=l.__decorate([w.subclass("esri.widgets.FeatureForm.FieldConfig")],m)})},"esri/widgets/FeatureForm/Format":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),function(b,l,m,z,C,A,g,k,w,u){z=function(x){function y(t){t=x.call(this,
t)||this;t.digitSeparator=!1;t.dateFormat=null;t.places=null;return t}b._inheritsLoose(y,x);return y}(z.JSONSupport);l.__decorate([C.property()],z.prototype,"digitSeparator",void 0);l.__decorate([C.property({json:{read:{source:"dateFormat",reader:m.fromJSON}}})],z.prototype,"dateFormat",void 0);l.__decorate([C.property()],z.prototype,"places",void 0);return z=l.__decorate([u.subclass("esri.widgets.FeatureForm.Format")],z)})},"esri/widgets/FeatureForm/FieldGroupConfig":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./FieldConfig".split(" "),
function(b,l,m,z,C,A,g,k,w,u){m=function(x){function y(t){t=x.call(this,t)||this;t.description=null;t.fieldConfig=null;t.label=null;t.state="expanded";t.visibilityExpression=null;return t}b._inheritsLoose(y,x);y.prototype.castFieldConfig=function(t){return t?t.map(p=>p.declaredClass?p:new u(p)):null};return y}(m);l.__decorate([z.property()],m.prototype,"description",void 0);l.__decorate([z.property()],m.prototype,"fieldConfig",void 0);l.__decorate([A.cast("fieldConfig")],m.prototype,"castFieldConfig",
null);l.__decorate([z.property()],m.prototype,"label",void 0);l.__decorate([z.property()],m.prototype,"state",void 0);l.__decorate([z.property()],m.prototype,"visibilityExpression",void 0);return m=l.__decorate([w.subclass("esri.widgets.FeatureForm.FieldGroupConfig")],m)})},"esri/widgets/FeatureForm/InputField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../layers/support/CodedValueDomain ../../layers/support/domains ../../layers/support/fieldUtils ../../intl/substitute".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){const q={type:"number"},d={type:"number",intlOptions:{notation:"scientific"}},a={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}};m=function(c){function r(h){h=c.call(this,h)||this;h.arcade=null;h.config=null;h.feature=null;h.field=null;h.initialFeature=null;h.layer=null;h.description=null;h.editorType=null;h.error=null;h.format=null;h.group=null;h.hint=null;h.messages=null;h.name=null;return h}
b._inheritsLoose(r,c);var e=r.prototype;e._isDomainCompatible=function(h){const {field:v}=this;if("coded-value"===(null==h?void 0:h.type)){const E=typeof h.codedValues[0].code;if("string"===E&&t.isStringField(v)||"number"===E&&t.isNumericField(v))return!0}return"range"===(null==h?void 0:h.type)&&t.isNumericField(v)||t.isDateField(v)?!0:!1};e._validate=function(){const {domain:h,field:v,initialFeature:E,minLength:n,required:B,type:f,value:D}=this,H=B&&null===D;return H||E.getAttribute(v.name)!==D?
"text"===f&&-1<n&&"string"===typeof D&&D.length<n?"length-validation-error::too-short":h?null!==D||B?y.validateDomainValue(h,D):null:H?t.TypeValidationError.INVALID_TYPE:t.validateFieldValue(v,D):null};e._shownByDefault=function(){var h;const v=null==(h=this.field)?void 0:h.type;return"oid"!==v&&"global-id"!==v&&!this._isGeometryField()};e._isEditorField=function(){return-1<t.getFeatureEditFields(this.layer).indexOf(this.name)};e._isGeometryField=function(){return-1<t.getFeatureGeometryFields(this.layer).indexOf(this.name)};
e._toErrorMessage=function(){const {domain:h,field:v,messages:E,minLength:n,value:B,required:f,type:D}=this;var H=this.error;return f&&null===B?E.validationErrors.cannotBeNull:H===y.DomainValidationError.VALUE_OUT_OF_RANGE||H===t.NumericRangeValidationError.OUT_OF_RANGE?(H=y.getDomainRange(h)||t.getFieldRange(v),p.substitute(E.validationErrors.outsideRange,H,{format:{max:"date"===D?a:H.isInteger?q:d,min:"date"===D?a:H.isInteger?q:d}})):H===y.DomainValidationError.INVALID_CODED_VALUE?E.validationErrors.invalidCodedValue:
H===t.TypeValidationError.INVALID_TYPE?E.validationErrors.invalidType:"length-validation-error::too-short"===H?p.substitute(E.validationErrors.tooShort,{min:n}):null};b._createClass(r,[{key:"compiledFunc",get:function(){var h;const {arcade:v}=this;return v&&v.arcadeUtils.createFunction(null==(h=this.config)?void 0:h.visibilityExpression)}},{key:"compiledRequiredFunc",get:function(){var h;const {arcade:v}=this;return v&&v.arcadeUtils.createFunction(null==(h=this.config)?void 0:h.requiredExpression)}},
{key:"evaluatedRequirement",get:function(){const h=this.compiledRequiredFunc;if(!h)return null;const {arcade:v}=this;return v.arcadeUtils.executeFunction(h,v.arcadeUtils.createExecContext(this.feature))}},{key:"evaluatedVisibility",get:function(){const h=this.compiledFunc;if(!h)return null;const {arcade:v}=this;return v.arcadeUtils.executeFunction(h,v.arcadeUtils.createExecContext(this.feature))}},{key:"domain",get:function(){var h,v,{typeIdField:E}=this.layer;const n=E===this.name;var B=null==(h=
this.field)?void 0:h.domain;if(n&&!B)return new x({name:"__internal-type-based-coded-value-domain__",codedValues:this.layer.types.map(({id:f,name:D})=>({code:f,name:D}))});({feature:h}=this);E=E&&this.layer.getFieldDomain(this.name,{feature:h})||B;B=null==(v=this.config)?void 0:v.domain;return this._isDomainCompatible(B)?B:E}},{key:"editable",get:function(){var h;return this.layer.capabilities.operations.supportsEditing&&this.field.editable&&!1!==(null==(h=this.config)?void 0:h.editable)}},{key:"errorMessage",
get:function(){return this._toErrorMessage()}},{key:"includeTime",get:function(){var h;const v=null==(h=this.config)?void 0:h.includeTime;return void 0===v?!0:v}},{key:"label",get:function(){var h;return(null==(h=this.config)?void 0:h.label)||this.field.alias||this.field.name}},{key:"maxLength",get:function(){var h,v;if("date"===this.type)return-1;const E=null==(h=this.field)?void 0:h.length;h=null==(v=this.config)?void 0:v.maxLength;return!isNaN(h)&&-1<=h&&(-1===E||h<=E)?h:E}},{key:"minLength",get:function(){var h,
v;if("date"===this.type)return-1;const E=null==(h=this.field)?void 0:h.length;h=null==(v=this.config)?void 0:v.minLength;return!isNaN(h)&&-1<=h&&(-1===E||h<=E)?h:-1}},{key:"required",get:function(){var h,v;return this.editable?null!=(h=this.field)&&h.nullable?"boolean"===typeof this.evaluatedRequirement?this.evaluatedRequirement:!0===(null==(v=this.config)?void 0:v.required):!0:!1}},{key:"type",get:function(){const {field:h}=this;return t.isNumericField(h)?"number":t.isStringField(h)?"text":t.isDateField(h)?
"date":"unsupported"}},{key:"valid",get:function(){const h=this.editable?this._validate():null;this._set("error",h);return null===h}},{key:"value",get:function(){return this._get("value")},set:function(h){this.notifyChange("evaluatedVisibility");this._set("value",h)}},{key:"visible",get:function(){return this._isEditorField()?!1:"boolean"===typeof this.evaluatedVisibility?this.evaluatedVisibility:!!this.config||this._shownByDefault()}}]);return r}(z);l.__decorate([C.property()],m.prototype,"arcade",
void 0);l.__decorate([C.property()],m.prototype,"compiledFunc",null);l.__decorate([C.property()],m.prototype,"compiledRequiredFunc",null);l.__decorate([C.property()],m.prototype,"config",void 0);l.__decorate([C.property()],m.prototype,"evaluatedRequirement",null);l.__decorate([C.property()],m.prototype,"evaluatedVisibility",null);l.__decorate([C.property()],m.prototype,"feature",void 0);l.__decorate([C.property()],m.prototype,"field",void 0);l.__decorate([C.property()],m.prototype,"initialFeature",
void 0);l.__decorate([C.property()],m.prototype,"layer",void 0);l.__decorate([C.property({aliasOf:"config.description"})],m.prototype,"description",void 0);l.__decorate([C.property()],m.prototype,"domain",null);l.__decorate([C.property()],m.prototype,"editable",null);l.__decorate([C.property({aliasOf:"config.editorType"})],m.prototype,"editorType",void 0);l.__decorate([C.property({readOnly:!0})],m.prototype,"error",void 0);l.__decorate([C.property({dependsOn:["error","messages","value"]})],m.prototype,
"errorMessage",null);l.__decorate([C.property({aliasOf:"config.format"})],m.prototype,"format",void 0);l.__decorate([C.property()],m.prototype,"group",void 0);l.__decorate([C.property({aliasOf:"config.hint"})],m.prototype,"hint",void 0);l.__decorate([C.property()],m.prototype,"includeTime",null);l.__decorate([C.property()],m.prototype,"label",null);l.__decorate([C.property()],m.prototype,"maxLength",null);l.__decorate([C.property()],m.prototype,"minLength",null);l.__decorate([C.property()],m.prototype,
"messages",void 0);l.__decorate([C.property({aliasOf:"field.name"})],m.prototype,"name",void 0);l.__decorate([C.property()],m.prototype,"required",null);l.__decorate([C.property()],m.prototype,"type",null);l.__decorate([C.property()],m.prototype,"valid",null);l.__decorate([C.property({value:null})],m.prototype,"value",null);l.__decorate([C.property()],m.prototype,"visible",null);return m=l.__decorate([u.subclass("esri.widgets.FeatureForm.InputField")],m)})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x){m=function(y){function t(p){p=y.call(this,p)||this;p.arcade=null;p.config=null;p.description=null;p.feature=null;p.label=null;p.state=null;p.visibilityExpression=null;return p}b._inheritsLoose(t,y);t.prototype._dirtyEvaluatedVisibility=function(){this.visibilityExpression&&this.notifyChange("evaluatedVisibility")};b._createClass(t,[{key:"compiledFunc",get:function(){const {arcade:p}=this;return p&&p.arcadeUtils.createFunction(this.visibilityExpression)}},{key:"evaluatedVisibility",
get:function(){const p=this.compiledFunc;if(p){var {arcade:q}=this;return q.arcadeUtils.executeFunction(p,q.arcadeUtils.createExecContext(this.feature))}}},{key:"inputFields",get:function(){return this._get("inputFields")},set:function(p){this.handles.removeAll();p&&this.handles.add(p.map(q=>q.watch("visible",this._dirtyEvaluatedVisibility)));this._set("inputFields",p)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibility&&this.inputFields&&this.inputFields.some(p=>p.visible)}}]);return t}(z.HandleOwnerMixin(m));
l.__decorate([u.property()],m.prototype,"arcade",void 0);l.__decorate([u.property()],m.prototype,"compiledFunc",null);l.__decorate([u.property()],m.prototype,"config",void 0);l.__decorate([u.property()],m.prototype,"evaluatedVisibility",null);l.__decorate([C.aliasOf("config.description")],m.prototype,"description",void 0);l.__decorate([u.property()],m.prototype,"feature",void 0);l.__decorate([u.property()],m.prototype,"inputFields",null);l.__decorate([C.aliasOf("config.label")],m.prototype,"label",
void 0);l.__decorate([C.aliasOf("config.state")],m.prototype,"state",void 0);l.__decorate([C.aliasOf("config.visibilityExpression")],m.prototype,"visibilityExpression",void 0);l.__decorate([u.property()],m.prototype,"visible",null);return m=l.__decorate([x.subclass("esri.widgets.FeatureForm.InputFieldGroup")],m)})},"esri/widgets/FeatureForm/support/formTemplateUtils":function(){define(["exports","../../../layers/support/RangeDomain","../FieldConfig","../FieldGroupConfig"],function(b,l,m,z){function C(A,
g,k,w=!0){return A.map(u=>{if("field"===u.type){{const {description:y,domain:t,editable:p,fieldName:q,hint:d,input:a,label:c,requiredExpression:r,visibilityExpression:e}=u;u=new m({description:y,domain:t,editable:p,hint:d,label:c,name:q,requiredExpression:g[r]||null,visibilityExpression:g[e]||null});if(a)if("barcode-scanner"===a.type||"text-area"===a.type||"text-box"===a.type)u.editorType=a.type,u.minLength=a.minLength,u.maxLength=a.maxLength;else if("combo-box"===a.type||"radio-buttons"===a.type)u.editorType=
a.type,u.noValueOptionLabel=a.noValueOptionLabel,u.showNoValueOption=a.showNoValueOption;else if("switch"===a.type)u.editorType=a.type,u.offValue=a.offValue,u.onValue=a.onValue;else if("datetime-picker"===a.type){u.editorType=a.type;u.includeTime=a.includeTime;const {max:h,min:v}=a;if(h||v){var x="range"===(null==t?void 0:t.type)?Math.min(null==h?void 0:h.getTime(),t.maxValue):null==h?void 0:h.getTime();const E="range"===(null==t?void 0:t.type)?Math.max(null==v?void 0:v.getTime(),t.minValue):null==
v?void 0:v.getTime();u.domain=new l({maxValue:x,minValue:E,name:"__internal-range-domain-based-on-datetime-picker-input__"})}}else k.push({type:"unsupported-input-type",details:a})}return u}if("group"===u.type){if(!w)return k.push({type:"nested-group",details:u}),null;x=g[u.visibilityExpression]||null;return new z({description:u.description,state:u.initialState,fieldConfig:C(u.elements,g,k,!1),label:u.label,visibilityExpression:x})}k.push({type:"unsupported-element-type",details:u});return null}).filter(u=>
!!u)}b.fieldConfigsFromFormTemplate=function(A){var g;const k={},w=[];null==(g=A.expressionInfos)?void 0:g.map(u=>k[u.name]=u.expression);return{config:C(A.elements,k,w),encounteredUnsupportedTypes:w}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/FeatureTemplates":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){function r(h){const {label:v}=h;return"items"in h?v:`${v}\u2013${h.layer.id}`}const e={filter:!0};m=function(h){function v(n,B){n=h.call(this,n,B)||this;n._iconIntersectionObserver=new IntersectionObserver((f,D)=>{f.forEach(function(){var H=b._asyncToGenerator(function*(P){if(P.isIntersecting&&(P=P.target,!P["data-has-icon"])){const R=P["data-item"];P["data-has-icon"]=!0;D.unobserve(P);yield R.fetchThumbnail();P["data-item"]===R&&R.thumbnail?P.appendChild(R.thumbnail):
(P["data-has-icon"]=!1,D.observe(P))}});return function(P){return H.apply(this,arguments)}}())});n.filterFunction=null;n.filterText="";n.groupBy=null;n.headingLevel=4;n.label=void 0;n.layers=null;n.messages=null;n.selectedItem=null;n.viewModel=new t;n.visibleElements={...e};n.renderItemIcon=n.renderItemIcon.bind(b._assertThisInitialized(n));n._afterItemCreateOrUpdate=n._afterItemCreateOrUpdate.bind(b._assertThisInitialized(n));n._afterItemRemoved=n._afterItemRemoved.bind(b._assertThisInitialized(n));
return n}b._inheritsLoose(v,h);var E=v.prototype;E.initialize=function(){const n=({label:B})=>!this.filterText||-1<B.toLowerCase().indexOf(this.filterText.toLowerCase());this.own(z.init(this,"viewModel",(B,f)=>{B&&!B.filterFunction&&(this.filterFunction=n);f&&f!==B&&f.filterFunction===n&&(f.filterFunction=null)}))};E.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};E.castVisibleElements=function(n){return{...e,...n}};
E.select=function(n){return null};E.render=function(){const {filterText:n,headingLevel:B,messages:f,viewModel:{items:D,selectedItem:H,state:P}}=this,R=this.visibleElements.filter;return c.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":f.widgetLabel},"loading"===P?this.renderLoader():"ready"===P?c.tsx(p.ItemList,{id:this.id,identify:r,filterText:n,items:D,headingLevel:B,messages:{filterPlaceholder:f.filterPlaceholder,noItems:f.noItems,noMatches:f.noMatches},filterEnabled:R,
onItemSelect:K=>{this.viewModel.select(K)},onFilterChange:K=>{this.filterText=K;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:H}):null)};E.renderItemIcon=function({item:n}){return c.tsx("span",{key:"icon",class:"esri-feature-templates__list-item-icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":n,"data-has-icon":!1})};E.renderLoader=function(){return c.tsx("div",{class:"esri-feature-templates__loader",
key:"loader"})};E._afterItemCreateOrUpdate=function(n){this._iconIntersectionObserver.observe(n)};E._afterItemRemoved=function(n){this._iconIntersectionObserver.unobserve(n)};return v}(m.HandleOwnerMixin(y));l.__decorate([C.aliasOf("viewModel.filterFunction")],m.prototype,"filterFunction",void 0);l.__decorate([u.property()],m.prototype,"filterText",void 0);l.__decorate([C.aliasOf("viewModel.groupBy")],m.prototype,"groupBy",void 0);l.__decorate([u.property()],m.prototype,"headingLevel",void 0);l.__decorate([u.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],m.prototype,"label",void 0);l.__decorate([C.aliasOf("viewModel.layers")],m.prototype,"layers",void 0);l.__decorate([u.property(),d.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],m.prototype,"messages",void 0);l.__decorate([C.aliasOf("viewModel.selectedItem")],m.prototype,"selectedItem",void 0);l.__decorate([u.property(),a.vmEvent("select")],m.prototype,"viewModel",void 0);l.__decorate([u.property()],m.prototype,"visibleElements",void 0);l.__decorate([g.cast("visibleElements")],
m.prototype,"castVisibleElements",null);l.__decorate([C.aliasOf("viewModel.select")],m.prototype,"select",null);return m=l.__decorate([x.subclass("esri.widgets.FeatureTemplates")],m)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/HandleOwner ../../core/ObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./TemplateItem ./TemplateItemGroup".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){const q=({layer:a})=>({key:a,label:a.title}),d=({layer:a})=>a.geometryType;m=function(a){function c(e){e=a.call(this,e)||this;e._itemPool=new C(t);e._groupPool=new C(p);e.filterFunction=null;e.groupBy="layer";e.selectedItem=null;return e}b._inheritsLoose(c,a);var r=c.prototype;r.destroy=function(){this._templateToLayer.clear()};r.refresh=function(){this.notifyChange("items")};r.select=function(e){e=(null==e?void 0:e.clone())||null;this._set("selectedItem",e);
this.emit("select",{item:e,template:(null==e?void 0:e.template)||null})};r._getTemplatesForLayer=function(e){const h=e.templates||[];e=(e.types||[]).map(v=>v.templates).reduce((v,E)=>[...v,...E],[]);return[...h,...e]};r._createItem=function(e){const h=this._itemPool.acquire();h.set({template:e,layer:this._templateToLayer.get(e)});return h};r._createGroup=function(e,h){const v=this._groupPool.acquire();v.set("label",e);v.items=h;return v};r._releasePreviousItems=function(){this._destroyItems(this._get("items"))};
r._destroyItems=function(e){e&&(e[0]instanceof t?e.forEach(h=>this._destroyItem(h)):e.forEach(h=>this._destroyGroup(h)))};r._destroyGroup=function(e){e.items.forEach(h=>this._destroyItem(h));e.items.length=0;this._groupPool.release(e)};r._destroyItem=function(e){e.layer=null;e.template=null;this._itemPool.release(e)};b._createClass(c,[{key:"_templateToLayer",get:function(){const e=new Map;for(const {layer:h,templates:v}of this._featureTemplateInfos)for(const E of v)e.set(E,h);return e}},{key:"layers",
get:function(){return this._get("layers")},set:function(e){this.handles.remove("layers");if(e){const h=()=>this.notifyChange("state");this.handles.add(e.map(v=>A.when(v,"loadStatus",h)),"layers")}this._set("layers",e)}},{key:"state",get:function(){const {layers:e}=this;return e&&0!==e.length?e.some(h=>"loading"===h.loadStatus||"not-loaded"===h.loadStatus)?"loading":"ready":"disabled"}},{key:"_featureTemplateInfos",get:function(){return this.layers?this.layers.filter(({capabilities:e,loaded:h})=>h&&
e.operations.supportsEditing&&e.operations.supportsAdd).map(e=>{const h=this._getTemplatesForLayer(e);return{layer:e,templates:h}}).filter(e=>null!=e&&0<e.templates.length):[]}},{key:"numberOfFeatureTemplates",get:function(){return this._featureTemplateInfos.reduce((e,h)=>e+h.templates.length,0)}},{key:"items",get:function(){var e=this._featureTemplateInfos;if(0===e.length)return this._releasePreviousItems(),[];const {groupBy:h}=this;if("none"===h)return e=e.map(({templates:n})=>n.filter(({name:B})=>
!this.filterFunction||this.filterFunction({label:B}))).map(n=>n.map(B=>this._createItem(B))).reduce((n,B)=>[...n,...B],[]),this._releasePreviousItems(),e;e=e.reduce((n,{layer:B,templates:f})=>{f.forEach(D=>{var H=("layer"===h?q:"geometry"===h?d:h)({template:D,layer:B});if(H){const P="string"===typeof H?H:H.key;H="string"===typeof H?H:H.label;n.has(P)||n.set(P,{label:H,templates:[]});n.get(P).templates.push(D)}});return n},new Map);if(0===e.size)return this._releasePreviousItems(),[];const v=[],{filterFunction:E}=
this;e.forEach(n=>{const {label:B,templates:f}=n;!E||this.filterFunction(n)?v.push(this._createGroup(B,f.map(D=>this._createItem(D)))):(n=f.filter(({name:D})=>this.filterFunction({label:D})).map(D=>this._createItem(D)),0<n.length&&v.push(this._createGroup(B,n)))});this._releasePreviousItems();return v}}]);return c}(z.HandleOwnerMixin(m.EventedAccessor));l.__decorate([g.property({readOnly:!0})],m.prototype,"_templateToLayer",null);l.__decorate([g.property()],m.prototype,"filterFunction",void 0);l.__decorate([g.property()],
m.prototype,"groupBy",void 0);l.__decorate([g.property()],m.prototype,"layers",null);l.__decorate([g.property()],m.prototype,"state",null);l.__decorate([g.property({readOnly:!0})],m.prototype,"_featureTemplateInfos",null);l.__decorate([g.property({readOnly:!0})],m.prototype,"numberOfFeatureTemplates",null);l.__decorate([g.property({readOnly:!0})],m.prototype,"items",null);l.__decorate([g.property({readOnly:!0})],m.prototype,"selectedItem",void 0);l.__decorate([g.property()],m.prototype,"select",null);
return m=l.__decorate([y.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],m)})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){function q(a){return Object.freeze({__proto__:null,"default":a})}var d;C=d=function(a){function c(e){e=a.call(this,e)||this;e._activeFetchInfo={id:null,request:null};e.description=null;e.label=null;e.layer=null;e.template=null;e.thumbnail=null;return e}l._inheritsLoose(c,a);var r=c.prototype;r.initialize=function(){this.handles.add(g.init(this,["layer.renderer","template"],()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",
null)}))};r.clone=function(){const e=this.thumbnail?this.thumbnail.cloneNode(!0):null,h=new d({layer:this.layer,template:this.template});h._set("thumbnail",e);return h};r.fetchThumbnail=function(){var e=l._asyncToGenerator(function*(){var h=this;const {_activeFetchInfo:v}=this;if(`${this.label}-${this.layer.id}`===v.id)return v.request;v.id=`${this.label}-${this.layer.id}`;v.request=this._getPreviewSymbol().then(function(){var E=l._asyncToGenerator(function*(n){var B;if(`${h.label}-${h.layer.id}`===
v.id){var f={maxSize:36};"dictionary"===(null==(B=h.layer.renderer)?void 0:B.type)&&(f.fieldMap=h.layer.renderer.fieldMap,f.feature={attributes:h.template.prototype.attributes});n=yield p.renderPreviewHTML(n,f);`${h.label}-${h.layer.id}`===v.id&&h._set("thumbnail",n)}});return function(n){return E.apply(this,arguments)}}());return v.request});return function(){return e.apply(this,arguments)}}();r._getPreviewSymbol=function(){var e=l._asyncToGenerator(function*(){const {layer:h,template:v,layer:{renderer:E}}=
this;if(E){var n=new z({attributes:v.prototype.attributes});if(n=yield E.getSymbolAsync(n))return n}return this._getFallbackSymbolFromGeometry(h)});return function(){return e.apply(this,arguments)}}();r._getFallbackSymbolFromGeometry=function(e){({geometryType:e}=e);if("point"===e||"multipoint"===e)return(new Promise(function(h,v){b(["../../symbols/SimpleMarkerSymbol"],function(E){h(q(E))},v)})).then(h=>new h.default);if("polyline"===e)return(new Promise(function(h,v){b(["../../symbols/SimpleLineSymbol"],
function(E){h(q(E))},v)})).then(h=>new h.default);if("polygon"===e||"mesh"===e||"multipatch"===e)return(new Promise(function(h,v){b(["../../symbols/SimpleFillSymbol"],function(E){h(q(E))},v)})).then(h=>new h.default)};return c}(A.HandleOwnerMixin(C));m.__decorate([k.property({aliasOf:"template.description"})],C.prototype,"description",void 0);m.__decorate([k.property({aliasOf:"template.name"})],C.prototype,"label",void 0);m.__decorate([k.property()],C.prototype,"layer",void 0);m.__decorate([k.property()],
C.prototype,"template",void 0);m.__decorate([k.property({readOnly:!0})],C.prototype,"thumbnail",void 0);return C=d=m.__decorate([t.subclass("esri.widgets.FeatureTemplates.TemplateItem")],C)})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w,u){m=function(x){function y(t){t=x.call(this,t)||this;t.items=null;t.label=null;return t}b._inheritsLoose(y,x);return y}(z.IdentifiableMixin(m));l.__decorate([C.property()],m.prototype,"items",void 0);l.__decorate([C.property()],m.prototype,"label",void 0);return m=l.__decorate([u.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],m)})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/Heading","../support/jsxFactory","../support/widgetUtils"],
function(b,l,m,z){function C(x){const {headingLevel:y,identify:t,items:p,renderIcon:q,filterText:d,onItemMouseLeave:a,onItemMouseEnter:c,onItemSelect:r,selectedItem:e}=x;return 0===p.length?m.tsx("div",{class:u.noMatchesMessage,key:"no-matches"},x.messages.noMatches):p[0].items?m.tsx("div",{class:u.scroller,key:"item-container"},p.map(h=>k({filterText:d,group:h,headingLevel:y,identify:t,onItemMouseLeave:a,onItemMouseEnter:c,onItemSelect:r,renderIcon:q,selectedItem:e}))):m.tsx("ul",{class:z.classes(u.list,
u.scroller),key:"item-container"},p.map(h=>g({item:h,identify:t,grouped:!0,onItemMouseLeave:a,onItemMouseEnter:c,onItemSelect:r,renderIcon:q,filterText:d,selectedItem:e})))}function A(x){const y=`${x.id}-placeholder`;return m.tsx("div",{class:u.filterContainer,key:"filter"},m.tsx("input",{"aria-labelledby":y,class:z.classes(u.input,u.filterInput),oninput:t=>{t=t.currentTarget;x.onFilterChange&&x.onFilterChange(t.value)},value:x.filterText,type:"search"}),x.filterText?null:m.tsx("div",{class:u.filterPlaceholder,
id:y,key:"placeholder"},m.tsx("span",{class:u.searchIcon,"aria-hidden":"true"}),m.tsx("div",{class:u.filterPlaceholderText},x.messages.filterPlaceholder)))}function g(x){const {identify:y,item:t,selectedItem:p,grouped:q,filterText:d,onItemSelect:a,onItemMouseEnter:c,onItemMouseLeave:r,renderIcon:e}=x;x=`${(null==y?void 0:y(t))||t.id}__${t.label}`;const h=p?`${(null==y?void 0:y(p))||p.id}__${p.label}`:"";return m.tsx("li",{"aria-level":q?"2":"",class:z.classes(u.item,x===h&&u.itemSelected),"data-item":t,
key:x,onclick:v=>{v=v.currentTarget["data-item"];a&&a(v)},onmouseenter:v=>{v=v.currentTarget["data-item"];c&&c(v)},onkeydown:v=>{z.isActivationKey(v.key)&&(v=v.currentTarget["data-item"],a&&a(v))},onmouseleave:v=>{v=v.currentTarget["data-item"];r&&r(v)},tabIndex:0},m.tsx("div",{class:u.itemContainer},e&&e({item:t}),w({text:t.label,match:d})))}function k(x){const {group:y,headingLevel:t,identify:p,onItemMouseLeave:q,onItemMouseEnter:d,onItemSelect:a,filterText:c,renderIcon:r,selectedItem:e}=x;x=`${p&&
p(y)||y.id}-heading`;return m.tsx("section",{"aria-labelledby":x,class:u.group,key:y.label},m.tsx(l.Heading,{id:x,class:u.groupHeader,level:t},w({text:y.label,match:c})),m.tsx("ul",{class:u.list},y.items.map(h=>g({item:h,identify:p,grouped:!0,onItemMouseLeave:q,onItemMouseEnter:d,onItemSelect:a,renderIcon:r,filterText:c,selectedItem:e}))))}function w(x){const {match:y,text:t}=x;x=null;if(y){x=t.toLowerCase();var p=y.toLowerCase(),q=x.indexOf(p);-1===q?x=t:(x=t.substring(0,q),p=t.substr(q,y.length),
q=t.substring(q+y.length),x=m.tsx("span",null,x,m.tsx("strong",null,p),q))}else x=t;return m.tsx("span",{class:u.itemLabel},x)}const u={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group-header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",noMatchesMessage:"esri-item-list__no-matches-message",
noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",input:"esri-input"};b.ItemList=function(x){const {id:y,identify:t,filterEnabled:p=!0,headingLevel:q=4,items:d,selectedItem:a,messages:c,filterText:r="",onFilterChange:e,renderIcon:h,onItemMouseLeave:v,
onItemMouseEnter:E,onItemSelect:n}=x;return m.tsx("div",{class:z.classes(u.base,u.widget),key:y},p?A({filterText:r,messages:c,onFilterChange:e,id:y}):null,C({identify:t,items:d,selectedItem:a,messages:c,filterText:r,headingLevel:q,renderIcon:h,onItemMouseLeave:v,onItemMouseEnter:E,onItemSelect:n}))};b.renderGroup=k;b.renderItem=g;b.renderLabel=w;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../views/interactive/snapping/SnappingOptions ../Attachments/AttachmentsViewModel ./BatchCreateWorkflow ./CreateWorkflow ./UpdateWorkflow ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E,n){function B(P,R,K){D.error(new z(P,R,K))}function f(P,R){return P&&P.find(K=>K.layer===R)}const D=g.getLogger("esri.widgets.Editor.EditorViewModel"),H=["create","update"];C=function(P){function R(J){J=P.call(this,J)||this;J._sketchGraphicsLayer=new q({listMode:"hide",internal:!0});J.activeWorkflow=null;J.activityQueue=[];J.failures=[];J.attachmentsViewModel=new a({abilities:{editing:!0}});J.featureFormViewModel=new h;J.featureTemplatesViewModel=
new v;J.layerInfos=null;J.sketchViewModel=new E({layer:J._sketchGraphicsLayer});J.snappingOptions=new d;J.spinnerViewModel=new n;return J}b._inheritsLoose(R,P);var K=R.prototype;K.initialize=function(){this.handles.add([k.on(this,"activeWorkflow","cancel",()=>this.emit("workflow-cancel")),k.on(this,"activeWorkflow","commit",()=>this.emit("workflow-commit")),k.init(this,"view.map",J=>{J&&J.add(this._sketchGraphicsLayer)}),k.watch(this,"editableItems",()=>{const {activeWorkflow:J}=this;this.refreshCreationTemplates();
if(J){var {stepId:Q}=J;"create"===J.type?"awaiting-feature-creation-info"!==Q||this.canCreate||this._cancelWorkflow():"update"===J.type&&("awaiting-feature-to-update"===Q&&!this.canUpdate||"awaiting-update-feature-candidate"===Q&&!J.data.candidates.some(F=>{const O=this.editableItems.find(V=>V.layer===F.layer);return O&&-1<O.supports.indexOf("update")}))&&this._cancelWorkflow()}})])};K.destroy=function(){this._cancelWorkflow().then(()=>{var J;null!=(J=this.view)&&J.map&&this.view.map.remove(this._sketchGraphicsLayer);
this.view=null})};K.startCreateWorkflowAtFeatureTypeSelection=function(){var J=b._asyncToGenerator(function*(){if(this.canCreate){yield this._cancelWorkflow();var Q=this._createCreateWorkflow();yield Q.start();this._set("activeWorkflow",Q)}else B("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(){return J.apply(this,arguments)}}();K.startCreateWorkflowAtFeatureCreation=function(){var J=b._asyncToGenerator(function*(Q){if(this.canCreate){yield this._cancelWorkflow();
var F=this._createCreateWorkflow("awaiting-feature-to-create");F.data.creationInfo=Q;yield F.start();this._set("activeWorkflow",F)}else B("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(Q){return J.apply(this,arguments)}}();K.startBatchCreateWorkflowAtFeatureCreation=function(){var J=b._asyncToGenerator(function*(Q,F="awaiting-feature-creation-info"){this.canCreate?(yield this._cancelWorkflow(),F=this._createBatchCreateWorkflow(F),F.data.creationInfo=
Q,yield F.start(),this._set("activeWorkflow",F)):B("editing:unsupported-workflow","Batch create workflow is unsupported or disabled.")});return function(Q){return J.apply(this,arguments)}}();K.startCreateWorkflowAtFeatureEdit=function(){var J=b._asyncToGenerator(function*(Q){if(this.canCreate){yield this._cancelWorkflow();var F=this._createCreateWorkflow("editing-new-feature");F.data.edits.feature=Q;yield F.start();this._set("activeWorkflow",F)}else B("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});
return function(Q){return J.apply(this,arguments)}}();K.startUpdateWorkflowAtFeatureSelection=function(){var J=b._asyncToGenerator(function*(){if(this.canUpdate){yield this._cancelWorkflow();var Q=this._createUpdateWorkflow();yield Q.start();this._set("activeWorkflow",Q)}else B("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(){return J.apply(this,arguments)}}();K.startUpdateWorkflowAtMultipleFeatureSelection=function(){var J=b._asyncToGenerator(function*(Q){if(this.canUpdate){yield this._cancelWorkflow();
var F=this._createUpdateWorkflow("awaiting-update-feature-candidate");F.data.candidates=Q;yield F.start();this._set("activeWorkflow",F)}else B("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(Q){return J.apply(this,arguments)}}();K.startUpdateWorkflowAtFeatureEdit=function(){var J=b._asyncToGenerator(function*(Q){if(this.canUpdate){yield this._cancelWorkflow();var F=this._createUpdateWorkflow("editing-existing-feature");F.data.edits.feature=Q;yield F.start();
this._set("activeWorkflow",F)}else B("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(Q){return J.apply(this,arguments)}}();K.deleteFeatureFromWorkflow=function(){var J=b._asyncToGenerator(function*(){const {activeWorkflow:Q}=this;Q&&"update"===Q.type?(yield this._delete(Q.data.edits.feature),yield Q.reset()):B("editing:unsupported-workflow","Deleting requires an active update workflow.")});return function(){return J.apply(this,arguments)}}();K.cancelWorkflow=
function(){var J=b._asyncToGenerator(function*(Q){return this._cancelWorkflow({warn:!0,...Q})});return function(Q){return J.apply(this,arguments)}}();K.refreshCreationTemplates=function(){const J=[];for(const {layer:Q,supports:F}of this.editableItems)"templates"in Q&&F.includes("create")&&J.push(Q);this.featureTemplatesViewModel.layers=J};K._cancelWorkflow=function(){var J=b._asyncToGenerator(function*(Q){const F=this.activeWorkflow;F?Q&&!1===Q.force?(yield F.cancel(Q),this._set("activeWorkflow",
null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",null),yield F.cancel(Q)):Q&&Q.warn&&B("editing:no-active-workflow","There is no active workflow to cancel.")});return function(Q){return J.apply(this,arguments)}}();K._createBatchCreateWorkflow=function(J){return c.create(this,J,(Q,F)=>this._applyEdits(Q,F))};K._createCreateWorkflow=function(J){return r.create(this,J,(Q,F)=>this._applyEdits(Q,F))};K._createUpdateWorkflow=function(J){return e.create(this,J,(Q,F)=>this._applyEdits(Q,F))};
K._delete=function(){var J=b._asyncToGenerator(function*(Q){const F=Q.sourceLayer;"applyEdits"in F&&(yield this._applyEdits(F,{deleteFeatures:[Q]}))});return function(Q){return J.apply(this,arguments)}}();K._applyEdits=function(){var J=b._asyncToGenerator(function*(Q,F){yield this._queueOperation(()=>Q.applyEdits(F));const O=yield this.view.whenLayerView(Q);yield k.whenFalseOnce(O,"updating")});return function(Q,F){return J.apply(this,arguments)}}();K._queueOperation=function(J){this.activityQueue.push(J);
this.notifyChange("syncing");const Q=(F,O)=>{F=O.indexOf(F);-1<F&&O.splice(F,1)};return J().then(({addFeatureResults:F,deleteFeatureResults:O,updateFeatureResults:V})=>{if(F=F.find(M=>!!M.error)||V.find(M=>!!M.error)||O.find(M=>!!M.error))throw F.error;}).catch(F=>{B("editing:operation-error","An error occurred.",{error:F});const O={error:F,retry:()=>{Q(O,this.failures);return this._queueOperation(J)},cancel:()=>{Q(O,this.failures)}};this._set("failures",[...this.failures,O])}).then(()=>{Q(J,this.activityQueue);
this.notifyChange("syncing")})};b._createClass(R,[{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(J){J&&0!==J.length||(J=[...H]);this._set("allowedWorkflows",J)}},{key:"canCreate",get:function(){return this.editableItems.some(J=>J.supports.includes("create"))}},{key:"canUpdate",get:function(){return this.editableItems.some(J=>J.supports.includes("update"))}},{key:"editableItems",get:function(){var J,Q,F;const O=null==(J=this.view)?void 0:J.allLayerViews;if(!O)return new m;
const V=new Set(null==(Q=this.view)?void 0:null==(F=Q.map)?void 0:F.editableLayers);return O.filter(M=>V.has(M.layer)).map(M=>{const {layer:T,suspended:S}=M,{data:L,operations:N}=T.capabilities;M=f(this.layerInfos,T);const U="supportsAttachment"in L&&L.supportsAttachment&&(!M||!1!==M.allowAttachments);if(S)return{hasAttachments:U,layer:T,supports:[]};const fa=[];N.supportsAdd&&this.allowedWorkflows.includes("create")&&(!M||!1!==M.enabled&&!1!==M.addEnabled)&&fa.push("create");N.supportsUpdate&&this.allowedWorkflows.includes("update")&&
(!M||!1!==M.enabled&&!1!==M.updateEnabled)&&fa.push("update");!1!==(M&&M.deleteEnabled)&&N.supportsDelete&&fa.push("delete");return{hasAttachments:U,layer:T,supports:fa}}).reverse()}},{key:"state",get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";var J=this.attachmentsViewModel.mode;if("add"===J)return"adding-attachment";if("edit"===J)return"editing-attachment";({activeWorkflow:J}=this);return J?J.stepId:"ready"}},{key:"syncing",get:function(){return 0<this.activityQueue.length}},
{key:"view",set:function(J){this.sketchViewModel.view=J;this.spinnerViewModel.view=J;this._set("view",J)}}]);return R}(A.HandleOwnerMixin(C.EventedAccessor));l.__decorate([t.property({readOnly:!0})],C.prototype,"activeWorkflow",void 0);l.__decorate([t.property({readOnly:!0})],C.prototype,"activityQueue",void 0);l.__decorate([t.property({value:[...H]})],C.prototype,"allowedWorkflows",null);l.__decorate([t.property({readOnly:!0})],C.prototype,"canCreate",null);l.__decorate([t.property({readOnly:!0})],
C.prototype,"canUpdate",null);l.__decorate([t.property({readOnly:!0})],C.prototype,"editableItems",null);l.__decorate([t.property({readOnly:!0})],C.prototype,"failures",void 0);l.__decorate([t.property()],C.prototype,"attachmentsViewModel",void 0);l.__decorate([t.property()],C.prototype,"featureFormViewModel",void 0);l.__decorate([t.property()],C.prototype,"featureTemplatesViewModel",void 0);l.__decorate([t.property()],C.prototype,"layerInfos",void 0);l.__decorate([t.property()],C.prototype,"sketchViewModel",
void 0);l.__decorate([w.aliasOf("sketchViewModel.snappingOptions")],C.prototype,"snappingOptions",void 0);l.__decorate([t.property()],C.prototype,"spinnerViewModel",void 0);l.__decorate([t.property()],C.prototype,"state",null);l.__decorate([t.property({readOnly:!0})],C.prototype,"syncing",null);l.__decorate([t.property()],C.prototype,"view",null);return C=l.__decorate([p.subclass("esri.widgets.Editor.EditorViewModel")],C)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/subclass ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t){z=function(p){function q(a){a=p.call(this,a)||this;a.elevationInfo=null;a.graphics=new y["default"];a.screenSizePerspectiveEnabled=!0;a.type="graphics";a.internal=!1;return a}b._inheritsLoose(q,p);var d=q.prototype;d.destroy=function(){this.removeAll();this.graphics.destroy()};d.add=function(a){this.graphics.add(a);return this};d.addMany=function(a){this.graphics.addMany(a);return this};d.removeAll=function(){this.graphics.removeAll();return this};d.remove=function(a){this.graphics.remove(a)};
d.removeMany=function(a){this.graphics.removeMany(a)};d.on=function(a,c){return p.prototype.on.call(this,a,c)};d.graphicChanged=function(a){this.emit("graphic-update",a)};return q}(u.BlendLayer(x.ScaleRangeLayer(w)));l.__decorate([m.property({type:t})],z.prototype,"elevationInfo",void 0);l.__decorate([m.property(y.graphicsCollectionProperty())],z.prototype,"graphics",void 0);l.__decorate([m.property({type:["show","hide"]})],z.prototype,"listMode",void 0);l.__decorate([m.property()],z.prototype,"screenSizePerspectiveEnabled",
void 0);l.__decorate([m.property({readOnly:!0})],z.prototype,"type",void 0);l.__decorate([m.property({constructOnly:!0})],z.prototype,"internal",void 0);return z=l.__decorate([k.subclass("esri.layers.GraphicsLayer")],z)})},"esri/widgets/Editor/BatchCreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/trackingUtils ../../views/interactive/snapping/FeatureSnappingLayerSource ./BatchCreateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q){var d;C=d=function(a){function c(e){e=a.call(this,e)||this;e.type="batch-create";e.createFeatureState="create-new";e.featureFormHandle=null;e.visualVariableAttributes={rotation:null,size:null};e.highlightHandles=new Map;e.preventDefaultActionOnCancel=!1;return e}b._inheritsLoose(c,a);var r=c.prototype;r.updatePendingFeature=function(){var e=b._asyncToGenerator(function*(h){this.preventDefaultActionOnCancel=!0;this.data.viewModel.sketchViewModel.cancel();m.remove(this.lastActiveGraphics,
h);return this.startUpdating(h)});return function(h){return e.apply(this,arguments)}}();c.create=function(e,h,v){e=new d({data:new t.BatchCreateWorkflowData({viewModel:e}),onCommit:function(){var E=b._asyncToGenerator(function*(n){yield v(n.creationInfo.layer,{addFeatures:n.viewModel.sketchViewModel.layer.graphics.toArray()})});return function(n){return E.apply(this,arguments)}}()});e._set("steps",this._createWorkflowSteps(e,h));return e};r.highlight=function(e){const h=this.data.viewModel.view;"3d"===
h.type&&this.highlightHandles.set(e,h.highlight(e))};r.removeHighlight=function(e){z.removeMaybe(this.highlightHandles.get(e));this.highlightHandles.delete(e)};r.startCreating=function(){var e=b._asyncToGenerator(function*(){this.createFeatureState="create-new";return q.startCreatingNewFeature(this.data.viewModel.sketchViewModel,this.data.creationInfo)});return function(){return e.apply(this,arguments)}}();r.startUpdating=function(){var e=b._asyncToGenerator(function*(h){var v;const E=this.data.viewModel,
n=E.sketchViewModel,B=this.data.creationInfo.layer;E.featureFormViewModel.set({feature:h,fieldConfig:null==(v=q.findLayerInfo(E.layerInfos,B))?void 0:v.fieldConfig});z.removeMaybe(this.featureFormHandle);this.featureFormHandle=E.featureFormViewModel.on("value-change",b._asyncToGenerator(function*(){h.attributes=E.featureFormViewModel.getValues();"3d"===n.view.type&&(yield q.updateGraphicSymbolWhenRequired(h))}));this.removeHighlight(h);this.createFeatureState="update-pending";this.visualVariableAttributes=
q.getVisualVariableAttributes(h);return q.startUpdatingFeature(n,h,B,this.visualVariableAttributes)});return function(h){return e.apply(this,arguments)}}();c._createWorkflowSteps=function(e,h="awaiting-feature-creation-info"){const {data:v,handles:E}=e;let n=null,B=!0;h=q.createWorkflowSteps(["awaiting-feature-creation-info","batch-creating-features"],h,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var f=this;return b._asyncToGenerator(function*(){v.creationInfo=
null;E.add(v.viewModel.featureTemplatesViewModel.on("select",({item:D})=>{v.creationInfo={layer:D.layer,template:D.template};v.viewModel.activeWorkflow.next()}),f.id)})()},tearDown(){var f=this;return b._asyncToGenerator(function*(){E.remove(f.id)})()}}),"batch-creating-features":()=>({id:"batch-creating-features",setUp(){var f=this;return b._asyncToGenerator(function*(){const D=v.viewModel.view,H=v.viewModel.sketchViewModel;B=H.updateOnGraphicClick;H.updateOnGraphicClick=!1;e.lastActiveGraphics=
[];e.featureFormHandle=z.removeMaybe(e.featureFormHandle);e.visualVariableAttributes={rotation:null,size:null};const P=H.on("create",function(){var O=b._asyncToGenerator(function*(V){if("cancel"===V.state){if(e.preventDefaultActionOnCancel){e.preventDefaultActionOnCancel=!1;return}if(1>e.lastActiveGraphics.length)return e.startCreating();V=e.lastActiveGraphics.pop();return e.startUpdating(V)}if("complete"===V.state)return e.startUpdating(V.graphic)});return function(V){return O.apply(this,arguments)}}()),
R=H.on("update",function(){var O=b._asyncToGenerator(function*(V){var M=V.graphics[0];if("complete"===V.state){M!==n&&(e.lastActiveGraphics.push(M),e.highlight(M));n=null;if(V.aborted&&e.preventDefaultActionOnCancel){e.preventDefaultActionOnCancel=!1;return}return e.startCreating()}"start"===V.state&&e.removeHighlight(M);yield q.visualVariableInteractiveUpdate(D,M,V,e.visualVariableAttributes);V=M.attributes;z.isSome(e.visualVariableAttributes.rotation)&&({field:M}=e.visualVariableAttributes.rotation,
v.viewModel.featureFormViewModel.setValue(M,V[M]));z.isSome(e.visualVariableAttributes.size)&&({field:M}=e.visualVariableAttributes.size,v.viewModel.featureFormViewModel.setValue(M,V[M]))});return function(V){return O.apply(this,arguments)}}()),K=H.on("delete",function(){var O=b._asyncToGenerator(function*(V){V=V.graphics[0];m.remove(e.lastActiveGraphics,V);n=V});return function(V){return O.apply(this,arguments)}}());let J=null;const Q=x.reactionInit(()=>{var O;const V=H.snappingOptions.featureSources.find(M=>
M.layer===v.creationInfo.layer);return{hasFeatureLayerSource:!!V,enabled:null!=(O=null==V?void 0:V.enabled)?O:!1}},({hasFeatureLayerSource:O,enabled:V})=>{const M=H.snappingOptions.featureSources;O?(z.isNone(J)&&(J=new y({layer:H.layer,enabled:V}),M.add(J)),J.enabled=V):(z.isSome(J)&&M.remove(J),J=z.destroyMaybe(J))}),F=D.on("immediate-click",function(){var O=b._asyncToGenerator(function*(V){V=yield D.hitTest(V,{include:H.layer});0<V.results.length&&(V=V.results[0].graphic,"transform"!==H.activeTool&&
"reshape"!==H.activeTool||H.updateGraphics.getItemAt(0)===V||(yield e.updatePendingFeature(V)))});return function(V){return O.apply(this,arguments)}}());yield e.startCreating();E.add({remove:()=>{z.removeMaybe(e.featureFormHandle);P.remove();R.remove();K.remove();Q.remove();z.isSome(J)&&H.snappingOptions.featureSources.remove(J);J=z.destroyMaybe(J);H.cancel();F.remove()}},f.id)})()},tearDown(f){var D=this;return b._asyncToGenerator(function*(){f.cancelled&&v.viewModel.sketchViewModel.layer.removeAll();
E.remove(D.id);v.viewModel.sketchViewModel.updateOnGraphicClick=B})()}})});return q.avoidFeatureTemplateSelectionWithOnlyOneItem(v,h)};b._createClass(c,[{key:"numPendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics.length}},{key:"pendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics}}]);return c}(p);return C=d=l.__decorate([u.subclass("esri.widgets.Editor.BatchCreateWorkflow")],C)})},"esri/widgets/Editor/BatchCreateWorkflowData":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w,u){b.BatchCreateWorkflowData=function(x){function y(t){t=x.call(this,t)||this;t.creationInfo=null;t.viewModel=null;return t}l._inheritsLoose(y,x);return y}(z);m.__decorate([C.property()],b.BatchCreateWorkflowData.prototype,"creationInfo",void 0);m.__decorate([C.property()],b.BatchCreateWorkflowData.prototype,"viewModel",void 0);b.BatchCreateWorkflowData=m.__decorate([u.subclass("esri.widgets.Editor.BatchCreateWorkflowData")],b.BatchCreateWorkflowData);Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),function(b,l,m,z,C,A,g,k,w,u,x){z=function(y){function t(q){q=y.call(this,q)||this;q._indexHistory=[];q._lastStepIndex=
-1;q._stepIndex=-1;q._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};q.data=void 0;q.started=!1;q.steps=[];q.type=null;return q}b._inheritsLoose(t,y);var p=t.prototype;p.cancel=function(){var q=b._asyncToGenerator(function*(d={force:!0}){return!1!==d.force?this._cancel():new Promise((a,c)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(a)},deny:()=>c(new m("workflow:cancel-denied","Request to cancel workflow was denied."))}})})});return function(){return q.apply(this,
arguments)}}();p.commit=function(){var q=b._asyncToGenerator(function*(){this.handles.remove(this._handleKeys.beforeCommit);yield this.onCommit(this.data);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit");this.started&&(yield this.reset())});return function(){return q.apply(this,arguments)}}();p.go=function(){var q=b._asyncToGenerator(function*(d){var {steps:a}=this;a=a.findIndex(c=>c.id===d);this._indexHistory.push(this._stepIndex);yield this._go(a)});return function(d){return q.apply(this,
arguments)}}();p.next=function(){var q=b._asyncToGenerator(function*(){this._indexHistory.push(this._stepIndex);yield this._go(this._stepIndex+1)});return function(){return q.apply(this,arguments)}}();p.previous=function(){var q=b._asyncToGenerator(function*(d={cancelCurrentStep:!1}){yield this._go(this._indexHistory.pop(),d.cancelCurrentStep)});return function(){return q.apply(this,arguments)}}();p.reset=function(){var q=b._asyncToGenerator(function*(){yield this._cancel(!1);yield this.start()});
return function(){return q.apply(this,arguments)}}();p.start=function(){var q=b._asyncToGenerator(function*(){this._set("started",!0);yield this._go(-1===this._stepIndex?0:this._stepIndex)});return function(){return q.apply(this,arguments)}}();p._cancel=function(){var q=b._asyncToGenerator(function*(d=!0){this.started&&(this._set("started",!1),yield this.steps[this._stepIndex].tearDown({cancelled:!0}),this.data&&this.data.viewModel.sketchViewModel.layer.removeAll());this.handles.remove([this._handleKeys.afterCommit,
this._handleKeys.beforeCommit]);this._resetIndexing(d);d&&this.emit("cancel")});return function(){return q.apply(this,arguments)}}();p._go=function(){var q=b._asyncToGenerator(function*(d=-1,a=!1){-1>=d||d>=this.steps.length||(this.started&&(-1<this._lastStepIndex&&(yield this.steps[this._lastStepIndex].tearDown({cancelled:a})),yield this.steps[d].setUp(),this._lastStepIndex=d),this._stepIndex=d,this._notifyStepProps())});return function(){return q.apply(this,arguments)}}();p._resetIndexing=function(q=
!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;q&&this._notifyStepProps()};p._notifyStepProps=function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};b._createClass(t,[{key:"hasNextStep",get:function(){const {steps:q}=this;return!!(q&&this._stepIndex<q.filter(d=>!d.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"stepId",get:function(){var {steps:q}=this;return(q=q&&q[this._stepIndex])&&
q.id}}]);return t}(C.HandleOwnerMixin(z.EventedAccessor));l.__decorate([A.property()],z.prototype,"data",void 0);l.__decorate([A.property()],z.prototype,"hasNextStep",null);l.__decorate([A.property()],z.prototype,"hasPreviousStep",null);l.__decorate([A.property()],z.prototype,"onCommit",void 0);l.__decorate([A.property()],z.prototype,"started",void 0);l.__decorate([A.property({readOnly:!0})],z.prototype,"stepId",null);l.__decorate([A.property()],z.prototype,"steps",void 0);l.__decorate([A.property({readOnly:!0})],
z.prototype,"type",void 0);l.__decorate([A.property()],z.prototype,"commit",null);return z=l.__decorate([x.subclass("esri.widgets.Editor.Workflow")],z)})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Graphic ../../core/has ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ../../core/watchUtils ../../core/accessorSupport/diffUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r){function e(oa){const G=oa.sourceLayer;a:switch(G.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":var I=!0;break a;default:I=!1}var Z=(oa=I&&p.getVisualVariableValues(G.renderer,oa))?oa.map(da=>da.variable):[];I=Z.filter(da=>"rotation"===da.type&&(!da.axis||"heading"===da.axis));oa=I[0];I=1===I.length&&oa.field&&!oa.valueExpression;var ca=Z.filter(da=>"size"===da.type);Z=ca[0];ca=1===ca.length&&
"real-world-size"===t.getTransformationType(Z)&&Z.field&&!Z.useSymbolValue&&!Z.valueExpression;return{rotation:I?h(oa,G):null,size:ca?B(Z,G):null}}function h(oa,G){const I="heading"===(oa.axis||"heading")&&"arithmetic"===oa.rotationType?-1:1,Z=oa.field,ca=(oa=G.fields&&G.fields.filter(ha=>ha.name===Z))&&1===oa.length?oa[0].type:"double";var da=0,ba=0;return{field:Z,getDefault:()=>Promise.resolve(0),getValue:ha=>{ba=da-I*ha;return f((ba+360)%360,ca)},initValue:ha=>{da=null!=ha?ha:ba;ba=0},isUpdatingInteractively:!1}}
function v(oa,G){switch(G){case "width":return oa[0];case "depth":return oa[1];case "height":return oa[2];default:return oa[2]||oa[1]||oa[0]}}function E(oa,G,I){return n.apply(this,arguments)}function n(){n=m._asyncToGenerator(function*(oa,G,I){if(A.isNone(G))return 0;({symbol:G}=q.to3D(G));if(A.isNone(G)||"web-style"===G.type)return 0;G=G.symbolLayers.getItemAt(0);if(!G)return 0;switch(G.type){case "icon":return{computeIconLayerResourceSize:I}=yield new Promise(function(Z,ca){b(["../../symbols/support/symbolLayerUtils"],
Z,ca)}),G.size||Math.min(ya.icon,(yield I(G,ya.icon))[0])||ya.icon;case "text":return G.size||ya.text;case "line":return G.size||ya.line;case "object":{const {computeObjectLayerResourceSize:Z}=yield new Promise(function(ca,da){b(["../../symbols/support/symbolLayerUtils"],ca,da)});oa=yield Z(G,oa.scale/ya.viewScaleSizeFactor);return v(oa,I)}case "path":case "extrude":return G.size||oa.scale/ya.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}});return n.apply(this,arguments)}
function B(oa,G){const I=oa.field,Z=oa.axis,ca=(G=G.fields&&G.fields.filter(W=>W.name===I))&&1===G.length?G[0].type:"double";var da=0,ba=0;const ha=y.meterIn[oa.valueUnit];let ea;ea="area"===oa.valueRepresentation?W=>(W*ha/2)**2*Math.PI:"radius"===oa.valueRepresentation||"distance"===oa.valueRepresentation?W=>W*ha/2:W=>W*ha;return{field:I,getDefault:function(){var W=m._asyncToGenerator(function*(X,Y){return f(ea(yield E(Y,X,Z)),ca)});return function(X,Y){return W.apply(this,arguments)}}(),getValue:(W,
X)=>{da||(da=X.pixelSizeAt(X.center));ba=da*W;return f(ba,ca)},initValue:W=>{da=null!=W?W:ba;ba=0},isUpdatingInteractively:!1}}function f(oa,G){switch(G){case "small-integer":case "integer":case "long":return Math.round(oa);case "double":case "single":return oa;default:return 0}}function D(oa){return H.apply(this,arguments)}function H(){H=m._asyncToGenerator(function*(oa){const G=yield d.getDisplayedSymbol(oa,{useSourceLayer:!0,ignoreGraphicSymbol:!0}),I=u.diff(oa.symbol,G);A.isSome(I)&&(oa.symbol=
G)});return H.apply(this,arguments)}function P(oa){if("mesh"===oa||"multipatch"===oa)throw Error("Mesh and Multipatch not supported");return oa}function R(){R=m._asyncToGenerator(function*(oa,G,I){yield K(oa,G);const Z=oa.on("create",function(){var ca=m._asyncToGenerator(function*(da){if("cancel"===da.state)return K(oa,G);"complete"===da.state&&(da=da.graphic,da.sourceLayer||(da.sourceLayer=G.layer),da.attributes||(da.attributes={...G.template.prototype.attributes}),yield D(da),I(da))});return function(da){return ca.apply(this,
arguments)}}());return{remove:()=>{Z.remove();oa.cancel()}}});return R.apply(this,arguments)}function K(oa,G){return J.apply(this,arguments)}function J(){J=m._asyncToGenerator(function*(oa,G){const I=G.layer;G={...G.template.prototype.attributes};yield Q(oa,I,G);G={graphicProperties:{attributes:G,sourceLayer:I},hasZ:I.capabilities.data.supportsZ};oa.layer.elevationInfo=I.elevationInfo;oa.create(P(I.geometryType),G)});return J.apply(this,arguments)}function Q(oa,G,I){return F.apply(this,arguments)}
function F(){F=m._asyncToGenerator(function*(oa,G,I){var Z;if("3d"===oa.view.type){G=new z({sourceLayer:G,attributes:I});var {rotation:ca,size:da}=e(G),ba=yield d.getDisplayedSymbol(G,{useSourceLayer:!0}),ha=!1;for(const ea of[da,ca])A.isNone(ea)||null!=I[ea.field]||(I[ea.field]=yield ea.getDefault(ba,oa.view),ha=!0);ha&&(ba=yield d.getDisplayedSymbol(G,{useSourceLayer:!0}));switch(null==(Z=ba)?void 0:Z.type){case "simple-fill":case "polygon-3d":oa.polygonSymbol=ba;break;case "simple-line":case "line-3d":oa.polylineSymbol=
ba;break;case "simple-marker":case "point-3d":oa.pointSymbol=ba}}});return F.apply(this,arguments)}function O(oa,G,I,Z){return V.apply(this,arguments)}function V(){V=m._asyncToGenerator(function*(oa,G,I,Z){if(0===oa.length)return[];const {updatable:ca,graphicsByLayer:da}=yield I.async(m._asyncToGenerator(function*(){var {results:ba}=yield g.whenOrAbort(r.hitTestSelectSameDistance(G,I),Z);const ha=new Map,ea=({layer:W})=>{var X=ha.get(W);return X?X:(X=[],ha.set(W,X),X)};ba.forEach(({graphic:W})=>ea(W).push(W));
ba=oa.filter(({supports:W,layer:X})=>-1<W.indexOf("update")&&ha.has(X));0!==ba.length&&I.stopPropagation();return{updatable:ba,graphicsByLayer:ha}}));return g.whenOrAbort(g.eachAlways(ca.map(function(){var ba=m._asyncToGenerator(function*({layer:ha}){const {objectIdField:ea,displayField:W}=ha,X=[ea];ha.fieldsIndex.has(W)&&X.push(W);const Y=da.get(ha);if(Y.some(aa=>X.some(ia=>!(ia in aa.attributes)))){const aa=ha.createQuery();aa.outFields=X;aa.returnGeometry=!1;aa.objectIds=Y.map(ia=>ia.getObjectId());
return ha.queryFeatures(aa,{signal:Z}).then(({features:ia})=>ia)}return Y});return function(ha){return ba.apply(this,arguments)}}())),Z)});return V.apply(this,arguments)}function M(oa,G,I,Z){return T.apply(this,arguments)}function T(){T=m._asyncToGenerator(function*(oa,G,I,Z){if(0===oa.length)return[];const ca=yield I.async(m._asyncToGenerator(function*(){var {results:da}=yield g.whenOrAbort(G.hitTest(I),Z);if(0===da.length)return[];const ba=new Set;da.forEach(({graphic:ha})=>ba.add(ha.layer));da=
oa.items.filter(({layer:ha,supports:ea})=>-1<ea.indexOf("update")&&ba.has(ha));0<da.length&&I.stopPropagation();return da}));return g.whenOrAbort(g.eachAlways(ca.map(({layer:da})=>{const {objectIdField:ba,displayField:ha}=da;var ea=[ba];da.fieldsIndex.has(ha)&&ea.push(ha);const W=da.createQuery();W.outFields=ea;W.returnGeometry=!1;ea="renderer"in da?x.calculateTolerance({renderer:da.renderer,event:I}):0;W.geometry=c.createQueryGeometry(I.mapPoint,ea,G);W.outSpatialReference=G.spatialReference;return da.queryFeatures(W,
{signal:Z}).then(({features:X})=>X)})),Z)});return T.apply(this,arguments)}function S(){S=m._asyncToGenerator(function*(oa,G,I,Z){switch(G.type){case "3d":return O(oa,G,I,Z);case "2d":return M(oa,G,I,Z)}});return S.apply(this,arguments)}function L(){L=m._asyncToGenerator(function*(oa,G,I){const Z=oa.layer,ca=Z.createQuery();ca.objectIds=[oa.getAttribute(Z.objectIdField)];ca.outFields=["*"];ca.outSpatialReference=G.spatialReference;ca.returnM=Z.capabilities.data.supportsM;ca.returnZ=Z.capabilities.data.supportsZ;
return(yield Z.queryFeatures(ca,{signal:I})).features[0]});return L.apply(this,arguments)}function N(oa,G,I,Z){return U.apply(this,arguments)}function U(){U=m._asyncToGenerator(function*(oa,G,I,Z){let ca=!1;const {rotation:da,size:ba}=Z;[da,ba].forEach(function(){var ha=m._asyncToGenerator(function*(ea){if(!A.isNone(ea)){var W=G.attributes[ea.field];A.isSome(W)?ea.initValue(W):(W=yield ea.getDefault(G.symbol,oa.view),ea.initValue(W),G.setAttribute(ea.field,W),ca=!0)}});return function(ea){return ha.apply(this,
arguments)}}());ca&&"3d"===oa.view.type&&(yield D(G));Z={multipleSelectionEnabled:!1};"point"===I.geometryType&&(Z.enableRotation=A.isSome(da),Z.enableScaling=A.isSome(ba));oa.layer.elevationInfo=I.elevationInfo;return oa.update(G,Z)});return U.apply(this,arguments)}function fa(oa,G,I,Z){return ka.apply(this,arguments)}function ka(){ka=m._asyncToGenerator(function*(oa,G,I,Z){var ca;if(A.isSome(G.geometry)&&"point"===(null==(ca=G.geometry)?void 0:ca.type)){ca=Z.rotation;var da=I.toolEventInfo;da=!da||
"rotate-start"!==da.type&&"rotate"!==da.type&&"rotate-stop"!==da.type?null:da;if(A.isSome(ca)&&A.isSome(da))if("rotate-stop"===da.type)ca.isUpdatingInteractively=!1,ca.initValue();else{ca.isUpdatingInteractively=!0;const {field:ba,getValue:ha}=ca;G.attributes[ba]=ha(da.angle,oa)}Z=Z.size;I=I.toolEventInfo;I=!I||"scale-start"!==I.type&&"scale"!==I.type&&"scale-stop"!==I.type?null:I;if(A.isSome(Z)&&A.isSome(I))if("scale-stop"===I.type)Z.isUpdatingInteractively=!1,Z.initValue();else{Z.isUpdatingInteractively=
!0;const {field:ba,getValue:ha}=Z;G.attributes[ba]=ha(I.xScale,oa)}"3d"===oa.type&&(yield D(G))}});return ka.apply(this,arguments)}function wa(){wa=m._asyncToGenerator(function*(oa,G,I,Z,ca){const da=oa.clone();yield D(da);I.layer.add(da);const ba=oa.sourceLayer,ha=Z.whenLayerView(ba),ea=()=>{const sa=oa.attributes[oa.layer.objectIdField];ha.then(ra=>ra.setVisibility(sa,!1),()=>{});return{remove(){ha.then(ra=>ra.setVisibility(sa,!0),()=>{})}}};let W=null,X=null;if("3d"===Z.type){const sa=new a.GraphicState({graphic:da});
W=Z.trackGraphicState(sa);w.init(sa,"displaying",ra=>{X=ra?ea():A.removeMaybe(X)})}else X=ea();N(I,da,ba,G);let Y=null;ha.then(sa=>Y=sa,()=>{});const aa=G.size,ia=G.rotation,ja=oa.watch("attributes",function(){var sa=m._asyncToGenerator(function*(ra){let na=!1;for(const ua in ra){const za=ra[ua];za!==da.attributes[ua]&&(da.setAttribute(ua,za),A.isSome(aa)&&!aa.isUpdatingInteractively&&aa.field===ua&&aa.initValue(za),A.isSome(ia)&&!ia.isUpdatingInteractively&&ia.field===ua&&ia.initValue(za),A.isNone(Y)||
Y.requiredFields.includes(ua))&&(na=!0)}na&&"3d"===Z.type&&(yield D(da))});return function(ra){return sa.apply(this,arguments)}}()),va=I.on("update",function(){var sa=m._asyncToGenerator(function*(ra){const na=ra.graphics[0];if("complete"===ra.state)return N(I,na,ba,G);yield fa(Z,na,ra,G);ca(na.clone())});return function(ra){return sa.apply(this,arguments)}}()),ma=I.on(["undo","redo"],function(){var sa=m._asyncToGenerator(function*(ra){ca(ra.graphics[0].clone())});return function(ra){return sa.apply(this,
arguments)}}());Z.map.add(I.layer);const ta=()=>{};return{interactive:{remove(){ma.remove();va.remove();I.cancel();ja&&ja.remove();this.remove=ta}},visual:{remove(){A.removeMaybe(X);Z.whenLayerView(ba).then(sa=>w.whenFalseOnce(sa,"updating")).then(()=>{A.removeMaybe(W);I.layer.remove(da);this.remove=ta})}}}});return wa.apply(this,arguments)}const ya={icon:k.px2pt(24),text:k.px2pt(12),line:k.px2pt(1),viewScaleSizeFactor:100};l.avoidFeatureTemplateSelectionWithOnlyOneItem=function(oa,G){oa.viewModel.refreshCreationTemplates();
if("awaiting-feature-creation-info"===G[0].id){var I=oa.viewModel.featureTemplatesViewModel.items;1!==I.length?I=null:(I=I[0],I="items"in I?1===I.items.length?I.items[0]:null:I);A.isSome(I)&&(oa.creationInfo={layer:I.layer,template:I.template},G.shift())}return G};l.createWorkflowSteps=function(oa,G,I){let Z=!1;return oa.filter(ca=>Z?!0:Z=ca===G).map(ca=>I[ca]())};l.fetchCandidates=function(oa,G,I,Z){return S.apply(this,arguments)};l.fetchFullFeature=function(oa,G,I){return L.apply(this,arguments)};
l.findLayerInfo=function(oa,G){return oa&&oa.find(I=>I.layer===G)};l.getVisualVariableAttributes=e;l.setUpFeatureAdd=function(oa,G,I){return R.apply(this,arguments)};l.setUpGeometryUpdate=function(oa,G,I,Z,ca){return wa.apply(this,arguments)};l.sizeDefaults=ya;l.startCreatingNewFeature=K;l.startUpdatingFeature=N;l.updateGraphicSymbolWhenRequired=D;l.visualVariableInteractiveUpdate=fa;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],
function(b){function l(C,A){return A?"xoffset"in A&&A.xoffset?Math.max(C,Math.abs(A.xoffset)):"yoffset"in A&&A.yoffset?Math.max(C,Math.abs(A.yoffset||0)):C:C}function m(C,A){if("number"===typeof C)return C;if(C&&C.stops&&C.stops.length){{C=C.stops;let g=A=0;for(let k=0;k<C.length;k++){const w=C[k].size;"number"===typeof w&&(A+=w,g++)}C=A/g}return C}return A}function z(C,A){if(!A)return C;A=A.filter(w=>"size"===w.type).map(w=>{const {maxSize:u,minSize:x}=w;return(m(u,C)+m(x,C))/2});let g=0;const k=
A.length;if(0===k)return C;for(let w=0;w<k;w++)g+=A[w];return Math.max(Math.floor(g/k),C)}b.calculateTolerance=function(C){const A=C&&C.renderer;C="touch"===(C&&C.event&&C.event.pointerType)?9:6;if(!A)return C;C="visualVariables"in A?z(C,A.visualVariables):C;if("simple"===A.type)return l(C,A.symbol);if("unique-value"===A.type){let g=C;A.uniqueValueInfos.forEach(k=>{g=l(g,k.symbol)});return g}if("class-breaks"===A.type){let g=C;A.classBreakInfos.forEach(k=>{g=l(g,k.symbol)});return g}return C};Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass".split(" "),function(b,l,m,z,C,A,g,k,w,u){b.GraphicState=function(x){function y(t){t=
x.call(this,t)||this;t.tracking=!1;t.displaying=!1;t.isDraped=!1;return t}l._inheritsLoose(y,x);return y}(z.EventedAccessor);m.__decorate([C.property({constructOnly:!0})],b.GraphicState.prototype,"graphic",void 0);m.__decorate([C.property()],b.GraphicState.prototype,"tracking",void 0);m.__decorate([C.property()],b.GraphicState.prototype,"displaying",void 0);m.__decorate([C.property()],b.GraphicState.prototype,"isDraped",void 0);b.GraphicState=m.__decorate([u.subclass("esri.views.3d.layers.graphics.GraphicState")],
b.GraphicState);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/support/drapedUtils":function(){define("exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils ../../geometry/Extent".split(" "),function(b,l,m,z,C,A){function g(w,u,x,y=new A){let t;if("2d"===x.type)t=u*x.resolution;else if("3d"===x.type){var p=x.overlayPixelSizeInMapUnits(w),q=x.basemapSpatialReference;t=m.isSome(q)&&!q.equals(x.spatialReference)?z.getMetersPerUnitForSR(q)/
z.getMetersPerUnitForSR(x.spatialReference):u*p}u=w.x-t;p=w.y-t;q=w.x+t;w=w.y+t;({spatialReference:x}=x);y.xmin=Math.min(u,q);y.ymin=Math.min(p,w);y.xmax=Math.max(u,q);y.ymax=Math.max(p,w);y.spatialReference=x;return y}const k=new A;b.createQueryGeometry=g;b.intersectsDrapedGeometry=function(w,u,x){w=x.toMap(w);if(m.isNone(w))return!1;const y=C.calculateTolerance();return g(w,y,x,k).intersects(u)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers"],function(b,l){function m(){m=l._asyncToGenerator(function*(z,C){if("2d"===z.type)return z.hitTest(C);z=yield z.hitTest(C);const A=z.results[0];C=z.results.findIndex(g=>g.distance!==A.distance);-1!==C&&(z.results=z.results.slice(0,C));return z});return m.apply(this,arguments)}b.hitTestSelectSameDistance=function(z,C){return m.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t){var p;z=p=function(q){function d(a){a=q.call(this,a)||this;a.type="create";return a}b._inheritsLoose(d,q);d.create=function(a,c,r){a=new p({data:new u({edits:new x.Edits,viewModel:a}),onCommit:function(){var e=b._asyncToGenerator(function*(h){yield r(h.creationInfo.layer,{addFeatures:[h.edits.feature]})});return function(h){return e.apply(this,arguments)}}()});a._set("steps",this._createWorkflowSteps(a,c));return a};d._createWorkflowSteps=function(a,c="awaiting-feature-creation-info"){const {data:r,
handles:e}=a;a=t.createWorkflowSteps(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature"],c,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var h=this;return b._asyncToGenerator(function*(){r.creationInfo=null;r.edits.feature=null;r.viewModel.featureTemplatesViewModel.select(null);e.add(r.viewModel.featureTemplatesViewModel.on("select",({item:v})=>{r.creationInfo={layer:v.layer,template:v.template};r.viewModel.activeWorkflow.next()}),
h.id)})()},tearDown(){var h=this;return b._asyncToGenerator(function*(){e.remove(h.id)})()}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",setUp(){var h=this;return b._asyncToGenerator(function*(){e.add(yield t.setUpFeatureAdd(r.viewModel.sketchViewModel,r.creationInfo,v=>{r.edits.feature=v;r.viewModel.activeWorkflow.next()}),h.id)})()},tearDown(){var h=this;return b._asyncToGenerator(function*(){e.remove(h.id)})()}}),"editing-new-feature":()=>({id:"editing-new-feature",setUp(){var h=
this;return b._asyncToGenerator(function*(){var v;const E=r.edits.feature,n=E.sourceLayer,B=r.viewModel,f=B.sketchViewModel;B.featureFormViewModel.set({feature:E,fieldConfig:null==(v=t.findLayerInfo(B.layerInfos,n))?void 0:v.fieldConfig});f.allowDeleteKey=!1;const D=t.getVisualVariableAttributes(E);yield t.startUpdatingFeature(f,E,n,D);v=f.on("update",function(){var H=b._asyncToGenerator(function*(P){var R=P.graphics[0];if("complete"===P.state)return t.startUpdatingFeature(f,R,n,D);yield t.visualVariableInteractiveUpdate(f.view,
R,P,D);P=R.attributes;m.isSome(D.rotation)&&({field:R}=D.rotation,B.featureFormViewModel.setValue(R,P[R]));m.isSome(D.size)&&({field:R}=D.size,B.featureFormViewModel.setValue(R,P[R]))});return function(P){return H.apply(this,arguments)}}());e.add([r.viewModel.featureFormViewModel.on("value-change",b._asyncToGenerator(function*(){r.edits.updateAttributes(r.viewModel.featureFormViewModel.getValues());E.attributes=r.edits.feature.attributes;"3d"===f.view.type&&(yield t.updateGraphicSymbolWhenRequired(E))})),
v],h.id)})()},tearDown(h){var v=this;return b._asyncToGenerator(function*(){h.cancelled&&r.viewModel.sketchViewModel.layer.removeAll();e.remove(v.id)})()}})});return t.avoidFeatureTemplateSelectionWithOnlyOneItem(r,a)};return d}(y);return z=p=l.__decorate([w.subclass("esri.widgets.Editor.CreateWorkflow")],z)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w){m=function(u){function x(y){y=u.call(this,y)||this;y.creationInfo=null;y.edits=null;y.viewModel=null;return y}b._inheritsLoose(x,u);return x}(m);l.__decorate([z.property()],m.prototype,"creationInfo",void 0);l.__decorate([z.property()],m.prototype,"edits",void 0);l.__decorate([z.property()],m.prototype,"viewModel",void 0);return m=l.__decorate([w.subclass("esri.widgets.Editor.CreateWorkflowData")],m)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){function t(p){return A.isNone(p)?null:JSON.stringify(p)}b.Edits=function(p){function q(a){a=p.call(this,a)||this;a._baselineAttributesJSON=null;a._baselineGeometryJSON=null;a.feature=null;return a}l._inheritsLoose(q,p);var d=q.prototype;d.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=t(this.feature.attributes),this._baselineGeometryJSON=t(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};d.updateAttributes=
function(a){this.feature.attributes=a;this.notifyChange("attributesModified")};d.updateGeometry=function(a){this.feature.geometry=a;this.notifyChange("geometryModified")};l._createClass(q,[{key:"attributesModified",get:function(){const {_baselineAttributesJSON:a,feature:c}=this;return!(!c||a===t(c.attributes))}},{key:"geometryModified",get:function(){const {_baselineGeometryJSON:a,feature:c}=this;return!(!c||a===t(c.geometry))}},{key:"modified",get:function(){return this.attributesModified||this.geometryModified}}]);
return q}(C.HandleOwnerMixin(z));m.__decorate([g.property()],b.Edits.prototype,"attributesModified",null);m.__decorate([g.property()],b.Edits.prototype,"feature",void 0);m.__decorate([g.property()],b.Edits.prototype,"geometryModified",null);m.__decorate([g.property()],b.Edits.prototype,"modified",null);b.Edits=m.__decorate([y.subclass("esri.widgets.Editor.Edits")],b.Edits);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a){var c;g=c=function(r){function e(v){v=r.call(this,v)||this;v.type="update";return v}b._inheritsLoose(e,r);e.create=function(v,E,n){v=new c({data:new q({edits:new p.Edits,viewModel:v}),onCommit:function(){var B=b._asyncToGenerator(function*(f){const D=f.edits.feature,H=D.sourceLayer,P=D.clone();if(!f.edits.attributesModified){const {objectIdField:R}=H;P.attributes={[R]:D.getAttribute(R)}}f.edits.geometryModified||(P.geometry=null);yield n(H,{updateFeatures:[P]})});
return function(f){return B.apply(this,arguments)}}()});v._set("steps",this._createWorkflowSteps(v,E));return v};var h=e.prototype;h.highlight=function(v){var {data:{viewModel:{view:E}}}=this;E=v&&E.allLayerViews.items.find(({layer:n})=>n===v.layer);t.highlightsSupported(E)&&this.handles.add(E.highlight(v),"candidate-highlight")};h.unhighlight=function(){this.handles.remove("candidate-highlight")};e._createWorkflowSteps=function(v,E="awaiting-feature-to-update"){const {data:n,handles:B}=v;return a.createWorkflowSteps(["awaiting-feature-to-update",
"awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],E,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",setUp(){var f=this;return b._asyncToGenerator(function*(){const {spinnerViewModel:D,view:H}=n.viewModel;let P=null;B.add({remove(){P&&(P.abort(),P=null)}},f.id);n.edits.feature=null;const R=H.on("immediate-click",K=>{D.location=K.mapPoint;D.visible=!0;P&&P.abort();const {editableItems:J}=n.viewModel;P=C.createAbortController();
(new Promise((Q,F)=>{C.onAbort(P.signal,()=>F(C.createAbortError()));Q(a.fetchCandidates(J,H,K,P.signal))})).then(Q=>{C.throwIfAborted(P);n.candidates=Q.reduce((F,O)=>O.error?F:[...F,...O.value],[]);n.viewModel.spinnerViewModel.visible=1===n.candidates.length;0!==n.candidates.length&&(1===n.candidates.length?(n.edits.feature=n.candidates[0],n.viewModel.activeWorkflow.go("editing-existing-feature").catch(()=>{}).then(()=>n.viewModel.spinnerViewModel.visible=!1)):n.viewModel.activeWorkflow.next())})});
B.add(R,f.id)})()},tearDown(){var f=this;return b._asyncToGenerator(function*(){B.remove(f.id)})()}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",setUp(){var f=this;return b._asyncToGenerator(function*(){const {edits:D}=n;D.feature=null;B.add(A.watch(D,"feature",H=>{v.unhighlight();v.highlight(H)}),f.id)})()},tearDown(){var f=this;return b._asyncToGenerator(function*(){v.unhighlight();B.remove(f.id)})()}}),"editing-existing-feature":()=>({id:"editing-existing-feature",
setUp(){var f=this;return b._asyncToGenerator(function*(){const D=n.edits.feature,H=n.viewModel;n.editableItem=H.editableItems.find(O=>O.layer===D.layer);const P=C.createAbortController();B.add({remove:()=>P.abort()},f.id);var R=H.view.whenLayerView(D.layer),K=a.fetchFullFeature(D,H.view,P.signal);R=yield R;const J=yield K;if(!C.isAborted(P)){n.edits.updateGeometry(J.geometry);n.edits.updateAttributes(J.attributes);n.edits.trackChanges();K=J.sourceLayer;var Q=a.findLayerInfo(H.layerInfos,K);Q=Q&&
Q.fieldConfig;H.attachmentsViewModel.set({graphic:J,mode:"view"});H.featureFormViewModel.set({feature:J,fieldConfig:Q});var F="createInteractiveEditSession"in R?R.createInteractiveEditSession(D):null;R=[H.featureFormViewModel.on("value-change",O=>{n.edits.updateAttributes(H.featureFormViewModel.getValues());J.attributes=n.edits.feature.attributes;F&&F.setAttribute(O.fieldName,O.value)}),H.attachmentsViewModel.watch("mode",O=>{"add"===O&&n.viewModel.activeWorkflow.go("adding-attachment");"edit"===
O&&n.viewModel.activeWorkflow.go("editing-attachment")})];F&&(R.push(m.makeHandle(()=>F.rollback())),B.add(m.makeHandle(()=>F.commit()),v._handleKeys.afterCommit));({supportsGeometryUpdate:K}=K.capabilities.editing);if(K){H.sketchViewModel.allowDeleteKey=!1;const O=a.getVisualVariableAttributes(J),{interactive:V,visual:M}=yield a.setUpGeometryUpdate(J,O,H.sketchViewModel,H.view,({geometry:T,attributes:S})=>{if(z.isSome(O.rotation)){var {field:L}=O.rotation;H.featureFormViewModel.setValue(L,S[L])}z.isSome(O.size)&&
({field:L}=O.size,H.featureFormViewModel.setValue(L,S[L]));n.edits.updateAttributes(S);n.edits.updateGeometry(T)});R.push(V,M);B.add(V,v._handleKeys.beforeCommit);B.add(M,v._handleKeys.afterCommit)}else v.highlight(J);B.add(R,f.id);H.spinnerViewModel.visible=!1}})()},tearDown(){var f=this;return b._asyncToGenerator(function*(){v.unhighlight();B.remove(f.id)})()}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",setUp(){return b._asyncToGenerator(function*(){})()},
tearDown(){return b._asyncToGenerator(function*(){})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){})()}})})};return e}(d);return g=c=l.__decorate([y.subclass("esri.widgets.Editor.UpdateWorkflow")],g)})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w){m=function(u){function x(y){y=u.call(this,y)||this;y.candidates=null;y.editableItem=null;y.edits=null;y.viewModel=null;return y}b._inheritsLoose(x,u);return x}(m);l.__decorate([z.property()],m.prototype,"candidates",void 0);l.__decorate([z.property()],m.prototype,"editableItem",void 0);l.__decorate([z.property()],m.prototype,"edits",void 0);l.__decorate([z.property()],m.prototype,"viewModel",void 0);return m=l.__decorate([w.subclass("esri.widgets.Editor.UpdateWorkflowData")],
m)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/Collection ../../core/has ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../geometry/projectionEllipsoid ../../geometry/support/coordsUtils ../../layers/GraphicsLayer ../../views/DOMContainer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/Draw ../../views/draw/DrawAction ../../views/draw/support/createUtilsAsync ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/support/screenUtils ./support/OperationHandle ../../geometry/Point ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/CIMSymbol ../../symbols/SimpleLineSymbol".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E,n,B,f,D,H,P,R,K,J,Q,F,O,V,M,T,S,L,N,U,fa){function ka(ba){return Object.freeze({__proto__:null,"default":ba})}function wa(ba,ha){oa("undo",ba.history.undo,ba.history.redo,ha)}function ya(ba,ha){oa("redo",ba.history.redo,ba.history.undo,ha)}function oa(ba,ha,ea,W){const X=ha.pop().updates,Y=[];W.forEach((aa,ia)=>{ia=X[ia];null!=ia&&("geometry"in ia&&t.isSome(ia.geometry)&&(Y.push({geometry:aa.geometry}),aa.geometry=ia.geometry),"symbol"in ia&&
t.isSome(ia.symbol)&&(Y.push({symbol:aa.symbol}),aa.symbol=ia.symbol),"undo"in ia&&(Y.push(ia),ia[ba](aa)))});ea.push({updates:Y})}function G(ba){return{updates:ba.map(ha=>({geometry:ha.geometry}))}}function I(ba){return"requireError"in ba&&"aborted"===ba.requireError}const Z=y.getLogger("esri.widgets.Sketch.SketchViewModel"),ca={defaultZ:0},da={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,
preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};z=function(ba){function ha(W){W=ba.call(this,W)||this;W._activeFillGraphic=null;W._activeLineGraphic=null;W._centerIndicatorGraphic=null;W._centerSymbol=new L({style:"cross",size:6,color:[255,255,255]});W._defaultSegmentOffset=48;W._numUpdating=0;W._handles=new x;W._internalGraphicsLayer=new E({listMode:"hide",internal:!0,title:"SVM Internal"});W._lineGraphic=null;W._operationHandle=null;W._vertexGraphics=[];W._viewHandles=new x;
W._doUnnormalization=!1;W.activeFillSymbol=new N({style:"solid",color:[150,150,150,.2],outline:{color:[50,50,50],width:0}});W.activeLineSymbol=new U({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,
capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}});W.activeVertexSymbol=new L({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});W.allowDeleteKey=!0;W.layer=null;W.pointSymbol=new L({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});W.polygonSymbol=new N({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});W.polylineSymbol=new fa({color:[130,130,130,1],width:2});W._snappingManager=null;W.updateGraphics=
new g;W.updateOnGraphicClick=!0;W.updatePointSymbol=new L({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});W.updatePolygonSymbol=new N({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});W.updatePolylineSymbol=new fa({color:[12,207,255],width:2});W.vertexSymbol=new L({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});W._moduleLoaderAbortController=null;W._viewReadyAbortController=null;W._originalAutoOpenEnabled=null;W.defaultCreateOptions=
ca;W.defaultUpdateOptions=da;W.snappingOptions=new V;return W}l._inheritsLoose(ha,ba);var ea=ha.prototype;ea.initialize=function(){this._handles.add([d.watch(this,"layer",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:null}),d.on(this,"view.map.layers","change",W=>{W.removed.includes(this.layer)&&this.cancel()}),d.on(this,"layer.graphics","change",W=>{if(t.isSome(this._operationHandle))for(const X of W.removed)this.updateGraphics.includes(X)&&
(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(X):this._operationHandle.cancel())}),d.init(this,"layer.elevationInfo",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:null},!0),d.init(this,"view",W=>{t.destroyMaybe(this._snappingManager);W&&(this._snappingManager=new O.SnappingManager({view:W,options:this.snappingOptions}),"3d"===W.type&&(new Promise(function(X,Y){b(["../../views/3d/interactive/editingTools"],X,Y)}),
new Promise(function(X,Y){b(["../../views/3d/layers/GraphicsLayerView3D"],function(aa){X(ka(aa))},Y)})))},!0)])};ea.destroy=function(){this.cancel();this._handles=t.destroyMaybe(this._handles);this._viewHandles=t.destroyMaybe(this._viewHandles);this._removeDefaultLayer();t.destroyMaybe(this._draw);t.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};ea.cancel=function(){this._moduleLoaderAbortController=t.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=
t.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};ea.complete=function(){this._operationHandle&&this._operationHandle.complete()};ea.delete=function(){const {state:W,updateGraphics:X}=this;if("active"===W&&X.length){const {activeTool:Y,layer:aa}=this,ia=X.toArray();aa.removeMany(ia);this.cancel();this._emitDeleteEvent({graphics:ia,tool:Y})}};ea.create=function(){var W=l._asyncToGenerator(function*(X,Y){yield this._waitViewReady();if("disabled"===this.state)throw this.layer||
this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),p.createAbortError();this.cancel();this.view.activeTool=null;if(X){var aa=yield this._setupCreateOperation(X,Y);t.isNone(aa)||this.destroyed||(Y=null,"2d"===this.view.type&&(Y=this.view.map.layers.findIndex(ia=>ia.id===R.SNAPPING_GRAPHICS_LAYER_ID),Y=-1<Y?Y:null),J.addUniqueLayer(this.view,this._internalGraphicsLayer,
Y),aa.on("complete",()=>{if(aa===this._operationHandle){const ia=this.createGraphic,ja=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);aa.cancelled||null==ia||this.layer.add(ia);this.emit("create",{graphic:ia,state:ja?"cancel":"complete",tool:X,toolEventInfo:null,type:"create"})}}),this._operationHandle=aa,this.view.ready&&n.isDOMContainer(this.view)&&
this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")});return function(X,Y){return W.apply(this,arguments)}}();ea.update=function(){var W=l._asyncToGenerator(function*(X,Y){yield this._waitViewReady();const {layer:aa,view:ia,state:ja}=this;if("disabled"===ja)throw ia||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),aa||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),p.createAbortError();
this.cancel();this.view.activeTool=null;const va=Array.isArray(X)?X:[X];null!=X&&va&&va.length?va.some(ma=>ma.layer!==aa?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):t.isNone(ma.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):"2d"!==ia.type||ia.spatialReference.equals(ma.geometry.spatialReference)?!1:(this._logError("sketch:invalid-parameter",
"Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied IMapView."),!0))||(X=yield this._setupUpdateOperation(va,Y),this.destroyed||t.isNone(X)||I(X)||(J.addUniqueLayer(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(X,Y),this.emit("update",{graphics:va,state:"start",aborted:!1,tool:X.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")});return function(X,Y){return W.apply(this,
arguments)}}();ea.undo=function(){this.canUndo()&&this._operationHandle.undo()};ea.redo=function(){this.canRedo()&&this._operationHandle.redo()};ea.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};ea.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};ea.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};ea._getFirstHit=function(){var W=l._asyncToGenerator(function*(X){const Y=
[];switch(this.view.type){case "2d":var aa=yield this.view.hitTest(X);if(0<aa.results.length&&(aa=aa.results[0],aa.graphic)){var ia,ja;const va=aa.graphic;"vector-tile"!==(null==(ia=va.layer)?void 0:ia.type)&&"imagery"!==(null==(ja=va.layer)?void 0:ja.type)&&Y.push(aa)}break;case "3d":{const va=[this.view.map.ground];this.view.map.allLayers.forEach(ma=>{"integrated-mesh"===ma.type&&va.push(ma)});ia=yield this.view.hitTest(X,{exclude:va});0<ia.results.length&&(ja=ia.results[0],(!ia.ground.mapPoint||
1>this.view.map.ground.opacity||ia.ground.distance-ja.distance>-Math.min(3*ia.ground.distance,"global"===this.view.viewingMode?h.getReferenceEllipsoid(this.view.renderCoordsHelper.spatialReference).radius/this.view.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY))&&Y.push(ja))}}return{screenPoint:X,results:Y}});return function(X){return W.apply(this,arguments)}}();ea._generateViewHandles=function(W){var X=this;return[W.on("immediate-click",function(){var Y=l._asyncToGenerator(function*(aa){var ia=
"active"===X.state&&"create"===X._operationHandle.type;if("disabled"!==X.state&&!ia&&X.updateOnGraphicClick){X._beginAsyncOperation();var ja=(yield aa.async(()=>X._getFirstHit(M.createScreenPointFromEvent(aa)))).results;ia=null;if(ja.length)for(const va of ja){if(va.graphic){ja=va.graphic;if(X.updateGraphics.includes(ja)||ja.layer===X.layer){aa.stopPropagation();ia=ja;break}"2d"!==W.type||X._isComponentGraphic(ja)||"active"!==X.state||X.cancel()}}else"active"===X.state&&X.cancel();t.isSome(ia)&&!X.updateGraphics.includes(ia)&&
(yield X.update([ia],{...X.defaultUpdateOptions,reshapeOptions:{...X.defaultUpdateOptions.reshapeOptions}}));X._endAsyncOperation()}});return function(aa){return Y.apply(this,arguments)}}(),Q.ViewEventPriorities.WIDGET)]};ea._setupCreateOperation=function(){var W=l._asyncToGenerator(function*(X,Y){if(!X)return null;Y={hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...Y};let aa;if("2d"===this.view.type)switch(X){case "point":aa=this._setupCreatePointOperation(X,Y);break;case "multipoint":aa=
yield this._setupCreateMultipointOperation(X,Y);break;case "polygon":aa=yield this._setupCreatePolyOperation(X,Y);break;case "polyline":aa=yield this._setupCreatePolyOperation(X,Y);break;case "rectangle":aa=yield this._setupCreateRectangleOperation(X,Y);break;case "circle":aa=yield this._setupCreateCircleOperation(X,Y)}else{X=yield this._setupCreate3DOperation(X,this.view,Y);if(t.isNone(X)||I(X))return null;aa=X}return aa});return function(X,Y){return W.apply(this,arguments)}}();ea._setupCreate3DOperation=
function(){var W=l._asyncToGenerator(function*(X,Y,aa){if("multipoint"===X)return null;this._removeCreateOperationGraphics();const ia="rectangle"!==X,ja="rectangle"!==X;this.snappingOptions.enabledToggled=!1;const va=yield this._requireModule(new Promise(function(na,ua){b(["../../views/3d/interactive/editingTools"],na,ua)}));if(I(va))return va;if(this.destroyed)return null;const ma=new va.module.DrawGraphicTool({view:Y,mode:"rectangle"===X||"circle"===X?"hybrid":"click",...aa,elevationInfo:this.layer.elevationInfo,
geometryType:X,createGraphicSymbol:this._getGraphicSymbolFromTool(X),snapToScene:t.isSome(this.layer.elevationInfo)?"absolute-height"===this.layer.elevationInfo.mode:!0,snappingManager:this._snappingManager,forceUniformSize:ja,centered:ia});this.view.tools.add(ma);let ta=null;this.view.activeTool=ma;const sa=[this.view.on("key-down",na=>{if(na.key===F.SKETCH_KEYS.pan)na.stopPropagation(),na.repeat||(ma.enabled=!1);else if(na.key===F.SKETCH_KEYS.complete)na.stopPropagation(),ma.completeCreateOperation();
else if(na.key!==F.SKETCH_KEYS.vertexAdd||na.repeat)na.key===F.SKETCH_KEYS.undo?(na.stopPropagation(),ra.undo()):na.key===F.SKETCH_KEYS.redo?(na.stopPropagation(),ra.redo()):na.key!==F.SKETCH_KEYS.snappingToggle||"rectangle"===X||"circle"===X||na.repeat?na.key!==F.SKETCH_KEYS.constraint||"rectangle"!==X&&"circle"!==X||na.repeat?na.key!==F.SKETCH_KEYS.center||na.repeat||(ma.centered=!ia,na.stopPropagation()):(ma.forceUniformSize=!ja,na.stopPropagation()):(this.snappingOptions.enabledToggled=!0,na.stopPropagation());
else{const ua=ma.drawOperation.geometryType;if("polyline"===ua||"polygon"===ua)na.stopPropagation(),ma.drawOperation.commitStagedVertex()}},Q.ViewEventPriorities.WIDGET),this.view.on("key-up",na=>{na.key===F.SKETCH_KEYS.pan?ma.enabled=!0:na.key===F.SKETCH_KEYS.snappingToggle&&"rectangle"!==X&&"circle"!==X?(this.snappingOptions.enabledToggled=!1,na.stopPropagation()):na.key!==F.SKETCH_KEYS.constraint||"rectangle"!==X&&"circle"!==X?na.key===F.SKETCH_KEYS.center&&(ma.centered=ia,na.stopPropagation()):
(ma.forceUniformSize=ja,na.stopPropagation())},Q.ViewEventPriorities.WIDGET),ma.on("vertex-add",na=>{ta=t.isNone(ta)?"start":"active";switch(na.operation){case "apply":this.emit("create",{graphic:t.unwrap(ma.createGraphic),state:ta,tool:this.activeTool,toolEventInfo:na,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(ma.createGraphic)],tool:X});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(ma.createGraphic)],tool:X})}}),ma.on("cursor-update",na=>{0<ma.drawOperation.numCommittedVertices&&
this.emit("create",{graphic:t.unwrap(ma.createGraphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:na.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),ma.on("vertex-remove",na=>{switch(na.operation){case "apply":this.emit("create",{graphic:t.unwrap(ma.createGraphic),state:"active",tool:this.activeTool,toolEventInfo:na,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(ma.createGraphic)],tool:X});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(ma.createGraphic)],
tool:X})}}),ma.on("complete",na=>{this._removeCreateOperationGraphics();this._set("createGraphic",t.unwrap(na.graphic));ta="complete";na.aborted?ra&&ra.cancel():ra&&ra.complete()})],ra=new T.OperationHandle({activeComponent:ma,tool:X,type:"update",onEnd:()=>{var na;sa.forEach(ua=>ua.remove());sa.length=0;null==(na=this.view.tools)?void 0:na.remove(ma);ma.destroy()},undo:()=>{ma.canUndo&&ma.undo()},redo:()=>{ma.canRedo&&ma.redo()},canUndo:()=>ma.canUndo,canRedo:()=>ma.canRedo});return ra});return function(X,
Y,aa){return W.apply(this,arguments)}}();ea._getGraphicSymbolFromTool=function(W){switch(W){case "point":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;default:return null}};ea._setupCreatePointOperation=function(W,X){X=this._draw.create(W,{elevationInfo:this.layer.elevationInfo,hasZ:X.hasZ,defaultZ:X.defaultZ,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});const Y=[X.on("cursor-update",
ja=>{t.isSome(ja.vertexIndex)?this._displayCrosshairCursor():this._displayDefaultCursor()}),X.on("draw-complete",ja=>{ja=this.createPointFromVertex(ja.vertices[0]);ja=new C(ja,this.pointSymbol);this._set("createGraphic",ja);ia&&ia.complete()})],aa=[this.view.on("key-down",ja=>{ja.key===F.SKETCH_KEYS.cancel&&(ia&&ia.cancel(),ja.stopPropagation())},Q.ViewEventPriorities.WIDGET)],ia=this._operationHandleForCreateAction(X,[...Y,...aa],W);return ia};ea._setupCreateMultipointOperation=function(){var W=
l._asyncToGenerator(function*(X,Y){const aa=yield K.loadCreateUtils();Y=this._draw.create(X,{...Y,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});let ia=null;const ja=[],va=this._operationHandleForCreateAction(Y,ja,X);ja.push(Y.on("vertex-add",ma=>{const {type:ta,vertexIndex:sa,vertices:ra}=ma,na=ra[sa];ia=ma;this._drawMultipointGraphic(aa,ra,!0);this.emit("create",{graphic:this.createGraphic,state:1===ra.length?"start":"active",tool:X,toolEventInfo:{added:na,
vertices:[{coordinates:na,componentIndex:0,vertexIndex:sa}],type:ta},type:"create"})}),Y.on("vertex-remove",ma=>{const {type:ta,vertexIndex:sa,vertices:ra}=ma,na=ra[sa];ia=ma;this._drawMultipointGraphic(aa,ra,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{removed:na,vertices:[{coordinates:na,componentIndex:0,vertexIndex:sa}],type:ta},type:"create"})}),Y.on("vertex-update",ma=>{const {type:ta,vertexIndex:sa,vertices:ra}=ma,na=ra[sa];ia=ma;this._drawMultipointGraphic(aa,
ra,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{type:ta,updated:na,vertices:[{coordinates:na,componentIndex:0,vertexIndex:sa}]},type:"create"})}),Y.on("cursor-update",ma=>{ia=ma}),Y.on("draw-complete",ma=>{ma=ma.vertices.slice(0);(ma=aa.createMultipoint(ma,this.view.spatialReference))&&this.createGraphic&&(this.createGraphic.geometry=ma);va&&va.complete()}),Y.on("undo",ma=>{ma=ma.vertices;const ta=ia&&"cursor-update"!==ia.type;this._resetCreateOperationGraphics();
ma.length&&this._drawMultipointGraphic(aa,ma,ta)}),Y.on("redo",ma=>{ma=ma.vertices;const ta=ia&&"cursor-update"!==ia.type;this._resetCreateOperationGraphics();ma.length&&this._drawMultipointGraphic(aa,ma,ta)}));ja.push(this.view.on("pointer-move",()=>this._displayCrosshairCursor(),Q.ViewEventPriorities.WIDGET),this.view.on("key-down",ma=>this._getCommonUpdateOperationKeyDownHandlers(va,ma),Q.ViewEventPriorities.WIDGET));return va});return function(X,Y){return W.apply(this,arguments)}}();ea._setupCreatePolyOperation=
function(){var W=l._asyncToGenerator(function*(X,Y){const aa=yield K.loadCreateUtils();Y={...Y,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0};let ia=null;"polyline"===X?ia=this._draw.create(X,Y):"polygon"===X&&(ia=this._draw.create(X,Y));let ja=null;Y=[ia.on("vertex-add",ta=>{const {type:sa,vertexIndex:ra,vertices:na}=ta,ua=na[ra];this._snapLastPolygonVertexToFirst(X,na);ja=ta;this._drawVertexGraphics(aa,X,na,{userClicked:!0});this.emit("create",
{graphic:this.createGraphic,state:1===na.length?"start":"active",tool:X,toolEventInfo:{added:ua,vertices:[{coordinates:ua,componentIndex:0,vertexIndex:ra}],type:sa},type:"create"})}),ia.on("vertex-remove",ta=>{const {type:sa,vertexIndex:ra,vertices:na}=ta,ua=na[ra];this._snapLastPolygonVertexToFirst(X,na);ja=ta;this._drawVertexGraphics(aa,X,na,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{removed:ua,vertices:[{coordinates:ua,componentIndex:0,
vertexIndex:ra}],type:sa},type:"create"})}),ia.on("vertex-update",ta=>{const {type:sa,vertexIndex:ra,vertices:na}=ta,ua=na[ra];this._snapLastPolygonVertexToFirst(X,na);ja=ta;this._drawVertexGraphics(aa,X,na,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{type:sa,updated:ua,vertices:[{coordinates:ua,componentIndex:0,vertexIndex:ra}]},type:"create"})}),ia.on("cursor-update",ta=>{const {type:sa,vertices:ra}=ta;ta.mapPoint&&(this._snapLastPolygonVertexToFirst(X,
ra),ja=ta,this._drawVertexGraphics(aa,X,ra,{userClicked:!1}),1<ra.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{coordinates:ra[ra.length-1],type:sa},type:"create"}))}),ia.on("draw-complete",ta=>{ta=ta.vertices.slice(0);let sa=null;"polyline"===X?sa=aa.createPolyline([ta],this.view.spatialReference,this._doUnnormalization):"polygon"===X&&(sa=aa.createPolygon([ta],this.view.spatialReference,this._doUnnormalization,!0));sa&&(this.createGraphic.geometry=sa);
ma&&ma.complete()}),ia.on("undo",ta=>{ta=ta.vertices;const sa=ja&&"cursor-update"!==ja.type;this._resetCreateOperationGraphics();this._snapLastPolygonVertexToFirst(X,ta);ta.length&&this._drawVertexGraphics(aa,X,ta,{userClicked:sa})}),ia.on("redo",ta=>{ta=ta.vertices;const sa=ja&&"cursor-update"!==ja.type;this._resetCreateOperationGraphics();this._snapLastPolygonVertexToFirst(X,ta);ta.length&&this._drawVertexGraphics(aa,X,ta,{userClicked:sa})})];const va=[this.view.on("pointer-move",ta=>{t.isSome(ia.getCoordsFromScreenPoint(q.createScreenPoint(ta.x,
ta.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},Q.ViewEventPriorities.WIDGET),this.view.on("key-down",ta=>{ta.key!==F.SKETCH_KEYS.snappingToggle||ta.repeat?ta.key===F.SKETCH_KEYS.undo&&ma&&ma.canUndo()?(ta.stopPropagation(),ma.undo()):ta.key===F.SKETCH_KEYS.redo&&ma&&ma.canRedo()?(ta.stopPropagation(),ma.redo()):ta.key===F.SKETCH_KEYS.cancel&&ma&&ma.cancel():(this.snappingOptions.enabledToggled=!0,ta.stopPropagation())},Q.ViewEventPriorities.WIDGET),this.view.on("key-up",ta=>
{ta.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,ta.stopPropagation())},Q.ViewEventPriorities.WIDGET)];if("polygon"===X){const ta=(na,ua,za)=>{if(!na||!na.layer||!na.visible)return!1;na=this.view.toScreen(na.geometry);return this._isWithinScreenDistance(na,ua,za)},sa=na=>{if(!(2>=this._vertexGraphics.length))return ta(this._vertexGraphics[0],na,this._getVertexIntersectDistance())};let ra=!1;va.push(this.view.on("pointer-move",()=>{ra=!1},Q.ViewEventPriorities.WIDGET),
this.view.on("pointer-down",na=>{sa(na)?(ra=!0,na.stopPropagation()):this._vertexGraphics.some(ua=>ta(ua,na,this._getVertexIntersectDistance()))&&na.stopPropagation()},Q.ViewEventPriorities.WIDGET),this.view.on("pointer-up",na=>{ra&&(na.stopPropagation(),ia.complete())}))}const ma=this._operationHandleForCreateAction(ia,[...Y,...va],X);return ma});return function(X,Y){return W.apply(this,arguments)}}();ea._setupCreateCircleOperation=function(){var W=l._asyncToGenerator(function*(X,Y){const aa=yield K.loadCreateUtils(),
ia=this._draw.create(X,{...Y,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});let ja=!1,va=!0;Y=[ia.on("vertex-add",sa=>{const {type:ra,vertexIndex:na,vertices:ua}=sa;sa=ua[na];this._drawSegmentGraphic(aa,X,ua,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===ua.length?"start":"active",tool:X,toolEventInfo:{added:sa,vertices:[{coordinates:sa,componentIndex:0,vertexIndex:na}],
type:ra},type:"create"})}),ia.on("cursor-update",sa=>{const {type:ra,vertices:na}=sa;this._drawSegmentGraphic(aa,X,na,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem);2===na.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{coordinates:na[na.length-1],type:ra},type:"create"})}),ia.on("draw-complete",sa=>{sa=sa.vertices.slice(0);1===sa.length?(sa.push(ia.viewAlignedCoordinateSystem.makeMapPoint(sa[0][0]+this._defaultSegmentOffset*this.view.resolution,
sa[0][1])),sa=aa.createCircle(sa,ia.viewAlignedCoordinateSystem,!0,this.view.resolution)):sa=ja?aa.createEllipse(sa,ia.viewAlignedCoordinateSystem,va):aa.createCircle(sa,ia.viewAlignedCoordinateSystem,va,this.view.resolution);this.createGraphic?this.createGraphic.geometry=sa:(this._removeCreateGraphic(),this._set("createGraphic",new C(sa,this.polygonSymbol)));ta&&ta.complete()})];const ma=[this.view.on("pointer-move",sa=>{t.isSome(ia.getCoordsFromScreenPoint(q.createScreenPoint(sa.x,sa.y)))?this._displayCrosshairCursor():
this._displayDefaultCursor()},Q.ViewEventPriorities.WIDGET),this.view.on("key-down",sa=>{sa.key===F.SKETCH_KEYS.constraint?ja||(ja=!0,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.center?va&&(va=!1,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.cancel&&ta&&ta.cancel()},Q.ViewEventPriorities.WIDGET),this.view.on("key-up",sa=>{sa.key===
F.SKETCH_KEYS.constraint?(ja=!1,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.center&&(va=!0,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem))},Q.ViewEventPriorities.WIDGET)],ta=this._operationHandleForCreateAction(ia,[...Y,...ma],X);return ta});return function(X,Y){return W.apply(this,arguments)}}();ea._setupCreateRectangleOperation=function(){var W=l._asyncToGenerator(function*(X,
Y){const aa=yield K.loadCreateUtils(),ia=this._draw.create(X,{...Y,elevationInfo:this.layer.elevationInfo,snappingManager:this._snappingManager,interactiveUndoDisabled:!0});let ja=!1,va=!1;Y=[ia.on("vertex-add",sa=>{const {type:ra,vertexIndex:na,vertices:ua}=sa;sa=ua[na];this._drawSegmentGraphic(aa,X,ua,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===ua.length?"start":"active",tool:X,toolEventInfo:{added:sa,vertices:[{coordinates:sa,
componentIndex:0,vertexIndex:na}],type:ra},type:"create"})}),ia.on("cursor-update",sa=>{const {type:ra,vertices:na}=sa;this._drawSegmentGraphic(aa,X,na,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem);2===na.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:X,toolEventInfo:{coordinates:na[na.length-1],type:ra},type:"create"})}),ia.on("draw-complete",sa=>{sa=sa.vertices.slice(0);let ra=null;1===sa.length&&(va=ja=!1);ra=ja?aa.createSquare(sa,ia.viewAlignedCoordinateSystem,
va):aa.createRectangle(sa,ia.viewAlignedCoordinateSystem,va);this.createGraphic?this.createGraphic.geometry=ra:(this._removeCreateGraphic(),this._set("createGraphic",new C(ra,this.polygonSymbol)));ta&&ta.complete()})];const ma=[this.view.on("pointer-move",sa=>{t.isSome(ia.getCoordsFromScreenPoint(q.createScreenPoint(sa.x,sa.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},Q.ViewEventPriorities.WIDGET),this.view.on("key-down",sa=>{sa.key===F.SKETCH_KEYS.constraint?ja||(ja=!0,this._drawSegmentGraphic(aa,
X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.center?va||(va=!0,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.cancel&&ta&&ta.cancel()},Q.ViewEventPriorities.WIDGET),this.view.on("key-up",sa=>{sa.key===F.SKETCH_KEYS.constraint?(ja=!1,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem)):sa.key===F.SKETCH_KEYS.center&&
(va=!1,this._drawSegmentGraphic(aa,X,ia.vertices,{centered:va,constrainToggle:ja},ia.viewAlignedCoordinateSystem))},Q.ViewEventPriorities.WIDGET)],ta=this._operationHandleForCreateAction(ia,[...Y,...ma],X);return ta});return function(X,Y){return W.apply(this,arguments)}}();ea._setupUpdateOperation=function(){var W=l._asyncToGenerator(function*(X,Y){const {layer:aa,view:ia}=this;Y={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...Y,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,
...null==Y?void 0:Y.reshapeOptions}};var ja=Y.tool;for(var va of X)aa.remove(va),aa.add(va);if("3d"===ia.type){if(0===X.length)return null;switch(ja){case "move":return this._setupMove3DOperation(X,Y,ia,ja);case "reshape":if(1<X.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ja=D.isSupportedGraphic(X[0]);if(0===ja)return this._setupReshape3DOperation(X[0],Y,ia);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${B.isSupportedGraphicResultMessage(ja)}).`);
return null;case "transform":return this._setupGraphicTransform3DOperation(X,Y,ia)}}switch(ja){case "move":return this._setupMoveOperation(X,Y,ia);case "reshape":if(1<X.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;va=D.isSupportedGraphic(X[0]);if(0===va)return this._setupTransformOrReshapeOperation(X,ja,Y,ia);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${B.isSupportedGraphicResultMessage(va)}).`);
return null;case "transform":return this._setupTransformOrReshapeOperation(X,1===X.length&&"point"===t.get(X[0].geometry,"type")?"reshape":ja,Y,ia)}});return function(X,Y){return W.apply(this,arguments)}}();ea._setupMove3DOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa,ia,ja=!1){var va=this;for(var ma of X){const na=f.isSupportedGraphic(ma);if(0!==na)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${B.isSupportedGraphicResultMessage(na)}).`),
null}ma=yield this._requireModule(new Promise(function(na,ua){b(["../../views/3d/interactive/editingTools"],na,ua)}));if(I(ma))return ma;const ta=new ma.module.GraphicMoveTool({view:aa,enableZ:Y.enableZ,snappingManager:this._snappingManager});this.view.tools.add(ta);ta.graphics.addMany(X);ja||this.updateGraphics.addMany(X);const sa=[],ra=new T.OperationHandle({activeComponent:ta,tool:ia,type:"update",onEnd:()=>{var na;sa.forEach(ua=>ua.remove());sa.length=0;null==(na=this.view.tools)?void 0:na.remove(ta);
ta.destroyed||ta.destroy()},undo:()=>{wa(ra,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ia})},redo:()=>{ya(ra,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ia})},addToSelection:na=>{this.updateGraphics.push(na);ta.graphics.push(na);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[na],removed:[],type:"selection-change"},
type:"update"})},removeFromSelection:na=>{const ua=this.updateGraphics.indexOf(na);ra.history.undo.forEach(za=>za.updates.splice(ua,1));ra.history.redo.forEach(za=>za.updates.splice(ua,1));this.updateGraphics.remove(na);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[na],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ra.complete():ta.graphics.remove(na)},toggleTool:function(){var na=
l._asyncToGenerator(function*(){if(1===va.updateGraphics.length&&!1!==Y.toggleToolOnClick&&"transform"===ia){var ua=va.updateGraphics.getItemAt(0);0===D.isSupportedGraphic(ua)&&(ua=yield va._setupReshape3DOperation(ua,Y,aa,!0),I(ua)||(ra.onEnd(),ra.destroy(),va._setUpdateOperationHandle(ua,Y)))}});return function(){return na.apply(this,arguments)}}()});sa.push(...this._getHandlesForComponent(ra,Y),this.view.on("immediate-click",na=>this._getCommonUpdateOperationClickHandlers(ra,na,Y),Q.ViewEventPriorities.WIDGET),
aa.on("key-down",na=>{this._getCommonUpdateOperationKeyDownHandlers(ra,na);na.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,na.stopPropagation())},Q.ViewEventPriorities.WIDGET),aa.on("key-up",na=>{na.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,na.stopPropagation())},Q.ViewEventPriorities.WIDGET));return ra});return function(X,Y,aa,ia){return W.apply(this,arguments)}}();ea._setupGraphicTransform3DOperation=function(W,X,Y,aa=!1){if(1===W.length&&
0===H.isSupportedGraphic(W[0])){const ia=W[0],ja=ia.geometry;if(t.isSome(ja)&&("point"===ja.type||"mesh"===ja.type))return this._setupPointTransform3DOperation(ia,X,Y);if(t.isSome(ja)&&("polygon"===ja.type||"polyline"===ja.type))return this._setupPolyTransform3DOperation(ia,X,Y,aa)}return this._setupMove3DOperation(W,X,Y,"transform",aa)};ea._setupPointTransform3DOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa){var ia=this;const {enableRotation:ja,enableScaling:va,enableZ:ma}=Y,ta=
yield this._requireModule(new Promise(function(ua,za){b(["../../views/3d/interactive/editingTools"],ua,za)}));if(I(ta))return ta;const sa=new ta.module.GraphicTransformTool({graphic:X,view:aa,enableRotation:ja,enableScaling:va,enableZ:ma,snappingManager:this._snappingManager});this.view.tools.add(sa);this.updateGraphics.add(X);const ra=[],na=new T.OperationHandle({activeComponent:sa,tool:"transform",type:"update",onEnd:()=>{var ua;ra.forEach(za=>za.remove());ra.length=0;null==(ua=this.view.tools)?
void 0:ua.remove(sa);sa.destroyed||sa.destroy()},undo:()=>{wa(na,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{ya(na,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var ua=l._asyncToGenerator(function*(za){ia.updateGraphics.add(za);ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[za],
removed:[],type:"selection-change"},type:"update"});za=yield ia._setupMove3DOperation(ia.updateGraphics.toArray(),Y,aa,"transform",!0);I(za)||(na.onEnd(),na.destroy(),ia._setUpdateOperationHandle(za,Y))});return function(za){return ua.apply(this,arguments)}}(),removeFromSelection:ua=>{this.updateGraphics.remove(ua);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ua],type:"selection-change"},type:"update"});
na.complete()},toggleTool:()=>{}});ra.push(...this._getHandlesForComponent(na,Y),this.view.on("immediate-click",ua=>this._getCommonUpdateOperationClickHandlers(na,ua,Y),Q.ViewEventPriorities.WIDGET),aa.on("key-down",ua=>{this._getCommonUpdateOperationKeyDownHandlers(na,ua);ua.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,ua.stopPropagation())},Q.ViewEventPriorities.WIDGET),aa.on("key-up",ua=>{ua.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=
!1,ua.stopPropagation())},Q.ViewEventPriorities.WIDGET));return na});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._setupPolyTransform3DOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa,ia=!1){var ja=this;const {enableRotation:va,enableScaling:ma,enableZ:ta,preserveAspectRatio:sa}=Y,ra=yield this._requireModule(new Promise(function(Ca,Da){b(["../../views/3d/interactive/editingTools"],Ca,Da)}));if(I(ra))return ra;const na=new ra.module.ExtentTransformTool({graphic:X,view:aa,
enableRotation:va,enableScaling:ma,enableZ:ta,preserveAspectRatio:sa});this.view.tools.add(na);ia||this.updateGraphics.add(X);const ua=[],za=new T.OperationHandle({activeComponent:na,tool:"transform",type:"update",onEnd:()=>{var Ca;ua.forEach(Da=>Da.remove());ua.length=0;null==(Ca=this.view.tools)?void 0:Ca.remove(na);na.destroyed||na.destroy()},canUndo:()=>na.canUndo,undo:()=>{na.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>na.canRedo,redo:()=>
{na.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var Ca=l._asyncToGenerator(function*(Da){ja.updateGraphics.add(Da);ja.emit("update",{graphics:ja.updateGraphics.toArray(),state:"active",aborted:!1,tool:ja.activeTool,toolEventInfo:{added:[Da],removed:[],type:"selection-change"},type:"update"});Da=yield ja._setupMove3DOperation(ja.updateGraphics.toArray(),Y,aa,"transform",!0);I(Da)||(za.onEnd(),za.destroy(),ja._setUpdateOperationHandle(Da,
Y))});return function(Da){return Ca.apply(this,arguments)}}(),removeFromSelection:Ca=>{this.updateGraphics.remove(Ca);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Ca],type:"selection-change"},type:"update"});za.complete()},toggleTool:function(){var Ca=l._asyncToGenerator(function*(){if(1===ja.updateGraphics.length&&!1!==Y.toggleToolOnClick){var Da=ja.updateGraphics.getItemAt(0);0===D.isSupportedGraphic(Da)&&
(Da=yield ja._setupReshape3DOperation(Da,Y,aa,!0),I(Da)||(za.onEnd(),za.destroy(),ja._setUpdateOperationHandle(Da,Y)))}});return function(){return Ca.apply(this,arguments)}}()});ua.push(...this._getHandlesForComponent(za,Y),this.view.on("immediate-click",Ca=>this._getCommonUpdateOperationClickHandlers(za,Ca,Y),Q.ViewEventPriorities.WIDGET),this.view.on("key-down",Ca=>this._getCommonUpdateOperationKeyDownHandlers(za,Ca),Q.ViewEventPriorities.WIDGET),this.view.on("key-down",Ca=>{Ca.key!==F.SKETCH_KEYS.constraint||
Ca.repeat||(na.preserveAspectRatio=!na.preserveAspectRatio,Ca.stopPropagation())},Q.ViewEventPriorities.WIDGET),this.view.on("key-up",Ca=>{Ca.key===F.SKETCH_KEYS.constraint&&(na.preserveAspectRatio=!na.preserveAspectRatio,Ca.stopPropagation())},Q.ViewEventPriorities.WIDGET));return za});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._setupMoveOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa){this.updateGraphics.addMany(X);const ia=yield this._getGraphicMover(X,Y,aa);
if(I(ia))return ia;const ja=new T.OperationHandle({activeComponent:ia,tool:"move",type:"update",onEnd:()=>{var sa;this._displayDefaultCursor();ta.forEach(ra=>ra.remove());ma.forEach(ra=>ra.remove());ta=[];ma=[];ia.destroy();null==(sa=this._internalGraphicsLayer)?void 0:sa.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const sa=this.updateGraphics.toArray();wa(ja,sa);ja.refreshComponent();this._emitUndoEvent({graphics:sa,tool:"move"})},redo:()=>{const sa=this.updateGraphics.toArray();ya(ja,
sa);ja.refreshComponent();this._emitRedoEvent({graphics:sa,tool:"move"})},addToSelection:sa=>{this.updateGraphics.push(sa);ia.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[sa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:sa=>{const ra=this.updateGraphics.indexOf(sa);ja.history.undo.forEach(ua=>ua.updates.splice(ra,1));ja.history.redo.forEach(ua=>ua.updates.splice(ra,
1));this.updateGraphics.remove(sa);const na=this.updateGraphics.toArray();this.emit("update",{graphics:na,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[sa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ja.complete():ia.graphics=na}});let va=!1,ma=[aa.on("immediate-click",sa=>this._getCommonUpdateOperationClickHandlers(ja,sa,Y),Q.ViewEventPriorities.WIDGET),aa.on("key-down",sa=>{this._getCommonUpdateOperationKeyDownHandlers(ja,sa);sa.key!==
F.SKETCH_KEYS.constraint||sa.repeat||(va=!0,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},Q.ViewEventPriorities.WIDGET),aa.on("key-up",sa=>{sa.key===F.SKETCH_KEYS.constraint&&va&&(va=!1,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},Q.ViewEventPriorities.WIDGET)],ta=this._getHandlesForComponent(ja,Y);return ja});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._setupReshape3DOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa,ia=!1){var ja=this;const va=yield this._requireModule(new Promise(function(ra,
na){b(["../../views/3d/interactive/editingTools"],ra,na)}));if(I(va))return va;this.snappingOptions.enabledToggled=!1;const ma=new va.module.GraphicReshapeTool({view:aa,graphic:X,enableZVertex:Y.enableZ&&"move"===Y.reshapeOptions.vertexOperation,enableZShape:Y.enableZ&&"move"===Y.reshapeOptions.shapeOperation,enableMoveGraphic:"move"===Y.reshapeOptions.shapeOperation||"move-xy"===Y.reshapeOptions.shapeOperation,enableMidpoints:"split"===Y.reshapeOptions.edgeOperation,enableEdgeOffset:"offset"===Y.reshapeOptions.edgeOperation,
snappingManager:this._snappingManager});aa.tools.add(ma);ia||this.updateGraphics.add(X);const ta=[],sa=new T.OperationHandle({activeComponent:ma,tool:"reshape",type:"update",onEnd:()=>{var ra;ta.forEach(na=>na.remove());ta.length=0;null==(ra=this.view.tools)?void 0:ra.remove(ma);ma.destroyed||ma.destroy()},canUndo:()=>ma.canUndo,undo:()=>{ma.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>ma.canRedo,redo:()=>{ma.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"reshape"})},addToSelection:function(){var ra=l._asyncToGenerator(function*(na){ja.updateGraphics.add(na);ja.emit("update",{graphics:ja.updateGraphics.toArray(),state:"active",aborted:!1,tool:ja.activeTool,toolEventInfo:{added:[na],removed:[],type:"selection-change"},type:"update"});na=yield ja._setupMove3DOperation(ja.updateGraphics.toArray(),Y,aa,"transform",!0);I(na)||(sa.onEnd(),sa.destroy(),ja._setUpdateOperationHandle(na,Y))});return function(na){return ra.apply(this,arguments)}}(),removeFromSelection:ra=>
{this.updateGraphics.remove(ra);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ra],type:"selection-change"},type:"update"});sa.complete()},toggleTool:function(){var ra=l._asyncToGenerator(function*(){if(!1!==Y.toggleToolOnClick){var na=yield ja._setupGraphicTransform3DOperation(ja.updateGraphics.toArray(),Y,aa,!0);I(na)||(sa.onEnd(),sa.destroy(),ja._setUpdateOperationHandle(na,Y))}});return function(){return ra.apply(this,
arguments)}}()});ta.push(...this._getHandlesForComponent(sa,Y),aa.on("immediate-click",ra=>this._getCommonUpdateOperationClickHandlers(sa,ra,Y),Q.ViewEventPriorities.WIDGET),aa.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(sa,ra);ra.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,ra.stopPropagation())},Q.ViewEventPriorities.WIDGET),aa.on("key-up",ra=>{ra.key===F.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,ra.stopPropagation())},
Q.ViewEventPriorities.WIDGET));return sa});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._setupTransformOrReshapeOperation=function(){var W=l._asyncToGenerator(function*(X,Y,aa,ia){var ja=this;const {multipleSelectionEnabled:va}=aa;this.updateGraphics.addMany(X);X="transform"===Y?yield this._getBox(X,aa,ia):yield this._getReshape(X,aa,ia);if(I(X))return X;const ma=new T.OperationHandle({activeComponent:X,type:"update",onEnd:()=>{sa.forEach(ra=>ra.remove());ta.forEach(ra=>ra.remove());
sa=[];ta=[];ma.activeComponent&&!ma.activeComponent.destroyed&&ma.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{wa(ma,this.updateGraphics.toArray());ma.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ma.tool})},redo:()=>{ya(ma,this.updateGraphics.toArray());ma.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ma.tool})},addToSelection:function(){var ra=l._asyncToGenerator(function*(na){var ua=
ma.activeComponent;if("reshape"===ua.type){ua=[...ja.updateGraphics,na];ja.updateGraphics.removeAll();ua=yield ja._setupMoveOperation(ua,aa,ia);if(I(ua))return;ma.onEnd();ma.destroy();ja._setUpdateOperationHandle(ua,aa)}else ja.updateGraphics.add(na),ua.graphics=ja.updateGraphics.toArray(),ua.refresh(),ma.resetHistory();ja.emit("update",{graphics:ja.updateGraphics.toArray(),state:"active",aborted:!1,tool:ja.activeTool,toolEventInfo:{added:[na],removed:[],type:"selection-change"},type:"update"})});
return function(na){return ra.apply(this,arguments)}}(),removeFromSelection:function(){var ra=l._asyncToGenerator(function*(na){const ua=ja.updateGraphics.indexOf(na);ma.history.undo.forEach(Ca=>Ca.updates.splice(ua,1));ma.history.redo.forEach(Ca=>Ca.updates.splice(ua,1));ja.updateGraphics.remove(na);const za=ja.updateGraphics.toArray();0===za.length?ma.complete():1===za.length&&t.isSome(za[0].geometry)&&"point"===za[0].geometry.type?ma.toggleTool():ma.activeComponent.graphics=za;ja.emit("update",
{graphics:za,state:"active",aborted:!1,tool:ja.activeTool,toolEventInfo:{added:[],removed:[na],type:"selection-change"},type:"update"})});return function(na){return ra.apply(this,arguments)}}(),toggleTool:function(){var ra=l._asyncToGenerator(function*(){if(!(1<ja.updateGraphics.length)){var na=ja.updateGraphics.getItemAt(0);if(!t.isSome(na.geometry)||!("transform"===ma.tool&&"extent"===na.geometry.type||"reshape"===ma.tool&&"point"===na.geometry.type)){var ua=null;"transform"===ma.tool?ua=yield ja._getReshape([na],
aa,ia):"reshape"===ma.tool&&(ua=yield ja._getBox([na],aa,ia));I(ua)||(ma.activeComponent.destroy(),ma.activeComponent=ua,ma.activeComponent&&(sa.forEach(za=>za.remove()),sa=ja._getHandlesForComponent(ma,aa)))}}});return function(){return ra.apply(this,arguments)}}()});let ta=[ia.on("immediate-click",function(){var ra=l._asyncToGenerator(function*(na){var ua;const za=yield na.async(()=>ja._getFirstHit(M.createScreenPointFromEvent(na)));null!=(ua=za.results)&&ua.length?za.results.some(Ca=>{if(Ca.graphic){var Da;
Ca=Ca.graphic;if(null!=(Da=na.native)&&Da.shiftKey&&va)return na.stopPropagation(),ma.addToSelection(Ca),!0;if(Ca.layer===ja.layer)return ma.complete(),!0}return!1}):ma.complete()});return function(na){return ra.apply(this,arguments)}}(),Q.ViewEventPriorities.WIDGET),ia.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(ma,ra);ra.key!==F.SKETCH_KEYS.snappingToggle||ra.repeat||(this.snappingOptions.enabledToggled=!0,ra.stopPropagation());ra.key===F.SKETCH_KEYS.constraint&&!ra.repeat&&
ma&&(ra=ma.activeComponent)&&"box"===ra.type&&(ra.preserveAspectRatio=!ra.preserveAspectRatio)},Q.ViewEventPriorities.WIDGET),ia.on("key-up",ra=>{var na;ra.key===F.SKETCH_KEYS.snappingToggle&&"reshape"===(null==ma?void 0:null==(na=ma.activeComponent)?void 0:na.type)&&(this.snappingOptions.enabledToggled=!1,ra.stopPropagation());ra.key===F.SKETCH_KEYS.constraint&&ma&&(ra=ma.activeComponent)&&"box"===ra.type&&(ra.preserveAspectRatio=!ra.preserveAspectRatio)},Q.ViewEventPriorities.WIDGET)],sa=this._getHandlesForComponent(ma,
aa);return ma});return function(X,Y,aa,ia){return W.apply(this,arguments)}}();ea._getGraphicMover=function(){var W=l._asyncToGenerator(function*(X,Y,aa){({enableMoveAllGraphics:Y}=Y);const ia=yield this._requireModule(new Promise(function(ja,va){b(["../../views/draw/support/GraphicMover"],function(ma){ja(ka(ma))},va)}));return I(ia)?ia:new ia.module.default({enableMoveAllGraphics:Y,graphics:X,view:aa,callbacks:{onGraphicMoveStart:({dx:ja,dy:va,graphic:ma})=>{this._displayGrabbingCursor();this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ja,dy:va,mover:ma,type:"move-start"},type:"update"})},onGraphicMove:({dx:ja,dy:va,graphic:ma})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ja,dy:va,mover:ma,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ja,dy:va,graphic:ma})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ja,dy:va,mover:ma,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._getBox=function(){var W=l._asyncToGenerator(function*(X,Y,aa){const {enableRotation:ia,enableScaling:ja,preserveAspectRatio:va}=Y;Y=yield this._requireModule(new Promise(function(ma,ta){b(["../../views/draw/support/Box"],
function(sa){ma(ka(sa))},ta)}));return I(Y)?Y:new Y.module.default({graphics:X,enableRotation:ia,enableScaling:ja,preserveAspectRatio:va,layer:this._internalGraphicsLayer,view:aa,callbacks:{onMoveStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onMove:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),
onMoveStop:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScaleStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScale:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScaleStop:ma=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotateStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotate:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotateStop:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"})}})});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._getReshape=function(){var W=l._asyncToGenerator(function*(X,Y,aa){var ia,ja;const va="split"===(null==(ia=Y.reshapeOptions)?void 0:ia.edgeOperation);Y="move"===(null==(ja=Y.reshapeOptions)?void 0:ja.shapeOperation);ja=yield this._requireModule(new Promise(function(ma,ta){b(["../../views/draw/support/Reshape"],function(sa){ma(ka(sa))},ta)}));return I(ja)?
ja:new ja.module.default({enableMidpoints:va,enableMovement:Y,graphic:X[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,view:aa,callbacks:{onReshapeStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onReshape:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onReshapeStop:({mover:ma,
type:ta})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ma,type:ta},type:"update"}),onMoveStart:({dx:ma,dy:ta,mover:sa,type:ra})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ta,mover:sa,type:ra},type:"update"}),onMove:({dx:ma,dy:ta,mover:sa,type:ra})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{dx:ma,dy:ta,mover:sa,type:ra},type:"update"}),onMoveStop:({dx:ma,dy:ta,mover:sa,type:ra})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ta,mover:sa,type:ra},type:"update"}),onVertexAdd:({added:ma,type:ta,vertices:sa})=>{ma=ma.map(ra=>v.geometryToCoordinates(ra.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ma,
vertices:sa,type:ta},type:"update"})},onVertexRemove:({removed:ma,type:ta,vertices:sa})=>{ma=ma.map(ra=>v.geometryToCoordinates(ra.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ma,vertices:sa,type:ta},type:"update"})}}})});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._getHandlesForComponent=function(W,X){const Y=W.activeComponent;switch(Y.type){case "graphic-mover":return[Y.on("graphic-click",
({graphic:aa,viewEvent:ia})=>{var ja;null!=(ja=ia.native)&&ja.shiftKey&&(ia.stopPropagation(),W.removeFromSelection(aa))}),Y.on("graphic-move-start",aa=>W.addToHistory(G(aa.allGraphics)))];case "box":return[Y.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(W,X,aa)),Y.on("move-start",aa=>W.addToHistory(G(aa.graphics))),Y.on("rotate-start",aa=>W.addToHistory(G(aa.graphics))),Y.on("scale-start",aa=>W.addToHistory(G(aa.graphics)))];case "reshape":return[Y.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(W,
X,aa)),Y.on("move-start",aa=>W.addToHistory(G([aa.mover]))),Y.on("reshape-start",aa=>W.addToHistory(G([aa.graphic]))),Y.on("vertex-add",aa=>W.addToHistory(G([aa.oldGraphic]))),Y.on("vertex-remove",aa=>W.addToHistory(G([aa.oldGraphic])))];case "move-3d":return[Y.on("graphic-move-start",aa=>{W.addToHistory(G(aa.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:
null,type:"move-start"},type:"update"})}),Y.on("graphic-move",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:aa.dx,dy:aa.dy,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,type:"move"},type:"update"})}),Y.on("graphic-move-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,
type:"move-stop"},type:"update"})}),Y.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],W,X):W.toggleTool()})];case "transform-3d":return[Y.on("record-undo",({record:aa})=>{W.addToHistory({updates:[aa]})}),Y.on("graphic-translate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-start"},type:"update"})}),Y.on("graphic-translate-stop",aa=>
{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-stop"},type:"update"})}),Y.on("graphic-rotate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-start"},type:"update"})}),Y.on("graphic-rotate-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-stop"},type:"update"})}),Y.on("graphic-scale-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale-start"},type:"update"})}),Y.on("graphic-scale-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale-stop"},type:"update"})}),Y.on("graphic-translate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move"},type:"update"})}),Y.on("graphic-rotate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,
type:"rotate"},type:"update"})}),Y.on("graphic-scale",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale"},type:"update"})}),Y.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],W,X):W.toggleTool()})];case "reshape-3d":return[Y.on("reshape",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:aa,type:"update"})}),Y.on("move",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Y.on("vertex-add",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Y.on("vertex-remove",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,
type:"update"})}),Y.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],W,X):W.toggleTool()})];case "draw":case "draw-3d":return null}};ea._onTransformOrReshape2DGraphicClick=function(W,X,Y){var aa;const {graphic:ia,viewEvent:ja}=Y;if(null!=(aa=ja.native)&&aa.shiftKey)return ja.stopPropagation(),W.removeFromSelection(ia);if(X.toggleToolOnClick)return ja.stopPropagation(),W.toggleTool()};ea._setUpdateOperationHandle=function(W,X){this._operationHandle=W;const Y=this.view.map;this._disablePopup(X);
W.on("complete",()=>{if(W===this._operationHandle){const aa=this.updateGraphics.toArray(),ia=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();Y&&Y.remove(this._internalGraphicsLayer);this._restorePopup(X);this.emit("update",{graphics:aa,state:"complete",aborted:W.cancelled,tool:ia,toolEventInfo:null,type:"update"})}})};ea._getCommonUpdateOperationClickHandlers=
function(){var W=l._asyncToGenerator(function*(X,Y,aa){const ia=M.createScreenPointFromEvent(Y),ja=(yield Y.async(()=>this._getFirstHit(ia))).results;ja.length?Y.native.shiftKey&&this._toggleSelection(ja.map(va=>va.graphic),X,aa)?Y.stopPropagation():ja.some(va=>va.graphic&&this.updateGraphics.includes(va.graphic))?Y.stopPropagation():X.complete():X.complete()});return function(X,Y,aa){return W.apply(this,arguments)}}();ea._toggleSelection=function(W,X,Y){const aa=!!Y.multipleSelectionEnabled;return W.some(ia=>
null==ia?!1:aa&&ia.layer===this.layer?(this.updateGraphics.includes(ia)?X.removeFromSelection(ia):X.addToSelection(ia),!0):!1)};ea._getCommonUpdateOperationKeyDownHandlers=function(W,X){if(W){var Y=X.key;Y===F.SKETCH_KEYS.undo&&W.canUndo()?(X.stopPropagation(),W.undo()):Y===F.SKETCH_KEYS.redo&&W.canRedo()?(X.stopPropagation(),W.redo()):Y===F.SKETCH_KEYS.cancel?(X.stopPropagation(),W.cancel()):this.allowDeleteKey&&F.SKETCH_KEYS.delete.includes(Y)&&this._onDeleteKey(X)}};ea._onDeleteKey=function(W){if(this._operationHandle&&
"update"===this._operationHandle.type){var X=this.activeComponent,Y=this.updateGraphics.toArray();t.isNone(X)||"reshape-3d"===X.type||"reshape"===X.type&&(1!==Y.length||"point"!==t.get(Y[0].geometry,"type"))||(W.stopPropagation(),this.delete())}};ea._drawMultipointGraphic=function(W,X,Y){var aa=null;!Y&&1<X.length?(aa=X.slice(0),aa.pop(),aa=W.createMultipoint(aa,this.view.spatialReference)):aa=W.createMultipoint(X,this.view.spatialReference);this.createGraphic?this.createGraphic.geometry=aa:this._set("createGraphic",
new C(aa,this.pointSymbol));Y&&1===X.length&&this._internalGraphicsLayer.add(this.createGraphic)};ea._drawVertexGraphics=function(W,X,Y,aa){if(Y.length){var {_doUnnormalization:ia,activeLineSymbol:ja,activeVertexSymbol:va,polygonSymbol:ma,polylineSymbol:ta,vertexSymbol:sa,view:{spatialReference:ra}}=this,na=!(!aa||!aa.userClicked),ua="polygon"===X;aa=ua?ma:ta;if(1===Y.length){this._removeLineGraphic();this._removeActiveLineGraphic();var za=this.createPointFromVertex(Y[0]);Y=ua?W.createPolygon([Y],
ra,ia,!0):W.createPolyline([Y],ra,ia);this._vertexGraphics.length?this._vertexGraphics[0].geometry=za:this._vertexGraphics.push(new C(za,va));this.createGraphic?this.createGraphic.set({geometry:Y,symbol:aa}):this._set("createGraphic",new C(Y,aa));na&&this._internalGraphicsLayer.add(this._vertexGraphics[0])}else if(2===Y.length){var Ca=this.createPointFromVertex(Y[1]);za=W.createPolyline([Y],ra,ia);W=ua?W.createPolygon([Y],ra,ia,!0):W.createPolyline([Y],ra,ia);this._vertexGraphics.length||(Y=this.createPointFromVertex(Y[0]),
Y=new C(Y,sa),this._vertexGraphics.push(Y));1===this._vertexGraphics.length?(Y=this._vertexGraphics[0],Ca=new C(Ca,sa),this._removeLineGraphic(),this._removeActiveFillGraphic(),this._vertexGraphics.push(Ca),this._internalGraphicsLayer.remove(Y),this._internalGraphicsLayer.add(Y)):this._vertexGraphics[1].geometry=Ca;this._showActiveLineGraphic(za);Y=this._vertexGraphics[0];na&&(this._activeLineGraphic.symbol=ta,Y.symbol=sa,this._internalGraphicsLayer.add(this._vertexGraphics[1]));this.createGraphic?
this.createGraphic.set({geometry:W,symbol:aa}):this._set("createGraphic",new C(W,aa));this._internalGraphicsLayer.remove(Y);this._internalGraphicsLayer.add(Y)}else if(2<Y.length){Ca=ua?W.createPolygon([Y],ra,ia,!0):W.createPolyline([Y],ra,ia);"polygon"===X&&this._showFillGraphic(Ca);ua=Y.map(Ia=>Ia.slice());X=ua.pop();const Da=[ua[ua.length-1],X];X=W.createPolyline([ua],ra,ia);W=W.createPolyline([Da],ra,ia);this._showLineGraphic(X);this._showActiveLineGraphic(W);for(W=0;W<ua.length;W++)(X=this._vertexGraphics[W])?
X.symbol=na||W!==this._vertexGraphics.length-1?sa:va:(X=this.createPointFromVertex(Y[W]),this._showVertexGraphic(X));na?(this._activeLineGraphic.symbol=ta,na=this.createPointFromVertex(Y[Y.length-1]),this._showVertexGraphic(na)):this._activeLineGraphic.symbol=ja;this.createGraphic?this.createGraphic.set({geometry:Ca,symbol:aa}):(this._removeCreateGraphic(),this._set("createGraphic",new C(Ca,aa)));for(za of this._vertexGraphics)this._internalGraphicsLayer.remove(za),this._internalGraphicsLayer.add(za)}}};
ea._drawSegmentGraphic=function(W,X,Y,aa,ia){if(Y.length){var ja=!(null==aa||!aa.centered);aa=!(null==aa||!aa.constrainToggle);var va;1===Y.length?this._removeCenterIndicatorGraphic():("rectangle"===X?va=aa?W.createSquare(Y,ia,ja):W.createRectangle(Y,ia,ja):"circle"===X&&(va=aa?W.createEllipse(Y,ia,ja):W.createCircle(Y,ia,ja,this.view.resolution)),t.isSome(va)&&va.extent&&va.extent.center&&this._showCenterIndicatorGraphic(va.extent.center));va?this.createGraphic?this.createGraphic.geometry=va:(this._removeCreateGraphic(),
this._set("createGraphic",new C(va,this.polygonSymbol)),this._internalGraphicsLayer.add(this.createGraphic)):this._removeCreateGraphic()}};ea._showCenterIndicatorGraphic=function(W){this._centerIndicatorGraphic?this._centerIndicatorGraphic.geometry=W:(this._centerIndicatorGraphic=new C(W,this._centerSymbol),this._internalGraphicsLayer.add(this._centerIndicatorGraphic))};ea._removeCenterIndicatorGraphic=function(){this._centerIndicatorGraphic&&(this._internalGraphicsLayer.remove(this._centerIndicatorGraphic),
this._centerIndicatorGraphic.destroy(),this._centerIndicatorGraphic=null)};ea._showActiveLineGraphic=function(W){this._activeLineGraphic?(this._activeLineGraphic.set({geometry:W,symbol:this.activeLineSymbol}),this._internalGraphicsLayer.remove(this._activeLineGraphic)):this._activeLineGraphic=new C(W,this.activeLineSymbol);this._internalGraphicsLayer.add(this._activeLineGraphic)};ea._showFillGraphic=function(W){this._activeFillGraphic?(this._activeFillGraphic.set({geometry:W,symbol:this.activeFillSymbol}),
this._internalGraphicsLayer.remove(this._activeFillGraphic)):this._activeFillGraphic=new C(W,this.activeFillSymbol);this._internalGraphicsLayer.add(this._activeFillGraphic)};ea._showLineGraphic=function(W){this._lineGraphic?(this._lineGraphic.set({geometry:W,symbol:this.polylineSymbol}),this._internalGraphicsLayer.remove(this._lineGraphic)):this._lineGraphic=new C(W,this.polylineSymbol);this._internalGraphicsLayer.add(this._lineGraphic)};ea._showVertexGraphic=function(W,X){W=new C(W,X?this.activeVertexSymbol:
this.vertexSymbol);this._vertexGraphics.push(W);this._internalGraphicsLayer.add(W)};ea._resetCreateOperationGraphics=function(){this._removeActiveFillGraphic();this._removeLineGraphic();this._removeActiveLineGraphic();this._removeVertexGraphics()};ea._removeCreateGraphic=function(){this.createGraphic&&(this._internalGraphicsLayer.remove(this.createGraphic),this._set("createGraphic",null))};ea._removeCreateOperationGraphics=function(){this._removeCenterIndicatorGraphic();this._removeActiveLineGraphic();
this._removeActiveFillGraphic();this._removeLineGraphic();this._removeVertexGraphics()};ea._removeActiveLineGraphic=function(){this._activeLineGraphic&&(this._internalGraphicsLayer.remove(this._activeLineGraphic),this._activeLineGraphic.destroy(),this._activeLineGraphic=null)};ea._removeActiveFillGraphic=function(){this._activeFillGraphic&&(this._internalGraphicsLayer.remove(this._activeFillGraphic),this._activeFillGraphic.destroy(),this._activeFillGraphic=null)};ea._removeLineGraphic=function(){this._lineGraphic&&
(this._internalGraphicsLayer.remove(this._lineGraphic),this._lineGraphic.destroy(),this._lineGraphic=null)};ea._removeVertexGraphics=function(){this._vertexGraphics.length&&(this._internalGraphicsLayer.removeMany(this._vertexGraphics),this._vertexGraphics.forEach(W=>W.destroy()),this._vertexGraphics=[])};ea._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer.destroy(),this._internalGraphicsLayer=
null)};ea._operationHandleForCreateAction=function(W,X,Y){return new T.OperationHandle({activeComponent:this._draw,tool:Y,type:"create",onEnd:()=>{X.forEach(aa=>aa.remove());X.length=0;this._removeCreateOperationGraphics();this._internalGraphicsLayer&&this._internalGraphicsLayer.remove(this.createGraphic);this._displayDefaultCursor()},undo:()=>{W.undo();this._emitUndoEvent({graphics:[this.createGraphic],tool:Y})},redo:()=>{W.redo();this._emitRedoEvent({graphics:[this.createGraphic],tool:Y})},canUndo:()=>
W&&W.canUndo(),canRedo:()=>W&&W.canRedo()})};ea._isComponentGraphic=function(W){const {activeComponent:X}=this;return!W||t.isNone(X)?!1:W.attributes&&W.attributes.esriSketchTool?!0:("box"===X.type||"reshape"===X.type)&&X.isUIGraphic(W)};ea._snapLastPolygonVertexToFirst=function(W,X){if(!("polygon"!==W&&2>=X.length)){W=X[0];X=X[X.length-1];var Y=this.view.toScreen(new S(W[0],W[1],this.view.spatialReference)),aa=this.view.toScreen(new S(X[0],X[1],this.view.spatialReference));this._isWithinScreenDistance(Y,
aa,this._getVertexIntersectDistance())&&(X[0]=W[0],X[1]=W[1])}};ea._getVertexIntersectDistance=function(){return this.vertexSymbol&&"simple-marker"===this.vertexSymbol.type?q.pt2px(this.vertexSymbol.size)/2+3:3};ea._isWithinScreenDistance=function(W,X,Y){const aa=W.x-X.x;W=W.y-X.y;return Math.sqrt(aa*aa+W*W)<=Y};ea._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};ea._displayGrabbingCursor=function(){this.view&&this.view.container&&
"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};ea._displayCrosshairCursor=function(){this.view&&this.view.container&&"crosshair"!==this.view.cursor&&(this.view.cursor="crosshair")};ea._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};ea._logError=function(W,X,Y){Z.error(new w(W,X,Y))};ea._requireModule=function(){var W=l._asyncToGenerator(function*(X){const Y=new AbortController;this._moduleLoaderAbortController=Y;X=yield X;
return this._moduleLoaderAbortController!==Y||Y.signal.aborted?{requireError:"aborted"}:{module:X}});return function(X){return W.apply(this,arguments)}}();ea._emitUndoEvent=function(W){this.emit("undo",{...W,type:"undo"})};ea._emitRedoEvent=function(W){this.emit("redo",{...W,type:"redo"})};ea._emitDeleteEvent=function(W){this.emit("delete",{...W,type:"delete"})};ea.createPointFromVertex=function(W){return 2<W.length?new S(W[0],W[1],W[2],this.view.spatialReference):new S(W[0],W[1],this.view.spatialReference)};
ea.test=function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:da}};ea.wait=function(){return d.whenNotOnce(this,"updating")};ea._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};ea._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};ea._disablePopupEnabled=function(W){var X;return"3d"!==(null==(X=this.view)?void 0:X.type)||this.updateOnGraphicClick||t.isSome(W)&&W.toggleToolOnClick};ea._disablePopup=function(W){this._disablePopupEnabled(W)&&
(W=this.view.popup)&&t.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=W.autoOpenEnabled,W.autoOpenEnabled=!1)};ea._restorePopup=function(W){this._disablePopupEnabled(W)&&(W=this.view.popup)&&t.isSome(this._originalAutoOpenEnabled)&&(W.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};ea._waitViewReady=function(){var W=l._asyncToGenerator(function*(){this.view&&(t.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=p.createAbortController(),
yield p.whenOrAbort(d.whenOnce(this.view,"ready"),this._viewReadyAbortController.signal))});return function(){return W.apply(this,arguments)}}();l._createClass(ha,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view.type?"move":"transform"}},{key:"_draw",get:function(){return"ready"===this.state||"active"===this.state?new P({view:this.view}):null}},{key:"updating",get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?
this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return this.view&&"3d"===this.view.type&&t.isSome(this.activeComponent)&&"draw-3d"===this.activeComponent.type?t.unwrap(this.activeComponent.createGraphic):this._get("createGraphic")}},{key:"defaultCreateOptions",set:function(W){this._set("defaultCreateOptions",{...ca,...W})}},{key:"defaultUpdateOptions",set:function(W){this._set("defaultUpdateOptions",
{...da,...W,reshapeOptions:{...da.reshapeOptions,...null==W?void 0:W.reshapeOptions}})}},{key:"snappingOptions",set:function(W){t.isSome(this._snappingManager)&&(this._snappingManager.options=W);this._set("snappingOptions",W)}},{key:"state",get:function(){var W;const X=!(null==(W=this.view)||!W.ready||!this.layer);W=this._operationHandle;return X&&W?"active":X?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(W){const X=this._get("view");if(X){const {container:Y,
map:aa}=X;Y&&(X.cursor=null);aa&&aa.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._doUnnormalization=null!=W&&"3d"===W.type&&"global"===W.viewingMode;this._handles.remove("view-ready");W&&this._handles.add(d.when(W,"ready",Y=>{this._viewHandles.removeAll();Y&&this._viewHandles.add(this._generateViewHandles(W))},!0),"view-ready");this._set("view",W)}}]);return ha}(u.EventedAccessor);m.__decorate([a.property({readOnly:!0})],z.prototype,"_draw",null);m.__decorate([a.property()],
z.prototype,"updating",null);m.__decorate([a.property()],z.prototype,"_operationHandle",void 0);m.__decorate([a.property({readOnly:!0})],z.prototype,"activeTool",null);m.__decorate([a.property()],z.prototype,"activeFillSymbol",void 0);m.__decorate([a.property()],z.prototype,"activeLineSymbol",void 0);m.__decorate([a.property()],z.prototype,"activeVertexSymbol",void 0);m.__decorate([a.property()],z.prototype,"allowDeleteKey",void 0);m.__decorate([a.property({readOnly:!0})],z.prototype,"createGraphic",
null);m.__decorate([a.property()],z.prototype,"defaultCreateOptions",null);m.__decorate([a.property()],z.prototype,"defaultUpdateOptions",null);m.__decorate([a.property()],z.prototype,"layer",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"pointSymbol",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"polygonSymbol",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"polylineSymbol",void 0);m.__decorate([a.property({type:V,nonNullable:!0})],
z.prototype,"snappingOptions",null);m.__decorate([a.property()],z.prototype,"_snappingManager",void 0);m.__decorate([a.property({readOnly:!0})],z.prototype,"state",null);m.__decorate([a.property({readOnly:!0})],z.prototype,"updateGraphics",void 0);m.__decorate([a.property()],z.prototype,"updateOnGraphicClick",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"updatePointSymbol",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"updatePolygonSymbol",void 0);m.__decorate([a.property({types:A.symbolTypes})],
z.prototype,"updatePolylineSymbol",void 0);m.__decorate([a.property({types:A.symbolTypes})],z.prototype,"vertexSymbol",void 0);m.__decorate([a.property({value:null})],z.prototype,"view",null);m.__decorate([a.property()],z.prototype,"cancel",null);m.__decorate([a.property()],z.prototype,"complete",null);m.__decorate([a.property()],z.prototype,"delete",null);m.__decorate([a.property()],z.prototype,"create",null);m.__decorate([a.property()],z.prototype,"update",null);m.__decorate([a.property()],z.prototype,
"undo",null);m.__decorate([a.property()],z.prototype,"redo",null);m.__decorate([a.property()],z.prototype,"canUndo",null);m.__decorate([a.property()],z.prototype,"canRedo",null);m.__decorate([a.property()],z.prototype,"toggleUpdateTool",null);return z=m.__decorate([e.subclass("esri.widgets.Sketch.SketchViewModel")],z)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(b,l){b.isSupportedGraphicResultMessage=function(m){switch(m){case 1:return"not owned by a graphics layer";
case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the elevation mode is not supported";case 5:return"the symbol type is not supported"}return""};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(b,l,m,z){b.isSupportedGraphic=function(C){var A;if("graphics"!==
(null==(A=C.layer)?void 0:A.type))return 1;if(m.isNone(C.geometry))return 2;switch(C.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return 3;default:return 3}return"on-the-ground"!==z.getGraphicEffectiveElevationMode(C)&&z.hasGraphicFeatureExpressionInfo(C)?4:0};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(b,
l,m){function z(u,x){return l.isNone(x)||!x.mode?u?"absolute-height":"on-the-ground":x.mode}function C(u,x){return z(l.isSome(u)?u.hasZ:!1,x)}function A(u){const x=g(u);return C(u.geometry,x)}function g(u){return u.layer&&"elevationInfo"in u.layer?u.layer.elevationInfo:null}function k(u,x,y,t,p,q,d=null){if(!l.isNone(q)){var a=l.isSome(d)?d.mode:"absolute-height";if("on-the-ground"===a)return 0;a:{q=w(x,y,t,p,u,q);d=l.isSome(d)&&l.isSome(d.offset)?d.offset:0;switch(a){case "absolute-height":u=q-d;
break a;case "relative-to-ground":u=q-(l.unwrapOr(u.elevationProvider.getElevation(x,y,t,p,"ground"),0)+d);break a;case "relative-to-scene":u=q-(l.unwrapOr(u.elevationProvider.getElevation(x,y,t,p,"scene"),0)+d);break a}u=void 0}return u}}function w(u,x,y,t,p,q){const d=l.isSome(q.offset)?q.offset:0;switch(q.mode){case "absolute-height":return y+d;case "on-the-ground":return l.unwrapOr(p.elevationProvider.getElevation(u,x,0,t,"ground"),0);case "relative-to-ground":return y+l.unwrapOr(p.elevationProvider.getElevation(u,
x,y,t,"ground"),0)+d;case "relative-to-scene":return y+l.unwrapOr(p.elevationProvider.getElevation(u,x,y,t,"scene"),0)+d}}b.getConvertedElevation=function(u,x,y,t=null){return k(u,x.x,x.y,x.hasZ?x.z:0,x.spatialReference,y,t)};b.getConvertedElevationFromVector=function(u,x,y,t,p=null){return k(u,x[0],x[1],2<x.length?x[2]:0,y,t,p)};b.getEffectiveElevationMode=z;b.getGeometryEffectiveElevationMode=C;b.getGraphicEffectiveElevationInfo=function(u){var x=g(u);u=C(u.geometry,x);x=l.isSome(x)&&"on-the-ground"!==
u?l.unwrapOr(x.offset,0)*m.getMetersPerUnit(l.unwrapOr(x.unit,"meters")):0;return{mode:u,offset:x}};b.getGraphicEffectiveElevationMode=A;b.getZForElevationMode=function(u,x,y){if(!l.isNone(y)&&y.mode){var t=u.hasZ?u.z:0,p=l.isSome(y.offset)?y.offset:0;switch(y.mode){case "absolute-height":return t-p;case "on-the-ground":return 0;case "relative-to-ground":return u=l.unwrapOr(x.elevationProvider.getElevation(u.x,u.y,u.z,u.spatialReference,"ground"),0)+p,t-u;case "relative-to-scene":return u=l.unwrapOr(x.elevationProvider.getElevation(u.x,
u.y,u.z,u.spatialReference,"scene"),0)+p,t-u}}};b.hasGraphicFeatureExpressionInfo=function(u){if("on-the-ground"===A(u))return!1;u=g(u);u=l.isSome(u)&&u.featureExpressionInfo?u.featureExpressionInfo.expression:null;return!(!u||"0"===u)};b.zValueInAbsoluteHeightMode=w;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils"],
function(b,l,m,z){function C(A){var g;return"graphics"!==(null==(g=A.layer)?void 0:g.type)?{result:1,geometry:null}:l.isNone(A.geometry)?{result:2,geometry:null}:"on-the-ground"!==z.getGraphicEffectiveElevationMode(A)&&z.hasGraphicFeatureExpressionInfo(A)?{result:4,geometry:null}:"point"!==A.geometry.type&&"polyline"!==A.geometry.type&&("polygon"!==A.geometry.type||A.geometry instanceof m)?{result:3,geometry:null}:{result:0,geometry:A.geometry}}b.geometryOfSupportedGraphic=function(A){return C(A).geometry};
b.isSupportedGraphic=function(A){return C(A).result};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/subclass ./Point ./Polygon ./projectionEllipsoid ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q){var d;C=d=function(a){function c(...e){e=a.call(this,...e)||this;e.center=null;e.geodesic=!1;e.numberOfPoints=60;e.radius=1E3;e.radiusUnit="meters";return e}b._inheritsLoose(c,a);var r=c.prototype;r.normalizeCtorArgs=function(e,h){if(!e||!e.center){if(e&&e.rings)return a.prototype.normalizeCtorArgs.call(this,e,h);e={center:e}}return{...a.prototype.normalizeCtorArgs.call(this),...e,...h}};r.initialize=function(){var e=this.center;const h=this.numberOfPoints;
this.hasZ=e&&e.hasZ;if(0===this.rings.length&&e){var v=m.convertUnit(this.radius,this.radiusUnit,"meters"),E=e.spatialReference,n="geographic";if(E.isWebMercator)n="webMercator";else if(null!=q[E.wkid]||E.wkt&&0===E.wkt.indexOf("PROJCS"))n="projected";if(this.geodesic){let B;switch(n){case "webMercator":B=p.webMercatorToGeographic(e);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":B=
e}e=this._createGeodesicCircle(B,v,h);"webMercator"===n&&(e=p.geographicToWebMercator(e))}else{let B;"webMercator"===n||"projected"===n?B=v/this._convert2Meters(1,e.spatialReference):"geographic"===n&&(B=m.lengthToDegrees(v,"meters",y.getReferenceEllipsoid(e.spatialReference).radius));e=this._createPlanarCircle(e,B,h)}this.spatialReference=e.spatialReference;this.addRing(e.rings[0])}};r.clone=function(){const {center:e,numberOfPoints:h,radius:v,radiusUnit:E,geodesic:n}=this;return new d({center:e.clone(),
numberOfPoints:h,radius:v,radiusUnit:E,geodesic:n})};r._createGeodesicCircle=function(e,h,v){let E=0;const n=[];for(;360>E;){const B=[0,0];t.directGeodeticSolver(B,[e.x,e.y],E,h);this.hasZ&&B.push(e.z);n.push(B);E+=360/v}n.push(n[0]);return new x(n)};r._createPlanarCircle=function(e,h,v){const E=[],n=2*Math.PI/v;for(let f=0;f<v;++f){var B=n*f;B=[e.x+Math.cos(-B)*h,e.y+Math.sin(-B)*h];this.hasZ&&B.push(e.z);E.push(B)}E.push(E[0]);return new x({spatialReference:e.spatialReference,rings:[E]})};r._convert2Meters=
function(e,h){if(null!=q[h.wkid])h=q.values[q[h.wkid]];else{h=h.wkt;const v=h.lastIndexOf(",")+1,E=h.lastIndexOf("]]");h=parseFloat(h.substring(v,E))}return e*h};return c}(x);l.__decorate([z.property({type:u})],C.prototype,"center",void 0);l.__decorate([z.property()],C.prototype,"geodesic",void 0);l.__decorate([z.property()],C.prototype,"numberOfPoints",void 0);l.__decorate([z.property()],C.prototype,"radius",void 0);l.__decorate([z.property()],C.prototype,"radiusUnit",void 0);return C=d=l.__decorate([w.subclass("esri.geometry.Circle")],
C)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(b,l,m,z,C,A,g,k,w){function u(a){if(!a)return null;if(a.isGeographic&&a.wkid){var c=C.spheroids[a.wkid];if(c)return c}return a.wkt&&((a=C.WKT_SPHEROID_REGEX.exec(a.wkt))&&2===a.length?(c=a[1].split(","),!c||3>c.length?a=null:(a=parseFloat(c[1]),c=parseFloat(c[2]),a=isNaN(a)||isNaN(c)?
null:{a,f:0===c?0:1/c})):a=null,a)?a:null}function x(a){a=u(a||w.WGS84);if("b"in a&&"eSq"in a&&"radius"in a)return a;const c=a.a*(1-a.f);return Object.assign(a,{b:c,eSq:1-(c/a.a)**2,radius:(2*a.a+c)/3,densificationRatio:1E4/((2*a.a+c)/3)})}function y(a,c,r){const {a:e,eSq:h}=x(r);r=Math.sqrt(h);const v=Math.sin(c[1]*C.toRadians);c=e*c[0]*C.toRadians;r=0<h?e*(1-h)*(v/(1-h*v*v)-1/(2*r)*Math.log((1-r*v)/(1+r*v)))*.5:e*v;a[0]=c;a[1]=r;return a}function t(a){return null!==u(a)}function p(a,c){if("polyline"!==
a.type&&"polygon"!==a.type)throw new m("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:r}=a;if(!t(r))throw new m("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var e="polyline"===a.type?a.paths:a.rings;const h=[],v=[0,0],E={distance:null};for(const f of e){e=[];h.push(e);e.push([f[0][0],f[0][1]]);var n=f[0][0],B=f[0][1];let D,H;for(let P=0;P<f.length-1;P++){D=f[P+1][0];H=f[P+1][1];
if(n===D&&B===H)continue;const R=[n,B];d(E,[n,B],[D,H],r);const {azimuth:K,distance:J}=E;n=J/c;if(1<n){for(B=1;B<=n-1;B++)q(v,R,K,B*c,r),e.push(v.slice(0));q(v,R,K,(J+Math.floor(n-1)*c)/2,r);e.push(v.slice(0))}q(v,R,K,J,r);e.push(v.slice(0));n=v[0];B=v[1]}}return"polyline"===a.type?new A({paths:h,spatialReference:r}):new g({rings:h,spatialReference:r})}function q(a,c,r,e,h){const v=c[0]*C.toRadians;c=c[1]*C.toRadians;r*=C.toRadians;const {a:E,b:n,f:B}=x(h);h=Math.sin(r);r=Math.cos(r);var f=(1-B)*
Math.tan(c);c=1/Math.sqrt(1+f*f);const D=f*c,H=Math.atan2(f,r);f=c*h;const P=f*f;var R=1-P,K=R*(E*E-n*n)/(n*n);const J=1+K/16384*(4096+K*(-768+K*(320-175*K))),Q=K/1024*(256+K*(-128+K*(74-47*K)));K=e/(n*J);let F=2*Math.PI,O,V,M,T;for(;1E-12<Math.abs(K-F);)M=Math.cos(2*H+K),O=Math.sin(K),V=Math.cos(K),T=Q*O*(M+Q/4*(V*(-1+2*M*M)-Q/6*M*(-3+4*O*O)*(-3+4*M*M))),F=K,K=e/(n*J)+T;e=D*O-c*V*r;R=B/16*R*(4+B*(4-3*R));e=Math.atan2(D*V+c*O*r,(1-B)*Math.sqrt(P+e*e))/C.toRadians;a[0]=(v+(Math.atan2(O*h,c*V-D*O*r)-
(1-R)*B*f*(K+R*O*(M+R*V*(-1+2*M*M)))))/C.toRadians;a[1]=e;return a}function d(a,c,r,e){var h=c[0]*C.toRadians;c=c[1]*C.toRadians;var v=r[0]*C.toRadians;r=r[1]*C.toRadians;const {a:E,b:n,f:B,radius:f}=x(e),D=v-h;var H=Math.atan((1-B)*Math.tan(c)),P=Math.atan((1-B)*Math.tan(r));e=Math.sin(H);H=Math.cos(H);const R=Math.sin(P);P=Math.cos(P);let K=1E3,J=D,Q,F,O;let V,M,T;do{var S=Math.sin(J);var L=Math.cos(J);O=Math.sqrt(P*S*P*S+(H*R-e*P*L)*(H*R-e*P*L));if(0===O)return a.distance=0,a.azimuth=void 0,a.reverseAzimuth=
void 0,a;L=e*R+H*P*L;V=Math.atan2(O,L);M=H*P*S/O;F=1-M*M;S=L-2*e*R/F;isNaN(S)&&(S=0);T=B/16*F*(4+B*(4-3*F));Q=J;J=D+(1-T)*B*M*(V+T*O*(S+T*L*(-1+2*S*S)))}while(1E-12<Math.abs(J-Q)&&0<--K);if(0===K)return e=Math.acos(Math.sin(c)*Math.sin(r)+Math.cos(c)*Math.cos(r)*Math.cos(v-h))*f,h=v-h,a.azimuth=Math.atan2(Math.sin(h)*Math.cos(r),Math.cos(c)*Math.sin(r)-Math.sin(c)*Math.cos(r)*Math.cos(h))/C.toRadians,a.distance=e,a.reverseAzimuth=void 0,a;h=F*(E*E-n*n)/(n*n);c=h/1024*(256+h*(-128+h*(74-47*h)));v=
Math.atan2(H*Math.sin(J),H*R*Math.cos(J)-e*P);a.azimuth=Math.atan2(P*Math.sin(J),H*R-e*P*Math.cos(J))/C.toRadians;a.distance=n*(1+h/16384*(4096+h*(-768+h*(320-175*h))))*(V-c*O*(S+c/4*(L*(-1+2*S*S)-c/6*S*(-3+4*O*O)*(-3+4*S*S))));a.reverseAzimuth=v/C.toRadians;return a}b.directGeodeticSolver=q;b.geodesicAreas=function(a,c="square-meters"){if(a.some(v=>!t(v.spatialReference)))throw new m("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const r=[];
for(var e=0;e<a.length;e++){var h=a[e];const {radius:v,densificationRatio:E}=x(h.spatialReference);r.push(p(h,v*E))}a=[];e=[0,0];h=[0,0];for(let v=0;v<r.length;v++){const {rings:E,spatialReference:n}=r[v];let B=0;for(let f=0;f<E.length;f++){const D=E[f];y(e,D[0],n);y(h,D[D.length-1],n);let H=h[0]*e[1]-e[0]*h[1];for(let P=0;P<D.length-1;P++)y(e,D[P+1],n),y(h,D[P],n),H+=h[0]*e[1]-e[0]*h[1];B+=H}B=z.convertUnit(B,"square-meters",c);a.push(B/-2)}return a};b.geodesicDensify=p;b.geodesicDistance=function(a,
c,r="meters"){if(!a||!c)throw new m("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!a.spatialReference||!c.spatialReference)throw new m("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!a.spatialReference.equals(c.spatialReference))throw new m("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:e}=a;if(!t(e))throw new m("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(a.equals(c))return{distance:0,azimuth:0,reverseAzimuth:0};const h={distance:null};d(h,[a.x,a.y],[c.x,c.y],e);h.distance=z.convertUnit(h.distance,"meters",r);return h};b.geodesicLengths=function(a,c="meters"){if(!a)throw new m("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(a.some(h=>!t(h.spatialReference)))throw new m("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const r=[];for(let h=0;h<a.length;h++){var e=a[h];const {spatialReference:v}=e;e="polyline"===e.type?e.paths:e.rings;let E=0;for(let n=0;n<e.length;n++){const B=e[n];let f=0;for(let D=1;D<B.length;D++){const H=B[D-1][0],P=B[D][0],R=B[D-1][1],K=B[D][1];if(R!==K||H!==P){const J={distance:null};d(J,[H,R],[P,K],v);f+=J.distance}}E+=f}E=z.convertUnit(E,"meters",c);r.push(E)}return r};b.inverseGeodeticSolver=d;b.isSupported=t;b.pointFromDistance=function(a,c,r){if(!a||null==c||null==r)throw new m("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>r||360<r)throw new m("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!a.spatialReference)throw new m("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:e}=a;if(!t(e))throw new m("geodesic-distance:not-supported","input geometry spatial reference is not supported");const h=[0,0];q(h,[a.x,a.y],
r,c,e);return new k({x:h[0],y:h[1],spatialReference:e})};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(b,l){const m=Math.PI/180;var z=l.earth.radius;const C=l.earth.eccentricitySquared;z={a1:z*C,a2:z*C*z*C,a3:z*C*C/2,a4:z*C*z*C*2.5,a5:z*C+z*C*C/2,a6:1-C};l={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:l.earth.radius,f:l.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,
f:0},104902:{a:6051800,f:0},104903:{a:l.moon.radius,f:l.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:l.mars.radius,f:l.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,
f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},
104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,
f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:l.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};b.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;b.earthEllipsoidConstants=z;b.spheroids=l;b.toRadians=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],
function(b,l,m,z){b.isSupportedGraphic=function(C){var A;if("graphics"!==(null==(A=C.layer)?void 0:A.type))return 1;if(m.isNone(C.geometry))return 2;switch(C.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return 0;default:return 3}return(A=m.isSome(C.symbol)&&"point-3d"===C.symbol.type&&C.symbol.symbolLayers)&&0<A.length&&A.some(g=>"object"===g.type)?"on-the-ground"!==z.getGraphicEffectiveElevationMode(C)&&z.hasGraphicFeatureExpressionInfo(C)?
4:0:5};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/Draw":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../chunks/MultipointDrawAction ./PointDrawAction ./PolygonDrawAction ./PolylineDrawAction ./SegmentDrawAction".split(" "),function(b,
l,m,z,C,A,g,k,w,u,x,y,t,p){m=function(q){function d(){var c=q.apply(this,arguments)||this;c.activeAction=null;c.type="draw";c.view=null;return c}b._inheritsLoose(d,q);var a=d.prototype;a.destroy=function(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)};a.create=function(c,r){this.reset();r={view:this.view,...r};switch(c){case "point":r.editGeometryType="point";this.activeAction=new x.PointDrawAction(r);break;case "polyline":r.editGeometryType="polyline";this.activeAction=
new t.PolylineDrawAction(r);break;case "multipoint":r.editGeometryType="polygon";this.activeAction=new u.MultipointDrawAction(r);break;case "polygon":r.editGeometryType="polygon";this.activeAction=new y.PolygonDrawAction(r);break;case "rectangle":case "circle":case "ellipse":case "triangle":r.editGeometryType="polygon",this.activeAction=new p.SegmentDrawAction(r)}return this.activeAction};a.complete=function(){this.activeAction&&this.activeAction.complete();this.activeAction=null};a.reset=function(){this.activeAction&&
this.activeAction.destroy();this.activeAction=null};return d}(m);l.__decorate([C.property()],m.prototype,"activeAction",void 0);l.__decorate([C.property({readOnly:!0})],m.prototype,"type",void 0);l.__decorate([C.property()],m.prototype,"view",void 0);return m=l.__decorate([w.subclass("esri.views.draw.Draw")],m)})},"esri/chunks/MultipointDrawAction":function(){define("exports ./_rollupPluginBabelHelpers ./tslib.es6 ../geometry ../core/Handles ../core/maybe ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/subclass ../views/draw/DrawAction ../views/draw/input/DrawEvents ../views/input/InputManager ../views/interactive/keybindings ../views/support/screenUtils ../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){b.MultipointDrawAction=function(r){function e(v){v=r.call(this,v)||this;v._popVertexOnPointerMove=!1;v._addVertexOnPointerUp=!1;v._activePointerId=null;v._viewHandles=new C;v._undoRedoHandles=new C;return v}l._inheritsLoose(e,r);var h=e.prototype;h.initialize=function(){this._addViewHandles();this._addUndoRedoHandles()};h.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this._removeUndoRedoHandles();this._undoRedoHandles.destroy();
this.emit("destroy")};h.undo=function(){r.prototype.undo.call(this);this.notifyChange("vertices")};h.redo=function(){r.prototype.redo.call(this);this.notifyChange("vertices")};h.complete=function(){this._completeDrawing()};h._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("click",v=>{v.stopPropagation()},q.ViewEventPriorities.TOOL),this.view.on("pointer-down",v=>{this._shouldHandlePointerEvent(v)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=
v.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=a.createScreenPointFromEvent(v),"touch"===v.pointerType&&this._updateCursor(v.native))},q.ViewEventPriorities.TOOL),this.view.on("pointer-move",v=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1);this._snappingTask=A.abortMaybe(this._snappingTask);this._cursorScreenPoint=a.createScreenPointFromEvent(v);"touch"!==v.pointerType&&this._updateCursor(v.native)},q.ViewEventPriorities.TOOL),this.view.on("pointer-drag",
v=>{this._shouldHandlePointerEvent(v)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._addVertexOnPointerUp=!1)},q.ViewEventPriorities.TOOL),this.view.on("pointer-up",v=>{this._shouldHandlePointerEvent(v)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._vertexAddHandler(v):this._updateCursor(v.native,"touch"===v.pointerType))},q.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],v=>{v.stopPropagation()},q.ViewEventPriorities.TOOL),
this.view.on("double-click",v=>{v.stopPropagation();this._drawCompleteHandler(v)},q.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],v=>{v.stopPropagation();this._drawCompleteHandler(v)},q.ViewEventPriorities.TOOL),this.view.on("key-down",v=>{const {key:E,repeat:n}=v;E===d.SKETCH_KEYS.vertexAdd&&!n&&this._cursorScreenPoint?(v.stopPropagation(),this._snappingTask=A.abortMaybe(this._snappingTask),this._vertexAddHandler(v)):E===d.SKETCH_KEYS.complete&&!n&&this._cursorScreenPoint&&2<
this.vertices.length?(v.stopPropagation(),this._snappingTask=A.abortMaybe(this._snappingTask),this._vertexAddHandler(v),this._drawCompleteHandler(v)):E!==d.SKETCH_KEYS.undo||this.interactiveUndoDisabled||n?E!==d.SKETCH_KEYS.redo||this.interactiveUndoDisabled||n?E!==d.SKETCH_KEYS.pan||n||v.stopPropagation():(v.stopPropagation(),this.redo()):(v.stopPropagation(),this.undo())},q.ViewEventPriorities.TOOL),this.view.on("key-up",v=>{v.key===d.SKETCH_KEYS.pan&&v.stopPropagation()},q.ViewEventPriorities.TOOL)])};
h._addUndoRedoHandles=function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",v=>{this.notifyChange("vertices");if("undo"===v.operation){const E=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(E);const n=[...this._committedVertices];A.isSome(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("undo",new p.VertexRemoveEvent(this.view,E,v.vertices[0].index,n))}}),this._editGeometry.on("vertex-add",
v=>{this.notifyChange("vertices");if("apply"===v.operation)v=new p.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",v),v.defaultPrevented&&(this._popVertexOnPointerMove=!0);else if("redo"===v.operation){const E=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(E);const n=[...this._committedVertices];A.isSome(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex));
this.emit("redo",new p.VertexAddEvent(this.view,E,v.vertices[0].index,n))}})])};h._removeViewHandles=function(){this._viewHandles.removeAll()};h._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};h._addVertex=function(v,E){v=this._coordinateHelper.fromArray(v);this._isDuplicateOfLastVertex(v)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(v),E=E||new Event("placeholder"),this._nativeEventHistory.undoStack.push(E))};
h._updateCursor=function(v,E=!1){this._popCursorVertex();if(this._cursorScreenPoint){var n=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(A.isSome(n)&&!E){this._pushCursorVertex(n.vertex);const B=()=>new p.CursorUpdateEvent(this.view,v,this._activeComponent.vertices.length,this.vertices,A.isSome(this._stagedVertex)?new c(this._stagedVertex):null);this.emit("cursor-update",B());A.isSome(this._snappingTask)&&this._snappingTask.promise.then(f=>{f.valid&&this.emit("cursor-update",B())},
()=>{})}}};h._completeDrawing=function(v){this._activePointerId=null;this._popCursorVertex();this._snappingTask=A.abortMaybe(this._snappingTask);A.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();2>this.vertices.length||(v=new p.DrawCompleteEvent(v,this.vertices),this.emit("draw-complete",v),v.defaultPrevented||this._removeViewHandles())};h._shouldHandlePointerEvent=function(v){return("mouse"!==v.pointerType||0===v.button)&&(A.isNone(this._activePointerId)||this._activePointerId===
v.pointerId)};return e}(t);b.MultipointDrawAction=m.__decorate([y.subclass("esri.views.draw.MultipointDrawAction")],b.MultipointDrawAction);m=Object.freeze({__proto__:null,get MultipointDrawAction(){return b.MultipointDrawAction}});b.MultipointDrawAction$1=m})},"esri/views/draw/DrawAction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/graphics/dehydratedFeatures ../2d/interactive/SnappingVisualizer2D ../interactive/coordinateHelper ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryHelper ../interactive/snapping/SnappingContext".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r){var e;m=e=function(E){function n(f){var D;var H=E.call(this,f)||this;H._hasZ=null;H._cursorScreenPoint=null;H._snappingTask=null;H._stagedVertex=null;H._stagedVertexUnsnapped=null;H._lastVertexUnsnapped=null;H._nativeEventHistory={undoStack:[],redoStack:[]};H.interactiveUndoDisabled=!1;H.history=[];H.redoHistory=[];H.snapToScene=!1;H.view=null;H.elevationInfo=null;H.defaultZ=0;H._coordinateHelper=d.createCoordinateHelper(f.hasZ,!1,f.view.spatialReference,
"local");H._snappingManager=f.snappingManager;H._editGeometry=new c.EditGeometryHelper(new a.EditGeometry(H._coordinateHelper),null!=(D=f.editGeometryType)?D:"polygon");H._snappingGraphicsLayer=new t({id:e.SNAPPING_GRAPHICS_LAYER_ID,listMode:"hide",internal:!0});H._snappingContext=new r.SnappingContext({geometry:H._editGeometry,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new q.SnappingVisualizer2D(H._snappingGraphicsLayer)});H._activeComponent=new a.Component(H._editGeometry.editGeometry);
H._editGeometry.editGeometry.components.push(H._activeComponent);return H}b._inheritsLoose(n,E);var B=n.prototype;B.initialize=function(){"2d"===this.view.type&&this.view.map.layers.add(this._snappingGraphicsLayer)};B.destroy=function(){this._snappingTask=z.abortMaybe(this._snappingTask);this.view.map.layers.remove(this._snappingGraphicsLayer);this._snappingGraphicsLayer.destroy();z.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();this._editGeometry.destroy()};B.canUndo=function(){return this._editGeometry.editGeometry.canUndo};
B.canRedo=function(){return this._editGeometry.editGeometry.canRedo};B.undo=function(){this.canUndo()&&this._editGeometry.undo()};B.redo=function(){this.canRedo()&&this._editGeometry.redo()};B.getCoordsFromScreenPoint=function(f){f=this.screenToMap(f);return z.isSome(f)?f.hasZ?[f.x,f.y,f.z]:[f.x,f.y]:null};B.getCoordsAndPointFromScreenPoint=function(f){f=this.screenToMap(f);return z.isSome(f)?f.hasZ?{vertex:[f.x,f.y,f.z],mapPoint:f}:{vertex:[f.x,f.y],mapPoint:f}:null};B._pushCursorVertex=function(f){var D=
this;const H=p.makeDehydratedPoint(f[0],f[1],null,this.view.spatialReference);this._stagedVertexUnsnapped=H;z.isNone(this._snappingManager)?this._stagedVertex=H:(this._stagedVertex=this._snappingManager.update(H,this._snappingContext),this._snappingTask=C.createTask(function(){var P=b._asyncToGenerator(function*(R){return z.isSome(D._snappingManager)?(R=yield D._snappingManager.snap(H,D._snappingContext,R),R.valid&&(D._stagedVertex=R.apply(),D.notifyChange("vertices")),R):null});return function(R){return P.apply(this,
arguments)}}()))};B._popCursorVertex=function(){this._stagedVertexUnsnapped=this._stagedVertex=null;this.notifyChange("vertices")};B.getGeometryZValue=function(){return this.defaultZ};B.screenToMap=function(f){var D=null;"3d"===this.view.type?this.hasZ?(D=z.unwrapOr(this.elevationInfo,h),D=this.view.sceneIntersectionHelper.intersectElevationFromScreen(A.createScreenPointArray(f.x,f.y),D,this.getGeometryZValue())):(D=z.unwrapOr(this.elevationInfo,v),D=this.view.sceneIntersectionHelper.intersectElevationFromScreen(A.createScreenPointArray(f.x,
f.y),D,0),z.isSome(D)&&(D.z=void 0)):(D=this.view.toMap(f),z.isSome(D)&&(D.z=this.hasZ?this.getGeometryZValue():void 0));return D};B._isDuplicateOfLastVertex=function(f){const D=this._editGeometry.editGeometry.components[0].getLastVertex();if(z.isSome(D)&&f[0]===D[0]&&f[1]===D[1])return!0;const {x:H,y:P}=this._coordinateHelper.createDehydratedPoint(f);return z.isSome(this._lastVertexUnsnapped)&&H===this._lastVertexUnsnapped.x&&P===this._lastVertexUnsnapped.y?!0:!1};B._vertexAddHandler=function(f){const D=
z.isSome(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);z.isSome(D)&&this._addVertex(D,f.native)};B._drawCompleteHandler=function(f){this._completeDrawing(f.native)};b._createClass(n,[{key:"_committedVertices",get:function(){return this._editGeometry.editGeometry.components[0].vertices.map(f=>f.pos)}},{key:"vertices",get:function(){return z.isSome(this._stagedVertex)?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:
this._committedVertices}},{key:"hasZ",get:function(){return z.isSome(this._hasZ)?this._hasZ:"3d"===this.view.type},set:function(f){this._hasZ=f;this.notifyChange("hasZ")}}]);return n}(m.EventedAccessor);m.SNAPPING_GRAPHICS_LAYER_ID="DrawAction-snapping-graphics-layer";l.__decorate([g.property({readOnly:!0})],m.prototype,"vertices",null);l.__decorate([g.property({type:Boolean,nonNullable:!0})],m.prototype,"interactiveUndoDisabled",void 0);l.__decorate([g.property({readOnly:!0})],m.prototype,"history",
void 0);l.__decorate([g.property({readOnly:!0})],m.prototype,"redoHistory",void 0);l.__decorate([g.property()],m.prototype,"snapToScene",void 0);l.__decorate([g.property()],m.prototype,"view",void 0);l.__decorate([g.property()],m.prototype,"elevationInfo",void 0);l.__decorate([g.property({nonNullable:!0})],m.prototype,"defaultZ",void 0);l.__decorate([g.property()],m.prototype,"hasZ",null);m=e=l.__decorate([y.subclass("esri.views.draw.DrawAction")],m);const h={mode:"absolute-height",offset:0},v={mode:"on-the-ground",
offset:0};return m})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../core/byteSizeEstimations ../../core/has ../../core/maybe ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),function(b,l,m,z,C,A,g,k,w,u,x,y,t){function p(e,h,v){if(!e)return null;
switch(h){case "point":return{x:e.x,y:e.y,z:e.z,m:e.m,hasZ:null!=e.z,hasM:null!=e.m,type:"point",spatialReference:v};case "polyline":return{paths:e.paths,hasZ:!!e.hasZ,hasM:!!e.hasM,type:"polyline",spatialReference:v};case "polygon":return{rings:e.rings,hasZ:!!e.hasZ,hasM:!!e.hasM,type:"polygon",spatialReference:v};case "multipoint":return{points:e.points,hasZ:!!e.hasZ,hasM:!!e.hasM,type:"multipoint",spatialReference:v}}}function q(e){if(z.isNone(e))return 0;let h=32;switch(e.type){case "point":h+=
42;break;case "polyline":case "polygon":{var v=0;const E=2+(e.hasZ?1:0)+(e.hasM?1:0);e="polyline"===e.type?e.paths:e.rings;for(const n of e)v+=n.length;h+=8*v*E+64;h+=128*v;h=h+34+32*(e.length+1);break}case "multipoint":v=e.points.length;h+=8*v*(2+(e.hasZ?1:0)+(e.hasM?1:0))+64;h+=128*v;h=h+34+32;break;case "extent":h+=98;e.hasM&&(h+=32);e.hasZ&&(h+=32);break;case "mesh":h+=C.estimateSize(e.vertexAttributes.position),h+=C.estimateSize(e.vertexAttributes.normal),h+=C.estimateSize(e.vertexAttributes.uv),
h+=C.estimateSize(e.vertexAttributes.tangent)}return h}function d(e,h){k.empty(h);"mesh"===e.type&&(e=e.extent);switch(e.type){case "point":h[0]=h[3]=e.x;h[1]=h[4]=e.y;e.hasZ&&(h[2]=h[5]=e.z);break;case "polyline":for(var v=0;v<e.paths.length;v++)k.expandWithNestedArray(h,e.paths[v],e.hasZ);break;case "polygon":for(v=0;v<e.rings.length;v++)k.expandWithNestedArray(h,e.rings[v],e.hasZ);break;case "multipoint":k.expandWithNestedArray(h,e.points,e.hasZ);break;case "extent":h[0]=e.xmin,h[1]=e.ymin,h[3]=
e.xmax,h[4]=e.ymax,null!=e.zmin&&(h[2]=e.zmin),null!=e.zmax&&(h[5]=e.zmax)}}function a(e,h){w.empty(h);"mesh"===e.type&&(e=e.extent);switch(e.type){case "point":h[0]=h[2]=e.x;h[1]=h[3]=e.y;break;case "polyline":for(var v=0;v<e.paths.length;v++)w.expandWithNestedArray(h,e.paths[v]);break;case "polygon":for(v=0;v<e.rings.length;v++)w.expandWithNestedArray(h,e.rings[v]);break;case "multipoint":w.expandWithNestedArray(h,e.points);break;case "extent":h[0]=e.xmin,h[1]=e.ymin,h[2]=e.xmax,h[3]=e.ymax}}const c=
k.create(),r=w.create();b.equals=t.equals;b.DehydratedFeatureClass=function(e,h,v){this.uid=e;this.geometry=h;this.attributes=v;this.visible=!0;this.centroid=this.objectId=null};b.DehydratedFeatureSetClass=function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null};b.computeAABB=d;b.computeAABR=a;b.estimateGeometryObjectSize=
q;b.estimateSize=function(e){let h;h=32+l.estimateAttributesObjectSize(e.attributes);return h=h+3+(8+q(e.geometry))};b.expandAABB=function(e,h){d(e,c);k.expandWithAABB(h,c)};b.expandAABR=function(e,h){a(e,r);w.expand(h,r)};b.fromFeatureSetJSON=function(e){const h=x.featureGeometryTypeKebabDictionary.fromJSON(e.geometryType),v=g.fromJSON(e.spatialReference),E=e.transform,n=e.features.map(B=>{var f=e.objectIdFieldName;B={uid:A.generateUID(),objectId:f&&B.attributes?B.attributes[f]:null,attributes:B.attributes,
geometry:p(B.geometry,h,v),visible:!0};f=B.geometry;if(z.isSome(f)&&E)switch(f.type){case "point":B.geometry=u.unquantizePoint(E,f,f,f.hasZ,f.hasM);break;case "multipoint":B.geometry=u.unquantizeMultipoint(E,f,f,f.hasZ,f.hasM);break;case "polygon":B.geometry=u.unquantizePolygon(E,f,f,f.hasZ,f.hasM);break;case "polyline":B.geometry=u.unquantizePolyline(E,f,f,f.hasZ,f.hasM);break;case "extent":B.geometry=f;break;case "mesh":B.geometry=f}return B});return{geometryType:h,features:n,spatialReference:v,
fields:e.fields?e.fields.map(B=>y.fromJSON(B)):null,objectIdFieldName:e.objectIdFieldName,globalIdFieldName:e.globalIdFieldName,geohashFieldName:e.geohashFieldName,geometryProperties:e.geometryProperties,hasZ:e.hasZ,hasM:e.hasM,exceededTransferLimit:e.exceededTransferLimit,transform:null}};b.fromJSONGeometry=p;b.getObjectId=function(e,h){return null!=e.objectId?e.objectId:e.attributes&&h?e.attributes[h]:null};b.hasGeometry=function(e){return z.isSome(e.geometry)};b.hasVertices=function(e){if(z.isNone(e))return!1;
switch(e.type){case "extent":case "point":return!0;case "polyline":for(const h of e.paths)if(0<h.length)return!0;return!1;case "polygon":for(const h of e.rings)if(0<h.length)return!0;return!1;case "multipoint":return 0<e.points.length;case "mesh":return!e.loaded||0<e.vertexAttributes.position.length}};b.isFeatureGeometry=function(e){return x.isFeatureGeometryType(e.type)};b.makeDehydratedPoint=function(e,h,v,E){return{x:e,y:h,z:v,hasZ:null!=v,hasM:!1,spatialReference:E,type:"point"}};b.numVertices=
function(e){if(z.isNone(e))return 0;switch(e.type){case "point":return 1;case "polyline":var h=0;for(var v of e.paths)h+=v.length;return h;case "polygon":v=0;for(h of e.rings)v+=h.length;return v;case "multipoint":return e.points.length;case "extent":return 2;case "mesh":return(e=e.vertexAttributes&&e.vertexAttributes.position)?e.length/3:0}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(b){function l(m){return 32+m.length}
b.estimateAttributesObjectSize=function(m){if(!m)return 0;let z=32;for(const C in m)if(m.hasOwnProperty(C)){const A=m[C];switch(typeof A){case "string":z+=l(A);break;case "number":z+=16;break;case "boolean":z+=4}}return z};b.estimateFixedArraySize=function(m,z){return 32+m.length*z};b.estimateNumberByteSize=function(){return 16};b.estimateStringByteSize=l;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent",
"./aaBoundingRect"],function(b,l,m,z){function C(d=p){return[d[0],d[1],d[2],d[3],d[4],d[5]]}function A(d,a,c,r,e,h,v=C()){v[0]=d;v[1]=a;v[2]=c;v[3]=r;v[4]=e;v[5]=h;return v}function g(d){return d[0]>=d[3]?0:d[3]-d[0]}function k(d){return d[1]>=d[4]?0:d[4]-d[1]}function w(d){return d[2]>=d[5]?0:d[5]-d[2]}function u(d,a){return Math.max(a[0],d[0])<=Math.min(a[3],d[3])&&Math.max(a[1],d[1])<=Math.min(a[4],d[4])&&Math.max(a[2],d[2])<=Math.min(a[5],d[5])}function x(d,a){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=
a[3];d[4]=a[4];d[5]=a[5];return d}function y(d){return 6===d.length}const t=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],p=[0,0,0,0,0,0],q=C();b.NEGATIVE_INFINITY=t;b.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];b.ZERO=p;b.allFinite=function(d){for(let a=0;6>a;a++)if(!isFinite(d[a]))return!1;return!0};b.center=function(d,a=[0,0,0]){a[0]=d[0]+g(d)/2;a[1]=d[1]+k(d)/2;a[2]=d[2]+w(d)/2;return a};b.contains=function(d,a){return a[0]>=d[0]&&a[1]>=d[1]&&a[2]>=
d[2]&&a[3]<=d[3]&&a[4]<=d[4]&&a[5]<=d[5]};b.containsPoint=function(d,a){return a[0]>=d[0]&&a[1]>=d[1]&&a[2]>=d[2]&&a[0]<=d[3]&&a[1]<=d[4]&&a[2]<=d[5]};b.containsPointWithMargin=function(d,a,c){return a[0]>=d[0]-c&&a[1]>=d[1]-c&&a[2]>=d[2]-c&&a[0]<=d[3]+c&&a[1]<=d[4]+c&&a[2]<=d[5]+c};b.create=C;b.depth=k;b.diameter=function(d){const a=g(d),c=w(d);d=k(d);return Math.sqrt(a*a+c*c+d*d)};b.empty=function(d){return d?x(d,t):C(t)};b.equals=function(d,a,c){if(l.isNone(d)||l.isNone(a))return d===a;if(!y(d)||
!y(a))return!1;if(c)for(let r=0;r<d.length;r++){if(!c(d[r],a[r]))return!1}else for(c=0;c<d.length;c++)if(d[c]!==a[c])return!1;return!0};b.expandWithAABB=function(d,a){d[0]=Math.min(d[0],a[0]);d[1]=Math.min(d[1],a[1]);d[2]=Math.min(d[2],a[2]);d[3]=Math.max(d[3],a[3]);d[4]=Math.max(d[4],a[4]);d[5]=Math.max(d[5],a[5])};b.expandWithBuffer=function(d,a,c=0,r=a.length/3){let e=d[0],h=d[1],v=d[2],E=d[3],n=d[4],B=d[5];for(let f=0;f<r;f++)e=Math.min(e,a[c+3*f]),h=Math.min(h,a[c+3*f+1]),v=Math.min(v,a[c+3*
f+2]),E=Math.max(E,a[c+3*f]),n=Math.max(n,a[c+3*f+1]),B=Math.max(B,a[c+3*f+2]);d[0]=e;d[1]=h;d[2]=v;d[3]=E;d[4]=n;d[5]=B};b.expandWithNestedArray=function(d,a,c){const r=a.length;let e=d[0],h=d[1],v=d[2],E=d[3],n=d[4],B=d[5];if(c)for(c=0;c<r;c++){var f=a[c];e=Math.min(e,f[0]);h=Math.min(h,f[1]);v=Math.min(v,f[2]);E=Math.max(E,f[0]);n=Math.max(n,f[1]);B=Math.max(B,f[2])}else for(c=0;c<r;c++)f=a[c],e=Math.min(e,f[0]),h=Math.min(h,f[1]),E=Math.max(E,f[0]),n=Math.max(n,f[1]);d[0]=e;d[1]=h;d[2]=v;d[3]=
E;d[4]=n;d[5]=B};b.expandWithOffset=function(d,a,c,r){d[0]=Math.min(d[0],d[0]+a);d[3]=Math.max(d[3],d[3]+a);d[1]=Math.min(d[1],d[1]+c);d[4]=Math.max(d[4],d[4]+c);d[2]=Math.min(d[2],d[2]+r);d[5]=Math.max(d[5],d[5]+r)};b.expandWithRect=function(d,a){d[0]=Math.min(d[0],a[0]);d[1]=Math.min(d[1],a[1]);d[3]=Math.max(d[3],a[2]);d[4]=Math.max(d[4],a[3])};b.expandWithVec3=function(d,a){d[0]=Math.min(d[0],a[0]);d[1]=Math.min(d[1],a[1]);d[2]=Math.min(d[2],a[2]);d[3]=Math.max(d[3],a[0]);d[4]=Math.max(d[4],a[1]);
d[5]=Math.max(d[5],a[2])};b.fromExtent=function(d,a=C()){a[0]=d.xmin;a[1]=d.ymin;a[2]=d.zmin;a[3]=d.xmax;a[4]=d.ymax;a[5]=d.zmax;return a};b.fromMinMax=function(d,a,c=C()){c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=a[0];c[4]=a[1];c[5]=a[2];return c};b.fromRect=function(d,a){d[0]=a[0];d[1]=a[1];d[2]=Number.NEGATIVE_INFINITY;d[3]=a[2];d[4]=a[3];d[5]=Number.POSITIVE_INFINITY;return d};b.fromValues=A;b.getMax=function(d,a){a[0]=d[3];a[1]=d[4];a[2]=d[5];return a};b.getMin=function(d,a){a[0]=d[0];a[1]=d[1];a[2]=
d[2];return a};b.height=w;b.intersects=u;b.intersectsClippingArea=function(d,a){return l.isNone(a)?!0:u(d,a)};b.is=y;b.isPoint=function(d){return 0===g(d)&&0===k(d)&&0===w(d)};b.maximumDimension=function(d){return Math.max(g(d),w(d),k(d))};b.offset=function(d,a,c,r,e=d){e[0]=d[0]+a;e[1]=d[1]+c;e[2]=d[2]+r;e[3]=d[3]+a;e[4]=d[4]+c;e[5]=d[5]+r;return e};b.scale=function(d,a,c=d){const r=d[0]+g(d)/2,e=d[1]+k(d)/2,h=d[2]+w(d)/2;c[0]=r+(d[0]-r)*a;c[1]=e+(d[1]-e)*a;c[2]=h+(d[2]-h)*a;c[3]=r+(d[3]-r)*a;c[4]=
e+(d[4]-e)*a;c[5]=h+(d[5]-h)*a;return c};b.set=x;b.setMax=function(d,a,c=d){c[3]=a[0];c[4]=a[1];c[5]=a[2];c!==d&&(c[0]=d[0],c[1]=d[1],c[2]=d[2]);return d};b.setMin=function(d,a,c=d){c[0]=a[0];c[1]=a[1];c[2]=a[2];c!==d&&(c[3]=d[3],c[4]=d[4],c[5]=d[5]);return c};b.size=function(d,a=[0,0,0]){a[0]=g(d);a[1]=k(d);a[2]=w(d);return a};b.toExtent=function(d,a){return isFinite(d[2])||isFinite(d[5])?new m({xmin:d[0],xmax:d[3],ymin:d[1],ymax:d[4],zmin:d[2],zmax:d[5],spatialReference:a}):new m({xmin:d[0],xmax:d[3],
ymin:d[1],ymax:d[4],spatialReference:a})};b.toRect=function(d,a){a||(a=z.create());a[0]=d[0];a[1]=d[1];a[2]=d[3];a[3]=d[4];return a};b.width=g;b.wrap=function(d,a,c,r,e,h){return A(d,a,c,r,e,h,q)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/maybe","../Extent"],function(b,l,m,z){function C(p=t){return[p[0],p[1],p[2],p[3]]}function A(p){return p[0]>=p[2]?0:p[2]-p[0]}function g(p){return p[1]>=p[3]?
0:p[3]-p[1]}function k(p,q,d){return q>=p[0]&&d>=p[1]&&q<=p[2]&&d<=p[3]}function w(p,q){p[0]=q[0];p[1]=q[1];p[2]=q[2];p[3]=q[3];return p}function u(p){return 4===p.length}function x(p,q,d){return p<q?q:p>d?d:p}const y=[Infinity,Infinity,-Infinity,-Infinity],t=[0,0,0,0];b.NEGATIVE_INFINITY=y;b.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];b.UNIT=[0,0,1,1];b.ZERO=t;b.allFinite=function(p){for(let q=0;4>q;q++)if(!isFinite(p[q]))return!1;return!0};b.area=function(p){return A(p)*g(p)};b.center=
function(p,q=[0,0]){q[0]=(p[0]+p[2])/2;q[1]=(p[1]+p[3])/2;return q};b.clone=function(p){return[p[0],p[1],p[2],p[3]]};b.contains=function(p,q){return q[0]>=p[0]&&q[2]<=p[2]&&q[1]>=p[1]&&q[3]<=p[3]};b.containsPoint=function(p,q){return k(p,q[0],q[1])};b.containsPointObject=function(p,q){return k(p,q.x,q.y)};b.containsPointWithMargin=function(p,q,d){return q[0]>=p[0]-d&&q[1]>=p[1]-d&&q[0]<=p[2]+d&&q[1]<=p[3]+d};b.containsXY=k;b.create=C;b.diameter=function(p){const q=A(p);p=g(p);return Math.sqrt(q*q+
p*p)};b.distance=function(p,q){const d=(p[1]+p[3])/2,a=Math.max(Math.abs(q[0]-(p[0]+p[2])/2)-A(p)/2,0);p=Math.max(Math.abs(q[1]-d)-g(p)/2,0);return Math.sqrt(a*a+p*p)};b.empty=function(p){return p?w(p,y):C(y)};b.equals=function(p,q,d){if(m.isNone(p)||m.isNone(q))return p===q;if(!u(p)||!u(q))return!1;if(d)for(let a=0;a<p.length;a++){if(!d(p[a],q[a]))return!1}else for(d=0;d<p.length;d++)if(p[d]!==q[d])return!1;return!0};b.expand=function(p,q,d=p){if("length"in q)if(u(q))d[0]=Math.min(p[0],q[0]),d[1]=
Math.min(p[1],q[1]),d[2]=Math.max(p[2],q[2]),d[3]=Math.max(p[3],q[3]);else{if(2===q.length||3===q.length)d[0]=Math.min(p[0],q[0]),d[1]=Math.min(p[1],q[1]),d[2]=Math.max(p[2],q[0]),d[3]=Math.max(p[3],q[1])}else switch(q.type){case "extent":d[0]=Math.min(p[0],q.xmin);d[1]=Math.min(p[1],q.ymin);d[2]=Math.max(p[2],q.xmax);d[3]=Math.max(p[3],q.ymax);break;case "point":d[0]=Math.min(p[0],q.x),d[1]=Math.min(p[1],q.y),d[2]=Math.max(p[2],q.x),d[3]=Math.max(p[3],q.y)}return d};b.expandPointInPlace=function(p,
q){q[0]<p[0]&&(p[0]=q[0]);q[0]>p[2]&&(p[2]=q[0]);q[1]<p[1]&&(p[1]=q[1]);q[1]>p[3]&&(p[3]=q[1])};b.expandWithNestedArray=function(p,q,d=p){const a=q.length;let c=p[0],r=p[1],e=p[2];p=p[3];for(let h=0;h<a;h++){const v=q[h];c=Math.min(c,v[0]);r=Math.min(r,v[1]);e=Math.max(e,v[0]);p=Math.max(p,v[1])}d[0]=c;d[1]=r;d[2]=e;d[3]=p;return d};b.fromExtent=function(p,q=C()){q[0]=p.xmin;q[1]=p.ymin;q[2]=p.xmax;q[3]=p.ymax;return q};b.fromValues=function(p,q,d,a,c=C()){c[0]=p;c[1]=q;c[2]=d;c[3]=a;return c};b.height=
g;b.intersection=function(p,q,d=p){const a=q[0],c=q[1],r=q[2];q=q[3];d[0]=x(p[0],a,r);d[1]=x(p[1],c,q);d[2]=x(p[2],a,r);d[3]=x(p[3],c,q);return d};b.intersects=function(p,q){return Math.max(q[0],p[0])<=Math.min(q[2],p[2])&&Math.max(q[1],p[1])<=Math.min(q[3],p[3])};b.is=u;b.isPoint=function(p){return(0===A(p)||!isFinite(p[0]))&&(0===g(p)||!isFinite(p[1]))};b.offset=function(p,q,d,a=p){a[0]=p[0]+q;a[1]=p[1]+d;a[2]=p[2]+q;a[3]=p[3]+d;return a};b.pad=function(p,q,d=p){d[0]=p[0]-q;d[1]=p[1]-q;d[2]=p[2]+
q;d[3]=p[3]+q;return d};b.set=w;b.setMax=function(p,q,d=p){d[2]=q[0];d[3]=q[1];d!==p&&(d[0]=p[0],d[1]=p[1]);return p};b.setMin=function(p,q,d=p){d[0]=q[0];d[1]=q[1];d!==p&&(d[2]=p[2],d[3]=p[3]);return d};b.size=function(p,q){q[0]=p[2]-p[0];q[1]=p[3]-p[1]};b.toExtent=function(p,q){return new z({xmin:p[0],ymin:p[1],xmax:p[2],ymax:p[3],spatialReference:q})};b.width=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],
function(b,l){function m({scale:f,translate:D},H){return Math.round((H-D[0])/f[0])}function z({scale:f,translate:D},H){return Math.round((D[1]-H)/f[1])}function C(f,D,H){const P=[];let R,K,J,Q;for(let F=0;F<H.length;F++){const O=H[F];if(0<F){if(J=m(f,O[0]),Q=z(f,O[1]),J!==R||Q!==K)P.push(D(O,J-R,Q-K)),R=J,K=Q}else R=m(f,O[0]),K=z(f,O[1]),P.push(D(O,R,K))}return 0<P.length?P:null}function A(f,D,H,P){return C(f,H?P?B:n:P?n:E,D)}function g(f,D,H,P){const R=[];H=H?P?B:n:P?n:E;for(P=0;P<D.length;P++){const K=
C(f,H,D[P]);K&&3<=K.length&&R.push(K)}return R.length?R:null}function k(f,D,H,P){const R=[];H=H?P?B:n:P?n:E;for(P=0;P<D.length;P++){const K=C(f,H,D[P]);K&&2<=K.length&&R.push(K)}return R.length?R:null}function w({scale:f,translate:D},H){return H*f[0]+D[0]}function u({scale:f,translate:D},H){return D[1]-H*f[1]}function x(f,D,H){const P=Array(H.length);if(!H.length)return P;const [R,K]=f.scale;let J=w(f,H[0][0]);f=u(f,H[0][1]);P[0]=D(H[0],J,f);for(let Q=1;Q<H.length;Q++){const F=H[Q];J+=F[0]*R;f-=F[1]*
K;P[Q]=D(F,J,f)}return P}function y(f,D,H){const P=Array(H.length);for(let R=0;R<H.length;R++)P[R]=x(f,D,H[R]);return P}function t(f,D,H,P){return x(f,H?P?B:n:P?n:E,D)}function p(f,D,H,P){return y(f,H?P?B:n:P?n:E,D)}function q(f,D,H,P){return y(f,H?P?B:n:P?n:E,D)}function d(f,D,H){let [P,R]=H[0],K=Math.min(P,D[0]),J=Math.min(R,D[1]),Q=Math.max(P,D[2]);D=Math.max(R,D[3]);for(let F=1;F<H.length;F++){const [O,V]=H[F];P+=O;R+=V;0>O&&(K=Math.min(K,P));0<O&&(Q=Math.max(Q,P));0>V?J=Math.min(J,R):0<V&&(D=
Math.max(D,R))}f[0]=K;f[1]=J;f[2]=Q;f[3]=D;return f}function a(f,D){if(!D.length)return null;f[0]=f[1]=Number.POSITIVE_INFINITY;f[2]=f[3]=Number.NEGATIVE_INFINITY;for(let H=0;H<D.length;H++)d(f,f,D[H]);return f}function c(f,D,H,P,R){D.xmin=m(f,H.xmin);D.ymin=z(f,H.ymin);D.xmax=m(f,H.xmax);D.ymax=z(f,H.ymax);D!==H&&(P&&(D.zmin=H.zmin,D.zmax=H.zmax),R&&(D.mmin=H.mmin,D.mmax=H.mmax));return D}function r(f,D,H,P,R){D.points=A(f,H.points,P,R);return D}function e(f,D,H,P,R){D.x=m(f,H.x);D.y=z(f,H.y);D!==
H&&(P&&(D.z=H.z),R&&(D.m=H.m));return D}function h(f,D,H,P,R){f=g(f,H.rings,P,R);if(!f)return null;D.rings=f;return D}function v(f,D,H,P,R){f=k(f,H.paths,P,R);if(!f)return null;D.paths=f;return D}const E=(f,D,H)=>[D,H],n=(f,D,H)=>[D,H,f[2]],B=(f,D,H)=>[D,H,f[2],f[3]];b.equals=function(f,D){if(f===D||null==f&&null==D)return!0;if(null==f||null==D)return!1;let H,P,R,K;f&&"upperLeft"===f.originPosition?(H=f.translate[0],P=f.translate[1],f=f.scale[0]):(H=f.extent.xmin,P=f.extent.ymax,f=f.tolerance);D&&
"upperLeft"===D.originPosition?(R=D.translate[0],K=D.translate[1],D=D.scale[0]):(R=D.extent.xmin,K=D.extent.ymax,D=D.tolerance);return H===R&&P===K&&f===D};b.getQuantizedBoundsCoordsArray=d;b.getQuantizedBoundsCoordsArrayArray=a;b.getQuantizedBoundsPaths=function(f){return a([0,0,0,0],f)};b.getQuantizedBoundsPoints=function(f){const D=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return d(D,D,f)};b.getQuantizedBoundsRings=function(f){return a([0,
0,0,0],f)};b.quantizeBounds=function(f,D,H){D[0]=m(f,H[0]);D[3]=z(f,H[1]);D[2]=m(f,H[2]);D[1]=z(f,H[3]);return D};b.quantizeExtent=c;b.quantizeGeometry=function(f,D){return f&&D?l.isPoint(D)?e(f,{},D,!1,!1):l.isPolyline(D)?v(f,{},D,!1,!1):l.isPolygon(D)?h(f,{},D,!1,!1):l.isMultipoint(D)?r(f,{},D,!1,!1):l.isExtent(D)?c(f,{},D,!1,!1):null:null};b.quantizeMultipoint=r;b.quantizePaths=k;b.quantizePoint=e;b.quantizePoints=A;b.quantizePolygon=h;b.quantizePolyline=v;b.quantizeRings=g;b.quantizeX=m;b.quantizeY=
z;b.toQuantizationTransform=function(f){return f?{originPosition:"upper-left"===f.originPosition?"upperLeft":"lower-left"===f.originPosition?"lowerLeft":f.originPosition,scale:f.tolerance?[f.tolerance,f.tolerance]:[1,1],translate:f.extent?[f.extent.xmin,f.extent.ymax]:[0,0]}:null};b.unquantizeBounds=function(f,D,H){return H?(D[0]=w(f,H[0]),D[1]=u(f,H[3]),D[2]=w(f,H[2]),D[3]=u(f,H[1]),D):[w(f,D[0]),u(f,D[3]),w(f,D[2]),u(f,D[1])]};b.unquantizeCoordsArray=x;b.unquantizeCoordsArrayArray=y;b.unquantizeExtent=
function(f,D,H,P,R){D.xmin=w(f,H.xmin);D.ymin=u(f,H.ymin);D.xmax=w(f,H.xmax);D.ymax=u(f,H.ymax);D!==H&&(P&&(D.zmin=H.zmin,D.zmax=H.zmax),R&&(D.mmin=H.mmin,D.mmax=H.mmax));return D};b.unquantizeMultipoint=function(f,D,H,P,R){D.points=t(f,H.points,P,R);return D};b.unquantizePaths=p;b.unquantizePoint=function(f,D,H,P,R){D.x=w(f,H.x);D.y=u(f,H.y);D!==H&&(P&&(D.z=H.z),R&&(D.m=H.m));return D};b.unquantizePoints=t;b.unquantizePolygon=function(f,D,H,P,R){D.rings=q(f,H.rings,P,R);return D};b.unquantizePolyline=
function(f,D,H,P,R){D.paths=p(f,H.paths,P,R);return D};b.unquantizeRings=q;b.unquantizeX=w;b.unquantizeY=u;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../core/maybe"],function(b,l,m){function z(u,x){if(u===x)return!0;if(null==u||null==x||u.length!==x.length)return!1;for(let y=0;y<u.length;y++){const t=u[y],p=x[y];if(t.length!==p.length)return!1;for(let q=0;q<t.length;q++)if(t[q]!==p[q])return!1}return!0}
function C(u,x){if(u===x)return!0;if(null==u||null==x||u.length!==x.length)return!1;for(let y=0;y<u.length;y++)if(!z(u[y],x[y]))return!1;return!0}function A(u,x){return g(u.spatialReference,x.spatialReference)?u.x===x.x&&u.y===x.y&&u.z===x.z&&u.m===x.m:!1}function g(u,x){return u===x||u&&x&&u.equals(x)}function k(u,x){if(u===x)return!0;if(m.isNone(u)||m.isNone(x)||u.type!==x.type)return!1;switch(u.type){case "point":return A(u,x);case "extent":return u=u.hasZ!==x.hasZ||u.hasM!==x.hasM?!1:g(u.spatialReference,
x.spatialReference)?u.xmin===x.xmin&&u.ymin===x.ymin&&u.zmin===x.zmin&&u.xmax===x.xmax&&u.ymax===x.ymax&&u.zmax===x.zmax:!1,u;case "polyline":return u=u.hasZ!==x.hasZ||u.hasM!==x.hasM?!1:g(u.spatialReference,x.spatialReference)?C(u.paths,x.paths):!1,u;case "polygon":return u=u.hasZ!==x.hasZ||u.hasM!==x.hasM?!1:g(u.spatialReference,x.spatialReference)?C(u.rings,x.rings):!1,u;case "multipoint":return u=u.hasZ!==x.hasZ||u.hasM!==x.hasM?!1:g(u.spatialReference,x.spatialReference)?z(u.points,x.points):
!1,u;case "mesh":return!1}}function w(u,x){if(u===x)return!0;if(!u||!x)return!1;const y=Object.keys(u),t=Object.keys(x);if(y.length!==t.length)return!1;for(const p of y)if(u[p]!==x[p])return!1;return!0}b.equals=function(u,x){return u===x?!0:null!=u&&null!=x&&u.objectId===x.objectId&&k(u.geometry,x.geometry)&&w(u.attributes,x.attributes)?!0:!1};b.pointEquals=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/2d/interactive/SnappingVisualizer2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../Graphic ../../../symbols ../../../core/handleUtils ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../draw/support/settings ../../interactive/snapping/Settings ../../interactive/snapping/SnappingVisualizer ../../../geometry/Point ../../../geometry/Polyline ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/CIMSymbol".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){m=function(H){function P(K){var J=H.call(this)||this;J.graphicsLayer=K;return J}l._inheritsLoose(P,H);var R=P.prototype;R.visualizeIntersectionPoint=function(K,J){return this._visualizeSnappingIndicator(new p({x:K.intersectionPoint[0],y:K.intersectionPoint[1],spatialReference:J.coordinateHelper.spatialReference}),h)};R.visualizePoint=function(K,J){return this._visualizeSnappingIndicator(new p({x:K.point[0],y:K.point[1],spatialReference:J.coordinateHelper.spatialReference}),
v)};R.visualizeLine=function(K,J){return this._visualizeSnappingIndicator(new q({paths:[[K.lineStart,K.lineEnd]],spatialReference:J.coordinateHelper.spatialReference}),E)};R.visualizeParallelSign=function(K,J){return this._visualizeSnappingIndicator(new q({paths:[[K.lineStart,K.lineEnd]],spatialReference:J.coordinateHelper.spatialReference}),n)};R.visualizeRightAngleQuad=function(K,J){return this._visualizeSnappingIndicator(new q({paths:[[K.previousVertex,K.centerVertex,K.nextVertex]],spatialReference:J.coordinateHelper.spatialReference}),
D(K))};R._visualizeSnappingIndicator=function(K,J){const Q=new z({geometry:K,symbol:J});this.graphicsLayer.add(Q);return A.makeHandle(()=>{this.graphicsLayer.remove(Q)})};return P}(t.SnappingVisualizer);const r=x.colors.main.toArray(),e=[...x.colors.main.toRgb(),100],h=new d({outline:new a({width:1.5,color:r}),size:15,color:[0,0,0,0]}),v=new d({outline:{width:.5,color:[0,0,0,1]},size:10,color:r}),E=new c({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",
enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:g.px2pt(y.defaults.lineHintWidthTarget),color:r}]}}}),n=new c({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,
0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:r}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},
symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:r}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});x=H=>new c({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:g.px2pt(y.defaults.rightAngleHintSize),rotation:H,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,
xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:g.px2pt(y.defaults.rightAngleHintOutlineSize),color:r},{type:"CIMSolidFill",enable:!0,color:e}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});const B=x(45),f=x(225),D=(()=>{const H=w.create(),P=w.create(),R=u.create();return K=>{k.subtract(H,K.centerVertex,
K.previousVertex);k.subtract(P,K.nextVertex,K.previousVertex);k.cross(R,H,P);return 0>R[2]?B:f}})();b.SnappingVisualizer2D=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(b,l){function m(M,T){M[0]=T[0];M[1]=T[1];return M}function z(M,T,S){M[0]=T;M[1]=S;return M}function C(M,T,S){M[0]=T[0]+S[0];M[1]=T[1]+S[1];return M}function A(M,T,S){M[0]=T[0]-S[0];M[1]=T[1]-S[1];return M}function g(M,T,S){M[0]=T[0]*S[0];M[1]=T[1]*S[1];return M}
function k(M,T,S){M[0]=T[0]/S[0];M[1]=T[1]/S[1];return M}function w(M,T){M[0]=Math.ceil(T[0]);M[1]=Math.ceil(T[1]);return M}function u(M,T){M[0]=Math.floor(T[0]);M[1]=Math.floor(T[1]);return M}function x(M,T,S){M[0]=Math.min(T[0],S[0]);M[1]=Math.min(T[1],S[1]);return M}function y(M,T,S){M[0]=Math.max(T[0],S[0]);M[1]=Math.max(T[1],S[1]);return M}function t(M,T){M[0]=Math.round(T[0]);M[1]=Math.round(T[1]);return M}function p(M,T,S){M[0]=T[0]*S;M[1]=T[1]*S;return M}function q(M,T,S,L){M[0]=T[0]+S[0]*
L;M[1]=T[1]+S[1]*L;return M}function d(M,T){const S=T[0]-M[0];M=T[1]-M[1];return Math.sqrt(S*S+M*M)}function a(M,T){const S=T[0]-M[0];M=T[1]-M[1];return S*S+M*M}function c(M){const T=M[0];M=M[1];return Math.sqrt(T*T+M*M)}function r(M){const T=M[0];M=M[1];return T*T+M*M}function e(M,T){M[0]=-T[0];M[1]=-T[1];return M}function h(M,T){M[0]=1/T[0];M[1]=1/T[1];return M}function v(M,T){var S=T[0];const L=T[1];S=S*S+L*L;0<S&&(S=1/Math.sqrt(S),M[0]=T[0]*S,M[1]=T[1]*S);return M}function E(M,T){return M[0]*
T[0]+M[1]*T[1]}function n(M,T,S){T=T[0]*S[1]-T[1]*S[0];M[0]=M[1]=0;M[2]=T;return M}function B(M,T,S,L){const N=T[0];T=T[1];M[0]=N+L*(S[0]-N);M[1]=T+L*(S[1]-T);return M}function f(M,T){T=T||1;const S=2*l.RANDOM()*Math.PI;M[0]=Math.cos(S)*T;M[1]=Math.sin(S)*T;return M}function D(M,T,S){const L=T[0];T=T[1];M[0]=S[0]*L+S[2]*T;M[1]=S[1]*L+S[3]*T;return M}function H(M,T,S){const L=T[0];T=T[1];M[0]=S[0]*L+S[2]*T+S[4];M[1]=S[1]*L+S[3]*T+S[5];return M}function P(M,T,S){const L=T[0];T=T[1];M[0]=S[0]*L+S[3]*
T+S[6];M[1]=S[1]*L+S[4]*T+S[7];return M}function R(M,T,S){const L=T[0];T=T[1];M[0]=S[0]*L+S[4]*T+S[12];M[1]=S[1]*L+S[5]*T+S[13];return M}function K(M,T,S,L){const N=T[0]-S[0];T=T[1]-S[1];const U=Math.sin(L);L=Math.cos(L);M[0]=N*L-T*U+S[0];M[1]=N*U+T*L+S[1];return M}function J(M,T){var S=M[0];M=M[1];const L=T[0];T=T[1];let N=S*S+M*M;0<N&&(N=1/Math.sqrt(N));let U=L*L+T*T;0<U&&(U=1/Math.sqrt(U));S=(S*L+M*T)*N*U;return 1<S?0:-1>S?Math.PI:Math.acos(S)}function Q(M){return"vec2("+M[0]+", "+M[1]+")"}function F(M,
T){return M[0]===T[0]&&M[1]===T[1]}function O(M,T){const S=M[0];M=M[1];const L=T[0];T=T[1];return Math.abs(S-L)<=l.EPSILON*Math.max(1,Math.abs(S),Math.abs(L))&&Math.abs(M-T)<=l.EPSILON*Math.max(1,Math.abs(M),Math.abs(T))}var V=Object.freeze({__proto__:null,copy:m,set:z,add:C,subtract:A,multiply:g,divide:k,ceil:w,floor:u,min:x,max:y,round:t,scale:p,scaleAndAdd:q,distance:d,squaredDistance:a,length:c,squaredLength:r,negate:e,inverse:h,normalize:v,dot:E,cross:n,lerp:B,random:f,transformMat2:D,transformMat2d:H,
transformMat3:P,transformMat4:R,rotate:K,angle:J,str:Q,exactEquals:F,equals:O,len:c,sub:A,mul:g,div:k,dist:d,sqrDist:a,sqrLen:r});b.add=C;b.angle=J;b.ceil=w;b.copy=m;b.cross=n;b.dist=d;b.distance=d;b.div=k;b.divide=k;b.dot=E;b.equals=O;b.exactEquals=F;b.floor=u;b.inverse=h;b.len=c;b.length=c;b.lerp=B;b.max=y;b.min=x;b.mul=g;b.multiply=g;b.negate=e;b.normalize=v;b.random=f;b.rotate=K;b.round=t;b.scale=p;b.scaleAndAdd=q;b.set=z;b.sqrDist=a;b.sqrLen=r;b.squaredDistance=a;b.squaredLength=r;b.str=Q;b.sub=
A;b.subtract=A;b.transformMat2=D;b.transformMat2d=H;b.transformMat3=P;b.transformMat4=R;b.vec2=V})},"esri/chunks/vec2f64":function(){define(["exports"],function(b){function l(){return[0,0]}function m(d){return[d[0],d[1]]}function z(d,a){return[d,a]}function C(d){const a=[0,0],c=Math.min(2,d.length);for(let r=0;r<c;++r)a[r]=d[r];return a}function A(d,a){return new Float64Array(d,a,2)}function g(){return[0,0]}function k(){return[1,1]}function w(){return[1,0]}function u(){return[0,1]}const x=[0,0],y=
[1,1],t=[1,0],p=[0,1];var q=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,fromArray:C,createView:A,zeros:g,ones:k,unitX:w,unitY:u,ZEROS:x,ONES:y,UNIT_X:t,UNIT_Y:p});b.ONES=y;b.UNIT_X=t;b.UNIT_Y=p;b.ZEROS=x;b.clone=m;b.create=l;b.createView=A;b.fromArray=C;b.fromValues=z;b.ones=k;b.unitX=w;b.unitY=u;b.vec2f64=q;b.zeros=g})},"esri/views/draw/support/settings":function(){define(["exports","../../../Color"],function(b,l){function m(u,x){if(x)for(const y in x)u[y]=x[y]}const z={main:new l([255,
127,0]),selected:new l([255,255,255]),outline:new l([0,0,0,.5]),selectedOutline:new l([255,255,255]),hoverOutline:new l([255,255,255]),secondary:new l([255,255,255]),secondaryOutline:new l([100,100,100]),transparent:new l([0,0,0,0])};let C=function(u){this.size=8;this.hoverSize=10;this.hoverColor=this.color=z.main;this.outlineColor=z.outline;this.hoverOutlineColor=z.hoverOutline;m(this,u)},A=function(u){this.color=z.secondary;this.hoverColor=z.main;m(this,u)},g=function(u){this.hoverColor=this.color=
z.transparent;this.hoverOutlineColor=this.outlineColor=z.main;this.stagedColor=z.transparent;this.stagedOutlineColor=z.secondary;m(this,u)},k=function(u){this.vertex=new C;this.midpoint=new C({color:z.secondary,outlineColor:z.secondaryOutline,size:6});this.selected=new C({color:z.selected,hoverColor:z.selected,hoverOutlineColor:z.hoverOutline});m(this,u)},w=function(u){this.center=new C({color:z.secondaryOutline});this.fill=new g;this.line=new A;this.vertex=new C({color:z.selected,outlineColor:z.main,
hoverColor:z.selected,hoverOutlineColor:z.secondaryOutline});m(this,u)};l=new function(u){this.reshapeGraphics=new k;this.transformGraphics=new w;m(this,u)};b.colors=z;b.settings=l;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingVisualizer":function(){define("exports ../../../core/handleUtils ./hints/IntersectionSnappingHint ./hints/LineSnappingHint ./hints/ParallelSnappingHint ./hints/PointSnappingHint ./hints/RightAngleSnappingHint".split(" "),function(b,
l,m,z,C,A,g){let k=function(){function w(){}var u=w.prototype;u.draw=function(x,y){x=this.getUniqueHints(x);const t=[];for(const p of x)p instanceof m.IntersectionSnappingHint&&t.push(this.visualizeIntersectionPoint(p,y)),p instanceof z.LineSnappingHint&&t.push(this.visualizeLine(p,y)),p instanceof C.ParallelSnappingHint&&t.push(this.visualizeParallelSign(p,y)),p instanceof g.RightAngleSnappingHint&&t.push(this.visualizeRightAngleQuad(p,y)),p instanceof A.PointSnappingHint&&t.push(this.visualizePoint(p,
y));return l.handlesGroup(t)};u.getUniqueHints=function(x){const y=[];for(const t of x){x=!0;for(const p of y)if(t.equals(p)){x=!1;break}x&&y.push(t)}return y};return w}();b.SnappingVisualizer=k;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../snappingUtils","./SnappingHint"],function(b,l,m,z){z=function(C){function A(g){var k=C.call(this)||this;k.intersectionPoint=
g;return k}l._inheritsLoose(A,C);A.prototype.equals=function(g){return g instanceof A?m.objectEqual(this.intersectionPoint,g.intersectionPoint):!1};return A}(z.SnappingHint);b.IntersectionSnappingHint=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3f64 ../../../geometry/Point ../../../support/elevationInfoUtils".split(" "),function(b,l,m,z,C,A){function g(x,
y,t,p,q=z.create()){x=y.toXYZ(x);x[2]=A.getConvertedElevationFromVector(p,x,y.spatialReference,t)||0;p.renderCoordsHelper.toRenderCoords(x,y.spatialReference,q);return q}const k=z.create(),w=l.createScreenPointArray(),u=new C;b.anyMapPointToRender=g;b.anyMapPointToScreenPoint=function(x,y,t,p){if("2d"===p.type)return p.toScreen(y.toPoint(x,u));g(x,y,t,p,k);p.state.camera.projectToScreen(k,w);return l.createScreenPoint(w[0],w[1])};b.anyMapPointsToRenderWithEqualZ=function(x,y,t,p,q,d,a){x=t.toXYZ(x);
y=t.toXYZ(y);const c=A.getConvertedElevationFromVector(q,x,t.spatialReference,p);p=A.getConvertedElevationFromVector(q,y,t.spatialReference,p);p=(null==c?p:null==p?c:Math.min(c,p))||0;x[2]=p;y[2]=p;q.renderCoordsHelper.toRenderCoords(x,t.spatialReference,d);q.renderCoordsHelper.toRenderCoords(y,t.spatialReference,a)};b.objectEqual=function(x,y){const t=x.length===y.length&&x[0]===y[0]&&x[1]===y[1];switch(x.length){case 2:return t;case 3:return t&&x[2]===y[2];case 4:return t&&x[3]===y[3]}return!1};
b.sortCandidatesInPlace=function(x,y){y.sort((t,p)=>{t=m.squaredDistance(t.targetPoint,x);p=m.squaredDistance(p.targetPoint,x);return t-p})};b.squareDistance=function(x,y){const t=x.x-y.x;x=x.y-y.y;return t*t+x*x};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(b){b.SnappingHint=function(){};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),
function(b,l,m,z,C,A){z.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");m=function(g){function k(w,u,x,y=!0,t=!0){var p=g.call(this)||this;p.type=w;p.lineStart=u;p.lineEnd=x;p.fadeLeft=y;p.fadeRight=t;return p}l._inheritsLoose(k,g);k.prototype.equals=function(w){return w instanceof k?this.type===w.type&&C.objectEqual(this.lineStart,w.lineStart)&&C.objectEqual(this.lineEnd,w.lineEnd)&&this.fadeLeft===w.fadeLeft&&this.fadeRight===w.fadeRight:!1};return k}(A.SnappingHint);b.LineSnappingHint=
m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(b,l,m,z,C,A){z.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");m=function(g){function k(w,u){var x=g.call(this)||this;x.lineStart=w;x.lineEnd=u;return x}l._inheritsLoose(k,g);k.prototype.equals=
function(w){return w instanceof k?C.objectEqual(this.lineStart,w.lineStart)&&C.objectEqual(this.lineEnd,w.lineEnd):!1};return k}(A.SnappingHint);b.ParallelSnappingHint=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/PointSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../snappingUtils","./SnappingHint"],function(b,l,m,z){z=function(C){function A(g){var k=C.call(this)||this;k.point=g;return k}l._inheritsLoose(A,
C);A.prototype.equals=function(g){return g instanceof A?m.objectEqual(this.point,g.point):!1};return A}(z.SnappingHint);b.PointSnappingHint=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(b,l,m,z,C,A){z.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");
m=function(g){function k(w,u,x){var y=g.call(this)||this;y.previousVertex=w;y.centerVertex=u;y.nextVertex=x;return y}l._inheritsLoose(k,g);k.prototype.equals=function(w){return w instanceof k?C.objectEqual(this.previousVertex,w.previousVertex)&&C.objectEqual(this.centerVertex,w.centerVertex)&&C.objectEqual(this.nextVertex,w.nextVertex):!1};return k}(A.SnappingHint);b.RightAngleSnappingHint=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/vec4f64 ../../geometry/Point ../../geometry/support/spatialReferenceUtils".split(" "),
function(b,l,m,z,C,A,g,k,w){function u(d,a){if(a.supported){var c=Infinity,r=-Infinity,e=a.upperBoundX-a.lowerBoundX;d.forEach(v=>{let E=v.pos[0];for(;E<a.lowerBoundX;)E+=e;for(;E>a.upperBoundX;)E-=e;c=Math.min(c,E);r=Math.max(r,E);v.pos[0]=E});var h=r-c;e-h<h&&d.forEach(v=>{0>v.pos[0]&&(v.pos[0]+=e)})}}function x(d,a){d=w.getInfo(d);return"global"===a&&d?{supported:!0,lowerBoundX:d.valid[0],upperBoundX:d.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}const y=m.create();let t=function(){function d(c,
r){this.spatialReference=c;this.viewingMode=r;this._unnormalizationInfo=x(c,r)}var a=d.prototype;a.tag=function(c){return c};a.createNew=function(){return this.tag(m.create())};a.fromPoint=function(c){return this.tag(m.fromValues(c.x,c.y))};a.fromArray=function(c){return this.tag(m.fromValues(c[0],c[1]))};a.toArray=function(c){return[c[0],c[1]]};a.clone=function(c){return this.tag(m.fromArray(c))};a.copy=function(c,r){return l.copy(r,c)};a.toPoint=function(c,r){r.x=c[0];r.y=c[1];r.hasZ=!1;r.hasM=
!1;r.spatialReference=this.spatialReference;return r};a.createPoint=function(c){return new k({x:c[0],y:c[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};a.createPointFromArray=function(c){return new k({x:c[0],y:c[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};a.createDehydratedPoint=function(c){return{x:c[0],y:c[1],z:void 0,m:void 0,hasZ:!1,hasM:!1,spatialReference:this.spatialReference,type:"point"}};a.lerp=function(c,r,e,h){return l.lerp(h,c,r,e)};a.addDelta=function(c,
r,e){c[0]+=r;c[1]+=e};a.scale=function(c,r,e,h){r=l.subtract(y,c,r);e=l.scale(y,e,l.dot(e,r));l.scaleAndAdd(c,c,e,h-1)};a.rotate=function(c,r,e){l.rotate(c,c,r,e)};a.pointToArray=function(c){return[c.x,c.y]};a.getZ=function(c,r){return r};a.hasZ=function(){return!1};a.getM=function(c,r){return r};a.hasM=function(){return!1};a.unnormalize=function(c){u(c,this._unnormalizationInfo)};a.fromXYZ=function(c){return this.tag(m.fromValues(c[0],c[1]))};a.toXYZ=function(c,r=0){return C.fromValues(c[0],c[1],
r)};a.distance=function(c,r){return l.distance(c,r)};return d}(),p=function(){function d(c,r,e){this.valueType=c;this.spatialReference=r;this._unnormalizationInfo=x(r,e)}var a=d.prototype;a.distance=function(c,r){return 0===this.valueType?z.distance(c,r):l.distance(c,r)};a.tag=function(c){return c};a.createNew=function(){return this.tag(C.create())};a.fromPoint=function(c){return this.tag(C.fromValues(c.x,c.y,0===this.valueType?c.z:c.m))};a.fromArray=function(c){return this.tag(C.fromValues(c[0],
c[1],c[2]||0))};a.toArray=function(c){return[c[0],c[1],c[2]]};a.clone=function(c){return this.tag(C.fromArray(c))};a.copy=function(c,r){return z.copy(r,c)};a.toPoint=function(c,r){r.x=c[0];r.y=c[1];0===this.valueType?(r.z=c[2],r.hasZ=!0,r.hasM=!1):(r.m=c[2],r.hasZ=!1,r.hasM=!0);r.spatialReference=this.spatialReference;return r};a.createPoint=function(c){return new k({x:c[0],y:c[1],z:0===this.valueType?c[2]:void 0,m:1===this.valueType?c[2]:void 0,spatialReference:this.spatialReference})};a.createPointFromArray=
function(c){return new k({x:c[0],y:c[1],z:0===this.valueType?c[2]:void 0,m:1===this.valueType?c[2]:void 0,spatialReference:this.spatialReference})};a.createDehydratedPoint=function(c){const r=0===this.valueType,e=1===this.valueType;return{x:c[0],y:c[1],z:r?c[2]:void 0,m:e?c[2]:void 0,hasZ:r,hasM:e,spatialReference:this.spatialReference,type:"point"}};a.lerp=function(c,r,e,h){return z.lerp(h,c,r,e)};a.addDelta=function(c,r,e,h){c[0]+=r;c[1]+=e;0===this.valueType&&(c[2]+=h)};a.scale=function(c,r,e,
h){r=l.subtract(y,c,r);e=l.scale(y,e,l.dot(e,r));l.scaleAndAdd(c,c,e,h-1)};a.rotate=function(c,r,e){l.rotate(c,c,r,e)};a.pointToArray=function(c){return 0===this.valueType?[c.x,c.y,c.z]:[c.x,c.y,c.m]};a.getZ=function(c,r){return 0===this.valueType?c[2]:r};a.hasZ=function(){return 0===this.valueType};a.getM=function(c,r){return 1===this.valueType?c[2]:r};a.hasM=function(){return 1===this.valueType};a.unnormalize=function(c){u(c,this._unnormalizationInfo)};a.fromXYZ=function(c,r=0,e=0){return this.tag(C.fromValues(c[0],
c[1],0===this.valueType?2<c.length?c[2]:r:e))};a.toXYZ=function(c,r=0){return this.tag(C.fromValues(c[0],c[1],0===this.valueType?c[2]:r))};return d}(),q=function(){function d(c,r){this.spatialReference=c;this._unnormalizationInfo=x(c,r)}var a=d.prototype;a.distance=function(c,r){return z.distance(c,r)};a.tag=function(c){return c};a.createNew=function(){return this.tag(g.create())};a.fromPoint=function(c){return this.tag(g.fromValues(c.x,c.y,c.z,c.m))};a.fromArray=function(c){return this.tag(g.fromValues(c[0],
c[1],c[2]||0,c[3]||0))};a.toArray=function(c){return[c[0],c[1],c[2],c[3]]};a.clone=function(c){return this.tag(g.fromArray(c))};a.copy=function(c,r){return A.copy(r,c)};a.toPoint=function(c,r){r.x=c[0];r.y=c[1];r.z=c[2];r.m=c[3];r.hasZ=!0;r.hasM=!0;r.spatialReference=this.spatialReference;return r};a.createPoint=function(c){return new k({x:c[0],y:c[1],z:c[2],m:c[3],spatialReference:this.spatialReference})};a.createPointFromArray=function(c){return new k({x:c[0],y:c[1],z:c[2],m:c[3],spatialReference:this.spatialReference})};
a.createDehydratedPoint=function(c){return{x:c[0],y:c[1],z:c[2],m:c[3],hasZ:!0,hasM:!0,spatialReference:this.spatialReference,type:"point"}};a.lerp=function(c,r,e,h){return A.lerp(h,c,r,e)};a.addDelta=function(c,r,e,h){c[0]+=r;c[1]+=e;c[2]+=h};a.scale=function(c,r,e,h){r=l.subtract(y,c,r);e=l.scale(y,e,l.dot(e,r));l.scaleAndAdd(c,c,e,h-1)};a.rotate=function(c,r,e){l.rotate(c,c,r,e)};a.pointToArray=function(c){return[c.x,c.y,c.z,c.m]};a.getZ=function(c){return c[2]};a.hasZ=function(){return!0};a.getM=
function(c){return c[3]};a.hasM=function(){return!0};a.unnormalize=function(c){u(c,this._unnormalizationInfo)};a.fromXYZ=function(c,r=0,e=0){return this.tag(g.fromValues(c[0],c[1],2<c.length?c[2]:r,e))};a.toXYZ=function(c){return C.fromValues(c[0],c[1],c[2])};return d}();b.CoordinateHelper2D=t;b.CoordinateHelper3D=p;b.CoordinateHelper4D=q;b.createCoordinateHelper=function(d,a,c,r){return d&&a?new q(c,r):a?new p(1,c,r):d?new p(0,c,r):new t(c,r)};Object.defineProperty(b,"__esModule",{value:!0})})},
"esri/chunks/vec4":function(){define(["exports","./common"],function(b,l){function m(J,Q){J[0]=Q[0];J[1]=Q[1];J[2]=Q[2];J[3]=Q[3];return J}function z(J,Q,F,O,V){J[0]=Q;J[1]=F;J[2]=O;J[3]=V;return J}function C(J,Q,F){J[0]=Q[0]+F[0];J[1]=Q[1]+F[1];J[2]=Q[2]+F[2];J[3]=Q[3]+F[3];return J}function A(J,Q,F){J[0]=Q[0]-F[0];J[1]=Q[1]-F[1];J[2]=Q[2]-F[2];J[3]=Q[3]-F[3];return J}function g(J,Q,F){J[0]=Q[0]*F[0];J[1]=Q[1]*F[1];J[2]=Q[2]*F[2];J[3]=Q[3]*F[3];return J}function k(J,Q,F){J[0]=Q[0]/F[0];J[1]=Q[1]/
F[1];J[2]=Q[2]/F[2];J[3]=Q[3]/F[3];return J}function w(J,Q){J[0]=Math.ceil(Q[0]);J[1]=Math.ceil(Q[1]);J[2]=Math.ceil(Q[2]);J[3]=Math.ceil(Q[3]);return J}function u(J,Q){J[0]=Math.floor(Q[0]);J[1]=Math.floor(Q[1]);J[2]=Math.floor(Q[2]);J[3]=Math.floor(Q[3]);return J}function x(J,Q,F){J[0]=Math.min(Q[0],F[0]);J[1]=Math.min(Q[1],F[1]);J[2]=Math.min(Q[2],F[2]);J[3]=Math.min(Q[3],F[3]);return J}function y(J,Q,F){J[0]=Math.max(Q[0],F[0]);J[1]=Math.max(Q[1],F[1]);J[2]=Math.max(Q[2],F[2]);J[3]=Math.max(Q[3],
F[3]);return J}function t(J,Q){J[0]=Math.round(Q[0]);J[1]=Math.round(Q[1]);J[2]=Math.round(Q[2]);J[3]=Math.round(Q[3]);return J}function p(J,Q,F){J[0]=Q[0]*F;J[1]=Q[1]*F;J[2]=Q[2]*F;J[3]=Q[3]*F;return J}function q(J,Q,F,O){J[0]=Q[0]+F[0]*O;J[1]=Q[1]+F[1]*O;J[2]=Q[2]+F[2]*O;J[3]=Q[3]+F[3]*O;return J}function d(J,Q){const F=Q[0]-J[0],O=Q[1]-J[1],V=Q[2]-J[2];J=Q[3]-J[3];return Math.sqrt(F*F+O*O+V*V+J*J)}function a(J,Q){const F=Q[0]-J[0],O=Q[1]-J[1],V=Q[2]-J[2];J=Q[3]-J[3];return F*F+O*O+V*V+J*J}function c(J){const Q=
J[0],F=J[1],O=J[2];J=J[3];return Math.sqrt(Q*Q+F*F+O*O+J*J)}function r(J){const Q=J[0],F=J[1],O=J[2];J=J[3];return Q*Q+F*F+O*O+J*J}function e(J,Q){J[0]=-Q[0];J[1]=-Q[1];J[2]=-Q[2];J[3]=-Q[3];return J}function h(J,Q){J[0]=1/Q[0];J[1]=1/Q[1];J[2]=1/Q[2];J[3]=1/Q[3];return J}function v(J,Q){const F=Q[0],O=Q[1],V=Q[2];Q=Q[3];let M=F*F+O*O+V*V+Q*Q;0<M&&(M=1/Math.sqrt(M),J[0]=F*M,J[1]=O*M,J[2]=V*M,J[3]=Q*M);return J}function E(J,Q){return J[0]*Q[0]+J[1]*Q[1]+J[2]*Q[2]+J[3]*Q[3]}function n(J,Q,F,O){const V=
Q[0],M=Q[1],T=Q[2];Q=Q[3];J[0]=V+O*(F[0]-V);J[1]=M+O*(F[1]-M);J[2]=T+O*(F[2]-T);J[3]=Q+O*(F[3]-Q);return J}function B(J,Q){Q=Q||1;let F,O,V,M;let T;do{F=2*l.RANDOM()-1;O=2*l.RANDOM()-1;var S=F*F+O*O}while(1<=S);do V=2*l.RANDOM()-1,M=2*l.RANDOM()-1,T=V*V+M*M;while(1<=T);S=Math.sqrt((1-S)/T);J[0]=Q*F;J[1]=Q*O;J[2]=Q*V*S;J[3]=Q*M*S;return J}function f(J,Q,F){const O=Q[0],V=Q[1],M=Q[2];Q=Q[3];J[0]=F[0]*O+F[4]*V+F[8]*M+F[12]*Q;J[1]=F[1]*O+F[5]*V+F[9]*M+F[13]*Q;J[2]=F[2]*O+F[6]*V+F[10]*M+F[14]*Q;J[3]=F[3]*
O+F[7]*V+F[11]*M+F[15]*Q;return J}function D(J,Q,F){var O=Q[0];const V=Q[1],M=Q[2],T=F[0],S=F[1],L=F[2];F=F[3];const N=F*O+S*M-L*V,U=F*V+L*O-T*M,fa=F*M+T*V-S*O;O=-T*O-S*V-L*M;J[0]=N*F+O*-T+U*-L-fa*-S;J[1]=U*F+O*-S+fa*-T-N*-L;J[2]=fa*F+O*-L+N*-S-U*-T;J[3]=Q[3];return J}function H(J){return"vec4("+J[0]+", "+J[1]+", "+J[2]+", "+J[3]+")"}function P(J,Q){return J[0]===Q[0]&&J[1]===Q[1]&&J[2]===Q[2]&&J[3]===Q[3]}function R(J,Q){const F=J[0],O=J[1],V=J[2];J=J[3];const M=Q[0],T=Q[1],S=Q[2];Q=Q[3];return Math.abs(F-
M)<=l.EPSILON*Math.max(1,Math.abs(F),Math.abs(M))&&Math.abs(O-T)<=l.EPSILON*Math.max(1,Math.abs(O),Math.abs(T))&&Math.abs(V-S)<=l.EPSILON*Math.max(1,Math.abs(V),Math.abs(S))&&Math.abs(J-Q)<=l.EPSILON*Math.max(1,Math.abs(J),Math.abs(Q))}var K=Object.freeze({__proto__:null,copy:m,set:z,add:C,subtract:A,multiply:g,divide:k,ceil:w,floor:u,min:x,max:y,round:t,scale:p,scaleAndAdd:q,distance:d,squaredDistance:a,length:c,squaredLength:r,negate:e,inverse:h,normalize:v,dot:E,lerp:n,random:B,transformMat4:f,
transformQuat:D,str:H,exactEquals:P,equals:R,sub:A,mul:g,div:k,dist:d,sqrDist:a,len:c,sqrLen:r});b.add=C;b.ceil=w;b.copy=m;b.dist=d;b.distance=d;b.div=k;b.divide=k;b.dot=E;b.equals=R;b.exactEquals=P;b.floor=u;b.inverse=h;b.len=c;b.length=c;b.lerp=n;b.max=y;b.min=x;b.mul=g;b.multiply=g;b.negate=e;b.normalize=v;b.random=B;b.round=t;b.scale=p;b.scaleAndAdd=q;b.set=z;b.sqrDist=a;b.sqrLen=r;b.squaredDistance=a;b.squaredLength=r;b.str=H;b.sub=A;b.subtract=A;b.transformMat4=f;b.transformQuat=D;b.vec4=K})},
"esri/chunks/vec4f64":function(){define(["exports"],function(b){function l(){return[0,0,0,0]}function m(e){return[e[0],e[1],e[2],e[3]]}function z(e,h,v,E){return[e,h,v,E]}function C(e){const h=l(),v=Math.min(4,e.length);for(let E=0;E<v;++E)h[E]=e[E];return h}function A(e,h){return new Float64Array(e,h,4)}function g(){return l()}function k(){return[1,1,1,1]}function w(){return[1,0,0,0]}function u(){return[0,1,0,0]}function x(){return[0,0,1,0]}function y(){return[0,0,0,1]}const t=l(),p=k(),q=w(),d=
u(),a=x(),c=y();var r=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,fromArray:C,createView:A,zeros:g,ones:k,unitX:w,unitY:u,unitZ:x,unitW:y,ZEROS:t,ONES:p,UNIT_X:q,UNIT_Y:d,UNIT_Z:a,UNIT_W:c});b.ONES=p;b.UNIT_W=c;b.UNIT_X=q;b.UNIT_Y=d;b.UNIT_Z=a;b.ZEROS=t;b.clone=m;b.create=l;b.createView=A;b.fromArray=C;b.fromValues=z;b.ones=k;b.unitW=y;b.unitX=w;b.unitY=u;b.unitZ=x;b.vec4f64=r;b.zeros=g})},"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Evented ../../../core/maybe ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper".split(" "),
function(b,l,m,z,C,A,g,k){let w=function(){function y(t){this.right=this.left=null;this.type="vertex";this.index=null;this.component=t}l._createClass(y,[{key:"pos",get:function(){return this._pos},set:function(t){this._pos=t;this.component.unnormalizeVertexPositions()}}]);return y}(),u=function(y,t,p){this.type="edge";this.component=y;this.left=t;this.right=p;t.right=this;p.left=this},x=function(){function y(p){this.vertices=[];this.edges=[];this.data=p}var t=y.prototype;t.unnormalizeVertexPositions=
function(){1>=this.vertices.length||this.data.coordinateHelper.unnormalize(this.vertices)};t.updateVertexIndex=function(p,q){if(0!==this.vertices.length){var d=this.vertices[0],a=null;do a=p,a.index=q++,p=a.right?a.right.right:null;while(null!=p&&p!==d);a.left&&a!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(a),this.vertices.length-1)}};t.getFirstVertex=function(){return 0===this.vertices.length?null:this.vertices[0]};t.getLastVertex=function(){return 0===this.vertices.length?
null:this.vertices[this.vertices.length-1]};t.isClosed=function(){return 2<this.vertices.length&&null!==this.vertices[0].left};t.swapVertices=function(p,q){const d=this.vertices[p];this.vertices[p]=this.vertices[q];this.vertices[q]=d};t.iterateVertices=function(p){if(0!==this.vertices.length){var q=this.vertices[0],d=q;do p(d,d.index),d=C.isSome(d.right)?d.right.right:null;while(d!==q&&null!=d)}};return y}();z=function(y){function t(q){var d=y.call(this)||this;d.coordinateHelper=q;d.undoStack=[];
d.redoStack=[];d.components=[];return d}l._inheritsLoose(t,y);var p=t.prototype;p.apply=function(q,d=1){if(0===d||C.isNone(this.lastOperation)||!this.lastOperation.accumulate(q))q.apply(),this.undoStack.push(q),this.redoStack=[];return q};p.undo=function(){if(0<this.undoStack.length){const q=this.undoStack.pop();q.undo();this.redoStack.push(q);return q}return null};p.redo=function(){if(0<this.redoStack.length){const q=this.redoStack.pop();q.apply();this.undoStack.push(q);return q}return null};p.toPoint=
function(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.createPoint(this.components[0].vertices[0].pos)};p.toPolyline=function(){const q=[],d=this.coordinateHelper.toArray;this.components.forEach((a,c)=>{c=[];const r=a=a.vertices.find(e=>null==e.left);do c.push(d(a.pos)),a=a.right?a.right.right:null;while(a&&a!==r);q.push(c)});return new g({paths:q,spatialReference:this.coordinateHelper.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})};
p.toPolygon=function(){const q=[],d=this.coordinateHelper.toArray;this.components.forEach((a,c)=>{c=[];const r=a.vertices[0];let e=r;const h=e;do c.push(d(e.pos)),e=C.isSome(e.right)?e.right.right:null;while(e&&e!==h);a.isClosed()&&c.push(d(r.pos));q.push(c)});return new A({rings:q,spatialReference:this.coordinateHelper.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})};t.fromGeometry=function(q,d){var a=k.createCoordinateHelper(q.hasZ,q.hasM,q.spatialReference,
d);d=new t(a);switch(q.type){case "polygon":var c=q.rings;for(q=0;q<c.length;++q){var r=c[q],e=new x(d),h=2<r.length&&m.equals(r[0],r[r.length-1]),v=h?r.length-1:r.length;for(var E=0;E<v;++E){const n=a.fromArray(r[E]),B=new w(e);e.vertices.push(B);B.pos=n;B.index=E}r=e.vertices.length-1;for(v=0;v<r;++v)E=new u(e,e.vertices[v],e.vertices[v+1]),e.edges.push(E);h&&(h=new u(e,e.vertices[e.vertices.length-1],e.vertices[0]),e.edges.push(h));d.components.push(e)}break;case "polyline":for(c of q.paths){q=
new x(d);e=c.length;for(h=0;h<e;++h)r=a.fromArray(c[h]),v=new w(q),q.vertices.push(v),v.pos=r,v.index=h;e=q.vertices.length-1;for(h=0;h<e;++h)r=new u(q,q.vertices[h],q.vertices[h+1]),q.edges.push(r);d.components.push(q)}break;case "point":a=new x(d),c=new w(a),c.index=0,c.pos=d.coordinateHelper.fromPoint(q),a.vertices.push(c),d.components.push(a)}return d};l._createClass(t,[{key:"canUndo",get:function(){return 0<this.undoStack.length}},{key:"lastOperation",get:function(){return 0<this.undoStack.length?
this.undoStack[this.undoStack.length-1]:null}},{key:"canRedo",get:function(){return 0<this.redoStack.length}}]);return t}(z);b.Component=x;b.Edge=u;b.EditGeometry=z;b.Vertex=w;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/EditGeometryHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ./EditGeometry ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/CloseComponent ./operations/MoveVertex ./operations/OffsetEdgeVertex ./operations/RotateVertex ./operations/ScaleVertex ./operations/UndoGroup".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q){m=function(d){function a(r,e){var h=d.call(this)||this;h.editGeometry=r;h.type=e;h._geometry=null;h._dirty=!0;h._listener=h.editGeometry.on("change",v=>{h._dirty=!0;v.addedVertices&&h.emit("vertex-add",{type:"vertex-add",vertices:v.addedVertices,operation:v.operation});v.removedVertices&&h.emit("vertex-remove",{type:"vertex-remove",vertices:v.removedVertices,operation:v.operation});v.updatedVertices&&h.emit("vertex-update",{type:"vertex-update",vertices:v.updatedVertices,
operation:v.operation})});return h}l._inheritsLoose(a,d);var c=a.prototype;c.destroy=function(){this._listener.remove()};c.splitEdge=function(r,e){return this.editGeometry.apply(new k.SplitEdge(this.editGeometry,r,e))};c.updateVertices=function(r,e,h=1){return this.editGeometry.apply(new A.UpdateVertices(this.editGeometry,r,e),h)};c.moveVertices=function(r,e,h,v,E=1){return this.updateVertices(r,new x.MoveVertex(this.editGeometry.coordinateHelper,e,h,v),E)};c.scaleVertices=function(r,e,h,v,E,n=1,
B=0){return this.updateVertices(r,new p.ScaleVertex(this.editGeometry.coordinateHelper,e,h,v,E,B),n)};c.rotateVertices=function(r,e,h,v=1,E=0){return this.updateVertices(r,new t.RotateVertex(this.editGeometry.coordinateHelper,e,h,E),v)};c.removeVertices=function(r){return this.editGeometry.apply(new g.RemoveVertices(this.editGeometry,r,this._minNumVerticesPerType))};c.appendVertex=function(r){return 0===this.editGeometry.components.length?null:this.editGeometry.apply(new C.AppendVertex(this.editGeometry,
this.editGeometry.components[0],r))};c.offsetEdge=function(r,e,h,v=1){return this.updateVertices([e.left,e.right],new y.OffsetEdgeVertex(this.editGeometry.coordinateHelper,r,e,h),v)};c.canRemoveVertex=function(){return this.editGeometry.components[0].vertices.length>this._minNumVerticesPerType};c.createUndoGroup=function(){const r=new q.UndoGroup;this.editGeometry.apply(r);return{remove(){return r.close()}}};c.undo=function(){return this.editGeometry.undo()};c.redo=function(){return this.editGeometry.redo()};
a.fromGeometry=function(r,e){return new a(z.EditGeometry.fromGeometry(r,e),r.type)};l._createClass(a,[{key:"canUndo",get:function(){return this.editGeometry.canUndo}},{key:"canRedo",get:function(){return this.editGeometry.canRedo}},{key:"geometry",get:function(){if(this._dirty){switch(this.type){case "point":this._geometry=this.editGeometry.toPoint();break;case "polyline":this._geometry=this.editGeometry.toPolyline();break;case "polygon":this._geometry=this.editGeometry.toPolygon()}this._dirty=!1}return this._geometry}},
{key:"_minNumVerticesPerType",get:function(){switch(this.type){case "point":return 1;case "polyline":return 2;case "polygon":return 3;default:return 0}}}]);return a}(m);b.Component=z.Component;b.Edge=z.Edge;b.EditGeometry=z.EditGeometry;b.Vertex=z.Vertex;b.EditGeometryHelper=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports","../../../../core/maybe","../EditGeometry"],function(b,l,m){let z=function(){function C(g,
k,w){this.editGeometry=g;this.component=k;this.pos=w;this.right=this.left=this.originalEdge=this.addedVertex=null}var A=C.prototype;A.apply=function(){let g="redo";l.isNone(this.addedVertex)&&(g="apply",this.addedVertex=new m.Vertex(this.component));const k=this.component.getLastVertex();if(l.isNone(k))this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{let w=null;k.right&&(this.originalEdge=k.right,w=this.originalEdge.right,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),
1));this.component.vertices.push(this.addedVertex);this.addedVertex.pos=this.pos;l.isNone(this.left)&&(this.left=new m.Edge(this.component,k,this.addedVertex));this.component.edges.push(this.left);k.right=this.left;l.isSome(this.originalEdge)&&l.isSome(w)&&(l.isNone(this.right)&&(this.right=new m.Edge(this.component,this.addedVertex,w)),this.component.edges.push(this.right),w.left=this.right);this.component.updateVertexIndex(this.addedVertex,k.index+1)}this.editGeometry.emit("change",{addedVertices:[this.addedVertex],
operation:g})};A.undo=function(){if(l.isNone(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1);l.isSome(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.left.right=null);l.isSome(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.right.left=null);l.isSome(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.left.right=
this.originalEdge,this.originalEdge.right.left=this.originalEdge);l.isSome(this.left)?this.component.updateVertexIndex(this.left.left,this.left.left.index):this.component.updateVertexIndex(this.addedVertex,0);this.editGeometry.emit("change",{removedVertices:[this.addedVertex],operation:"undo"})};A.accumulate=function(){return!1};return C}();b.AppendVertex=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],
function(b){let l=function(){function m(C,A,g){this.editGeometry=C;this.vertices=A;this.operation=g;this.undone=!1}var z=m.prototype;z.apply=function(){this.vertices.forEach(C=>this.operation.apply(C));this.editGeometry.components.forEach(C=>C.unnormalizeVertexPositions());this.editGeometry.emit("change",{updatedVertices:this.vertices,operation:this.undone?"redo":"apply"})};z.undo=function(){this.vertices.forEach(C=>this.operation.undo(C));this.editGeometry.emit("change",{updatedVertices:this.vertices,
operation:"undo"});this.undone=!0};z.canAccumulate=function(C){if(this.undone||C.vertices.length!==this.vertices.length)return!1;for(let A=0;A<C.vertices.length;++A)if(C.vertices[A]!==this.vertices[A])return!1;return this.operation.canAccumulate(C.operation)};z.accumulate=function(C){return C instanceof m&&this.canAccumulate(C)?(this.vertices.forEach(A=>this.operation.accumulate(A,C.operation)),this.operation.accumulateParams(C.operation),this.editGeometry.components.forEach(A=>A.unnormalizeVertexPositions()),
this.editGeometry.emit("change",{updatedVertices:this.vertices,operation:"apply"}),!0):!1};return m}();b.PerVertexOperation=function(m){this.helper=m};b.UpdateVertices=l;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../../../../core/maybe","../EditGeometry"],function(b,l,m){let z=function(){function C(g,k,w=0){this.editGeometry=g;this.vertices=k;this.minNumberOfVertices=w;this.removedVertices=null}
var A=C.prototype;A.apply=function(){let g="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach(k=>{k=this._removeVertex(k);l.isSome(k)&&this.removedVertices.push(k)}),g="apply"):this.removedVertices.forEach(k=>{this._removeVertex(k.removedVertex)});this.editGeometry.emit("change",{removedVertices:this.vertices,operation:g})};A.undo=function(){this.removedVertices.forEach(g=>{this._undoRemoveVertex(g)});this.editGeometry.emit("change",{addedVertices:this.vertices,operation:"undo"})};
A.accumulate=function(){return!1};A._removeVertex=function(g){const k=g.component;if(k.vertices.length<=this.minNumberOfVertices)return null;const w={removedVertex:g,createdEdge:null},u=g.left,x=g.right;k.vertices.splice(k.vertices.indexOf(g),1);u&&(k.edges.splice(k.edges.indexOf(u),1),u.left.right=null);x&&(k.edges.splice(k.edges.indexOf(x),1),x.right.left=null);0===g.index&&x&&0<this.vertices.length&&k.swapVertices(k.vertices.indexOf(x.right),0);u&&x&&(w.createdEdge=new m.Edge(k,u.left,x.right),
k.edges.push(w.createdEdge));x&&k.updateVertexIndex(x.right,x.right.index-1);return w};A._undoRemoveVertex=function(g){const k=g.removedVertex,w=g.removedVertex.component,u=k.left,x=k.right;g.createdEdge&&w.edges.splice(w.edges.indexOf(g.createdEdge),1);w.vertices.push(k);u&&(w.edges.push(u),u.left.right=u);x&&(w.edges.push(x),x.right.left=x);w.updateVertexIndex(k,k.index)};return C}();b.RemoveVertices=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports",
"../../../../core/maybe","../EditGeometry"],function(b,l,m){let z=function(){function C(g,k,w){this.editGeometry=g;this.edge=k;this.t=w;this.right=this.left=this.createdVertex=null}var A=C.prototype;A.apply=function(){let g="redo";const k=this.edge,w=k.component,u=k.component.data,x=k.left,y=k.right;w.edges.splice(w.edges.indexOf(k),1);l.isNone(this.createdVertex)&&(g="apply",this.createdVertex=new m.Vertex(k.component));w.vertices.push(this.createdVertex);this.createdVertex.pos=u.coordinateHelper.lerp(k.left.pos,
k.right.pos,this.t,u.coordinateHelper.createNew());l.isNone(this.left)&&(this.left=new m.Edge(w,x,this.createdVertex));this.left.left.left?w.edges.push(this.left):w.edges.unshift(this.left);x.right=this.left;l.isNone(this.right)&&(this.right=new m.Edge(w,this.createdVertex,y));w.edges.push(this.right);y.left=this.right;w.updateVertexIndex(this.createdVertex,x.index+1);this.editGeometry.emit("change",{addedVertices:[this.createdVertex],operation:g})};A.undo=function(){if(l.isNone(this.createdVertex)||
l.isNone(this.left)||l.isNone(this.right))return null;const g=this.edge,k=g.component,w=this.createdVertex.left.left,u=this.createdVertex.right.right;k.vertices.splice(k.vertices.indexOf(this.createdVertex),1);k.edges.splice(k.edges.indexOf(this.left),1);k.edges.splice(k.edges.indexOf(this.right),1);this.edge.left.left?k.edges.push(this.edge):k.edges.unshift(this.edge);w.right=g;u.left=g;k.updateVertexIndex(w,w.index);this.editGeometry.emit("change",{removedVertices:[this.createdVertex],operation:"undo"})};
A.accumulate=function(){return!1};return C}();b.SplitEdge=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports","../../../../core/maybe"],function(b,l){let m=function(){function z(A,g,k){this.editGeometry=A;this.vertex=g;this.pos=k}var C=z.prototype;C.apply=function(){const A=l.isNone(this.originalPosition);A&&(this.originalPosition=this.vertex.pos);this._apply(A?"apply":"redo")};C.undo=function(){this.vertex.pos=
l.unwrap(this.originalPosition);this.editGeometry.emit("change",{updatedVertices:[this.vertex],operation:"undo"})};C.accumulate=function(A){return A instanceof z&&A.vertex===this.vertex?(this.pos=A.pos,this._apply("apply"),!0):!1};C._apply=function(A){this.vertex.pos=this.pos;this.editGeometry.components.forEach(g=>g.unnormalizeVertexPositions());this.editGeometry.emit("change",{updatedVertices:[this.vertex],operation:A})};return z}();b.SetVertexPosition=m;Object.defineProperty(b,"__esModule",{value:!0})})},
"esri/views/interactive/editGeometry/operations/CloseComponent":function(){define(["exports","../../../../core/maybe","../EditGeometry"],function(b,l,m){let z=function(){function C(g,k){this.editGeometry=g;this.component=k;this.createdEdge=null}var A=C.prototype;A.apply=function(){let g="redo";if(l.isNone(this.createdEdge)){g="apply";const k=this.component.getFirstVertex(),w=this.component.getLastVertex();if(this.component.isClosed()||3>this.component.vertices.length||l.isNone(k)||l.isNone(w))return;
this.createdEdge=new m.Edge(this.component,w,k)}this.createdEdge.left.right=this.createdEdge;this.createdEdge.right.left=this.createdEdge;this.component.edges.push(this.createdEdge);this.editGeometry.emit("change",{operation:g})};A.undo=function(){l.isNone(this.createdEdge)||(this.component.edges.splice(this.component.edges.indexOf(this.createdEdge),1),this.createdEdge.left.right=null,this.createdEdge.right.left=null,this.editGeometry.emit("change",{operation:"undo"}))};A.accumulate=function(){return!1};
return C}();b.CloseComponent=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./UpdateVertices"],function(b,l,m){m=function(z){function C(g,k,w,u){g=z.call(this,g)||this;g.dx=k;g.dy=w;g.dz=u;return g}l._inheritsLoose(C,z);var A=C.prototype;A.move=function(g,k,w,u){this.helper.addDelta(g.pos,k,w,u)};A.apply=function(g){this.move(g,this.dx,this.dy,this.dz)};A.undo=
function(g){this.move(g,-this.dx,-this.dy,-this.dz)};A.canAccumulate=function(g){return g instanceof C};A.accumulate=function(g,k){this.move(g,k.dx,k.dy,k.dz)};A.accumulateParams=function(g){this.dx+=g.dx;this.dy+=g.dy;this.dz+=g.dz};return C}(m.PerVertexOperation);b.MoveVertex=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/OffsetEdgeVertex":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/vector ./UpdateVertices ../../../support/geometry2dUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){x=function(p){function q(a,c,r,e=0,h=0){a=p.call(this,a)||this;a.planeType=c;a.edge=r;a.distance=e;a._plane=w.create();a._offsetPlane=w.create();a._minDistance=-Infinity;a._maxDistance=Infinity;0===h&&a._initialize();return a}l._inheritsLoose(q,p);var d=q.prototype;d._initialize=function(){this._initializeNeighbors();this._initializePlane();this._initializeDistanceConstraints()};d._initializeNeighbors=function(){var a,c,r,e;const h=this._toXYZ(this.edge.left.pos),
v=this._toXYZ(null==(a=this.edge.left.left)?void 0:null==(c=a.left)?void 0:c.pos);a=this._toXYZ(this.edge.right.pos);c=this._toXYZ(null==(r=this.edge.right.right)?void 0:null==(e=r.right)?void 0:e.pos);this._edgeDirection=g.direction(k.create(),h,a);this._left=this._computeNeighbor(h,v,this._edgeDirection);this._right=this._computeNeighbor(a,c,this._edgeDirection)};d._toXYZ=function(a){return z.isSome(a)?this.helper.toXYZ(a):null};d._computeNeighbor=function(a,c,r){if(z.isNone(c))return{start:a,end:c,
direction:k.fromValues(-r[1],r[0],0),isOriginalDirection:!0};const e=g.direction(k.create(),a,c),h=!this._passesBisectingAngleThreshold(e,r);return{start:a,end:c,direction:h?this._bisectVectorsPerpendicular(r,e):e,isOriginalDirection:!h}};d._passesBisectingAngleThreshold=function(a,c){a=Math.abs(u.angle(c,a));return a>=t&&a<=Math.PI-t};d._bisectVectorsPerpendicular=function(a,c){a=0>g.dot(a,c)?a:g.negate(k.create(),a);const r=Math.abs(g.dot(a,c));if(!(.001>r||.999<r))return this._bisectDirection(a,
c);c=g.cross(k.create(),a,[0,0,1]);return g.normalize(c,c)};d._bisectDirection=function(a,c){a=g.add(k.create(),a,c);return g.normalize(a,a)};d._initializePlane=function(){const a=this._computeNormalDirection(this._left),c=this._computeNormalDirection(this._right);0>g.dot(a,c)&&g.negate(c,c);w.fromPositionAndNormal(this._left.start,this._bisectDirection(a,c),this._plane)};d._computeNormalDirection=function(a){a=g.cross(k.create(),a.direction,this._edgeDirection);g.normalize(a,a);a=g.cross(k.create(),
this._edgeDirection,a);1===this.planeType&&(a[2]=0);return g.normalize(a,a)};d._initializeDistanceConstraints=function(){z.isSome(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint(w.signedDistance(this._plane,this._left.end));z.isSome(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint(w.signedDistance(this._plane,this._right.end));this._updateIntersectDistanceConstraint(this._plane)};d._updateDistanceConstraint=function(a){0>=a&&(this._minDistance=
Math.max(this._minDistance,a));0<=a&&(this._maxDistance=Math.min(this._maxDistance,a))};d._updateIntersectDistanceConstraint=function(a){var c=w.normal(a);const r=this._edgeDirection;var e=g.add(k.create(),this._left.start,this._left.direction);const h=g.add(k.create(),this._right.start,this._right.direction);var v=this._pointInBasis2D(A.create(),c,r,this._left.start),E=this._pointInBasis2D(A.create(),c,r,e),n=this._pointInBasis2D(A.create(),c,r,this._right.start);c=this._pointInBasis2D(A.create(),
c,r,h);[n]=y.intersectLineAndRay({start:E,end:v,type:1},{start:c,end:n,type:1});n&&(v=C.subtract(A.create(),v,E),C.normalize(v,v),E=C.subtract(A.create(),n,E),E=C.dot(v,E),e=g.add(k.create(),e,g.scale(k.create(),this._left.direction,-E)),a=w.signedDistance(a,e),this._updateDistanceConstraint(a))};d._pointInBasis2D=function(a,c,r,e){a[0]=u.projectPointSignedLength(c,e);a[1]=u.projectPointSignedLength(r,e);return a};d._offset=function(a,c){Number.isFinite(this._minDistance)&&(c=Math.max(this._minDistance,
c));Number.isFinite(this._maxDistance)&&(c=Math.min(this._maxDistance,c));w.copy(this._plane,this._offsetPlane);this._offsetPlane[3]-=c;c=(e,h,v)=>z.isSome(h)&&w.intersectLine(this._offsetPlane,e,g.add(k.create(),e,h),v);const r=k.create();(a===this.edge.left?c(this._left.start,this._left.direction,r):c(this._right.start,this._right.direction,r))&&this.helper.copy(this.helper.fromXYZ(r,void 0,this.helper.getM(a.pos)),a.pos)};d.signedDistanceToPoint=function(a){return w.signedDistance(this.plane,this.helper.toXYZ(this.helper.fromPoint(a)))};
d.apply=function(a){this._offset(a,this.distance)};d.undo=function(a){this._offset(a,0)};d.canAccumulate=function(a){return a instanceof q&&this.edge.left.index===a.edge.left.index&&this.edge.right.index===a.edge.right.index&&this.edge.component===a.edge.component&&this._maybeEqualsVec3(this._left.direction,a._left.direction)&&this._maybeEqualsVec3(this._right.direction,a._right.direction)&&g.equals(w.normal(this._plane),w.normal(a._plane))};d.accumulate=function(a,c){this._offset(a,this._plane[3]-
c._plane[3]+c.distance)};d.accumulateParams=function(a){this.distance=a.distance-a._plane[3]+this._plane[3]};d.clone=function(){const a=new q(this.helper,this.planeType,this.edge,this.distance,1);w.copy(this._plane,a._plane);w.copy(this._offsetPlane,a._offsetPlane);a._maxDistance=this._maxDistance;a._minDistance=this._minDistance;a._left=this._cloneNeighbor(this._left);a._right=this._cloneNeighbor(this._right);a._edgeDirection=g.copy(k.create(),this._edgeDirection);return a};d._maybeEqualsVec3=function(a,
c){return z.isNone(a)&&z.isNone(c)||z.isSome(a)&&z.isSome(c)&&g.equals(a,c)};d._cloneNeighbor=function({start:a,end:c,direction:r,isOriginalDirection:e}){return{start:g.copy(k.create(),a),end:z.isSome(c)?g.copy(k.create(),c):null,direction:g.copy(k.create(),r),isOriginalDirection:e}};l._createClass(q,[{key:"plane",get:function(){return this._plane}},{key:"requiresSplitEdgeLeft",get:function(){return!this._left.isOriginalDirection}},{key:"requiresSplitEdgeRight",get:function(){return!this._right.isOriginalDirection}},
{key:"edgeDirection",get:function(){return this._edgeDirection}}]);return q}(x.PerVertexOperation);const t=m.deg2rad(15);b.OffsetEdgeVertex=x;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../core/maybe ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/sphere ./vectorStacks".split(" "),function(b,l,m,z,C,A,g){function k(B=n){return[B[0],B[1],B[2],B[3]]}function w(B,f=k()){return u(B[0],B[1],B[2],B[3],f)}function u(B,
f,D,H,P=k()){P[0]=B;P[1]=f;P[2]=D;P[3]=H;return P}function x(B,f,D){z.copy(D,f);f=z.dot(f,f);1E-5<Math.abs(f-1)&&1E-12<f&&z.scale(D,D,1/Math.sqrt(f));return p(D,B,D)}function y(B,f,D,H=k()){return q(z.subtract(g.sv3d.get(),B,f),z.subtract(g.sv3d.get(),D,f),B,H)}function t(B,f,D,H,P){if(3>B.count)return!1;B.getVec(D,r);let R=H,K=!1;for(;R<B.count-1&&!K;)B.getVec(R,e),R++,K=!z.exactEquals(r,e);if(!K)return!1;R=Math.max(R,P);for(K=!1;R<B.count&&!K;)B.getVec(R,h),R++,z.subtract(v,r,e),z.normalize(v,v),
z.subtract(E,e,h),z.normalize(E,E),K=!z.exactEquals(r,h)&&!z.exactEquals(e,h)&&.99619469809>Math.abs(z.dot(v,E));if(!K)return 0===D&&1===H&&2===P?!1:t(B,f,0,1,2);y(r,e,h,f);return!0}function p(B,f,D){B!==D&&w(B,D);D[3]=-z.dot(D,f);return D}function q(B,f,D,H){B=z.cross(h,f,B);return x(D,B,H)}function d(B,f,D){B=z.scale(g.sv3d.get(),B,z.dot(B,f));z.subtract(D,f,B);return D}function a(B,f){return z.dot(B,f)+B[3]}function c(B,f,D,H,P){const R=z.dot(B,D);if(0===R)return!1;B=-(z.dot(B,f)+B[3])/R;H&1&&
(B=l.clamp(B,0,1));if(!(H&4)&&0>B||!(H&8)&&1<B)return!1;z.add(P,f,z.scale(P,D,B));return!0}const r=C.create(),e=C.create(),h=C.create(),v=C.create(),E=C.create(),n=[0,0,1,0];b.UP=n;b.clip=function(B,f){const D=z.dot(B,f.ray.direction);B=-a(B,f.ray.origin);if(0>B&&0<=D)return!1;if(-1E-6<D&&1E-6>D)return 0<B;if((0>B||0>D)&&!(0>B&&0>D))return!0;B/=D;0<D?B<f.c1&&(f.c1=B):B>f.c0&&(f.c0=B);return f.c0<=f.c1};b.clipInfinite=function(B,f){const D=z.dot(B,f.ray.direction);B=-a(B,f.ray.origin);if(-1E-6<D&&
1E-6>D)return 0<B;B/=D;0<D?B<f.c1&&(f.c1=B):B>f.c0&&(f.c0=B);return f.c0<=f.c1};b.copy=w;b.create=k;b.distance=function(B,f){return Math.abs(a(B,f))};b.fromManyPoints=function(B,f){return t(B,f,0,1,2)};b.fromManyPointsSampleAt=t;b.fromNormalAndOffset=function(B,f,D){z.copy(D,B);D[3]=f;return D};b.fromPoints=y;b.fromPositionAndNormal=x;b.fromValues=u;b.fromVectorsAndPoint=q;b.intersectLine=function(B,f,D,H){D=z.subtract(g.sv3d.get(),D,f);return c(B,f,D,12,H)};b.intersectLineSegment=function(B,f,D){return c(B,
f.origin,f.vector,0,D)};b.intersectLineSegmentClamp=function(B,f,D){return c(B,f.origin,f.vector,1,D)};b.intersectRay=function(B,f,D){return m.isSome(f)?c(B,f.origin,f.direction,8,D):!1};b.isAABBFullyInside=function(B,f){const D=f[0],H=f[1],P=f[2],R=f[3],K=f[4];f=f[5];return 0<=B[0]*(0<B[0]?D:R)+B[1]*(0<B[1]?H:K)+B[2]*(0<B[2]?P:f)+B[3]};b.isPointInside=function(B,f){return 0<=a(B,f)};b.isPointOutside=function(B,f){return 0>a(B,f)};b.isSphereFullyInside=function(B,f){return 0<=a(B,A.getCenter(f))-
f[3]};b.isSphereFullyOutside=function(B,f){return 0>a(B,A.getCenter(f))+f[3]};b.negate=function(B,f){f[0]=-B[0];f[1]=-B[1];f[2]=-B[2];f[3]=-B[3];return f};b.normal=function(B){return B};b.projectPoint=function(B,f,D){const H=z.scale(g.sv3d.get(),B,-B[3]);f=z.subtract(g.sv3d.get(),f,H);B=d(B,f,g.sv3d.get());z.add(D,B,H);return D};b.projectVector=d;b.setOffsetFromPoint=p;b.signedDistance=a;b.wrap=function(B,f,D,H){return u(B,f,D,H,g.sv4d.get())};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ../core/maybe ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t){function p(){return u.create()}function q(L,N=p()){return w.copy(N,L)}function d(L,N){return u.fromValues(L[0],L[1],L[2],N)}function a(L){return L}function c(L){L[0]=L[1]=L[2]=L[3]=0}function r(L){return L}function e(L){return Array.isArray(L)?L[3]:L}function h(L){return Array.isArray(L)?L:T}function v(L,N,U,fa){return u.fromValues(L,N,U,fa)}function E(L,N,U){L!==U&&g.copy(U,L);U[3]=L[3]+N;return U}function n(L,N,U){V.error("sphere.setExtent is not yet supported");
return L===U?U:q(L,U)}function B(L,N,U){if(C.isNone(N))return!1;var fa=g.subtract(t.sv3d.get(),N.origin,h(L)),ka=g.dot(N.direction,N.direction);const wa=2*g.dot(N.direction,fa);L=g.dot(fa,fa)-L[3]*L[3];L=wa*wa-4*ka*L;if(0>L)return!1;fa=Math.sqrt(L);L=(-wa-fa)/(2*ka);ka=(-wa+fa)/(2*ka);if(0>L||ka<L&&0<ka)L=ka;if(0>L)return!1;U&&g.add(U,N.origin,g.scale(t.sv3d.get(),N.direction,L));return!0}function f(L,N){return B(L,N,null)}function D(L,N,U){if(B(L,N,U))return U;L=H(L,N,t.sv3d.get());g.add(U,N.origin,
g.scale(t.sv3d.get(),N.direction,g.distance(N.origin,L)/g.length(N.direction)));return U}function H(L,N,U){const fa=t.sv3d.get(),ka=t.sm4d.get();g.cross(fa,N.origin,N.direction);const wa=e(L);g.cross(U,fa,N.origin);g.scale(U,U,1/g.length(U)*wa);L=J(L,N.origin);N=y.angle(N.origin,U);A.identity(ka);A.rotate(ka,ka,N+L,fa);g.transformMat4(U,U,ka);return U}function P(L,N,U){if(B(L,N,U))return U;x.closestPoint(N,h(L),U);return R(L,U,U)}function R(L,N,U){N=g.subtract(t.sv3d.get(),N,h(L));N=g.scale(t.sv3d.get(),
N,L[3]/g.length(N));return g.add(U,N,h(L))}function K(L,N){N=g.subtract(t.sv3d.get(),N,h(L));N=g.squaredLength(N);return Math.sqrt(Math.abs(N-L[3]*L[3]))}function J(L,N){N=g.subtract(t.sv3d.get(),N,h(L));N=g.length(N);L=e(L);return z.acosClamped(L/(L+Math.abs(L-N)))}function Q(L,N,U,fa){L=g.subtract(M,N,h(L));switch(U){case 0:return U=z.cartesianToSpherical(L,M)[2],g.set(fa,-Math.sin(U),Math.cos(U),0);case 1:return L=z.cartesianToSpherical(L,M),U=L[1],L=L[2],N=Math.sin(U),g.set(fa,-N*Math.cos(L),
-N*Math.sin(L),Math.cos(U));case 2:return g.normalize(fa,L)}}function F(L,N){N=g.subtract(S,N,h(L));return g.length(N)-L[3]}function O(L,N,U,fa){const ka=F(L,N);L=Q(L,N,2,S);U=g.scale(S,L,U-ka);return g.add(fa,N,U)}const V=m.getLogger("esri.geometry.support.sphere"),M=k.create(),T=k.create(),S=k.create();l=Object.freeze({__proto__:null,create:p,copy:q,fromCenterAndRadius:d,wrap:a,clear:c,fromRadius:r,getRadius:e,getCenter:h,fromValues:v,elevate:E,setExtent:n,intersectRay:B,intersectsRay:f,intersectRayClosestSilhouette:D,
closestPointOnSilhouette:H,closestPoint:P,projectPoint:R,distanceToSilhouette:K,angleToSilhouette:J,axisAt:Q,altitudeAt:F,setAltitudeAt:O});b.altitudeAt=F;b.angleToSilhouette=J;b.axisAt=Q;b.clear=c;b.closestPoint=P;b.closestPointOnSilhouette=H;b.copy=q;b.create=p;b.distanceToSilhouette=K;b.elevate=E;b.fromCenterAndRadius=d;b.fromRadius=r;b.fromValues=v;b.getCenter=h;b.getRadius=e;b.intersectRay=B;b.intersectRayClosestSilhouette=D;b.intersectsRay=f;b.projectPoint=R;b.setAltitudeAt=O;b.setExtent=n;
b.sphere=l;b.wrap=a})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(b,l,m){function z(G,I){G[0]=I[0];G[1]=I[1];G[2]=I[2];G[3]=I[3];G[4]=I[4];G[5]=I[5];G[6]=I[6];G[7]=I[7];G[8]=I[8];G[9]=I[9];G[10]=I[10];G[11]=I[11];G[12]=I[12];G[13]=I[13];G[14]=I[14];G[15]=I[15];return G}function C(G,I,Z,ca,da,ba,ha,ea,W,X,Y,aa,ia,ja,va,ma,ta){G[0]=I;G[1]=Z;G[2]=ca;G[3]=da;G[4]=ba;G[5]=ha;G[6]=ea;G[7]=W;G[8]=X;G[9]=Y;G[10]=aa;G[11]=ia;G[12]=ja;G[13]=va;G[14]=ma;G[15]=ta;return G}
function A(G){G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function g(G,I){if(G===I){const Z=I[1],ca=I[2],da=I[3],ba=I[6],ha=I[7],ea=I[11];G[1]=I[4];G[2]=I[8];G[3]=I[12];G[4]=Z;G[6]=I[9];G[7]=I[13];G[8]=ca;G[9]=ba;G[11]=I[14];G[12]=da;G[13]=ha;G[14]=ea}else G[0]=I[0],G[1]=I[4],G[2]=I[8],G[3]=I[12],G[4]=I[1],G[5]=I[5],G[6]=I[9],G[7]=I[13],G[8]=I[2],G[9]=I[6],G[10]=I[10],G[11]=I[14],G[12]=I[3],G[13]=I[7],G[14]=I[11],G[15]=
I[15];return G}function k(G,I){const Z=I[0],ca=I[1],da=I[2],ba=I[3],ha=I[4],ea=I[5],W=I[6],X=I[7],Y=I[8],aa=I[9],ia=I[10],ja=I[11],va=I[12],ma=I[13],ta=I[14];I=I[15];const sa=Z*ea-ca*ha,ra=Z*W-da*ha,na=Z*X-ba*ha,ua=ca*W-da*ea,za=ca*X-ba*ea,Ca=da*X-ba*W,Da=Y*ma-aa*va,Ia=Y*ta-ia*va,Pa=Y*I-ja*va,Oa=aa*ta-ia*ma,Qa=aa*I-ja*ma,Ka=ia*I-ja*ta;let Ja=sa*Ka-ra*Qa+na*Oa+ua*Pa-za*Ia+Ca*Da;if(!Ja)return null;Ja=1/Ja;G[0]=(ea*Ka-W*Qa+X*Oa)*Ja;G[1]=(da*Qa-ca*Ka-ba*Oa)*Ja;G[2]=(ma*Ca-ta*za+I*ua)*Ja;G[3]=(ia*za-aa*
Ca-ja*ua)*Ja;G[4]=(W*Pa-ha*Ka-X*Ia)*Ja;G[5]=(Z*Ka-da*Pa+ba*Ia)*Ja;G[6]=(ta*na-va*Ca-I*ra)*Ja;G[7]=(Y*Ca-ia*na+ja*ra)*Ja;G[8]=(ha*Qa-ea*Pa+X*Da)*Ja;G[9]=(ca*Pa-Z*Qa-ba*Da)*Ja;G[10]=(va*za-ma*na+I*sa)*Ja;G[11]=(aa*na-Y*za-ja*sa)*Ja;G[12]=(ea*Ia-ha*Oa-W*Da)*Ja;G[13]=(Z*Oa-ca*Ia+da*Da)*Ja;G[14]=(ma*ra-va*ua-ta*sa)*Ja;G[15]=(Y*ua-aa*ra+ia*sa)*Ja;return G}function w(G,I){const Z=I[0],ca=I[1],da=I[2],ba=I[3],ha=I[4],ea=I[5],W=I[6],X=I[7],Y=I[8],aa=I[9],ia=I[10],ja=I[11],va=I[12],ma=I[13],ta=I[14];I=I[15];
G[0]=ea*(ia*I-ja*ta)-aa*(W*I-X*ta)+ma*(W*ja-X*ia);G[1]=-(ca*(ia*I-ja*ta)-aa*(da*I-ba*ta)+ma*(da*ja-ba*ia));G[2]=ca*(W*I-X*ta)-ea*(da*I-ba*ta)+ma*(da*X-ba*W);G[3]=-(ca*(W*ja-X*ia)-ea*(da*ja-ba*ia)+aa*(da*X-ba*W));G[4]=-(ha*(ia*I-ja*ta)-Y*(W*I-X*ta)+va*(W*ja-X*ia));G[5]=Z*(ia*I-ja*ta)-Y*(da*I-ba*ta)+va*(da*ja-ba*ia);G[6]=-(Z*(W*I-X*ta)-ha*(da*I-ba*ta)+va*(da*X-ba*W));G[7]=Z*(W*ja-X*ia)-ha*(da*ja-ba*ia)+Y*(da*X-ba*W);G[8]=ha*(aa*I-ja*ma)-Y*(ea*I-X*ma)+va*(ea*ja-X*aa);G[9]=-(Z*(aa*I-ja*ma)-Y*(ca*I-ba*
ma)+va*(ca*ja-ba*aa));G[10]=Z*(ea*I-X*ma)-ha*(ca*I-ba*ma)+va*(ca*X-ba*ea);G[11]=-(Z*(ea*ja-X*aa)-ha*(ca*ja-ba*aa)+Y*(ca*X-ba*ea));G[12]=-(ha*(aa*ta-ia*ma)-Y*(ea*ta-W*ma)+va*(ea*ia-W*aa));G[13]=Z*(aa*ta-ia*ma)-Y*(ca*ta-da*ma)+va*(ca*ia-da*aa);G[14]=-(Z*(ea*ta-W*ma)-ha*(ca*ta-da*ma)+va*(ca*W-da*ea));G[15]=Z*(ea*ia-W*aa)-ha*(ca*ia-da*aa)+Y*(ca*W-da*ea);return G}function u(G){const I=G[0],Z=G[1],ca=G[2],da=G[3],ba=G[4],ha=G[5],ea=G[6],W=G[7],X=G[8],Y=G[9],aa=G[10],ia=G[11],ja=G[12],va=G[13],ma=G[14];
G=G[15];return(I*ha-Z*ba)*(aa*G-ia*ma)-(I*ea-ca*ba)*(Y*G-ia*va)+(I*W-da*ba)*(Y*ma-aa*va)+(Z*ea-ca*ha)*(X*G-ia*ja)-(Z*W-da*ha)*(X*ma-aa*ja)+(ca*W-da*ea)*(X*va-Y*ja)}function x(G,I,Z){const ca=I[0],da=I[1],ba=I[2],ha=I[3],ea=I[4],W=I[5],X=I[6],Y=I[7],aa=I[8],ia=I[9],ja=I[10],va=I[11],ma=I[12],ta=I[13],sa=I[14];I=I[15];let ra=Z[0],na=Z[1],ua=Z[2],za=Z[3];G[0]=ra*ca+na*ea+ua*aa+za*ma;G[1]=ra*da+na*W+ua*ia+za*ta;G[2]=ra*ba+na*X+ua*ja+za*sa;G[3]=ra*ha+na*Y+ua*va+za*I;ra=Z[4];na=Z[5];ua=Z[6];za=Z[7];G[4]=
ra*ca+na*ea+ua*aa+za*ma;G[5]=ra*da+na*W+ua*ia+za*ta;G[6]=ra*ba+na*X+ua*ja+za*sa;G[7]=ra*ha+na*Y+ua*va+za*I;ra=Z[8];na=Z[9];ua=Z[10];za=Z[11];G[8]=ra*ca+na*ea+ua*aa+za*ma;G[9]=ra*da+na*W+ua*ia+za*ta;G[10]=ra*ba+na*X+ua*ja+za*sa;G[11]=ra*ha+na*Y+ua*va+za*I;ra=Z[12];na=Z[13];ua=Z[14];za=Z[15];G[12]=ra*ca+na*ea+ua*aa+za*ma;G[13]=ra*da+na*W+ua*ia+za*ta;G[14]=ra*ba+na*X+ua*ja+za*sa;G[15]=ra*ha+na*Y+ua*va+za*I;return G}function y(G,I,Z){const ca=Z[0],da=Z[1];Z=Z[2];let ba=void 0,ha=void 0,ea=void 0,W=void 0,
X=void 0,Y=void 0,aa=void 0,ia=void 0,ja=void 0,va=void 0,ma=void 0,ta=void 0;I===G?(G[12]=I[0]*ca+I[4]*da+I[8]*Z+I[12],G[13]=I[1]*ca+I[5]*da+I[9]*Z+I[13],G[14]=I[2]*ca+I[6]*da+I[10]*Z+I[14],G[15]=I[3]*ca+I[7]*da+I[11]*Z+I[15]):(ba=I[0],ha=I[1],ea=I[2],W=I[3],X=I[4],Y=I[5],aa=I[6],ia=I[7],ja=I[8],va=I[9],ma=I[10],ta=I[11],G[0]=ba,G[1]=ha,G[2]=ea,G[3]=W,G[4]=X,G[5]=Y,G[6]=aa,G[7]=ia,G[8]=ja,G[9]=va,G[10]=ma,G[11]=ta,G[12]=ba*ca+X*da+ja*Z+I[12],G[13]=ha*ca+Y*da+va*Z+I[13],G[14]=ea*ca+aa*da+ma*Z+I[14],
G[15]=W*ca+ia*da+ta*Z+I[15]);return G}function t(G,I,Z){const ca=Z[0],da=Z[1];Z=Z[2];G[0]=I[0]*ca;G[1]=I[1]*ca;G[2]=I[2]*ca;G[3]=I[3]*ca;G[4]=I[4]*da;G[5]=I[5]*da;G[6]=I[6]*da;G[7]=I[7]*da;G[8]=I[8]*Z;G[9]=I[9]*Z;G[10]=I[10]*Z;G[11]=I[11]*Z;G[12]=I[12];G[13]=I[13];G[14]=I[14];G[15]=I[15];return G}function p(G,I,Z,ca){let da=ca[0],ba=ca[1];ca=ca[2];let ha=Math.sqrt(da*da+ba*ba+ca*ca);var ea=void 0,W=void 0;let X=void 0,Y=void 0,aa=void 0,ia=void 0,ja=void 0,va=void 0,ma=void 0,ta=void 0,sa=void 0,
ra=void 0,na=void 0,ua=void 0,za=void 0,Ca=void 0,Da=void 0,Ia=void 0,Pa=void 0,Oa=void 0,Qa=void 0,Ka=void 0;W=ea=void 0;if(ha<m.EPSILON)return null;ha=1/ha;da*=ha;ba*=ha;ca*=ha;ea=Math.sin(Z);W=Math.cos(Z);X=1-W;Y=I[0];aa=I[1];ia=I[2];ja=I[3];va=I[4];ma=I[5];ta=I[6];sa=I[7];ra=I[8];na=I[9];ua=I[10];za=I[11];Ca=da*da*X+W;Da=ba*da*X+ca*ea;Ia=ca*da*X-ba*ea;Pa=da*ba*X-ca*ea;Oa=ba*ba*X+W;Qa=ca*ba*X+da*ea;Ka=da*ca*X+ba*ea;ea=ba*ca*X-da*ea;W=ca*ca*X+W;G[0]=Y*Ca+va*Da+ra*Ia;G[1]=aa*Ca+ma*Da+na*Ia;G[2]=
ia*Ca+ta*Da+ua*Ia;G[3]=ja*Ca+sa*Da+za*Ia;G[4]=Y*Pa+va*Oa+ra*Qa;G[5]=aa*Pa+ma*Oa+na*Qa;G[6]=ia*Pa+ta*Oa+ua*Qa;G[7]=ja*Pa+sa*Oa+za*Qa;G[8]=Y*Ka+va*ea+ra*W;G[9]=aa*Ka+ma*ea+na*W;G[10]=ia*Ka+ta*ea+ua*W;G[11]=ja*Ka+sa*ea+za*W;I!==G&&(G[12]=I[12],G[13]=I[13],G[14]=I[14],G[15]=I[15]);return G}function q(G,I,Z){const ca=Math.sin(Z);Z=Math.cos(Z);const da=I[4],ba=I[5],ha=I[6],ea=I[7],W=I[8],X=I[9],Y=I[10],aa=I[11];I!==G&&(G[0]=I[0],G[1]=I[1],G[2]=I[2],G[3]=I[3],G[12]=I[12],G[13]=I[13],G[14]=I[14],G[15]=I[15]);
G[4]=da*Z+W*ca;G[5]=ba*Z+X*ca;G[6]=ha*Z+Y*ca;G[7]=ea*Z+aa*ca;G[8]=W*Z-da*ca;G[9]=X*Z-ba*ca;G[10]=Y*Z-ha*ca;G[11]=aa*Z-ea*ca;return G}function d(G,I,Z){const ca=Math.sin(Z);Z=Math.cos(Z);const da=I[0],ba=I[1],ha=I[2],ea=I[3],W=I[8],X=I[9],Y=I[10],aa=I[11];I!==G&&(G[4]=I[4],G[5]=I[5],G[6]=I[6],G[7]=I[7],G[12]=I[12],G[13]=I[13],G[14]=I[14],G[15]=I[15]);G[0]=da*Z-W*ca;G[1]=ba*Z-X*ca;G[2]=ha*Z-Y*ca;G[3]=ea*Z-aa*ca;G[8]=da*ca+W*Z;G[9]=ba*ca+X*Z;G[10]=ha*ca+Y*Z;G[11]=ea*ca+aa*Z;return G}function a(G,I,Z){const ca=
Math.sin(Z);Z=Math.cos(Z);const da=I[0],ba=I[1],ha=I[2],ea=I[3],W=I[4],X=I[5],Y=I[6],aa=I[7];I!==G&&(G[8]=I[8],G[9]=I[9],G[10]=I[10],G[11]=I[11],G[12]=I[12],G[13]=I[13],G[14]=I[14],G[15]=I[15]);G[0]=da*Z+W*ca;G[1]=ba*Z+X*ca;G[2]=ha*Z+Y*ca;G[3]=ea*Z+aa*ca;G[4]=W*Z-da*ca;G[5]=X*Z-ba*ca;G[6]=Y*Z-ha*ca;G[7]=aa*Z-ea*ca;return G}function c(G,I){G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=I[0];G[13]=I[1];G[14]=I[2];G[15]=1;return G}function r(G,I){G[0]=I[0];
G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=I[1];G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=I[2];G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function e(G,I,Z){let ca=Z[0],da=Z[1];Z=Z[2];let ba=Math.sqrt(ca*ca+da*da+Z*Z),ha=void 0,ea=void 0,W=void 0;if(ba<m.EPSILON)return null;ba=1/ba;ca*=ba;da*=ba;Z*=ba;ha=Math.sin(I);ea=Math.cos(I);W=1-ea;G[0]=ca*ca*W+ea;G[1]=da*ca*W+Z*ha;G[2]=Z*ca*W-da*ha;G[3]=0;G[4]=ca*da*W-Z*ha;G[5]=da*da*W+ea;G[6]=Z*da*W+ca*ha;G[7]=0;G[8]=ca*Z*W+da*ha;G[9]=da*Z*W-ca*ha;G[10]=Z*Z*W+ea;G[11]=
0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function h(G,I){const Z=Math.sin(I);I=Math.cos(I);G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=I;G[6]=Z;G[7]=0;G[8]=0;G[9]=-Z;G[10]=I;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function v(G,I){const Z=Math.sin(I);I=Math.cos(I);G[0]=I;G[1]=0;G[2]=-Z;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=Z;G[9]=0;G[10]=I;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function E(G,I){const Z=Math.sin(I);I=Math.cos(I);G[0]=I;G[1]=Z;G[2]=0;G[3]=0;G[4]=-Z;G[5]=I;G[6]=0;G[7]=
0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function n(G,I,Z){var ca=I[0],da=I[1],ba=I[2],ha=I[3],ea=ca+ca,W=da+da;const X=ba+ba;I=ca*ea;const Y=ca*W;ca*=X;const aa=da*W;da*=X;ba*=X;ea*=ha;W*=ha;ha*=X;G[0]=1-(aa+ba);G[1]=Y+ha;G[2]=ca-W;G[3]=0;G[4]=Y-ha;G[5]=1-(I+ba);G[6]=da+ea;G[7]=0;G[8]=ca+W;G[9]=da-ea;G[10]=1-(I+aa);G[11]=0;G[12]=Z[0];G[13]=Z[1];G[14]=Z[2];G[15]=1;return G}function B(G,I){const Z=oa,ca=-I[0],da=-I[1],ba=-I[2],ha=I[3],ea=I[4],W=I[5],X=I[6],Y=I[7],aa=
ca*ca+da*da+ba*ba+ha*ha;0<aa?(Z[0]=2*(ea*ha+Y*ca+W*ba-X*da)/aa,Z[1]=2*(W*ha+Y*da+X*ca-ea*ba)/aa,Z[2]=2*(X*ha+Y*ba+ea*da-W*ca)/aa):(Z[0]=2*(ea*ha+Y*ca+W*ba-X*da),Z[1]=2*(W*ha+Y*da+X*ca-ea*ba),Z[2]=2*(X*ha+Y*ba+ea*da-W*ca));n(G,I,Z);return G}function f(G,I){G[0]=I[12];G[1]=I[13];G[2]=I[14];return G}function D(G,I){const Z=I[0],ca=I[1],da=I[2],ba=I[4],ha=I[5],ea=I[6],W=I[8],X=I[9];I=I[10];G[0]=Math.sqrt(Z*Z+ca*ca+da*da);G[1]=Math.sqrt(ba*ba+ha*ha+ea*ea);G[2]=Math.sqrt(W*W+X*X+I*I);return G}function H(G,
I){const Z=I[0]+I[5]+I[10];let ca=0;0<Z?(ca=2*Math.sqrt(Z+1),G[3]=.25*ca,G[0]=(I[6]-I[9])/ca,G[1]=(I[8]-I[2])/ca,G[2]=(I[1]-I[4])/ca):I[0]>I[5]&&I[0]>I[10]?(ca=2*Math.sqrt(1+I[0]-I[5]-I[10]),G[3]=(I[6]-I[9])/ca,G[0]=.25*ca,G[1]=(I[1]+I[4])/ca,G[2]=(I[8]+I[2])/ca):I[5]>I[10]?(ca=2*Math.sqrt(1+I[5]-I[0]-I[10]),G[3]=(I[8]-I[2])/ca,G[0]=(I[1]+I[4])/ca,G[1]=.25*ca,G[2]=(I[6]+I[9])/ca):(ca=2*Math.sqrt(1+I[10]-I[0]-I[5]),G[3]=(I[1]-I[4])/ca,G[0]=(I[8]+I[2])/ca,G[1]=(I[6]+I[9])/ca,G[2]=.25*ca);return G}function P(G,
I,Z,ca){var da=I[0],ba=I[1],ha=I[2],ea=I[3],W=da+da,X=ba+ba,Y=ha+ha;I=da*W;const aa=da*X;da*=Y;const ia=ba*X;ba*=Y;ha*=Y;W*=ea;X*=ea;ea*=Y;Y=ca[0];const ja=ca[1];ca=ca[2];G[0]=(1-(ia+ha))*Y;G[1]=(aa+ea)*Y;G[2]=(da-X)*Y;G[3]=0;G[4]=(aa-ea)*ja;G[5]=(1-(I+ha))*ja;G[6]=(ba+W)*ja;G[7]=0;G[8]=(da+X)*ca;G[9]=(ba-W)*ca;G[10]=(1-(I+ia))*ca;G[11]=0;G[12]=Z[0];G[13]=Z[1];G[14]=Z[2];G[15]=1;return G}function R(G,I,Z,ca,da){var ba=I[0],ha=I[1],ea=I[2],W=I[3],X=ba+ba,Y=ha+ha,aa=ea+ea;I=ba*X;var ia=ba*Y,ja=ba*aa;
ba=ha*Y;ha*=aa;var va=ea*aa;ea=W*X;Y*=W;const ma=W*aa;var ta=ca[0],sa=ca[1];aa=ca[2];ca=da[0];W=da[1];da=da[2];X=(1-(ba+va))*ta;const ra=(ia+ma)*ta;ta*=ja-Y;ia=(ia-ma)*sa;va=(1-(I+va))*sa;sa*=ha+ea;ja=(ja+Y)*aa;ha=(ha-ea)*aa;I=(1-(I+ba))*aa;G[0]=X;G[1]=ra;G[2]=ta;G[3]=0;G[4]=ia;G[5]=va;G[6]=sa;G[7]=0;G[8]=ja;G[9]=ha;G[10]=I;G[11]=0;G[12]=Z[0]+ca-(X*ca+ia*W+ja*da);G[13]=Z[1]+W-(ra*ca+va*W+ha*da);G[14]=Z[2]+da-(ta*ca+sa*W+I*da);G[15]=1;return G}function K(G,I){var Z=I[0],ca=I[1],da=I[2];I=I[3];var ba=
Z+Z,ha=ca+ca;const ea=da+da;Z*=ba;const W=ca*ba;ca*=ha;const X=da*ba,Y=da*ha;da*=ea;ba*=I;ha*=I;I*=ea;G[0]=1-ca-da;G[1]=W+I;G[2]=X-ha;G[3]=0;G[4]=W-I;G[5]=1-Z-da;G[6]=Y+ba;G[7]=0;G[8]=X+ha;G[9]=Y-ba;G[10]=1-Z-ca;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function J(G,I,Z,ca,da,ba,ha){const ea=1/(Z-I),W=1/(da-ca),X=1/(ba-ha);G[0]=2*ba*ea;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=2*ba*W;G[6]=0;G[7]=0;G[8]=(Z+I)*ea;G[9]=(da+ca)*W;G[10]=(ha+ba)*X;G[11]=-1;G[12]=0;G[13]=0;G[14]=ha*ba*2*X;G[15]=0;return G}
function Q(G,I,Z,ca,da){I=1/Math.tan(I/2);let ba=void 0;G[0]=I/Z;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=I;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[11]=-1;G[12]=0;G[13]=0;G[15]=0;null!=da&&Infinity!==da?(ba=1/(ca-da),G[10]=(da+ca)*ba,G[14]=2*da*ca*ba):(G[10]=-1,G[14]=-2*ca);return G}function F(G,I,Z,ca){const da=Math.tan(I.upDegrees*Math.PI/180),ba=Math.tan(I.downDegrees*Math.PI/180),ha=Math.tan(I.leftDegrees*Math.PI/180);I=Math.tan(I.rightDegrees*Math.PI/180);const ea=2/(ha+I),W=2/(da+ba);G[0]=ea;G[1]=0;G[2]=0;G[3]=
0;G[4]=0;G[5]=W;G[6]=0;G[7]=0;G[8]=-((ha-I)*ea*.5);G[9]=(da-ba)*W*.5;G[10]=ca/(Z-ca);G[11]=-1;G[12]=0;G[13]=0;G[14]=ca*Z/(Z-ca);G[15]=0;return G}function O(G,I,Z,ca,da,ba,ha){const ea=1/(I-Z),W=1/(ca-da),X=1/(ba-ha);G[0]=-2*ea;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=-2*W;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=2*X;G[11]=0;G[12]=(I+Z)*ea;G[13]=(da+ca)*W;G[14]=(ha+ba)*X;G[15]=1;return G}function V(G,I,Z,ca){let da=void 0,ba=void 0;var ha=void 0,ea=void 0;let W=void 0,X=void 0;var Y=void 0,aa=void 0;let ia=void 0,
ja=void 0;const va=I[0],ma=I[1];I=I[2];ha=ca[0];ea=ca[1];ca=ca[2];Y=Z[0];aa=Z[1];Z=Z[2];if(Math.abs(va-Y)<m.EPSILON&&Math.abs(ma-aa)<m.EPSILON&&Math.abs(I-Z)<m.EPSILON)return A(G);Y=va-Y;aa=ma-aa;ia=I-Z;ja=1/Math.sqrt(Y*Y+aa*aa+ia*ia);Y*=ja;aa*=ja;ia*=ja;da=ea*ia-ca*aa;ba=ca*Y-ha*ia;ha=ha*aa-ea*Y;(ja=Math.sqrt(da*da+ba*ba+ha*ha))?(ja=1/ja,da*=ja,ba*=ja,ha*=ja):ha=ba=da=0;ea=aa*ha-ia*ba;W=ia*da-Y*ha;X=Y*ba-aa*da;(ja=Math.sqrt(ea*ea+W*W+X*X))?(ja=1/ja,ea*=ja,W*=ja,X*=ja):X=W=ea=0;G[0]=da;G[1]=ea;G[2]=
Y;G[3]=0;G[4]=ba;G[5]=W;G[6]=aa;G[7]=0;G[8]=ha;G[9]=X;G[10]=ia;G[11]=0;G[12]=-(da*va+ba*ma+ha*I);G[13]=-(ea*va+W*ma+X*I);G[14]=-(Y*va+aa*ma+ia*I);G[15]=1;return G}function M(G,I,Z,ca){const da=I[0],ba=I[1];I=I[2];var ha=ca[0];const ea=ca[1];var W=ca[2];ca=da-Z[0];let X=ba-Z[1];Z=I-Z[2];let Y=ca*ca+X*X+Z*Z;0<Y&&(Y=1/Math.sqrt(Y),ca*=Y,X*=Y,Z*=Y);let aa=ea*Z-W*X;W=W*ca-ha*Z;ha=ha*X-ea*ca;Y=aa*aa+W*W+ha*ha;0<Y&&(Y=1/Math.sqrt(Y),aa*=Y,W*=Y,ha*=Y);G[0]=aa;G[1]=W;G[2]=ha;G[3]=0;G[4]=X*ha-Z*W;G[5]=Z*aa-
ca*ha;G[6]=ca*W-X*aa;G[7]=0;G[8]=ca;G[9]=X;G[10]=Z;G[11]=0;G[12]=da;G[13]=ba;G[14]=I;G[15]=1;return G}function T(G){return"mat4("+G[0]+", "+G[1]+", "+G[2]+", "+G[3]+", "+G[4]+", "+G[5]+", "+G[6]+", "+G[7]+", "+G[8]+", "+G[9]+", "+G[10]+", "+G[11]+", "+G[12]+", "+G[13]+", "+G[14]+", "+G[15]+")"}function S(G){return Math.sqrt(G[0]**2+G[1]**2+G[2]**2+G[3]**2+G[4]**2+G[5]**2+G[6]**2+G[7]**2+G[8]**2+G[9]**2+G[10]**2+G[11]**2+G[12]**2+G[13]**2+G[14]**2+G[15]**2)}function L(G,I,Z){G[0]=I[0]+Z[0];G[1]=I[1]+
Z[1];G[2]=I[2]+Z[2];G[3]=I[3]+Z[3];G[4]=I[4]+Z[4];G[5]=I[5]+Z[5];G[6]=I[6]+Z[6];G[7]=I[7]+Z[7];G[8]=I[8]+Z[8];G[9]=I[9]+Z[9];G[10]=I[10]+Z[10];G[11]=I[11]+Z[11];G[12]=I[12]+Z[12];G[13]=I[13]+Z[13];G[14]=I[14]+Z[14];G[15]=I[15]+Z[15];return G}function N(G,I,Z){G[0]=I[0]-Z[0];G[1]=I[1]-Z[1];G[2]=I[2]-Z[2];G[3]=I[3]-Z[3];G[4]=I[4]-Z[4];G[5]=I[5]-Z[5];G[6]=I[6]-Z[6];G[7]=I[7]-Z[7];G[8]=I[8]-Z[8];G[9]=I[9]-Z[9];G[10]=I[10]-Z[10];G[11]=I[11]-Z[11];G[12]=I[12]-Z[12];G[13]=I[13]-Z[13];G[14]=I[14]-Z[14];G[15]=
I[15]-Z[15];return G}function U(G,I,Z){G[0]=I[0]*Z;G[1]=I[1]*Z;G[2]=I[2]*Z;G[3]=I[3]*Z;G[4]=I[4]*Z;G[5]=I[5]*Z;G[6]=I[6]*Z;G[7]=I[7]*Z;G[8]=I[8]*Z;G[9]=I[9]*Z;G[10]=I[10]*Z;G[11]=I[11]*Z;G[12]=I[12]*Z;G[13]=I[13]*Z;G[14]=I[14]*Z;G[15]=I[15]*Z;return G}function fa(G,I,Z,ca){G[0]=I[0]+Z[0]*ca;G[1]=I[1]+Z[1]*ca;G[2]=I[2]+Z[2]*ca;G[3]=I[3]+Z[3]*ca;G[4]=I[4]+Z[4]*ca;G[5]=I[5]+Z[5]*ca;G[6]=I[6]+Z[6]*ca;G[7]=I[7]+Z[7]*ca;G[8]=I[8]+Z[8]*ca;G[9]=I[9]+Z[9]*ca;G[10]=I[10]+Z[10]*ca;G[11]=I[11]+Z[11]*ca;G[12]=
I[12]+Z[12]*ca;G[13]=I[13]+Z[13]*ca;G[14]=I[14]+Z[14]*ca;G[15]=I[15]+Z[15]*ca;return G}function ka(G,I){return G[0]===I[0]&&G[1]===I[1]&&G[2]===I[2]&&G[3]===I[3]&&G[4]===I[4]&&G[5]===I[5]&&G[6]===I[6]&&G[7]===I[7]&&G[8]===I[8]&&G[9]===I[9]&&G[10]===I[10]&&G[11]===I[11]&&G[12]===I[12]&&G[13]===I[13]&&G[14]===I[14]&&G[15]===I[15]}function wa(G,I){const Z=G[0],ca=G[1],da=G[2],ba=G[3],ha=G[4],ea=G[5],W=G[6],X=G[7],Y=G[8],aa=G[9],ia=G[10],ja=G[11],va=G[12],ma=G[13],ta=G[14];G=G[15];const sa=I[0],ra=I[1],
na=I[2],ua=I[3],za=I[4],Ca=I[5],Da=I[6],Ia=I[7],Pa=I[8],Oa=I[9],Qa=I[10],Ka=I[11],Ja=I[12],Ha=I[13],Sa=I[14];I=I[15];return Math.abs(Z-sa)<=m.EPSILON*Math.max(1,Math.abs(Z),Math.abs(sa))&&Math.abs(ca-ra)<=m.EPSILON*Math.max(1,Math.abs(ca),Math.abs(ra))&&Math.abs(da-na)<=m.EPSILON*Math.max(1,Math.abs(da),Math.abs(na))&&Math.abs(ba-ua)<=m.EPSILON*Math.max(1,Math.abs(ba),Math.abs(ua))&&Math.abs(ha-za)<=m.EPSILON*Math.max(1,Math.abs(ha),Math.abs(za))&&Math.abs(ea-Ca)<=m.EPSILON*Math.max(1,Math.abs(ea),
Math.abs(Ca))&&Math.abs(W-Da)<=m.EPSILON*Math.max(1,Math.abs(W),Math.abs(Da))&&Math.abs(X-Ia)<=m.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ia))&&Math.abs(Y-Pa)<=m.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Pa))&&Math.abs(aa-Oa)<=m.EPSILON*Math.max(1,Math.abs(aa),Math.abs(Oa))&&Math.abs(ia-Qa)<=m.EPSILON*Math.max(1,Math.abs(ia),Math.abs(Qa))&&Math.abs(ja-Ka)<=m.EPSILON*Math.max(1,Math.abs(ja),Math.abs(Ka))&&Math.abs(va-Ja)<=m.EPSILON*Math.max(1,Math.abs(va),Math.abs(Ja))&&Math.abs(ma-Ha)<=m.EPSILON*Math.max(1,
Math.abs(ma),Math.abs(Ha))&&Math.abs(ta-Sa)<=m.EPSILON*Math.max(1,Math.abs(ta),Math.abs(Sa))&&Math.abs(G-I)<=m.EPSILON*Math.max(1,Math.abs(G),Math.abs(I))}function ya(G){const I=m.EPSILON,Z=G[0],ca=G[1],da=G[2],ba=G[4],ha=G[5],ea=G[6],W=G[8],X=G[9];G=G[10];return Math.abs(1-(Z*Z+ba*ba+W*W))<=I&&Math.abs(1-(ca*ca+ha*ha+X*X))<=I&&Math.abs(1-(da*da+ea*ea+G*G))<=I}const oa=l.create();l=Object.freeze({__proto__:null,copy:z,set:C,identity:A,transpose:g,invert:k,adjoint:w,determinant:u,multiply:x,translate:y,
scale:t,rotate:p,rotateX:q,rotateY:d,rotateZ:a,fromTranslation:c,fromScaling:r,fromRotation:e,fromXRotation:h,fromYRotation:v,fromZRotation:E,fromRotationTranslation:n,fromQuat2:B,getTranslation:f,getScaling:D,getRotation:H,fromRotationTranslationScale:P,fromRotationTranslationScaleOrigin:R,fromQuat:K,frustum:J,perspective:Q,perspectiveFromFieldOfView:F,ortho:O,lookAt:V,targetTo:M,str:T,frob:S,add:L,subtract:N,multiplyScalar:U,multiplyScalarAndAdd:fa,exactEquals:ka,equals:wa,isOrthoNormal:ya,mul:x,
sub:N});b.add=L;b.adjoint=w;b.copy=z;b.determinant=u;b.equals=wa;b.exactEquals=ka;b.frob=S;b.fromQuat=K;b.fromQuat2=B;b.fromRotation=e;b.fromRotationTranslation=n;b.fromRotationTranslationScale=P;b.fromRotationTranslationScaleOrigin=R;b.fromScaling=r;b.fromTranslation=c;b.fromXRotation=h;b.fromYRotation=v;b.fromZRotation=E;b.frustum=J;b.getRotation=H;b.getScaling=D;b.getTranslation=f;b.identity=A;b.invert=k;b.isOrthoNormal=ya;b.lookAt=V;b.mat4=l;b.mul=x;b.multiply=x;b.multiplyScalar=U;b.multiplyScalarAndAdd=
fa;b.ortho=O;b.perspective=Q;b.perspectiveFromFieldOfView=F;b.rotate=p;b.rotateX=q;b.rotateY=d;b.rotateZ=a;b.scale=t;b.set=C;b.str=T;b.sub=N;b.subtract=N;b.targetTo=M;b.translate=y;b.transpose=g})},"esri/geometry/support/ray":function(){define(["exports","../../core/ObjectStack","../../chunks/vec3","../../chunks/vec3f64","./vectorStacks"],function(b,l,m,z,C){function A(u){return u?{origin:z.clone(u.origin),direction:z.clone(u.direction)}:{origin:z.create(),direction:z.create()}}function g(u,x,y=A()){m.copy(y.origin,
u);m.copy(y.direction,x);return y}function k(u,x){u=m.cross(C.sv3d.get(),m.normalize(C.sv3d.get(),u.direction),m.subtract(C.sv3d.get(),x,u.origin));return m.dot(u,u)}const w=new l.ObjectStack(function(){return{origin:null,direction:null}});b.closestPoint=function(u,x,y){x=m.dot(u.direction,m.subtract(y,x,u.origin));m.add(y,u.origin,m.scale(y,u.direction,x));return y};b.copy=function(u,x=A()){return g(u.origin,u.direction,x)};b.create=A;b.distance=function(u,x){return Math.sqrt(k(u,x))};b.distance2=
k;b.fromPoints=function(u,x,y=A()){m.copy(y.origin,u);m.subtract(y.direction,x,u);return y};b.fromValues=g;b.wrap=function(u,x){const y=w.get();y.origin=u;y.direction=x;return y};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/core/ObjectStack":function(){define(["exports","./maybe","./nextTick"],function(b,l,m){let z=function(){function C(g){this.allocator=g;this.items=[];this.itemsPtr=0;this.tickHandle=m.before(()=>this.reset());this.grow()}var A=C.prototype;A.destroy=function(){this.tickHandle&&
(this.tickHandle.remove(),this.tickHandle=l.nullifyNonnullableForDispose(this.tickHandle));this.items=l.nullifyNonnullableForDispose(this.items)};A.get=function(){0===this.itemsPtr&&m(()=>{});this.itemsPtr===this.items.length&&this.grow();return this.items[this.itemsPtr++]};A.reset=function(){this.items.length=Math.min(Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3072),this.items.length);this.itemsPtr=0};A.grow=function(){for(let g=0;g<Math.max(8,Math.min(this.items.length,1024));g++)this.items.push(this.allocator())};
return C}();b.ObjectStack=z;b.default=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],function(b,l){const m=l.VectorStack.createVec2f64(),z=l.VectorStack.createVec3f64(),C=l.VectorStack.createVec4f64(),A=l.VectorStack.createMat3f64(),g=l.VectorStack.createMat4f64();l=l.VectorStack.createQuatf64();b.sm3d=A;b.sm4d=g;b.sq4d=l;b.sv2d=m;b.sv3d=z;b.sv4d=C;Object.defineProperty(b,"__esModule",{value:!0})})},
"esri/core/VectorStack":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./maybe ./nextTick ../chunks/mat3f64 ../chunks/mat4f64 ../chunks/quatf64 ../chunks/vec2f64 ../chunks/vec3f64 ../chunks/vec4f64".split(" "),function(b,l,m,z,C,A,g,k,w,u){let x=function(){function y(p,q,d){this.itemByteSize=p;this.itemCreate=q;this.buffers=[];this.items=[];this.itemsPtr=this.itemsPerBuffer=0;this.itemsPerBuffer=Math.ceil(d/this.itemByteSize);this.tickHandle=z.before(()=>this.reset())}var t=y.prototype;
t.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=m.nullifyNonnullableForDispose(this.tickHandle));this.itemsPtr=0;this.items=m.nullifyNonnullableForDispose(this.items);this.buffers=m.nullifyNonnullableForDispose(this.buffers)};t.get=function(){0===this.itemsPtr&&z(()=>{});const p=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=p;){const q=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let d=0;d<this.itemsPerBuffer;++d)this.items.push(this.itemCreate(q,
d*this.itemByteSize));this.buffers.push(q)}return this.items[this.itemsPtr++]};t.reset=function(){const p=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>p;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0};y.createVec2f64=function(p=4096){return new y(16,k.createView,p)};y.createVec3f64=function(p=4096){return new y(24,w.createView,p)};y.createVec4f64=function(p=4096){return new y(32,u.createView,p)};y.createMat3f64=function(p=
4096){return new y(72,C.createView,p)};y.createMat4f64=function(p=4096){return new y(128,A.createView,p)};y.createQuatf64=function(p=4096){return new y(32,g.createView,p)};l._createClass(y,[{key:"test",get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}]);return y}();b.VectorStack=x;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/mat3f64":function(){define(["exports"],function(b){function l(){return[1,0,0,0,1,0,0,0,1]}function m(g){return[g[0],
g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8]]}function z(g,k,w,u,x,y,t,p,q){return[g,k,w,u,x,y,t,p,q]}function C(g,k){return new Float64Array(g,k,9)}var A=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C});b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.mat3f64=A})},"esri/chunks/mat4f64":function(){define(["exports"],function(b){function l(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function m(k){return[k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],k[8],k[9],k[10],k[11],k[12],k[13],
k[14],k[15]]}function z(k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E){return[k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E]}function C(k,w){return new Float64Array(k,w,16)}const A=l();var g=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C,IDENTITY:A});b.IDENTITY=A;b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.mat4f64=g})},"esri/chunks/quatf64":function(){define(["exports"],function(b){function l(){return[0,0,0,1]}function m(k){return[k[0],k[1],k[2],k[3]]}function z(k,w,u,x){return[k,w,u,x]}function C(k,
w){return new Float64Array(k,w,4)}const A=l();var g=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C,IDENTITY:A});b.IDENTITY=A;b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.quatf64=g})},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec3","../../chunks/vec3f64"],function(b,l,m,z){const C=z.create(),A=z.create();b.angle=function(g,k){g=m.dot(g,k)/(m.length(g)*m.length(k));return-l.acosClamped(g)};b.angleAroundAxis=function(g,
k,w){m.normalize(C,g);m.normalize(A,k);g=m.dot(C,A);g=l.acosClamped(g);k=m.cross(C,C,A);return 0>m.dot(k,w)?2*Math.PI-g:g};b.projectPoint=function(g,k,w){k=m.dot(g,k)/m.dot(g,g);return m.scale(w,g,k)};b.projectPointSignedLength=function(g,k){return m.dot(g,k)/m.length(g)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(b,l,m,z){function C(t,p){return t[0]*
p[1]-t[1]*p[0]}function A(t,p,q){p=m.dot(q,p)/m.squaredLength(q);return m.scale(t,q,p)}function g(t,p,q,d,a=q){m.subtract(w,d,q);m.subtract(x,p,a);A(y,x,w);return m.add(t,a,y)}function k(t,p,q,d){m.subtract(w,p,q);p=d/m.length(w);return m.scaleAndAdd(t,q,w,p)}const w=z.create(),u=z.create(),x=z.create(),y=z.create();b.cross=C;b.intersectCircleAndPoint=function(t,p,q){k(x,q,t,p);return l.floatEqualAbsolute(x[0],q[0])&&l.floatEqualAbsolute(x[1],q[1])?[z.clone(q)]:[]};b.intersectLineAndPoint=function(t,
p){g(x,p,t.start,t.end);return l.floatEqualAbsolute(x[0],p[0])&&l.floatEqualAbsolute(x[1],p[1])?[z.clone(p)]:[]};b.intersectLineAndRay=function(t,p){const q=t.start;var d=p.start,a=p.end;const c=m.subtract(w,t.end,q);var r=m.subtract(u,a,d);a=C(c,r);if(1E-6>=Math.abs(a))return[];d=m.subtract(x,q,d);r=C(r,d)/a;a=C(c,d)/a;if(0<=r){if(0<=a||1===p.type)return[m.scaleAndAdd(y,q,c,r)]}else if(1===t.type&&(0<=a||1===p.type))return[m.scaleAndAdd(y,q,c,r)];return[]};b.intersectLineLikeAndCircle=function(t,
p,q){const d=[],a=m.subtract(w,t.end,t.start);var c=m.subtract(u,t.start,p);p=m.squaredLength(a);const r=2*m.dot(a,c);q=m.squaredLength(c)-q*q;q=r*r-4*p*q;0===q?(p=-r/(2*p),(1===t.type||0<=p)&&d.push(m.scaleAndAdd(y,t.start,a,p))):0<q&&(q=Math.sqrt(q),c=(-r+q)/(2*p),(1===t.type||0<=c)&&d.push(m.scaleAndAdd(y,t.start,a,c)),p=(-r-q)/(2*p),(1===t.type||0<=p)&&d.push(m.scaleAndAdd(x,t.start,a,p)));return d};b.pointToLineDistance=function(t,p,q){return Math.abs((p[0]-t[0])*(q[1]-t[1])-(p[1]-t[1])*(q[0]-
t[0]))/m.distance(p,q)};b.projectPoint=A;b.projectPointToCircle=k;b.projectPointToLine=g;b.projectPointToRay=function(t,p,q,d){m.subtract(w,d,q);m.subtract(x,p,q);p=m.dot(w,x)/m.squaredLength(w);return 0<p?m.scaleAndAdd(t,q,w,p):m.copy(t,q)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/arrayUtils","./UpdateVertices"],function(b,l,m,z){z=
function(C){function A(k,w,u,x=0){k=C.call(this,k)||this;k.origin=w;k.angle=u;k.accumulationType=x;return k}l._inheritsLoose(A,C);var g=A.prototype;g.rotate=function(k,w){this.helper.rotate(k.pos,this.origin,w)};g.apply=function(k){this.rotate(k,this.angle)};g.undo=function(k){this.rotate(k,-this.angle)};g.canAccumulate=function(k){return k instanceof A&&m.equals(this.origin,k.origin)};g.accumulate=function(k,w){this.rotate(k,1===w.accumulationType?w.angle-this.angle:w.angle)};g.accumulateParams=
function(k){this.angle=1===k.accumulationType?k.angle:this.angle+k.angle};return A}(z.PerVertexOperation);b.RotateVertex=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/arrayUtils ../../../../chunks/vec2 ../../../../chunks/vec2f64 ./UpdateVertices".split(" "),function(b,l,m,z,C,A){A=function(g){function k(u,x,y,t,p,q=0){u=g.call(this,u)||this;
u.origin=x;u.axis1=y;u.factor1=t;u.factor2=p;u.accumulationType=q;u.axis2=z.set(C.create(),y[1],-y[0]);return u}l._inheritsLoose(k,g);var w=k.prototype;w.scale=function(u,x,y){this.helper.scale(u.pos,this.origin,this.axis1,x);this.helper.scale(u.pos,this.origin,this.axis2,y)};w.apply=function(u){this.scale(u,this.factor1,this.factor2)};w.undo=function(u){this.scale(u,1/this.factor1,1/this.factor2)};w.canAccumulate=function(u){return u instanceof k&&m.equals(this.origin,u.origin)&&m.equals(this.axis1,
u.axis1)};w.accumulate=function(u,x){1===x.accumulationType?this.scale(u,x.factor1/this.factor1,x.factor2/this.factor2):this.scale(u,x.factor1,x.factor2)};w.accumulateParams=function(u){const x=1===u.accumulationType;this.factor1=x?u.factor1:this.factor1*u.factor1;this.factor2=x?u.factor2:this.factor2*u.factor2};return k}(A.PerVertexOperation);b.ScaleVertex=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/editGeometry/operations/UndoGroup":function(){define(["exports"],
function(b){let l=function(){function m(){this.operations=[];this.closed=!1}var z=m.prototype;z.close=function(){this.closed=!0};z.apply=function(){for(const C of this.operations)C.apply()};z.undo=function(){for(let C=this.operations.length-1;0<=C;C--)this.operations[C].undo()};z.accumulate=function(C){if(this.closed)return!1;const A=this.operations.length?this.operations[this.operations.length-1]:null;A&&A.accumulate(C)||(this.operations.push(C),C.apply());return!0};return m}();b.UndoGroup=l;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingContext":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers"],function(b,l){let m=function(){function z(C){this.visualizer=this.excludeFeature=this.vertexHandle=null;this.geometry=C.geometry;this.elevationInfo=C.elevationInfo;this.pointer=C.pointer;this.vertexHandle=C.vertexHandle;this.excludeFeature=C.excludeFeature;this.visualizer=C.visualizer}l._createClass(z,[{key:"coordinateHelper",get:function(){return this.geometry.editGeometry.coordinateHelper}}]);
return z}();b.SnappingContext=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/input/DrawEvents":function(){define(["exports"],function(b){let l=function(){function g(k,w,u,x){this.view=k;this.native=w;this.vertexIndex=u;this.vertices=x;this.defaultPrevented=!1;this.type="vertex-add"}g.prototype.preventDefault=function(){this.defaultPrevented=!0};return g}(),m=function(){function g(k,w,u,x){this.view=k;this.native=w;this.vertexIndex=u;this.vertices=x;this.defaultPrevented=!1;
this.type="vertex-update"}g.prototype.preventDefault=function(){this.defaultPrevented=!0};return g}(),z=function(){function g(k,w,u,x){this.view=k;this.native=w;this.vertexIndex=u;this.vertices=x;this.defaultPrevented=!1;this.type="vertex-remove"}g.prototype.preventDefault=function(){this.defaultPrevented=!0};return g}(),C=function(){function g(k,w,u,x,y=null){this.view=k;this.native=w;this.vertexIndex=u;this.vertices=x;this.mapPoint=y;this.coordinates=null;this.defaultPrevented=!1;this.type="cursor-update";
this.coordinates=1===x.length?x[0]:null}g.prototype.preventDefault=function(){this.defaultPrevented=!0};return g}(),A=function(){function g(k,w){this.native=k;this.vertices=w;this.coordinates=null;this.defaultPrevented=!1;this.type="draw-complete";this.coordinates=1===w.length?w[0]:null}g.prototype.preventDefault=function(){this.defaultPrevented=!0};return g}();b.CursorUpdateEvent=C;b.DrawCompleteEvent=A;b.VertexAddEvent=l;b.VertexRemoveEvent=z;b.VertexUpdateEvent=m;Object.defineProperty(b,"__esModule",
{value:!0})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(b){b.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/PointDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/deprecate ../../core/Handles ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ../input/InputManager ../interactive/keybindings ../support/screenUtils ../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e){b.PointDrawAction=function(h){function v(n){n=h.call(this,n)||this;n._addVertexOnPointerUp=!1;n._activePointerId=null;n._viewHandles=new A;return n}l._inheritsLoose(v,h);var E=v.prototype;E.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};E.destroy=function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};E.complete=function(){"2d"===
this.view.type?this._cursorScreenPoint&&this._completeDrawing():this._drawTool.completeCreateOperation()};E._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("pointer-down",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=k.abortMaybe(this._snappingTask),this._activePointerId=n.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=r.createScreenPointFromEvent(n),"touch"===n.pointerType&&this._updateCursor(n.native))},a.ViewEventPriorities.TOOL),
this.view.on("pointer-move",n=>{this._snappingTask=k.abortMaybe(this._snappingTask);this._cursorScreenPoint=r.createScreenPointFromEvent(n);"touch"!==n.pointerType&&this._updateCursor(n.native)},a.ViewEventPriorities.TOOL),this.view.on("pointer-drag",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=k.abortMaybe(this._snappingTask),this._addVertexOnPointerUp=!1)},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=k.abortMaybe(this._snappingTask),
this._activePointerId=null,this._addVertexOnPointerUp?(n.stopPropagation(),this._vertexAddHandler(n)):this._updateCursor(n.native,"touch"===n.pointerType))},a.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],n=>{n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("key-down",n=>{n.key===c.SKETCH_KEYS.complete&&this._cursorScreenPoint&&(this._snappingTask=k.abortMaybe(this._snappingTask),this._vertexAddHandler(n))},a.ViewEventPriorities.TOOL)])};E._removeViewHandles=function(){this._viewHandles.removeAll()};
E._addDrawTool=function(n){this._drawTool=new p.DrawTool({view:n,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("cursor-update",B=>{1===B.vertices.length&&this.emit("cursor-update",new d.CursorUpdateEvent(this.view,null,B.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",B=>{this.emit("draw-complete",new d.DrawCompleteEvent(null,
this._drawTool.getVertexCoords()));this._removeDrawTool()})};E._removeDrawTool=function(){k.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};E._addVertex=function(n){n=this._coordinateHelper.fromArray(n);this._isDuplicateOfLastVertex(n)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(n),this.notifyChange("vertices"),this._completeDrawing())};E._updateCursor=function(n,B=!1){this._popCursorVertex();
if(this._cursorScreenPoint){var f=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(k.isSome(f)&&!B){this._pushCursorVertex(f.vertex);const D=()=>new d.CursorUpdateEvent(this.view,n,this._activeComponent.vertices.length,this.vertices,k.isSome(this._stagedVertex)?new e(this._stagedVertex):null);this.emit("cursor-update",D());k.isSome(this._snappingTask)&&this._snappingTask.promise.then(H=>{H.valid&&this.emit("cursor-update",D())},()=>{})}}};E._completeDrawing=function(n){this._activePointerId=
null;this._popCursorVertex();this._snappingTask=k.abortMaybe(this._snappingTask);k.isSome(this._snappingManager)&&this._snappingManager.doneSnapping();n=new d.DrawCompleteEvent(n,this.vertices);this.emit("draw-complete",n);n.defaultPrevented||this._removeViewHandles()};E._shouldHandlePointerEvent=function(n){return("mouse"!==n.pointerType||0===n.button)&&(k.isNone(this._activePointerId)||this._activePointerId===n.pointerId)};l._createClass(v,[{key:"coordinates",get:function(){C.deprecatedProperty(g.getLogger("esri.views.draw.PointDrawAction"),
"coordinates",{replacement:"vertices",version:"4.19"});return this.vertices[0]}}]);return v}(q);m.__decorate([w.property({readOnly:!0})],b.PointDrawAction.prototype,"coordinates",null);b.PointDrawAction=m.__decorate([t.subclass("esri.views.draw.PointDrawAction")],b.PointDrawAction);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawTool":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/Logger ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ./DrawOperation ./drawSurfaces ../../../../interactive/InteractiveToolBase".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){b.DrawTool=function(q){function d(c){c=q.call(this,c)||this;c.drawOperation=null;c.hasZ=!0;c.defaultZ=0;c.elevationInfo=null;c.snapToScene=null;c.mode=null;c.geometryType=null;c.type="draw-3d";return c}l._inheritsLoose(d,q);var a=d.prototype;a.initialize=function(){const c=C.unwrapOr(this.elevationInfo,{mode:this.hasZ?"absolute-height":"on-the-ground",offset:0});this.drawOperation=new y.DrawOperation({view:this.view,manipulators:this.manipulators,geometryType:this.geometryType,
drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,sceneDrawSurface:new t.SceneDrawSurface(this.view,c),elevationDrawSurface:new t.ElevationDrawSurface(c,this.defaultZ,this.view),hasM:!1,elevationInfo:c});this.drawOperation.on("vertex-add",r=>this.onVertexAdd(r));this.drawOperation.on("vertex-remove",r=>this.onVertexRemove(r));this.drawOperation.on("vertex-update",r=>this.onVertexUpdate(r));this.drawOperation.on("cursor-update",r=>this.onCursorUpdate(r));
this.drawOperation.on("complete",r=>this.onComplete(r));this.complete()};a.destroy=function(){this.drawOperation.destroy();this.drawOperation=null;this._set("view",null)};a.onInputEvent=function(c){this.drawOperation.onInputEvent(c)};a.reset=function(){};a.redo=function(){this.drawOperation.redo()};a.undo=function(){this.drawOperation.undo()};a.completeCreateOperation=function(){this.drawOperation.complete()};a.activate=function(){};a.deactivate=function(){this.drawOperation.isCompleted||this.drawOperation.cancel()};
a.getVertexCoords=function(){return this.drawOperation.vertices};a.onVertexAdd=function(c){this.emit("vertex-add",c)};a.onVertexRemove=function(c){this.emit("vertex-remove",c)};a.onVertexUpdate=function(c){this.emit("vertex-update",c)};a.onCursorUpdate=function(c){this.emit("cursor-update",c)};a.onComplete=function(c){this.emit("complete",c)};l._createClass(d,[{key:"updating",get:function(){var c,r;return null!=(c=null==(r=this.drawOperation)?void 0:r.updating)?c:!1}},{key:"enabled",set:function(c){this.drawOperation.interactive=
c;this._set("enabled",c)}},{key:"canRedo",get:function(){return this.drawOperation.canRedo}},{key:"canUndo",get:function(){return this.drawOperation.canUndo}}]);return d}(z.EventedMixin(p.InteractiveToolBase));m.__decorate([A.property()],b.DrawTool.prototype,"drawOperation",void 0);m.__decorate([A.property({readOnly:!0})],b.DrawTool.prototype,"updating",null);m.__decorate([A.property({constructOnly:!0,nonNullable:!0})],b.DrawTool.prototype,"view",void 0);m.__decorate([A.property({value:!0})],b.DrawTool.prototype,
"enabled",null);m.__decorate([A.property({constructOnly:!0})],b.DrawTool.prototype,"hasZ",void 0);m.__decorate([A.property({constructOnly:!0,nonNullable:!0})],b.DrawTool.prototype,"defaultZ",void 0);m.__decorate([A.property({constructOnly:!0})],b.DrawTool.prototype,"elevationInfo",void 0);m.__decorate([A.property()],b.DrawTool.prototype,"snapToScene",void 0);m.__decorate([A.property({constructOnly:!0})],b.DrawTool.prototype,"mode",void 0);m.__decorate([A.property({constructOnly:!0})],b.DrawTool.prototype,
"geometryType",void 0);m.__decorate([A.property({readOnly:!0})],b.DrawTool.prototype,"type",void 0);b.DrawTool=m.__decorate([x.subclass("esri.views.3d.interactive.editingTools.draw.DrawTool")],b.DrawTool);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawOperation":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Evented ../../../../../core/HandleOwner ../../../../../core/Handles ../../../../../core/lang ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/has ../../../../../core/Logger ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/dehydratedFeatureComparison ../../SnappingDragPipelineStep ../../SnappingVisualizer3D ./DrawManipulator ../../../../draw/DrawingMode ../../../../interactive/coordinateHelper ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/EditGeometryHelper ../../../../interactive/snapping/SnappingContext ../../../../support/Scheduler ../../../../interactive/editGeometry/EditGeometry ../../../../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E,n,B,f,D,H,P){b.DrawOperation=function(K){function J(F){F=K.call(this,F)||this;F._manipulator=null;F._stagedVertex=null;F.elevationInfo=null;F.snapToSceneEnabled=null;F._handles=new g;F._snappingPipeline=new r.SnappingPipeline;F._createOperationCompleted=!1;F._pointerDownStates=new Set;F._snappingTask=null;return F}l._inheritsLoose(J,K);var Q=J.prototype;Q.initialize=function(){var F,O;this.coordinateHelper=E.createCoordinateHelper(this.hasZ,this.hasM,
this.view.spatialReference,this.view.viewingMode);var V=null==(F=this.view)?void 0:null==(O=F.resourceController)?void 0:O.scheduler;this._frameTask=V?V.registerTask(D.TaskPriority.SNAPPING):D.ImmediateTask;this._editGeometry=new B.EditGeometryHelper(new H.EditGeometry(this.coordinateHelper),"segment"===this.geometryType?"polyline":this.geometryType);this._activeComponent=new H.Component(this._editGeometry.editGeometry);this._editGeometry.editGeometry.components.push(this._activeComponent);this._editGeometry.on(["vertex-add",
"vertex-update","vertex-remove"],M=>{const T=M.vertices.map(L=>({componentIndex:0,vertexIndex:L.index,coordinates:this.coordinateHelper.toArray(L.pos)})),S=T.map(L=>L.coordinates);switch(M.type){case "vertex-add":this.emit(M.type,{...M,added:S,vertices:T});break;case "vertex-update":this.emit(M.type,{...M,updated:S,vertices:T});break;case "vertex-remove":this.emit(M.type,{...M,removed:S,vertices:T})}});this._manipulator=new h.DrawManipulator({grabbableForEvent:M=>"click"!==this.drawingMode?!0:"touch"===
M.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(this._manipulator);this._manipulator.grabbable="point"!==this.geometryType;F=this.createManipulatorDragPipeline(this._manipulator);O=this._manipulator.events.on("immediate-double-click",M=>{this._manipulator.dragging||"point"===this.geometryType||(this.complete(),M.stopPropagation())});V=this._manipulator.events.on("immediate-click",M=>{if(!this._manipulator.dragging){var T=this._activeComponent,S=this._closeOnClickVertexIndex(M.screenPoint);
if(w.isSome(S))this.discardStagedVertex(),this.complete();else if(S=this._screenToMap(M.screenPoint),w.isSome(S))switch(this.drawingMode){case "freehand":"point"===this.geometryType&&(this.hasStagedVertex?this.commitStagedVertex():this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(S)),this.complete());break;case "click":case "hybrid":this._snappingTask=w.abortMaybe(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(S)),
("point"===this.geometryType||"segment"===this.geometryType&&2===T.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===T.vertices.length)&&this.complete()}M.stopPropagation()}});this._handles.add([F,V,O])};Q.createManipulatorDragPipeline=function(F){switch(this.drawingMode){case "click":return this.createManipulatorDragPipelineClick(F);case "freehand":return this.createManipulatorDragPipelineFreehand(F);case "hybrid":return this.createManipulatorDragPipelineHybrid(F)}};
Q.createManipulatorDragPipelineClick=function(F){return n.createManipulatorDragEventPipeline(F,(O,V,M,T)=>{const S="touch"===T&&this._snappingEnabled;!this.isCompleted&&S&&(V.next(this._screenToMapDragEventStep()).next(L=>{"start"===L.action&&(this.stagedVertex=L.mapStart,("segment"===this.geometryType||S&&0===this.numVertices)&&this.commitStagedVertex());return L}).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>S,cancel:M,snappingManager:this.snappingManager,snappingContext:new f.SnappingContext({geometry:this._editGeometry,
elevationInfo:this.elevationInfo,pointer:T,visualizer:new e.SnappingVisualizer3D}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next(L=>{S&&(this.stagedVertex=L.mapEnd,"end"===L.action&&this.commitStagedVertex());return L}).next(L=>{"end"!==L.action||"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete();return L}),M.next(()=>{S&&w.isSome(this.snappingManager)&&this.snappingManager.doneSnapping()}))})};Q.createManipulatorDragPipelineFreehand=function(F){return n.createManipulatorDragEventPipeline(F,
(O,V)=>{this.isCompleted||V.next(this._screenToMapDragEventStep()).next(M=>{"start"===M.action&&(this.stagedVertex=M.mapStart,"segment"===this.geometryType&&this.commitStagedVertex());return M}).next(M=>{switch(M.action){case "start":case "update":this.stagedVertex=M.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return M})})};Q.createManipulatorDragPipelineHybrid=function(F){return n.createManipulatorDragEventPipeline(F,
(O,V)=>{this.isCompleted||V.next(this._screenToMapDragEventStep()).next(M=>{"start"===M.action&&(this.stagedVertex=M.mapStart,this.commitStagedVertex());return M}).next(M=>{switch(M.action){case "start":case "update":this.stagedVertex=M.mapEnd;"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return M})})};Q.destroy=function(){this._handles.destroy();this._handles=null;
this._editGeometry.destroy();this._frameTask.remove()};Q.onInputEvent=function(F){switch(F.type){case "pointer-down":this._pointerDownStates.add(F.pointerId);break;case "pointer-up":this._pointerDownStates.delete(F.pointerId)}switch(F.type){case "pointer-move":return this._onPointerMove(F);case "hold":return this._onHold(F)}};Q.redo=function(){this._editGeometry.redo()};Q.undo=function(){w.isSome(this.snappingManager)&&this.snappingManager.doneSnapping();this._editGeometry.undo()};Q.complete=function(F=
!1){w.abortMaybe(this._snappingTask);w.isSome(this.snappingManager)&&this.snappingManager.doneSnapping();"polyline"===this.geometryType||"polygon"===this.geometryType?this.discardStagedVertex():this.commitStagedVertex();this._createOperationCompleted=!("polyline"===this.geometryType&&2>this.numVertices||"polygon"===this.geometryType&&3>this.numVertices);(this.isCompleted||F)&&this.emit("complete",{vertices:this.vertices.map((O,V)=>({componentIndex:0,vertexIndex:V,coordinates:O})),aborted:F,type:"complete"})};
Q.cancel=function(){this.complete(!0)};Q.commitStagedVertex=function(){this._snappingTask=w.abortMaybe(this._snappingTask);if(w.isSome(this._stagedVertex)){const F=this._stagedVertex;this._stagedVertex=null;this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(F))}};Q.discardStagedVertex=function(){this._stagedVertex=null};Q._onPointerMove=function(F){var O=this;w.abortMaybe(this._snappingTask);if(!(this._manipulator.dragging||this._pointerDownStates.has(F.pointerId)||this._manipulator.grabbing)&&
this._manipulator.interactive){var V=x.createScreenPoint(F.x,F.y),M=this._closeOnClickVertexIndex(V);if(w.isSome(M))this.discardStagedVertex(),V={componentIndex:0,vertexIndex:M,coordinates:this.coordinateHelper.toArray(this._activeComponent.vertices[M].pos)},this.emit("cursor-update",{updated:null,vertices:[V],operation:"apply",type:"vertex-update"});else{const T=this._screenToMap(V);this._manipulator.cursor=w.isSome(T)?"crosshair":null;if(w.isSome(T))if(w.isSome(this.snappingManager)){const S=this.snappingManager,
L=new f.SnappingContext({geometry:this._editGeometry,elevationInfo:this.elevationInfo,pointer:F.pointerType,visualizer:new e.SnappingVisualizer3D});this.stagedVertex=S.update(T,L);this._snappingTask=u.createTask(function(){var N=l._asyncToGenerator(function*(U){const fa=yield O._frameTask.schedule(()=>S.snap(T,L,U),U);fa.valid&&(yield O._frameTask.schedule(()=>{O.stagedVertex=fa.apply()},U))});return function(U){return N.apply(this,arguments)}}());this.updatingHandles.addPromise(this._snappingTask.promise)}else this.stagedVertex=
T}F.stopPropagation()}};Q._onHold=function(F){w.abortMaybe(this._snappingTask);"click"===this.drawingMode&&"touch"===F.pointerType&&this._snappingEnabled&&(this.stagedVertex=F.mapPoint);F.stopPropagation()};Q._screenToMapDragEventStep=function(){let F=null;return O=>{"start"===O.action&&(F=this._screenToMap(O.screenStart));if(w.isNone(F))return null;const V=this._screenToMap(O.screenEnd);return w.isSome(V)?{...O,mapStart:F,mapEnd:V}:null}};Q._screenToMap=function(F){return this._getDrawSurface().screenToMap(F)};
Q._mapToScreen=function(F){return this._getDrawSurface().mapToScreen(F)};Q._getDrawSurface=function(){if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let F=this.defaultZ,O=!1;w.isSome(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(O=!0);w.isSome(this.snapToSceneEnabled)&&(O=this.snapToSceneEnabled);w.isSome(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(O=!1);const V=this._activeComponent.vertices.length;
("segment"===this.geometryType||"polygon"===this.geometryType)&&0<V&&(F=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),O=!1);if(O)return this.sceneDrawSurface;this.elevationDrawSurface.defaultZ=F;return this.elevationDrawSurface};Q._vertexWithinPointerDistance=function(F,O){const V=this._mapToScreen(F);w.isSome(V)?(F=V.x-O.x,O=V.y-O.y,O=25>=F*F+O*O):O=!1;return O};Q._closeOnClickVertexIndex=function(F){const O=this._activeComponent;if("polygon"===this.geometryType&&2<O.vertices.length){if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(O.vertices[0].pos,
R),F))return 0;if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(O.vertices[O.vertices.length-1].pos,R),F))return O.vertices.length-1}return null};l._createClass(J,[{key:"drawingMode",set:function(F){this._set("drawingMode",null!=F?F:v.defaultDrawingMode)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"_snappingEnabled",get:function(){return w.isSome(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}},
{key:"canRedo",get:function(){return this._editGeometry.canRedo}},{key:"canUndo",get:function(){return this._editGeometry.canUndo}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(F){this._manipulator.interactive=F}},{key:"numVertices",get:function(){return w.isSome(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"vertices",
get:function(){const F=this.committedVertices;w.isSome(this._stagedVertex)&&F.push(this.coordinateHelper.pointToArray(this._stagedVertex));return F}},{key:"committedVertices",get:function(){return this._activeComponent.vertices.map(F=>this.coordinateHelper.toArray(F.pos))}},{key:"spatialReference",get:function(){return this.view.spatialReference}},{key:"hasStagedVertex",get:function(){return w.isSome(this._stagedVertex)}},{key:"stagedVertex",get:function(){return this._stagedVertex},set:function(F){if(w.isNone(F))this.discardStagedVertex();
else{if(w.isNone(this._stagedVertex))this._stagedVertex=k.clone(F);else{if(c.pointEquals(this._stagedVertex,F))return;this._stagedVertex.x=F.x;this._stagedVertex.y=F.y;this._stagedVertex.z=F.z;this._stagedVertex.m=F.m;this._stagedVertex.hasZ=F.hasZ;this._stagedVertex.hasM=F.hasM;this._stagedVertex.spatialReference=F.spatialReference}this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(F)}],
operation:"apply",type:"vertex-update"})}}}]);return J}(C.EventedMixin(A.HandleOwner));m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"view",void 0);m.__decorate([y.property({value:v.defaultDrawingMode})],b.DrawOperation.prototype,"drawingMode",null);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"geometryType",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"elevationInfo",void 0);m.__decorate([y.property()],b.DrawOperation.prototype,
"snapToSceneEnabled",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"manipulators",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"hasZ",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"hasM",void 0);m.__decorate([y.property()],b.DrawOperation.prototype,"defaultZ",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"sceneDrawSurface",void 0);m.__decorate([y.property({constructOnly:!0})],
b.DrawOperation.prototype,"elevationDrawSurface",void 0);m.__decorate([y.property({constructOnly:!0})],b.DrawOperation.prototype,"snappingManager",void 0);m.__decorate([y.property({readOnly:!0})],b.DrawOperation.prototype,"updating",null);b.DrawOperation=m.__decorate([a.subclass("esri.views.3d.interactive.editingTools.draw3D.DrawOperation")],b.DrawOperation);const R=new P({x:0,y:0,z:0});Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/SnappingDragPipelineStep":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../layers/graphics/dehydratedFeatureComparison ../../interactive/dragEventPipeline ../../interactive/snapping/SnappingContext ../../support/Scheduler".split(" "),
function(b,l,m,z,C,A,g,k){let w=function(){function u(){this.next=new A.EventPipeline}u.prototype.createSnapDragEventPipelineStep=function({predicate:x=()=>!0,cancel:y,snappingManager:t,snappingContext:p,updatingHandles:q}){var d=this;if(m.isNone(t))return e=>e;let a=null,c=null;const r=()=>{a=m.abortMaybe(a);t.doneSnapping();m.isSome(c)&&c.frameTask.remove();c=null};y.next(e=>{r();return e});this.next=new A.EventPipeline;return e=>{if(!x(e))return e;a=m.abortMaybe(a);if("start"===e.action){const h=
"3d"===t.view.type?t.view.resourceController.scheduler.registerTask(k.TaskPriority.SNAPPING):k.ImmediateTask;c={context:new g.SnappingContext({geometry:p.geometry,elevationInfo:p.elevationInfo,pointer:p.pointer,vertexHandle:m.isSome(e.info)?e.info.handle:null,excludeFeature:p.excludeFeature,visualizer:p.visualizer}),originalPos:m.isSome(e.snapOrigin)?p.coordinateHelper.createDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:h}}if(m.isSome(c)){const h=c.context.coordinateHelper.createDehydratedPoint(c.context.coordinateHelper.fromArray([c.originalPos.x,
c.originalPos.y,c.originalPos.z]));h.x+=e.mapEnd.x-e.mapStart.x;h.y+=e.mapEnd.y-e.mapStart.y;const v=e.mapStart.x-c.originalPos.x,E=e.mapStart.y-c.originalPos.y,n={...e,action:"udpate"},B=c.context,f=t.update(h,c.context);e.mapEnd.x=f.x+v;e.mapEnd.y=f.y+E;if("end"!==e.action){const D=c.frameTask;a=z.createTask(function(){var H=l._asyncToGenerator(function*(P){const R=yield D.schedule(()=>t.snap(h,B,P),P);if(R.valid){const K=yield D.schedule(()=>R.apply(),P);C.pointEquals(K,f)||(n.mapEnd.x=K.x+v,n.mapEnd.y=
K.y+E,d.next.execute(n))}});return function(P){return H.apply(this,arguments)}}());q.addPromise(a.promise)}}"end"===e.action&&r();return e}};return u}();b.SnappingPipeline=w;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../core/handleUtils ../../core/lang ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../geometry/projection ../draw/support/drawUtils".split(" "),function(b,l,m,z,C,A,
g,k,w){function u(h,v){let E=null,n=null;return B=>{if("cancel"===B.action)C.isSome(n)&&(n.execute({action:"cancel"}),n=E=null);else{var f={action:B.action,screenStart:B.start,screenEnd:B.screenPoint};"start"===B.action&&C.isNone(E)&&(E=new e,n=new e,v(h,E,n,B.pointerType,f));C.isSome(E)&&E.execute(f);"end"===B.action&&C.isSome(E)&&(n=E=null)}}}function x(h,v){return h.events.on("drag",u(h,v))}function y(h,v){let E=null;return n=>{"start"===n.action&&(E=p(h,n.mapStart.spatialReference,v));if(C.isNone(E))return null;
const B=n.mapEnd.x-n.mapStart.x,f=n.mapEnd.y-n.mapStart.y,D=n.mapEnd.z-n.mapStart.z;E.move(B,f,D);return{...n,translationX:B,translationY:f,translationZ:D}}}function t(h,v){return C.isNone(h)?null:h.spatialReference.equals(v)?h.clone():k.project(h,v)}function p(h,v,E){const n=h.geometry;if(C.isNone(n))return null;if("mesh"===n.type)return q(h,n,v,E);const B=t(n,v),f=n.spatialReference;return C.isNone(B)?null:{move:(D,H,P)=>{D=w.move(B.clone(),D,H,P);D.spatialReference.equals(f)?h.geometry=D:h.geometry=
k.project(D,f)}}}function q(h,v,E,n){if(C.isSome(v.transform))return d(h,v,v.transform,E);if(!v.spatialReference.equals(E))return null;let B=0,f=0,D=0;return{move:(H,P,R)=>{var K=H-B;const J=P-f,Q=R-D;if(K||J||Q)K=v.origin.clone().offset(K,J,Q),v.centerAt(K,{geographic:1===n}),h.notifyGeometryChanged(),B=H,f=P,D=R}}}function d(h,v,E,n){const B=E.getOriginPoint(v.spatialReference),f=t(B,n),D=v.spatialReference;return C.isNone(f)?null:{move:(H,P,R)=>{H=w.move(f.clone(),H,P,R);H.spatialReference.equals(D)?
E.origin=g.fromValues(H.x,H.y,H.z):(H=k.project(H,D),C.isSome(H)&&(E.origin=g.fromValues(H.x,H.y,H.z)));h.notifyGeometryChanged()}}}function a(h,v){const E=new Map;for(const n of v)E.set(n,m.clone(h[n]));return n=>{E.forEach((B,f)=>{h[f]=B});return n}}function c(h){return C.isSome(h.geometry)&&"mesh"===h.geometry.type?r(h,h.geometry):a(h,["geometry"])}function r(h,v){const E=C.isSome(v.transform)?v.transform.clone():null,n=v.vertexAttributes.clonePositional();return B=>{v.transform=E;v.vertexAttributes=
n;h.notifyGeometryChanged();return B}}let e=function(){function h(){this.execute=()=>{}}h.prototype.next=function(v,E=new h){C.isSome(v)&&(this.execute=n=>{n=v(n);C.isSome(n)&&E.execute(n)});return E};return h}();b.EventPipeline=e;b.addMapDelta=function(){let h=0,v=0,E=0;return n=>{"start"===n.action&&(h=n.mapStart.x,v=n.mapStart.y,E=n.mapStart.z);const B=n.mapEnd.x-h,f=n.mapEnd.y-v,D=n.mapEnd.z-E;h=n.mapEnd.x;v=n.mapEnd.y;E=n.mapEnd.z;return{...n,mapDeltaX:B,mapDeltaY:f,mapDeltaZ:D,mapDeltaSpatialReference:n.mapStart.spatialReference}}};
b.addScreenDelta=function(){let h=0,v=0;return E=>{"start"===E.action&&(h=E.screenStart.x,v=E.screenStart.y);const n=E.screenEnd.x-h,B=E.screenEnd.y-v;h=E.screenEnd.x;v=E.screenEnd.y;return{...E,screenDeltaX:n,screenDeltaY:B}}};b.constrainToMapAxis=function(h,v){const E=[h.x,h.y,h.z],n=[Math.cos(v),Math.sin(v)];h=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(0===h)return null;n[0]/=h;n[1]/=h;const B=f=>{const D=(f.x-E[0])*n[0]+(f.y-E[1])*n[1];f.x=E[0]+D*n[0];f.y=E[1]+D*n[1]};return f=>{B(f.mapStart);B(f.mapEnd);
return f}};b.createDragEventPipelineCallback=u;b.createManipulatorDragEventPipeline=x;b.createManipulatorDragEventPipelineMany=function(h,v){const E=[];for(const n of h)E.push(x(n,v));return l.handlesGroup(E)};b.dragAtLocation=function(h,v){let E=null,n=0,B=0;return f=>{"start"===f.action&&(E=h.toScreen(v),0>E.x||E.x>h.width||0>E.y||E.y>h.height?E=null:(n=f.screenStart.x-E.x,B=f.screenStart.y-E.y));if(null==E)return null;var D=z.clamp(f.screenEnd.x-n,0,h.width);const H=z.clamp(f.screenEnd.y-B,0,h.height);
D=A.createScreenPoint(D,H);f.screenStart=E;f.screenEnd=D;return f}};b.dragGraphic=y;b.dragGraphicMany=function(h,v){const E=h.map(n=>C.unwrap(y(n,v))).filter(n=>C.isSome(n));return n=>{const B=n.mapEnd.x-n.mapStart.x,f=n.mapEnd.y-n.mapStart.y,D=n.mapEnd.z-n.mapStart.z;E.forEach(H=>H(n));return{...n,translationX:B,translationY:f,translationZ:D}}};b.resetGraphic=c;b.resetGraphicMany=function(h){const v=h.map(E=>C.unwrap(c(E))).filter(E=>C.isSome(E));return E=>{v.forEach(n=>n(E));return E}};b.resetProperties=
a;b.resetSymbol=function(h){return a(h,["symbol"])};b.screenToMap=function(h,v=null,E){let n=null;const B=C.isSome(v)&&!h.spatialReference.equals(v)?D=>C.isSome(D)?k.project(D,v):D:D=>D,f={exclude:[],...E};return D=>{"start"===D.action&&(n=B(h.toMap(D.screenStart,f)));if(C.isNone(n))return null;const H=B(h.toMap(D.screenEnd,f));return C.isSome(H)?{...D,mapStart:n,mapEnd:H}:null}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E){function n(){return!!ra&&p.isLoaded()}function B(la){A.isNone(ua)&&(ua=Promise.all([p.load(),(new Promise(function(qa,pa){b(["../chunks/geometryEngineBase"],qa,pa)})).then(function(qa){return qa.geometryEngineBase}),new Promise(function(qa,pa){b(["./geometryAdapters/hydrated"],qa,pa)})]));return ua.then(([,qa,{hydratedAdapter:pa}])=>{g.throwIfAborted(la);na=pa;ra=qa.default;ra._enableProjection(p.pe)})}function f(la,qa,pa,xa,Aa=null){if(A.isNone(pa)||
A.isNone(xa))return qa;if(H(pa,xa,Aa))return qa.map(Ba=>R(Ba,pa,xa));if(A.isNone(Aa)){const Ba=v.cacheKey(pa,xa);void 0!==za[Ba]?Aa=za[Ba]:(Aa=D(pa,xa,null),A.isNone(Aa)&&(Aa=new v),za[Ba]=Aa)}if(A.isNone(ra))throw new Ca;return ra._project(la,qa,pa,xa,Aa)}function D(la,qa,pa=null){if(A.isNone(ra))throw new Ca;if(A.isNone(la)||A.isNone(qa))return null;la=ra._getTransformation(na,la,qa,pa,null==pa?void 0:pa.spatialReference);return null!==la?v.fromGE(la):null}function H(la,qa,pa){return pa?!1:E.equals(la,
qa)?!0:E.isValid(la)&&E.isValid(qa)&&!!ma(la,qa,Oa)}function P(){P=m._asyncToGenerator(function*(la,qa,pa,xa){if(!n())if(Array.isArray(la))for(const {source:Aa,dest:Ba,geographicTransformation:Ea}of la){if(!H(Aa,Ba,Ea))return B(xa)}else if(!H(la,qa,pa))return B(xa)});return P.apply(this,arguments)}function R(la,qa,pa){if(!la)return la;if("x"in la){var xa=new q;return K(la,qa,xa,pa)?xa:null}return"xmin"in la?(xa=new y,O(la,qa,xa,pa)?xa:null):"rings"in la?(xa=new d,F(la,qa,xa,pa)?xa:null):"paths"in
la?(xa=new a,Q(la,qa,xa,pa)?xa:null):"points"in la?(xa=new t,J(la,qa,xa,pa)?xa:null):null}function K(la,qa,pa,xa,Aa=0){Ga[0]=la.x;Ga[1]=la.y;const Ba=la.z;Ga[2]=void 0!==Ba?Ba:Aa;if(!S(Ga,qa,0,Ga,xa,0,1))return!1;pa.x=Ga[0];pa.y=Ga[1];pa.spatialReference=xa;void 0===Ba?(pa.z=void 0,pa.hasZ=!1):(pa.z=Ga[2],pa.hasZ=!0);void 0===la.m?(pa.m=void 0,pa.hasM=!1):(pa.m=la.m,pa.hasM=!0);return!0}function J(la,qa,pa,xa,Aa=0){const {points:Ba,hasZ:Ea,hasM:Fa}=la;la=[];const Na=Ba.length,Ma=[];for(var La of Ba)Ma.push(La[0],
La[1],Ea?La[2]:Aa);if(!S(Ma,qa,0,Ma,xa,0,Na))return!1;for(qa=0;qa<Na;++qa){Aa=3*qa;La=Ma[Aa];const Ra=Ma[Aa+1];Ea&&Fa?la.push([La,Ra,Ma[Aa+2],Ba[qa][3]]):Ea?la.push([La,Ra,Ma[Aa+2]]):Fa?la.push([La,Ra,Ba[qa][2]]):la.push([La,Ra])}pa.points=la;pa.spatialReference=xa;pa.hasZ=Ea;pa.hasM=Fa;return!0}function Q(la,qa,pa,xa,Aa=0){const {paths:Ba,hasZ:Ea,hasM:Fa}=la;la=[];if(!L(Ba,Ea,Fa,qa,la,xa,Aa))return!1;pa.paths=la;pa.spatialReference=xa;pa.hasZ=Ea;pa.hasM=Fa;return!0}function F(la,qa,pa,xa,Aa=0){const {rings:Ba,
hasZ:Ea,hasM:Fa}=la;la=[];if(!L(Ba,Ea,Fa,qa,la,xa,Aa))return!1;pa.rings=la;pa.spatialReference=xa;pa.hasZ=Ea;pa.hasM=Fa;return!0}function O(la,qa,pa,xa,Aa=0){const {xmin:Ba,ymin:Ea,xmax:Fa,ymax:Na,hasZ:Ma,hasM:La}=la;if(!V(Ba,Ea,Ma?la.zmin:Aa,qa,Ga,xa))return!1;pa.xmin=Ga[0];pa.ymin=Ga[1];Ma&&(pa.zmin=Ga[2]);if(!V(Fa,Na,Ma?la.zmax:Aa,qa,Ga,xa))return!1;pa.xmax=Ga[0];pa.ymax=Ga[1];Ma&&(pa.zmax=Ga[2]);La&&(pa.mmin=la.mmin,pa.mmax=la.mmax);pa.spatialReference=xa;return!0}function V(la,qa,pa,xa,Aa,Ba){Ha[0]=
la;Ha[1]=qa;Ha[2]=pa;return S(Ha,xa,0,Aa,Ba,0,1)}function M(la,qa,pa,xa){if(A.isNone(qa)||A.isNone(xa)||2>la.length)return!1;2===la.length&&(Ha[0]=la[0],Ha[1]=la[1],Ha[2]=0,la=Ha);return S(la,qa,0,pa,xa,0,1)}function T(la,qa,pa){if(A.isNone(qa))return!1;qa=U(qa,Ia);qa=Da[qa][6];if(A.isNone(qa))return!1;qa(la,0,Ha,0);pa!==Ha&&(pa[0]=Ha[0],pa[1]=Ha[1],2<pa.length&&(pa[2]=Ha[2]));return!0}function S(la,qa,pa,xa,Aa,Ba,Ea=1){qa=ma(qa,Aa,Oa);if(A.isNone(qa))return!1;if(qa===fa){if(la===xa&&pa===Ba)return!0;
Ea=pa+3*Ea;for(let Fa=pa,Na=Ba;Fa<Ea;Fa++,Na++)xa[Na]=la[Fa];return!0}Ea=pa+3*Ea;for(let Fa=pa,Na=Ba;Fa<Ea;Fa+=3,Na+=3)qa(la,Fa,xa,Na);return!0}function L(la,qa,pa,xa,Aa,Ba,Ea=0){const Fa=[];for(const Na of la)for(const Ma of Na)Fa.push(Ma[0],Ma[1],qa?Ma[2]:Ea);if(!S(Fa,xa,0,Fa,Ba,0,Fa.length/3))return!1;xa=0;Aa.length=0;for(const Na of la){la=[];for(const Ma of Na)qa&&pa?la.push([Fa[xa++],Fa[xa++],Fa[xa++],Ma[3]]):qa?la.push([Fa[xa++],Fa[xa++],Fa[xa++]]):(pa?la.push([Fa[xa++],Fa[xa++],Ma[2]]):la.push([Fa[xa++],
Fa[xa++]]),xa++);Aa.push(la)}return!0}function N(la,qa,pa){const xa=Math.sin(qa);qa=Math.cos(qa);const Aa=Math.sin(la);la=Math.cos(la);pa[0]=-xa;pa[4]=-Aa*qa;pa[8]=la*qa;pa[12]=0;pa[1]=qa;pa[5]=-Aa*xa;pa[9]=la*xa;pa[13]=0;pa[2]=0;pa[6]=la;pa[10]=Aa;pa[14]=0;pa[3]=0;pa[7]=0;pa[11]=0;pa[15]=1;return pa}function U(la,qa){if(qa.spatialReference===la)return qa.spatialReferenceId;qa.spatialReference=la;"metersPerUnit"in qa&&(qa.metersPerUnit=k.getMetersPerUnitForSR(la,1));return la.wkt===c.SphericalECEFSpatialReference.wkt?
qa.spatialReferenceId=1:E.isWGS84(la)?qa.spatialReferenceId=2:E.isWebMercator(la)?qa.spatialReferenceId=3:la.wkt===c.WGS84ECEFSpatialReference.wkt?qa.spatialReferenceId=4:4490===la.wkid?qa.spatialReferenceId=5:la.wkt===c.SphericalPCPFMars.wkt?qa.spatialReferenceId=7:la.wkt===c.SphericalPCPFMoon.wkt?qa.spatialReferenceId=9:E.isMars(la)?qa.spatialReferenceId=8:E.isMoon(la)?qa.spatialReferenceId=10:qa.spatialReferenceId=0}function fa(la,qa,pa,xa){la!==pa&&(pa[xa++]=la[qa++],pa[xa++]=la[qa++],pa[xa]=
la[qa])}function ka(la,qa,pa,xa){pa[xa++]=Ja*(la[qa++]/e.earth.radius);pa[xa++]=Ja*(Math.PI/2-2*Math.atan(Math.exp(-1*la[qa++]/e.earth.radius)));pa[xa]=la[qa]}function wa(la,qa,pa,xa){ka(la,qa,pa,xa);da(pa,xa,pa,xa)}function ya(la,qa,pa,xa){ka(la,qa,pa,xa);aa(pa,xa,pa,xa)}function oa(la,qa,pa,xa,Aa){var Ba=.4999999*Math.PI;Ba=C.clamp(Ka*la[qa+1],-Ba,Ba);Ba=Math.sin(Ba);pa[xa++]=Ka*la[qa]*Aa.radius;pa[xa++]=Aa.halfSemiMajorAxis*Math.log((1+Ba)/(1-Ba));pa[xa]=la[qa+2]}function G(la,qa,pa,xa){oa(la,
qa,pa,xa,e.earth)}function I(la,qa,pa,xa,Aa){Aa+=la[qa+2];const Ba=Ka*la[qa+1];la=Ka*la[qa];qa=Math.cos(Ba);pa[xa++]=Math.cos(la)*qa*Aa;pa[xa++]=Math.sin(la)*qa*Aa;pa[xa]=Math.sin(Ba)*Aa}function Z(la,qa,pa,xa){I(la,qa,pa,xa,e.moon.radius)}function ca(la,qa,pa,xa){I(la,qa,pa,xa,e.mars.radius)}function da(la,qa,pa,xa){I(la,qa,pa,xa,e.earth.radius)}function ba(la,qa,pa,xa,Aa){var Ba=la[qa];const Ea=la[qa+1];qa=la[qa+2];la=Math.sqrt(Ba*Ba+Ea*Ea+qa*qa);qa=C.asinClamped(qa/(0===la?1:la));Ba=Math.atan2(Ea,
Ba);pa[xa++]=Ja*Ba;pa[xa++]=Ja*qa;pa[xa]=la-Aa}function ha(la,qa,pa,xa){ba(la,qa,pa,xa,e.moon.radius)}function ea(la,qa,pa,xa){ba(la,qa,pa,xa,e.mars.radius)}function W(la,qa,pa,xa){ba(la,qa,pa,xa,e.earth.radius)}function X(la,qa,pa,xa){W(la,qa,pa,xa);G(pa,xa,pa,xa)}function Y(la,qa,pa,xa){W(la,qa,pa,xa);aa(pa,xa,pa,xa)}function aa(la,qa,pa,xa){{var Aa=e.earth;const Ea=Ka*la[qa];var Ba=Ka*la[qa+1];la=la[qa+2];qa=Math.sin(Ba);Ba=Math.cos(Ba);const Fa=Aa.radius/Math.sqrt(1-Aa.eccentricitySquared*qa*
qa);pa[xa++]=(Fa+la)*Ba*Math.cos(Ea);pa[xa++]=(Fa+la)*Ba*Math.sin(Ea);pa[xa++]=(Fa*(1-Aa.eccentricitySquared)+la)*qa}}function ia(la,qa,pa,xa){var Aa=h.earthEllipsoidConstants,Ba=la[qa],Ea=la[qa+1];la=la[qa+2];let Fa;qa=Math.abs(la);var Na=Ba*Ba+Ea*Ea;var Ma=Math.sqrt(Na);var La=Na+la*la;var Ra=Math.sqrt(La);Ba=Math.atan2(Ea,Ba);var Ta=la*la/La;La=Na/La;Ea=Aa.a2/Ra;Na=Aa.a3-Aa.a4/Ra;.3<La?(Ta=qa/Ra*(1+La*(Aa.a1+Ea+Ta*Na)/Ra),Ra=Math.asin(Ta),Ea=Ta*Ta,La=Math.sqrt(1-Ea)):(La=Ma/Ra*(1-Ta*(Aa.a5-Ea-
La*Na)/Ra),Ra=Math.acos(La),Ea=1-La*La,Ta=Math.sqrt(Ea));Fa=1-e.earth.eccentricitySquared*Ea;Ea=e.earth.radius/Math.sqrt(Fa);Aa=Aa.a6*Ea;Ea=Ma-Ea*La;Na=qa-Aa*Ta;qa=La*Ea+Ta*Na;Ma=La*Na-Ta*Ea;Aa=Ma/(Aa/Fa+qa);Ra+=Aa;0>la&&(Ra=-Ra);pa[xa++]=Ja*Ba;pa[xa++]=Ja*Ra;pa[xa]=qa+Ma*Aa/2}function ja(la,qa,pa,xa){ia(la,qa,pa,xa);da(pa,xa,pa,xa)}function va(la,qa,pa,xa){ia(la,qa,pa,xa);G(pa,xa,pa,xa)}function ma(la,qa,pa=sa()){return A.isNone(la)||A.isNone(qa)?null:ta(la,qa,pa).projector}function ta(la,qa,pa){if(A.isNone(la)||
A.isNone(qa)||pa.source.spatialReference===la&&pa.dest.spatialReference===qa)return pa;const xa=U(la,pa.source),Aa=U(qa,pa.dest);0===xa&&0===Aa?E.equals(la,qa)?pa.projector=fa:pa.projector=null:pa.projector=Da[xa][Aa];return pa}function sa(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:fa}}let ra=null,na=null,ua=null,za={},Ca=function(la){function qa(){return la.call(this,"projection:not-loaded",
"projection engine not fully loaded yet, please call load()")||this}m._inheritsLoose(qa,la);return qa}(z);const Da={[2]:{[5]:null,[8]:null,[10]:null,[11]:fa,[6]:fa,[1]:da,[7]:null,[9]:null,[0]:null,[3]:G,[2]:fa,[4]:aa},[5]:{[5]:fa,[8]:null,[10]:null,[11]:fa,[6]:fa,[1]:da,[7]:null,[9]:null,[0]:null,[3]:null,[2]:null,[4]:aa},[8]:{[5]:null,[8]:fa,[10]:null,[11]:fa,[6]:null,[1]:null,[7]:ca,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:fa,[11]:fa,[6]:null,[1]:null,[7]:null,
[9]:Z,[0]:null,[3]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[11]:ka,[6]:ka,[1]:wa,[7]:null,[9]:null,[0]:null,[3]:fa,[2]:ka,[4]:ya},[4]:{[5]:ia,[8]:null,[10]:null,[11]:ia,[6]:ia,[1]:ja,[7]:null,[9]:null,[0]:null,[3]:va,[2]:ia,[4]:fa},[1]:{[5]:W,[8]:null,[10]:null,[11]:W,[6]:W,[1]:fa,[7]:null,[9]:null,[0]:null,[3]:X,[2]:W,[4]:Y},[7]:{[5]:null,[8]:ea,[10]:null,[11]:ea,[6]:null,[1]:null,[7]:fa,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:ha,[11]:ha,[6]:null,
[1]:null,[7]:null,[9]:fa,[0]:null,[3]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[11]:null,[6]:null,[1]:null,[7]:null,[9]:null,[0]:fa,[3]:null,[2]:null,[4]:null},[11]:{[5]:fa,[8]:fa,[10]:fa,[11]:fa,[6]:fa,[1]:da,[7]:ca,[9]:Z,[0]:null,[3]:G,[2]:fa,[4]:aa},[6]:{[5]:null,[8]:null,[10]:null,[11]:fa,[6]:fa,[1]:da,[7]:null,[9]:null,[0]:null,[3]:null,[2]:fa,[4]:aa}},Ia={spatialReference:null,spatialReferenceId:0},Pa={spatialReference:null,spatialReferenceId:0},Oa=sa(),Qa=sa(),Ka=C.deg2rad(1),
Ja=C.rad2deg(1),Ha=x.create(),Sa=x.create(),Ua=x.create(),Ga=x.create(),Va=x.create();l.canProjectToWGS84ComparableLonLat=function(la){if(A.isNone(la))return!1;la=U(la,Ia);return!!Da[la][6]};l.canProjectWithoutEngine=H;l.computeLatLonToENURotation=N;l.computeLinearTransformation=function(la,qa,pa,xa){if(A.isNone(la)||A.isNone(xa))return!1;var Aa=U(la,Ia),Ba=U(xa,Pa);if(Aa===Ba&&1!==Ba&&7!==Ba&&9!==Ba&&(0!==Aa||E.equals(la,xa)))return w.identity(pa),w.translate(pa,pa,qa),!0;if(1===Ba||7===Ba||9===
Ba){xa=la=0;Aa=Da[Aa][11];Ba=Da[11][Ba];if(A.isNone(Aa)||A.isNone(Ba))return!1;Aa(qa,0,Sa,0);Ba(Sa,0,Ua,0);la=Ka*Sa[0];xa=Ka*Sa[1];N(xa,la,pa);pa[12]=Ua[0];pa[13]=Ua[1];pa[14]=Ua[2];return!0}if(3===Ba&&(2===Aa||1===Aa)){Ba=Da[Aa][11];if(A.isNone(Ba))return!1;Ba(qa,0,Sa,0);qa=Ka*Sa[1];G(Sa,0,Ua,0);w.identity(pa);w.translate(pa,pa,Ua);qa=1/Math.cos(qa);w.scale(pa,pa,[qa,qa,1]);return!0}return!1};l.getProjectorName=function(la,qa){switch(ma(la,qa,Oa)){case fa:return"copy3";case da:return"wgs84ToSphericalECEF";
case G:return"wgs84ToWebMercator";case aa:return"wgs84ToWGS84ECEF";case ka:return"webMercatorToWGS84";case wa:return"webMercatorToSphericalECEF";case ya:return"webMercatorToWGS84ECEF";case ia:return"wgs84ECEFToWGS84";case ja:return"wgs84ECEFToSphericalECEF";case va:return"wgs84ECEFToWebMercator";case W:return"sphericalECEFToWGS84";case X:return"sphericalECEFToWebMercator";case ea:return"sphericalMarsPCPFToMars2000";case ha:return"sphericalMoonPCPFToMoon2000";case Y:return"sphericalECEFToWGS84ECEF";
case ca:return"mars2000ToSphericalPCPF";case Z:return"moon2000ToSphericalPCPF";default:return null}};l.getTransformation=D;l.getTransformations=function(la,qa,pa=null){if(A.isNone(ra))throw new Ca;la=ra._getTransformationBySuitability(na,la,qa,pa,null==pa?void 0:pa.spatialReference);if(null!==la){qa=[];for(const xa of la)qa.push(v.fromGE(xa));return qa}return[]};l.initializeProjection=function(la,qa,pa,xa){return P.apply(this,arguments)};l.isLoaded=n;l.isSupported=function(){return!0};l.load=B;l.localLinearScaleFactors=
function(la,qa,pa,xa){if(A.isNone(qa)||A.isNone(xa))return!1;const Aa=U(qa,Ia);var Ba=U(xa,Pa);if(Aa===Ba&&0!==Aa||E.equals(qa,xa))return pa[0]=1,pa[1]=1,pa[2]=1,!0;if(1===Aa){qa=u.length(la);la=qa/Math.sqrt(la[0]*la[0]+la[1]*la[1]);qa/=e.earth.radius;if(3===Ba)return pa[0]=la*qa,pa[1]=la*qa,pa[2]=1,!0;if(2===Ba||5===Ba)return Ba=180/(e.earth.radius*Math.PI),pa[0]=Ba*la*qa,pa[1]=Ba*qa,pa[2]=1,!0}return!1};l.lonLatToSphericalPCPF=function(la,qa,pa,xa,Aa=0){xa+=Aa;Aa=Math.cos(pa);la[0]=Math.cos(qa)*
Aa*xa;la[1]=Math.sin(qa)*Aa*xa;la[2]=Math.sin(pa)*xa};l.lonLatToWebMercatorComparable=oa;l.project=function(la,qa,pa=null){return Array.isArray(la)?0===la.length?[]:f(na,la,la[0].spatialReference,qa,pa):f(na,[la],la.spatialReference,qa,pa)[0]};l.projectBoundingRect=function(la,qa,pa,xa){if(null==la)return!1;if(E.equals(qa,xa))return r.set(pa,la),!0;Ha[0]=la[0];Ha[1]=la[1];Ha[2]=0;if(!S(Ha,qa,0,Ha,xa,0,1))return!1;pa[0]=Ha[0];pa[1]=Ha[1];Ha[0]=la[2];Ha[1]=la[3];Ha[2]=0;if(!S(Ha,qa,0,Ha,xa,0,1))return!1;
pa[2]=Ha[0];pa[3]=Ha[1];return!0};l.projectBoundingSphere=function(la,qa,pa,xa){if(A.isNone(qa)||A.isNone(xa))return!1;qa=ta(qa,xa,Qa);if(qa.projector===fa)return pa[0]=la[0],pa[1]=la[1],pa[2]=la[2],pa[3]=la[3],!0;if(A.isNone(qa.projector))return!1;const {source:Aa,dest:Ba}=qa;if(3===Ba.spatialReferenceId){qa=Da[Aa.spatialReferenceId][2];if(A.isNone(qa))return!1;qa(la,0,Sa,0);qa=Math.abs(Ka*Sa[1])+Math.asin(la[3]/(e.earth.radius+la[2]));G(Sa,0,pa,0);pa[3]=qa>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(qa)*
la[3];return!0}qa.projector(la,0,pa,0);pa[3]=la[3]*Aa.metersPerUnit/Ba.metersPerUnit;return!0};l.projectBuffer=S;l.projectDirection=function(la,qa,pa,xa,Aa){u.copy(Ga,la);u.add(Va,la,qa);M(Ga,pa,Ga,Aa);M(Va,pa,Va,Aa);u.subtract(xa,Va,Ga);u.normalize(xa,xa)};l.projectExtent=function(la,qa,pa=qa.spatialReference,xa=0){return A.isNone(pa)?!1:O(la,la.spatialReference,qa,pa,xa)};l.projectMany=f;l.projectMultipoint=function(la,qa,pa=qa.spatialReference,xa=0){return A.isNone(pa)?!1:J(la,la.spatialReference,
qa,pa,xa)};l.projectPoint=function(la,qa,pa=qa.spatialReference,xa=0){return A.isNone(pa)?!1:K(la,la.spatialReference,qa,pa,xa)};l.projectPointToVector=function(la,qa,pa,xa=0){Ga[0]=la.x;Ga[1]=la.y;const Aa=la.z;Ga[2]=void 0!==Aa?Aa:xa;return S(Ga,la.spatialReference,0,qa,pa,0,1)};l.projectPointToWGS84ComparableLonLat=function(la,qa){Ga[0]=la.x;Ga[1]=la.y;const pa=la.z;Ga[2]=void 0!==pa?pa:0;return T(Ga,la.spatialReference,qa)};l.projectPolygon=function(la,qa,pa=qa.spatialReference,xa=0){return A.isNone(pa)?
!1:F(la,la.spatialReference,qa,pa,xa)};l.projectPolyline=function(la,qa,pa=qa.spatialReference,xa=0){return A.isNone(pa)?!1:Q(la,la.spatialReference,qa,pa,xa)};l.projectVectorToDehydratedPoint=function(la,qa,pa){return S(la,qa,0,Ga,pa.spatialReference,0,1)?(pa.x=Ga[0],pa.y=Ga[1],pa.z=Ga[2],pa):null};l.projectVectorToPoint=function(la,qa,pa){if(A.isNone(qa)||A.isNone(pa))return null;const xa=new q({spatialReference:pa});return S(la,qa,0,Ga,pa,0,1)?(xa.x=Ga[0],xa.y=Ga[1],xa.z=Ga[2],xa):null};l.projectVectorToVector=
M;l.projectVectorToWGS84ComparableLonLat=function(la,qa,pa){return T(la,qa,pa)};l.projectXYZToVector=V;l.sphericalPCPFtoLonLatElevation=ba;l.unload=function(){ua=na=ra=null;za={}};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(b,l,m,z,C){function A(){return!!l._pe}function g(){return!!C("esri-wasm")}function k(){return p?p:p=(new Promise(function(d,a){b(["./pe-wasm"],d,a)})).then(function(d){return d.peWasm}).then(({default:d})=>
d({locateFile:a=>z.getAssetUrl(`esri/geometry/support/${a}`)})).then(d=>{w(d)})}function w(d){function a(e,h,v){e[h]=v(e[h])}l._pe=d;l.PeDefs.init();l.PeGTlistExtended.init();l.PeNotationMgrs.init();l.PeNotationUtm.init();l.PePCSInfo.init();l.PeGCSExtent=function(e){function h(){return e.apply(this,arguments)||this}m._inheritsLoose(h,e);h.prototype.destroy=function(){l._pe.destroy(this)};return h}(l._pe.PeGCSExtent);d=[l._pe.PeDatum,l._pe.PeGeogcs,l._pe.PeGeogtran,l._pe.PeObject,l._pe.PeParameter,
l._pe.PePrimem,l._pe.PeProjcs,l._pe.PeSpheroid,l._pe.PeUnit];for(var c of d)a(c.prototype,"getName",e=>function(){return e.call(this,Array(l.PeDefs.PE_NAME_MAX))});for(const e of[l._pe.PeGeogtran,l._pe.PeProjcs])a(e.prototype,"getParameters",h=>function(){const v=Array(l.PeDefs.PE_PARM_MAX);let E=h.call(this);for(let n=0;n<v.length;n++){const B=l._pe.getValue(E,"*");v[n]=B?l._pe.wrapPointer(B,l._pe.PeParameter):null;E+=Int32Array.BYTES_PER_ELEMENT}return v});a(l._pe.PeHorizon.prototype,"getCoord",
e=>function(){const h=this.getSize();if(!h)return null;const v=[],E=e.call(this);t(v,h,E);return v});a(l._pe.PeGTlistExtendedEntry.prototype,"getEntries",e=>{const h=l._pe._pe_getPeGTlistExtendedGTsSize();return function(){let v=null;var E=e.call(this);if(!l._pe.compare(E,l._pe.NULL)){v=[E];const n=this.getSteps();if(1<n){E=l._pe.getPointer(E);for(let B=1;B<n;B++)v.push(l._pe.wrapPointer(E+h*B,l._pe.PeGTlistExtendedGTs))}}return v}});const r=l._pe._pe_getPeHorizonSize();c=e=>function(){let h=this._cache;
h||(this._cache=h=new Map);if(h.has(e))return h.get(e);let v=null;var E=e.call(this);if(!l._pe.compare(E,l._pe.NULL)){v=[E];const n=E.getNump();if(1<n){E=l._pe.getPointer(E);for(let B=1;B<n;B++)v.push(l._pe.wrapPointer(E+r*B,l._pe.PeHorizon))}}h.set(e,v);return v};a(l._pe.PeProjcs.prototype,"horizonGcsGenerate",c);a(l._pe.PeProjcs.prototype,"horizonPcsGenerate",c);l._pe.PeObject.prototype.toString=function(e=l.PeDefs.PE_STR_OPTS_NONE){l._pe.ensureCache.prepare();const h=l._pe.getPointer(this),v=l._pe.ensureInt8(Array(l.PeDefs.PE_BUFFER_MAX));
return l._pe.UTF8ToString(l._pe._pe_object_to_string_ext(h,e,v))}}function u(d){if(d){var a=l._pe.getClass(d);a&&(a=l._pe.getCache(a))&&(d=l._pe.getPointer(d))&&delete a[d]}}function x(d,a){const c=[];a=Array(a);for(let r=0;r<d;r++)c.push(l._pe.ensureInt8(a));return c}function y(d){let a;Array.isArray(d[0])?(a=[],d.forEach(c=>{a.push(c[0],c[1])})):a=d;return a}function t(d,a,c,r=!1){if(r)for(r=0;r<2*a;r++)d[r]=l._pe.getValue(c+r*Float64Array.BYTES_PER_ELEMENT,"double");else{r=0===d.length;for(let e=
0;e<a;e++)r&&(d[e]=Array(2)),d[e][0]=l._pe.getValue(c,"double"),d[e][1]=l._pe.getValue(c+Float64Array.BYTES_PER_ELEMENT,"double"),c+=2*Float64Array.BYTES_PER_ELEMENT}}let p;l._pe=null;l.PeCSTransformations=void 0;(function(d){function a(e,h,v){l._pe.ensureCache.prepare();var E=y(v);const n=v===E;E=l._pe.ensureFloat64(E);(e=l._pe._pe_geog_to_proj(l._pe.getPointer(e),h,E))&&t(v,h,E,n);return e}function c(e,h,v){return r(e,h,v,0)}function r(e,h,v,E){l._pe.ensureCache.prepare();var n=y(v);const B=v===
n;n=l._pe.ensureFloat64(n);(e=l._pe._pe_proj_to_geog_center(l._pe.getPointer(e),h,n,E))&&t(v,h,n,B);return e}d.geogToProj=a;d.projGeog=function(e,h,v,E){switch(E){case l.PeDefs.PE_TRANSFORM_P_TO_G:return c(e,h,v);case l.PeDefs.PE_TRANSFORM_G_TO_P:return a(e,h,v)}return 0};d.projToGeog=c;d.projToGeogCenter=r})(l.PeCSTransformations||(l.PeCSTransformations={}));l.PeDefs=void 0;(function(d){d.init=function(){d.PE_BUFFER_MAX=l._pe.PeDefs.prototype.PE_BUFFER_MAX;d.PE_NAME_MAX=l._pe.PeDefs.prototype.PE_NAME_MAX;
d.PE_MGRS_MAX=l._pe.PeDefs.prototype.PE_MGRS_MAX;d.PE_USNG_MAX=l._pe.PeDefs.prototype.PE_USNG_MAX;d.PE_DD_MAX=l._pe.PeDefs.prototype.PE_DD_MAX;d.PE_DDM_MAX=l._pe.PeDefs.prototype.PE_DDM_MAX;d.PE_DMS_MAX=l._pe.PeDefs.prototype.PE_DMS_MAX;d.PE_UTM_MAX=l._pe.PeDefs.prototype.PE_UTM_MAX;d.PE_PARM_MAX=l._pe.PeDefs.prototype.PE_PARM_MAX;d.PE_TYPE_NONE=l._pe.PeDefs.prototype.PE_TYPE_NONE;d.PE_TYPE_GEOGCS=l._pe.PeDefs.prototype.PE_TYPE_GEOGCS;d.PE_TYPE_PROJCS=l._pe.PeDefs.prototype.PE_TYPE_PROJCS;d.PE_TYPE_GEOGTRAN=
l._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;d.PE_TYPE_COORDSYS=l._pe.PeDefs.prototype.PE_TYPE_COORDSYS;d.PE_TYPE_UNIT=l._pe.PeDefs.prototype.PE_TYPE_UNIT;d.PE_TYPE_LINUNIT=l._pe.PeDefs.prototype.PE_TYPE_LINUNIT;d.PE_STR_OPTS_NONE=l._pe.PeDefs.prototype.PE_STR_OPTS_NONE;d.PE_STR_AUTH_NONE=l._pe.PeDefs.prototype.PE_STR_AUTH_NONE;d.PE_STR_AUTH_TOP=l._pe.PeDefs.prototype.PE_STR_AUTH_TOP;d.PE_STR_NAME_CANON=l._pe.PeDefs.prototype.PE_STR_NAME_CANON;d.PE_PARM_X0=l._pe.PeDefs.prototype.PE_PARM_X0;d.PE_PARM_ND=
l._pe.PeDefs.prototype.PE_PARM_ND;d.PE_TRANSFORM_1_TO_2=l._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;d.PE_TRANSFORM_2_TO_1=l._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;d.PE_TRANSFORM_P_TO_G=l._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;d.PE_TRANSFORM_G_TO_P=l._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;d.PE_HORIZON_RECT=l._pe.PeDefs.prototype.PE_HORIZON_RECT;d.PE_HORIZON_POLY=l._pe.PeDefs.prototype.PE_HORIZON_POLY;d.PE_HORIZON_LINE=l._pe.PeDefs.prototype.PE_HORIZON_LINE;d.PE_HORIZON_DELTA=l._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(l.PeDefs||
(l.PeDefs={}));l.PeFactory=void 0;(function(d){function a(h,v){let E=null,n=c[h];n||(n={},c[h]=n);n.hasOwnProperty(String(v))?E=n[v]:(h=l._pe.PeFactory.prototype.factoryByType(h,v),l._pe.compare(h,l._pe.NULL)||(E=h,n[v]=E));return E=e(E)}const c={},r={},e=h=>{if(h){const v=h.getType();switch(v){case l.PeDefs.PE_TYPE_GEOGCS:h=l._pe.castObject(h,l._pe.PeGeogcs);break;case l.PeDefs.PE_TYPE_PROJCS:h=l._pe.castObject(h,l._pe.PeProjcs);break;case l.PeDefs.PE_TYPE_GEOGTRAN:h=l._pe.castObject(h,l._pe.PeGeogtran);
break;default:v&l.PeDefs.PE_TYPE_UNIT&&(h=l._pe.castObject(h,l._pe.PeUnit))}}return h};d.initialize=function(){l._pe.PeFactory.prototype.initialize(null)};d.coordsys=function(h){return a(l.PeDefs.PE_TYPE_COORDSYS,h)};d.factoryByType=a;d.fromString=function(h,v){let E=null,n=r[h];n||(n={},r[h]=n);n.hasOwnProperty(v)?E=n[v]:(h=l._pe.PeFactory.prototype.fromString(h,v),l._pe.compare(h,l._pe.NULL)||(E=h,n[v]=E));return E=e(E)};d.geogcs=function(h){return a(l.PeDefs.PE_TYPE_GEOGCS,h)};d.geogtran=function(h){return a(l.PeDefs.PE_TYPE_GEOGTRAN,
h)};d.getCode=function(h){return l._pe.PeFactory.prototype.getCode(h)};d.projcs=function(h){return a(l.PeDefs.PE_TYPE_PROJCS,h)};d.unit=function(h){return a(l.PeDefs.PE_TYPE_UNIT,h)}})(l.PeFactory||(l.PeFactory={}));l.PeGCSExtent=null;l.PeGTlistExtended=void 0;(function(d){let a;d.init=function(){d.PE_GTLIST_OPTS_COMMON=l._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;a=l._pe._pe_getPeGTlistExtendedEntrySize()};d.getGTlist=function(c,r,e,h,v,E){let n=null;const B=new l._pe.PeInteger(E);try{const f=
l._pe.PeGTlistExtended.prototype.getGTlist(c,r,e,h,v,B);if(E=B.val)if(n=[f],1<E){const D=l._pe.getPointer(f);for(c=1;c<E;c++)n.push(l._pe.wrapPointer(D+a*c,l._pe.PeGTlistExtendedEntry))}}finally{l._pe.destroy(B)}return n}})(l.PeGTlistExtended||(l.PeGTlistExtended={}));l.PeGTlistExtendedEntry=void 0;(function(d){d.destroy=function(a){if(a&&a.length){for(const c of a)u(c),c.getEntries().forEach(r=>{u(r);r=r.getGeogtran();u(r);r.getParameters().forEach(u);[r.getGeogcs1(),r.getGeogcs2()].forEach(e=>{u(e);
const h=e.getDatum();u(h);u(h.getSpheroid());u(e.getPrimem());u(e.getUnit())})});l._pe.PeGTlistExtendedEntry.prototype.Delete(a[0])}}})(l.PeGTlistExtendedEntry||(l.PeGTlistExtendedEntry={}));l.PeGTTransformations=void 0;(function(d){d.geogToGeog=function(a,c,r,e,h){l._pe.ensureCache.prepare();var v=y(r);const E=r===v;v=l._pe.ensureFloat64(v);let n=0;e&&(n=l._pe.ensureFloat64(e));(a=l._pe._pe_geog_to_geog(l._pe.getPointer(a),c,v,n,h))&&t(r,c,v,E);return a}})(l.PeGTTransformations||(l.PeGTTransformations=
{}));l.PeNotationDms=void 0;(function(d){const a=(r,e,h,v,E,n)=>{l._pe.ensureCache.prepare();switch(r){case "dd":var B=l._pe._pe_geog_to_dd;var f=l.PeDefs.PE_DD_MAX;break;case "ddm":B=l._pe._pe_geog_to_ddm;f=l.PeDefs.PE_DDM_MAX;break;case "dms":B=l._pe._pe_geog_to_dms,f=l.PeDefs.PE_DMS_MAX}r=0;e&&(r=l._pe.getPointer(e));e=y(v);e=l._pe.ensureFloat64(e);f=x(h,f);v=l._pe.ensureInt32(f);if(E=B(r,h,e,E,v))for(B=0;B<h;B++)n[B]=l._pe.UTF8ToString(f[B]);return E},c=(r,e,h,v,E)=>{l._pe.ensureCache.prepare();
switch(r){case "dd":var n=l._pe._pe_dd_to_geog;break;case "ddm":n=l._pe._pe_ddm_to_geog;break;case "dms":n=l._pe._pe_dms_to_geog}r=0;e&&(r=l._pe.getPointer(e));e=v.map(B=>l._pe.ensureString(B));v=l._pe.ensureInt32(e);e=l._pe.ensureFloat64(Array(2*h));(n=n(r,h,v,e))&&t(E,h,e);return n};d.geog_to_dms=function(r,e,h,v,E){return a("dms",r,e,h,v,E)};d.dms_to_geog=function(r,e,h,v){return c("dms",r,e,h,v)};d.geog_to_ddm=function(r,e,h,v,E){return a("ddm",r,e,h,v,E)};d.ddm_to_geog=function(r,e,h,v){return c("ddm",
r,e,h,v)};d.geog_to_dd=function(r,e,h,v,E){return a("dd",r,e,h,v,E)};d.dd_to_geog=function(r,e,h,v){return c("dd",r,e,h,v)}})(l.PeNotationDms||(l.PeNotationDms={}));l.PeNotationMgrs=void 0;(function(d){d.init=function(){d.PE_MGRS_STYLE_NEW=l._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;d.PE_MGRS_STYLE_OLD=l._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;d.PE_MGRS_STYLE_AUTO=l._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;d.PE_MGRS_180_ZONE_1_PLUS=l._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
d.PE_MGRS_ADD_SPACES=l._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};d.geog_to_mgrs_extended=function(a,c,r,e,h,v,E){l._pe.ensureCache.prepare();let n=0;a&&(n=l._pe.getPointer(a));a=y(r);r=l._pe.ensureFloat64(a);a=x(c,l.PeDefs.PE_MGRS_MAX);const B=l._pe.ensureInt32(a);if(e=l._pe._pe_geog_to_mgrs_extended(n,c,r,e,h,v,B))for(h=0;h<c;h++)E[h]=l._pe.UTF8ToString(a[h]);return e};d.mgrs_to_geog_extended=function(a,c,r,e,h){l._pe.ensureCache.prepare();let v=0;a&&(v=l._pe.getPointer(a));a=r.map(E=>l._pe.ensureString(E));
r=l._pe.ensureInt32(a);a=l._pe.ensureFloat64(Array(2*c));(e=l._pe._pe_mgrs_to_geog_extended(v,c,r,e,a))&&t(h,c,a);return e}})(l.PeNotationMgrs||(l.PeNotationMgrs={}));l.PeNotationUsng=void 0;(function(d){d.geog_to_usng=function(a,c,r,e,h,v,E){l._pe.ensureCache.prepare();let n=0;a&&(n=l._pe.getPointer(a));a=y(r);r=l._pe.ensureFloat64(a);a=x(c,l.PeDefs.PE_MGRS_MAX);const B=l._pe.ensureInt32(a);if(e=l._pe._pe_geog_to_usng(n,c,r,e,h,v,B))for(h=0;h<c;h++)E[h]=l._pe.UTF8ToString(a[h]);return e};d.usng_to_geog=
function(a,c,r,e){l._pe.ensureCache.prepare();var h=0;a&&(h=l._pe.getPointer(a));a=r.map(v=>l._pe.ensureString(v));r=l._pe.ensureInt32(a);a=l._pe.ensureFloat64(Array(2*c));(h=l._pe._pe_usng_to_geog(h,c,r,a))&&t(e,c,a);return h}})(l.PeNotationUsng||(l.PeNotationUsng={}));l.PeNotationUtm=void 0;(function(d){d.init=function(){d.PE_UTM_OPTS_NONE=l._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;d.PE_UTM_OPTS_ADD_SPACES=l._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;d.PE_UTM_OPTS_NS=l._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};
d.geog_to_utm=function(a,c,r,e,h){l._pe.ensureCache.prepare();var v=0;a&&(v=l._pe.getPointer(a));a=y(r);r=l._pe.ensureFloat64(a);a=x(c,l.PeDefs.PE_UTM_MAX);const E=l._pe.ensureInt32(a);if(e=l._pe._pe_geog_to_utm(v,c,r,e,E))for(v=0;v<c;v++)h[v]=l._pe.UTF8ToString(a[v]);return e};d.utm_to_geog=function(a,c,r,e,h){l._pe.ensureCache.prepare();let v=0;a&&(v=l._pe.getPointer(a));a=r.map(E=>l._pe.ensureString(E));r=l._pe.ensureInt32(a);a=l._pe.ensureFloat64(Array(2*c));(e=l._pe._pe_utm_to_geog(v,c,r,e,a))&&
t(h,c,a);return e}})(l.PeNotationUtm||(l.PeNotationUtm={}));l.PePCSInfo=void 0;(function(d){const a=new Map;d.init=function(){d.PE_PCSINFO_OPTION_NONE=l._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;d.PE_PCSINFO_OPTION_DOMAIN=l._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;d.PE_POLE_OUTSIDE_BOUNDARY=l._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;d.PE_POLE_POINT=l._pe.PePCSInfo.prototype.PE_POLE_POINT};d.generate=function(c,r=d.PE_PCSINFO_OPTION_DOMAIN){let e,h;a.has(c)&&(h=a.get(c),h[r]&&
(e=h[r]));e||(e=l._pe.PePCSInfo.prototype.generate(c,r),h||(h=[],a.set(c,h)),h[r]=e);return e}})(l.PePCSInfo||(l.PePCSInfo={}));l.PeVersion=void 0;(function(d){d.version_string=function(){return l._pe.PeVersion.prototype.version_string()}})(l.PeVersion||(l.PeVersion={}));var q=Object.freeze({__proto__:null,get _pe(){return l._pe},isLoaded:A,isSupported:g,load:k,get PeCSTransformations(){return l.PeCSTransformations},get PeDefs(){return l.PeDefs},get PeFactory(){return l.PeFactory},get PeGCSExtent(){return l.PeGCSExtent},
get PeGTlistExtended(){return l.PeGTlistExtended},get PeGTlistExtendedEntry(){return l.PeGTlistExtendedEntry},get PeGTTransformations(){return l.PeGTTransformations},get PeNotationDms(){return l.PeNotationDms},get PeNotationMgrs(){return l.PeNotationMgrs},get PeNotationUsng(){return l.PeNotationUsng},get PeNotationUtm(){return l.PeNotationUtm},get PePCSInfo(){return l.PePCSInfo},get PeVersion(){return l.PeVersion},_init:w});l._init=w;l.isLoaded=A;l.isSupported=g;l.load=k;l.pe=q})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],
function(b){return function(){function l(z){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(z&&z.steps)for(const C of z.steps)C instanceof b?this.steps.push(C):this.steps.push(new b({wkid:C.wkid,wkt:C.wkt,isInverse:C.isInverse}))}l.cacheKey=function(z,C){return[void 0!==z.wkid&&null!==z.wkid?z.wkid.toString():"-1",void 0!==z.wkt&&null!==z.wkt?z.wkt.toString():"",void 0!==C.wkid&&null!==C.wkid?C.wkid.toString():"-1",void 0!==C.wkt&&null!==C.wkt?C.wkt.toString():""].join()};
l.fromGE=function(z){const C=new l;let A="";for(const g of z.steps)z=b.fromGE(g),C.steps.push(z),A+=z.uid.toString()+",";C._cached_projection={};C._gtlistentry=null;C._chain=A;return C};var m=l.prototype;m.getInverse=function(){const z=new l;z.steps=[];for(let C=this.steps.length-1;0<=C;C--)z.steps.push(this.steps[C].getInverse());return z};m.getGTListEntry=function(){let z="";for(const C of this.steps)z+=C.uid.toString()+",";z!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=
z);return this._gtlistentry};m.assignCachedGe=function(z,C,A){this._cached_projection[l.cacheKey(z,C)]=A};m.getCachedGeTransformation=function(z,C){let A="";for(const g of this.steps)A+=g.uid.toString()+",";A!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=A);z=this._cached_projection[l.cacheKey(z,C)];return void 0===z?null:z};return l}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(b){let l=
0;return function(){function m(z=null){this.uid=l++;z?(this._wkt=void 0!==z.wkt?z.wkt:null,this._wkid=void 0!==z.wkid?z.wkid:-1,this._isInverse=void 0!==z.isInverse?!0===z.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}m.fromGE=function(z){const C=new m;C._wkt=z.wkt;C._wkid=z.wkid;C._isInverse=z.isInverse;return C};m.prototype.getInverse=function(){const z=new m;z._wkt=this.wkt;z._wkid=this._wkid;z._isInverse=!this.isInverse;return z};b._createClass(m,[{key:"wkt",get:function(){return this._wkt},
set:function(z){this._wkt=z;this.uid=l++}},{key:"wkid",get:function(){return this._wkid},set:function(z){this._wkid=z;this.uid=l++}},{key:"isInverse",get:function(){return this._isInverse},set:function(z){this._isInverse=z;this.uid=l++}}]);return m}()})},"esri/views/draw/support/drawUtils":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(b,l,m,z){function C(k,w,u,x){null==x||k.hasZ||(x=
void 0);if("point"===k.type)return k.x+=w,k.y+=u,k.hasZ&&null!=x&&(k.z+=x),k;if("multipoint"===k.type){var y=k.points;for(var t=0;t<y.length;t++)y[t]=A(y[t],w,u,x);return k}if("extent"===k.type)return k.xmin+=w,k.xmax+=w,k.ymin+=u,k.ymax+=u,null!=x&&(k.zmin+=x,k.zmax+=x),k;y=z.geometryToCoordinates(k);t="polyline"===k.type?k.paths:k.rings;for(let p=0;p<y.length;p++){const q=y[p];for(let d=0;d<q.length;d++)q[d]=A(q[d],w,u,x)}"paths"in k?k.paths=t:k.rings=t;return k}function A(k,w,u,x){return g(k,k[0]+
w,k[1]+u,null!=k[2]&&null!=x?k[2]+x:void 0)}function g(k,w,u,x){w=[w,u];2<k.length&&w.push(null!=x?x:k[2]);3<k.length&&w.push(k[3]);return w}b.cloneMove=function(k,w,u,x,y){k=k.clone();var t=x.resolution;if("point"===k.type)return y?C(k,w*t,-u*t):(y=x.state.transform,x=x.state.inverseTransform,t=y[0]*k.x+y[2]*k.y+y[4],y=y[1]*k.x+y[3]*k.y+y[5],k.x=x[0]*(t+w)+x[2]*(y+u)+x[4],k.y=x[1]*(t+w)+x[3]*(y+u)+x[5]),k;if("multipoint"===k.type){if(y)C(k,w*t,-u*t);else{y=k.points;t=x.state.transform;x=x.state.inverseTransform;
for(var p=0;p<y.length;p++){var q=y[p],d=t[0]*q[0]+t[2]*q[1]+t[4],a=t[1]*q[0]+t[3]*q[1]+t[5];y[p]=g(q,x[0]*(d+w)+x[2]*(a+u)+x[4],x[1]*(d+w)+x[3]*(a+u)+x[5],void 0)}}return k}if("extent"===k.type)return y?C(k,w*t,-u*t):(y=x.state.transform,x=x.state.inverseTransform,t=y[0]*k.xmin+y[2]*k.ymin+y[4],p=y[1]*k.xmin+y[3]*k.ymin+y[5],q=y[0]*k.xmax+y[2]*k.ymax+y[4],y=y[1]*k.xmax+y[3]*k.ymax+y[5],k.xmin=x[0]*(t+w)+x[2]*(p+u)+x[4],k.ymin=x[1]*(t+w)+x[3]*(p+u)+x[5],k.xmax=x[0]*(q+w)+x[2]*(y+u)+x[4],k.ymax=x[1]*
(q+w)+x[3]*(y+u)+x[5]),k;if(y)C(k,w*t,-u*t);else{y=z.geometryToCoordinates(k);t="polyline"===k.type?k.paths:k.rings;p=x.state.transform;x=x.state.inverseTransform;for(q=0;q<y.length;q++)for(d=y[q],a=0;a<d.length;a++){const c=d[a],r=p[0]*c[0]+p[2]*c[1]+p[4],e=p[1]*c[0]+p[3]*c[1]+p[5];d[a]=g(c,x[0]*(r+w)+x[2]*(e+u)+x[4],x[1]*(r+w)+x[3]*(e+u)+x[5],void 0)}"paths"in k?k.paths=t:k.rings=t}return k};b.getRotationAngle=function(k,w,u,x,y,t){return 180*Math.atan2(w-t,k-y)/Math.PI-180*Math.atan2(w-x,k-u)/
Math.PI};b.getScaleRatio=function(k,w,u,x,y,t){return Math.sqrt((y-k)*(y-k)+(t-w)*(t-w))/Math.sqrt((u-k)*(u-k)+(x-w)*(x-w))};b.move=C;b.scale=function(k,w,u,x){if("point"===k.type){const {x:e,y:h}=k;var y=x?x[0]:e,t=x?x[1]:h;k=k.clone();u=(h-t)*u+t;k.x=(e-y)*w+y;k.y=u;return k}if("multipoint"===k.type){y=z.geometryToCoordinates(k);t=l.create();const [e,h,v,E]=m.getRingsOrPathsBounds(t,[y]);y=x?x[0]:(e+v)/2;t=x?x[1]:(E+h)/2;k=k.clone();x=k.points;for(var p=0;p<x.length;p++){var q=x[p];const [n,B]=
q;x[p]=g(q,(n-y)*w+y,(B-t)*u+t,void 0)}return k}if("extent"===k.type){const {xmin:e,xmax:h,ymin:v,ymax:E}=k;y=x?x[0]:(e+h)/2;t=x?x[1]:(E+v)/2;k=k.clone();k.xmin=(e-y)*w+y;k.ymax=(E-t)*u+t;k.xmax=(h-y)*w+y;k.ymin=(v-t)*u+t;k.xmin>k.xmax&&(w=k.xmin,k.xmin=k.xmax,k.xmax=w);k.ymin>k.ymax&&(w=k.ymin,k.ymin=k.ymax,k.ymax=w);return k}y=z.geometryToCoordinates(k);t=l.create();const [d,a,c,r]=m.getRingsOrPathsBounds(t,y);t=x?x[0]:(d+c)/2;x=x?x[1]:(r+a)/2;k=k.clone();p="polyline"===k.type?k.paths:k.rings;for(q=
0;q<y.length;q++){const e=y[q];for(let h=0;h<e.length;h++){const v=e[h],[E,n]=v;p[q][h]=g(v,(E-t)*w+t,(n-x)*u+x,void 0)}}"paths"in k?k.paths=p:k.rings=p;return k};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/time ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../layers/support/PromiseQueue ./debugFlags".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){function r(K){return h.has(K)?h.get(K):"number"===typeof K?K:1}const e=C.getLogger("esri.views.support.Scheduler");b.TaskPriority=void 0;(function(K){K.RESOURCE_CONTROLLER="schedule";K.SLIDE="slide";K.STREAM_DATA_LOADER="stream loader";K.ELEVATION_QUERY="elevation query";K.TERRAIN_SURFACE="terrain";K.SURFACE_GEOMETRY_UPDATES="surface geometry updates";K.GRAPHICS_CORE="Graphics3D";K.I3S_CONTROLLER="I3S";K.POINT_CLOUD_LAYER="point cloud";K.FEATURE_TILE_FETCHER=
"feature fetcher";K.STAGE="stage";K.GRAPHICS_DECONFLICTOR="graphics deconflictor";K.FILTER_VISIBILITY="Graphics3D filter visibility";K.SCALE_VISIBILITY="Graphics3D scale visibility";K.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";K.POINT_OF_INTEREST_FREQUENT="POI frequent";K.POINT_OF_INTEREST_INFREQUENT="POI infrequent";K.LABELER="labeler";K.FEATURE_QUERY_ENGINE="feature query";K.FEATURE_TILE_TREE="feature tile tree";K.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";K.ELEVATION_ALIGNMENT="elevation alignment";
K.TEXT_TEXTURE_ATLAS="text texture atlas";K.TEXTURE_UNLOAD="texture unload";K.OVERLAY_MANAGER="overlay manager";K.LINE_OF_SIGHT_TOOL="line of sight tool";K.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";K.ELEVATION_PROFILE="elevation profile";K.SNAPPING="snapping";K.SHADOW_ACCUMULATOR="shadow accumulator";K[K.TEST_PRIO=1]="TEST_PRIO"})(b.TaskPriority||(b.TaskPriority={}));const h=new Map([[b.TaskPriority.RESOURCE_CONTROLLER,0],[b.TaskPriority.SLIDE,0],[b.TaskPriority.STREAM_DATA_LOADER,
0],[b.TaskPriority.ELEVATION_QUERY,0],[b.TaskPriority.TERRAIN_SURFACE,1],[b.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[b.TaskPriority.GRAPHICS_CORE,2],[b.TaskPriority.I3S_CONTROLLER,2],[b.TaskPriority.POINT_CLOUD_LAYER,2],[b.TaskPriority.FEATURE_TILE_FETCHER,2],[b.TaskPriority.STAGE,4],[b.TaskPriority.GRAPHICS_DECONFLICTOR,4],[b.TaskPriority.FILTER_VISIBILITY,4],[b.TaskPriority.SCALE_VISIBILITY,4],[b.TaskPriority.FRUSTUM_VISIBILITY,4],[b.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[b.TaskPriority.POINT_OF_INTEREST_INFREQUENT,
30],[b.TaskPriority.LABELER,8],[b.TaskPriority.FEATURE_QUERY_ENGINE,8],[b.TaskPriority.FEATURE_TILE_TREE,16],[b.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[b.TaskPriority.ELEVATION_ALIGNMENT,12],[b.TaskPriority.TEXT_TEXTURE_ATLAS,12],[b.TaskPriority.TEXTURE_UNLOAD,12],[b.TaskPriority.OVERLAY_MANAGER,12],[b.TaskPriority.LINE_OF_SIGHT_TOOL,16],[b.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[b.TaskPriority.SNAPPING,0],[b.TaskPriority.SHADOW_ACCUMULATOR,30]]),v=u.Milliseconds(6.5),E=u.Milliseconds(1),
n=u.Milliseconds(30),B=u.Milliseconds(1E3/30),f=u.Milliseconds(100);var D;(function(K){let J=function(O){function V(T){var S=O.call(this,T)||this;S.updating=!0;S.performanceInfo={total:new g("total"),tasks:new Map};S._frameTaskTimes=new Map;S._budget=null;S._state=1;S._tasks=new k;S._runQueue=new k;S._load=0;S._idleStateCallbacks=new k;S._idleUpdatesStartFired=!1;S._maxReschedule=R;S._forceTask=!1;S._debug=!1;S._debugHandle=x.init(c,"SCHEDULER_LOG_SLOW_TASKS",U=>S._debug=U);S._budget=new F(T.nowFunc);
for(const U of Object.keys(b.TaskPriority))S.performanceInfo.tasks.set(b.TaskPriority[U],new g(b.TaskPriority[U]));let L;const N=l._assertThisInitialized(S);S._test={get state(){return A.isNone(L)?N._state:L},set state(U){L=U},FRAME_SAFETY_BUDGET:v,INTERACTING_BUDGET:B,IDLE_BUDGET:f,get budget(){return N._budget.budget},usedBudget:0,updateTask:U=>S._updateTask(U),getState:U=>S._getState(U),getRuntime:U=>S._getRuntime(U),resetRuntimes:()=>S._resetRuntimes(),getRunning:()=>S._getRunning()};return S}
l._inheritsLoose(V,O);var M=V.prototype;M.destroy=function(){this._debugHandle&&this._debugHandle.remove()};M.registerTask=function(T,S){const L=r(T);S=new Q(this,T,S,L);this._tasks.push(S);this.performanceInfo.tasks.has(T)||this.performanceInfo.tasks.set(T,new g(T));return S};M.registerIdleStateCallbacks=function(T,S){const L={idleBegin:T,idleEnd:S};this._idleStateCallbacks.push(L);2===this.state&&this._idleUpdatesStartFired&&L.idleBegin();const N=this;return{remove:()=>this._removeIdleStateCallbacks(L),
set idleBegin(U){N._idleUpdatesStartFired&&(L.idleEnd(),2===N._state&&U());L.idleBegin=U},set idleEnd(U){L.idleEnd=U}}};M.updateBudget=function(T){this._test.usedBudget=0;let S=v,L=T.frameDuration,N=E;switch(this.state){case 2:S=u.Milliseconds(0);L=u.Milliseconds(Math.max(f,T.frameDuration));N=n;break;case 1:L=u.Milliseconds(Math.max(B,T.frameDuration))}L=u.Milliseconds(L-T.elapsedFrameTime-S);if(2!==this.state&&L<E&&!this._forceTask)return this._forceTask=!0,!1;L=u.Milliseconds(Math.max(L,N));this._budget.reset(L,
this.state);this._maxReschedule=R;this._updateLoad();return this._schedule()};M.frame=function(){this._forceTask=!1;switch(this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(T=>T.idleBegin()));this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};M.stopFrame=function(){this._budget.reset(u.Milliseconds(0),this._state);this._budget.madeProgress()};M._removeIdleStateCallbacks=
function(T){this._idleUpdatesStartFired&&T.idleEnd();this._idleStateCallbacks.removeUnordered(T)};M.removeTask=function(T){this._tasks.removeUnordered(T);this._runQueue.removeUnordered(T)};M._updateTask=function(T){this._tasks.forAll(S=>{S.name===T&&S.setPriority(T)})};M._getState=function(T){if(this._runQueue.some(L=>L.name===T))return b.TaskState.SCHEDULED;let S=b.TaskState.IDLE;this._tasks.forAll(L=>{L.name===T&&L.needsUpdate&&(1>=L.schedulePriority?S=b.TaskState.READY:S!==b.TaskState.READY&&(S=
b.TaskState.WAITING))});return S};M._getRuntime=function(T){let S=0;this._tasks.forAll(L=>{L.name===T&&(S+=L.runtime)});return S};M._resetRuntimes=function(){this._tasks.forAll(T=>T.runtime=0)};M._getRunning=function(){const T=new Map;this._tasks.forAll(L=>{L.needsUpdate&&T.set(L.name,(T.get(L.name)||0)+1)});if(0===T.size)return null;let S="";T.forEach((L,N)=>{S=1<L?S+` ${L}x ${N}`:S+` ${N}`});return S};M._runIdle=function(){this._run()};M._runInteracting=function(){this._run()};M._runAnimating=function(){this._run()};
M._updateLoad=function(){const T=this._tasks.reduce((S,L)=>L.needsUpdate?++S:S,0);this._load=.9*this._load+T*(1-.9)};M._schedule=function(){if(0>=this._maxReschedule)return!1;this._runQueue.filterInPlace(T=>{if(T.needsUpdate)return!0;T.schedulePriority=T.basePriority;return!1});for(this._tasks.forAll(T=>{0===T.basePriority&&T.needsUpdate&&!this._runQueue.some(S=>S===T)&&this._runQueue.unshift(T)});0===this._runQueue.length;){let T=!1,S=0;this._tasks.forAll(L=>{if(L.needsUpdate&&0!==L.schedulePriority&&
0!==L.basePriority)switch(T=!0,S=Math.max(S,L.basePriority),L.schedulePriority){case 1:L.schedulePriority=0;this._runQueue.push(L);break;default:--L.schedulePriority}});if(!T)return this.updating=!1;this._maxReschedule===R&&(this._maxReschedule=S);--this._maxReschedule}return this.updating=!0};M._run=function(){const T=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var S=this._budget.now();const L=this._runQueue.pop();this._budget.resetProgress();try{L.task.runTask(this._budget)}catch(N){e.error(`Exception in task "${L.name}"`,
N)}L.schedulePriority=L.basePriority;S=this._budget.now()-S;L.runtime+=S;this._frameTaskTimes.set(L.priority,this._frameTaskTimes.get(L.priority)+S);this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",L.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._recordFrameTaskTimes(this._budget.now()-T);return}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-T)};M._startFrameTaskTimes=function(){for(const T of Object.keys(b.TaskPriority))this._frameTaskTimes.set(b.TaskPriority[T],
0)};M._recordFrameTaskTimes=function(T){this._frameTaskTimes.forEach((S,L)=>this.performanceInfo.tasks.get(L).record(S));this.performanceInfo.total.record(T)};l._createClass(V,[{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return A.isNone(this._test.state)?this._state:this._test.state},set:function(T){this._state!==T&&(this._state=T,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(S=>
S.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return V}(z);m.__decorate([y.property()],J.prototype,"updating",void 0);m.__decorate([y.property()],J.prototype,"nowFunc",void 0);J=m.__decorate([d.subclass("esri.views.support.Scheduler")],J);K.Scheduler=J;let Q=function(O){function V(T,S,L,N){var U=O.call(this,{})||this;U._scheduler=T;U.name=S;U._basePriority=N;U.runtime=0;U._queue=new a;U.updating=!1;U.schedulePriority=U._basePriority;U.task=A.isSome(L)?L:{running:!1,runTask:fa=>
U.processQueue(fa)};return U}l._inheritsLoose(V,O);var M=V.prototype;M.normalizeCtorArgs=function(){return{}};M.remove=function(){this.processQueue(H);this._scheduler.removeTask(this);this.schedule=P.schedule;this.reschedule=P.reschedule};M.setPriority=function(T){this.name=T;T=r(T);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=T;this._basePriority=T};M.schedule=function(T,S,L){this.updating=!0;return this._queue.push(T,S,L)};M.reschedule=function(T,S,L){this.updating=
!0;return this._queue.unshift(T,S,L)};M.processQueue=function(T){for(;!T.done&&this._queue.process();)T.madeProgress();this.updating=0<this._queue.length};l._createClass(V,[{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(T){this.setPriority(T)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return V}(z);m.__decorate([y.property()],Q.prototype,"updating",void 0);Q=m.__decorate([d.subclass("esri.views.support.SchedulerTask")],
Q);let F=function(){function O(M){this.now=M;this._budget=this._begin=0;this._state=2;this._didWork=!1;this._enabled=!0}var V=O.prototype;V.run=function(M){if(this.done)return!1;!0===M()&&(this._didWork=!0);return!0};V.madeProgress=function(){this._didWork=!0};V.reset=function(M,T){this._begin=this.now();this._budget=M;this._state=T;this._didWork=!1};V.resetProgress=function(){this._didWork=!1};l._createClass(O,[{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},
{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(M){this._enabled=M}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"hasProgressed",get:function(){return this._didWork}}]);return O}();K.Budget=F})(D||(D={}));b.TaskState=void 0;(function(K){K.SCHEDULED="s";K.READY="r";K.WAITING="w";K.IDLE=
"i"})(b.TaskState||(b.TaskState={}));const H=(()=>{const K=new D.Budget(()=>performance.now());K.enabled=!1;return K})(),P=new (function(){function K(){}var J=K.prototype;J.remove=function(){};J.processQueue=function(){};J.schedule=function(Q,F,O){try{if(w.isAborted(F)){const V=w.createAbortError();return O?Promise.resolve(O(V)):Promise.reject(V)}return w.when(Q())}catch(V){return Promise.reject(V)}};J.reschedule=function(Q,F,O){return this.schedule(Q,F,O)};return K}()),R=Number.MAX_SAFE_INTEGER;
b.ImmediateTask=P;b.getTaskPriority=r;b.newScheduler=function(K){return new D.Scheduler({nowFunc:K})};b.noBudget=H;b.taskPriorities=h;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/layers/support/PromiseQueue":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils"],function(b,l){let m=function(z,C,A,g,k){this.resolve=z;this.reject=C;this.callback=A;this.signal=g;this.abortCallback=k};return function(){function z(){this._tasks=[]}var C=z.prototype;C.push=function(A,
g,k){return new Promise((w,u)=>this._tasks.push(new m(w,u,A,g,k)))};C.unshift=function(A,g,k){return new Promise((w,u)=>this._tasks.unshift(new m(w,u,A,g,k)))};C.process=function(){if(0===this._tasks.length)return!1;const A=this._tasks.shift();try{const g=l.isAborted(A.signal);if(g&&!A.abortCallback)A.reject(l.createAbortError());else{const k=g?A.abortCallback(l.createAbortError()):A.callback();l.isPromise(k)?k.then(A.resolve,A.reject):A.resolve(k)}}catch(g){A.reject(g)}return!0};C.cancelAll=function(){const A=
l.createAbortError();for(const g of this._tasks)if(g.abortCallback){const k=g.abortCallback(A);g.resolve(k)}else g.reject(A);this._tasks.length=0};b._createClass(z,[{key:"length",get:function(){return this._tasks.length}}]);return z}()})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w){m=function(u){function x(){var y=u.apply(this,arguments)||this;y.SCHEDULER_LOG_SLOW_TASKS=!1;y.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return y}b._inheritsLoose(x,u);return x}(m);l.__decorate([z.property()],m.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);l.__decorate([z.property()],m.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);m=l.__decorate([w.subclass("esri.views.support.DebugFlags")],m);return new m})},"esri/views/3d/interactive/SnappingVisualizer3D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../core/has ../../../core/handleUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../../interactive/snapping/Settings ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){z=function(q){function d(){return q.apply(this,arguments)||this}l._inheritsLoose(d,q);var a=d.prototype;a.visualizeIntersectionPoint=function(c,r){const {coordinateHelper:e,elevationInfo:h,view:v}=r;return C.destroyHandle(new u.PointVisualElement({view:v,primitive:"circle",geometry:e.createPoint(c.intersectionPoint),elevationInfo:h,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:m.toUnitRGBA(y.defaults.orange),pixelSnappingEnabled:!1}))};a.visualizePoint=function(c,
r){const {coordinateHelper:e,elevationInfo:h,view:v}=r;return C.destroyHandle(new u.PointVisualElement({view:v,primitive:"circle",geometry:e.createPoint(c.point),elevationInfo:h,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:m.toUnitRGBA(y.defaults.orange),pixelSnappingEnabled:!1}))};a.visualizeLine=function(c,r){const {coordinateHelper:e,elevationInfo:h,view:v}=r;return C.destroyHandle(this.createLineSegmentHintFromMap(c.type,c.lineStart,c.lineEnd,e,h,v,c.fadeLeft,c.fadeRight))};a.visualizeParallelSign=
function(c,r){const {coordinateHelper:e,elevationInfo:h,view:v}=r,E=t.anyMapPointToRender(c.lineStart,e,h,r.view);c=t.anyMapPointToRender(c.lineEnd,e,h,r.view);c=A.lerp(c,E,c,.5);r=new w.ParallelLineVisualElement({view:v,attached:!1,offset:y.defaults.parallelLineHintOffset,length:y.defaults.parallelLineHintLength,width:y.defaults.parallelLineHintWidth,color:m.toUnitRGBA(y.defaults.orange),location:c,renderOccluded:16});r.setDirectionFromPoints(E,c);r.attached=!0;return C.destroyHandle(r)};a.visualizeRightAngleQuad=
function(c,r){const {coordinateHelper:e,elevationInfo:h,view:v}=r;return C.destroyHandle(new x.RightAngleQuadVisualElement({view:v,attached:!0,color:m.toUnitRGBA(y.defaults.orange),renderOccluded:2,outlineRenderOccluded:16,outlineColor:m.toUnitRGBA(y.defaults.orange),outlineSize:y.defaults.rightAngleHintOutlineSize,size:y.defaults.rightAngleHintSize,geometry:{previous:t.anyMapPointToRender(c.previousVertex,e,h,v),center:t.anyMapPointToRender(c.centerVertex,e,h,v),next:t.anyMapPointToRender(c.nextVertex,
e,h,v)}}))};a.createLineSegmentHintFromMap=function(c,r,e,h,v,E,n=!0,B=!0){const f=g.create(),D=g.create();t.anyMapPointsToRenderWithEqualZ(r,e,h,v,E,f,D);return this.createLineSegmentHint(c,E,f,D,n,B)};a.createLineSegmentHint=function(c,r,e,h,v=!0,E=!0){r=new k.ExtendedLineVisualElement({view:r,extensionType:3,start:e,end:h,color:m.toUnitRGBA(y.defaults.orange),renderOccluded:16});switch(c){case 0:r.width=y.defaults.lineHintWidthTarget;r.fadedExtensions={start:0,end:y.defaults.lineHintFadedExtensions};
break;case 2:r.width=y.defaults.lineHintWidthReference;r.fadedExtensions={start:0,end:0};break;case 1:r.width=y.defaults.lineHintWidthReference,r.fadedExtensions={start:v?y.defaults.lineHintFadedExtensions:0,end:E?y.defaults.lineHintFadedExtensions:0}}r.attached=!0;return r};return d}(p.SnappingVisualizer);b.SnappingVisualizer3D=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/ExtendedLineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Handles ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../geometry/support/clipRay ../../../../geometry/support/frustum ../../../../geometry/support/lineSegment ../../../../geometry/support/ray ./LaserlineVisualElement ./Object3DVisualElement ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a){m=function(E){function n(f){var D=E.call(this,f)||this;D._ray=t.create();D._externalResources=null;D._handles=new z;D._isWorldDown=!1;D._start=g.create();D._end=g.fromValues(1,0,0);D._width=1;D._color=w.fromValues(1,0,1,1);D._polygonOffset=!1;D._writeDepthEnabled=!0;D._innerWidth=0;D._innerColor=w.fromValues(1,1,1,1);D._stippleIntegerRepeats=!0;D._stipplePattern=null;D._stippleOffColor=null;D._falloff=0;D._extensionType=0;D._laserlineStyle=null;D._laserlineEnabled=
!1;D._renderOccluded=4;D._fadedExtensions=v;D.applyProps(f);return D}l._inheritsLoose(n,E);var B=n.prototype;B.createExternalResources=function(){const f=new a.RibbonLineMaterial(this.materialParameters);this._handles.add(this.view.state.watch("camera",()=>{this.updateGeometry()}));const D=new p.LaserlineVisualElement({view:this.view,attached:this._laserlineEnabled});this._externalResources={material:f,laserline:D}};B.destroyExternalResources=function(){C.isSome(this._externalResources)&&this._externalResources.laserline.destroy();
this._externalResources=null;this._handles.removeAll()};B.forEachExternalMaterial=function(f){C.isSome(this._externalResources)&&f(this._externalResources.material)};B.createGeometries=function(f){var D=[g.create(),g.create()],H=3===this.extensionType;H&&D.push(g.create(),g.create());H=H?new Float32Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]):null;D=d.createPolylineGeometry(D,null,H);f.addGeometry(D,C.unwrap(this._externalResources).material);this.updateVertices(D)};B.updateVisibility=function(f){E.prototype.updateVisibility.call(this,
f);C.isSome(this._externalResources)&&(this._externalResources.laserline.visible=f)};B.setStartEndFromWorldDownAtLocation=function(f){this._isWorldDown=!0;A.copy(this._start,f);this.view.renderCoordsHelper.worldUpAtPosition(f,this._end);A.subtract(this._end,f,this._end);t.fromPoints(this._start,this._end,this._ray);this.updateGeometry()};B.updateMaterial=function(){C.isNone(this._externalResources)||this._externalResources.material.setParameterValues(this.materialParameters)};B.updateGeometry=function(){C.isSome(this.object)&&
this.updateVertices(this.object.geometries[0])};B.updateVertices=function(f){const D=3===this._extensionType?this.updateLineSegmentFinite(h):this.updateLineSegmentInfinite(this._extensionType,h);this.updateVertexAttributes(f,D);C.isSome(this._externalResources)&&(this._externalResources.laserline.intersectsLine=D)};B.updateLineSegmentFinite=function(f){return y.fromPoints(this._start,this._end,f)};B.updateLineSegmentInfinite=function(f,D){var H=this.view.state.camera;u.fromRay(this._ray,c);switch(f){case 0:c.c0=
-Number.MAX_VALUE;break;case 1:case 2:var P=this._ray.origin;f=C.unwrapOr(this.view.elevationProvider.getElevation(P[0],P[1],P[2],this.view.renderCoordsHelper.spatialReference,"ground"),0);P=this.view.renderCoordsHelper.getAltitude(P);this._isWorldDown&&P<f&&A.negate(c.ray.direction,c.ray.direction);2===this._extensionType&&null!=f&&(c.c1=Math.abs(P-f))}if(!x.intersectClipRay(H.frustum,c))return y.fromPoints(this._start,this._end,D);H=u.getStart(c,r);f=u.getEnd(c,e);return y.fromPoints(H,f,D)};B.updateVertexAttributes=
function(f,D){f=f.getMutableAttribute("position").data;if(3===this.extensionType){var H=y.pointAt(D,-this.fadedExtensions.start,r);f[0]=H[0];f[1]=H[1];f[2]=H[2];H=y.pointAt(D,0,r);f[3]=H[0];f[4]=H[1];f[5]=H[2];H=y.pointAt(D,1,r);f[6]=H[0];f[7]=H[1];f[8]=H[2];D=y.pointAt(D,1+this.fadedExtensions.end,r);f[9]=D[0];f[10]=D[1];f[11]=D[2]}else H=y.pointAt(D,0,r),f[0]=H[0],f[1]=H[1],f[2]=H[2],D=y.pointAt(D,1,r),f[3]=D[0],f[4]=D[1],f[5]=D[2];C.isSome(this.object)&&this.object.geometryVertexAttrsUpdated(0)};
l._createClass(n,[{key:"start",get:function(){return this._start},set:function(f){this._isWorldDown=!1;A.exactEquals(this._start,f)||(A.copy(this._start,f),t.fromPoints(this._start,this._end,this._ray),this.updateGeometry())}},{key:"end",get:function(){return this._end},set:function(f){this._isWorldDown=!1;A.exactEquals(this._end,f)||(A.copy(this._end,f),t.fromPoints(this._start,this._end,this._ray),this.updateGeometry())}},{key:"width",get:function(){return this._width},set:function(f){f!==this._width&&
(this._width=f,this.updateMaterial())}},{key:"color",get:function(){return this._color},set:function(f){k.exactEquals(f,this._color)||(k.copy(this._color,f),this.updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(f){f!==this._polygonOffset&&(this._polygonOffset=f,this.updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(f){this._writeDepthEnabled!==f&&(this._writeDepthEnabled=f,this.updateMaterial())}},
{key:"innerWidth",get:function(){return this._innerWidth},set:function(f){f!==this._innerWidth&&(this._innerWidth=f,this.updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(f){k.exactEquals(f,this._innerColor)||(k.copy(this._innerColor,f),this.updateMaterial())}},{key:"stippleIntegerRepeats",get:function(){return this._stippleIntegerRepeats},set:function(f){f!==this._stippleIntegerRepeats&&(this._stippleIntegerRepeats=f,this.updateMaterial())}},{key:"stipplePattern",
get:function(){return this._stipplePattern},set:function(f){const D=C.isSome(f)!==C.isSome(this._stipplePattern);this._stipplePattern=f;D?this.recreate():this.updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(f){if(C.isNone(f)||C.isNone(this._stippleOffColor)||!k.exactEquals(f,this._stippleOffColor))this._stippleOffColor=C.isSome(f)?w.clone(f):null,this.updateMaterial()}},{key:"falloff",get:function(){return this._falloff},set:function(f){f!==this._falloff&&
(this._falloff=f,this.updateMaterial())}},{key:"extensionType",get:function(){return this._extensionType},set:function(f){f!==this._extensionType&&(this._extensionType=f,this.updateGeometry())}},{key:"_laserlineAttached",get:function(){return this._laserlineEnabled&&C.isSome(this._laserlineStyle)}},{key:"laserlineStyle",get:function(){return this._laserlineStyle},set:function(f){this._laserlineStyle=f;C.isSome(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached,
C.isSome(f)&&(this._externalResources.laserline.style=f))}},{key:"laserlineEnabled",get:function(){return this._laserlineEnabled},set:function(f){this._laserlineEnabled!==f&&(this._laserlineEnabled=f,C.isSome(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached))}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(f){f!==this._renderOccluded&&(this._renderOccluded=f,this.updateMaterial())}},{key:"fadedExtensions",get:function(){return this._fadedExtensions},
set:function(f){this._fadedExtensions=C.unwrapOr(f,v);this.recreateGeometry()}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stippleIntegerRepeats:this._stippleIntegerRepeats,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}}]);return n}(q.Object3DVisualElement);
const c=u.create(),r=g.create(),e=g.create(),h=y.create();q=1/3;const v={start:q,end:q};b.ExtendedLineVisualElement=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/vec4f32":function(){define(["exports"],function(b){function l(){return new Float32Array(4)}function m(r){const e=new Float32Array(4);e[0]=r[0];e[1]=r[1];e[2]=r[2];e[3]=r[3];return e}function z(r,e,h,v){const E=new Float32Array(4);E[0]=r;E[1]=e;E[2]=h;E[3]=v;return E}function C(r,e){return new Float32Array(r,e,4)}function A(){return l()}
function g(){return z(1,1,1,1)}function k(){return z(1,0,0,0)}function w(){return z(0,1,0,0)}function u(){return z(0,0,1,0)}function x(){return z(0,0,0,1)}const y=l(),t=g(),p=k(),q=w(),d=u(),a=x();var c=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C,zeros:A,ones:g,unitX:k,unitY:w,unitZ:u,unitW:x,ZEROS:y,ONES:t,UNIT_X:p,UNIT_Y:q,UNIT_Z:d,UNIT_W:a});b.ONES=t;b.UNIT_W=a;b.UNIT_X=p;b.UNIT_Y=q;b.UNIT_Z=d;b.ZEROS=y;b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.ones=g;b.unitW=
x;b.unitX=k;b.unitY=w;b.unitZ=u;b.vec4f32=c;b.zeros=A})},"esri/geometry/support/clipRay":function(){define(["exports","../../core/ObjectStack","../../chunks/vec3","./ray","./vectorStacks"],function(b,l,m,z,C){function A(x){return x?{ray:z.create(x.ray),c0:x.c0,c1:x.c1}:{ray:z.create(),c0:0,c1:Number.MAX_VALUE}}function g(x,y,t,p=A()){z.copy(x,p.ray);p.c0=y;p.c1=t;return p}function k(x,y,t=A()){const p=m.length(x.vector);z.fromValues(x.origin,y,t.ray);t.c0=0;t.c1=p;return t}function w(x,y,t){return m.add(t,
x.ray.origin,m.scale(t,x.ray.direction,y))}const u=new l.ObjectStack(()=>({c0:0,c1:0,ray:null}));b.copy=function(x,y=A()){return g(x.ray,x.c0,x.c1,y)};b.create=A;b.fromLineSegment=function(x,y=A()){const t=m.normalize(C.sv3d.get(),x.vector);return k(x,t,y)};b.fromLineSegmentAndDirection=k;b.fromRay=function(x,y=A()){z.copy(x,y.ray);y.c0=0;y.c1=Number.MAX_VALUE;return y};b.fromValues=g;b.getAt=w;b.getEnd=function(x,y){return w(x,x.c1,y)};b.getStart=function(x,y){return w(x,x.c0,y)};b.wrap=function(x,
y,t){const p=u.get();p.ray=x;p.c0=y;p.c1=t;return p};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/frustum":function(){define("exports ../../core/ObjectStack ../../chunks/mat4 ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/vec4 ../../chunks/vec4f64 ./clipRay ./plane ./vectorStacks".split(" "),function(b,l,m,z,C,A,g,k,w,u){function x(c){return c?[w.create(c[0]),w.create(c[1]),w.create(c[2]),w.create(c[3]),w.create(c[4]),w.create(c[5])]:[w.create(),w.create(),w.create(),
w.create(),w.create(),w.create()]}function y(){return[C.create(),C.create(),C.create(),C.create(),C.create(),C.create(),C.create(),C.create()]}function t(c,r){w.fromPoints(r[4],r[0],r[3],c[0]);w.fromPoints(r[1],r[5],r[6],c[1]);w.fromPoints(r[4],r[5],r[1],c[2]);w.fromPoints(r[3],r[2],r[6],c[3]);w.fromPoints(r[0],r[1],r[2],c[4]);w.fromPoints(r[5],r[4],r[7],c[5])}function p(c,r){for(let e=0;6>e;e++)if(!w.clip(c[e],r))return!1;return!0}const q=[g.fromValues(-1,-1,-1,1),g.fromValues(1,-1,-1,1),g.fromValues(1,
1,-1,1),g.fromValues(-1,1,-1,1),g.fromValues(-1,-1,1,1),g.fromValues(1,-1,1,1),g.fromValues(1,1,1,1),g.fromValues(-1,1,1,1)],d=new l.ObjectStack(k.create),a=y();b.computePlanes=t;b.copy=function(c,r=x()){for(let e=0;6>e;e++)w.copy(c[e],r[e])};b.create=x;b.createPoints=y;b.fromMatrix=function(c,r,e,h=a){c=m.multiply(u.sm4d.get(),r,c);m.invert(c,c);for(r=0;8>r;++r){const v=A.transformMat4(u.sv4d.get(),q[r],c);z.set(h[r],v[0]/v[3],v[1]/v[3],v[2]/v[3])}t(e,h)};b.intersectClipRay=function(c,r){for(let e=
0;6>e;e++)if(!w.clipInfinite(c[e],r))return!1;return!0};b.intersectsAABB=function(c,r){for(let e=0;6>e;e++)if(w.isAABBFullyInside(c[e],r))return!1;return!0};b.intersectsLineSegment=function(c,r,e){return p(c,k.fromLineSegmentAndDirection(r,e,d.get()))};b.intersectsPoint=function(c,r){for(let e=0;6>e;e++)if(0<w.signedDistance(c[e],r))return!1;return!0};b.intersectsRay=function(c,r){return p(c,k.fromRay(r,d.get()))};b.intersectsSphere=function(c,r){for(let e=0;6>e;e++)if(w.isSphereFullyInside(c[e],
r))return!1;return!0};b.planePointIndices={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/lineSegment":function(){define("exports ../../core/mathUtils ../../core/ObjectStack ../../chunks/vec3 ../../chunks/vec3f64 ./vectorStacks".split(" "),function(b,l,m,z,C,A){function g(q){return q?{origin:C.clone(q.origin),vector:C.clone(q.vector)}:{origin:C.create(),vector:C.create()}}function k(q,
d){const a=p.get();a.origin=q;a.vector=d;return a}function w(q,d,a=g()){z.copy(a.origin,q);z.copy(a.vector,d);return a}function u(q,d){d=z.subtract(A.sv3d.get(),d,q.origin);var a=z.dot(q.vector,d);const c=z.dot(q.vector,q.vector);a=l.clamp(a/c,0,1);q=z.subtract(A.sv3d.get(),z.scale(A.sv3d.get(),q.vector,a),d);return z.dot(q,q)}function x(q,d,a,c,r){const {vector:e,origin:h}=q;d=z.subtract(A.sv3d.get(),d,h);d=z.dot(e,d)/z.squaredLength(e);z.scale(r,e,l.clamp(d,a,c));return z.add(r,r,q.origin)}function y(q,
d,a,c){const r=q.origin;var e=z.add(A.sv3d.get(),r,q.vector);q=d.origin;var h=z.add(A.sv3d.get(),q,d.vector),v=A.sv3d.get();d=A.sv3d.get();v[0]=r[0]-q[0];v[1]=r[1]-q[1];v[2]=r[2]-q[2];d[0]=h[0]-q[0];d[1]=h[1]-q[1];d[2]=h[2]-q[2];if(1E-6>Math.abs(d[0])&&1E-6>Math.abs(d[1])&&1E-6>Math.abs(d[2]))return!1;h=A.sv3d.get();h[0]=e[0]-r[0];h[1]=e[1]-r[1];h[2]=e[2]-r[2];if(1E-6>Math.abs(h[0])&&1E-6>Math.abs(h[1])&&1E-6>Math.abs(h[2]))return!1;e=v[0]*d[0]+v[1]*d[1]+v[2]*d[2];var E=d[0]*h[0]+d[1]*h[1]+d[2]*h[2];
const n=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],B=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*n-E*E;if(1E-6>Math.abs(B))return!1;v=(e*E-(v[0]*h[0]+v[1]*h[1]+v[2]*h[2])*n)/B;e=(e+E*v)/n;a&&(v=l.clamp(v,0,1),e=l.clamp(e,0,1));a=A.sv3d.get();E=A.sv3d.get();a[0]=r[0]+v*h[0];a[1]=r[1]+v*h[1];a[2]=r[2]+v*h[2];E[0]=q[0]+e*d[0];E[1]=q[1]+e*d[1];E[2]=q[2]+e*d[2];c.tA=v;c.tB=e;c.pA=a;c.pB=E;c.distance2=z.squaredDistance(a,E);return!0}const t={tA:0,tB:0,pA:C.create(),pB:C.create(),distance2:0},p=new m.ObjectStack(()=>({origin:null,
vector:null}));b.closestLineSegmentDistance2=function(q,d){return y(q,d,!0,t)?t.distance2:null};b.closestLineSegmentPoint=function(q,d,a){return y(q,d,!0,t)?(z.copy(a,t.pA),!0):!1};b.closestRayDistance2=function(q,d){if(y(q,k(d.origin,d.direction),!1,t)){const {tA:a,pB:c,distance2:r}=t;if(0<=a&&1>=a)return r;if(0>a)return z.squaredDistance(q.origin,c);if(1<a)return z.squaredDistance(z.add(A.sv3d.get(),q.origin,q.vector),c)}return null};b.copy=function(q,d=g()){return w(q.origin,q.vector,d)};b.create=
g;b.distance=function(q,d){return Math.sqrt(u(q,d))};b.distance2=u;b.fromPoints=function(q,d,a=g()){z.copy(a.origin,q);z.subtract(a.vector,d,q);return a};b.fromValues=w;b.pointAt=function(q,d,a){return z.add(a,q.origin,z.scale(a,q.vector,d))};b.projectPoint=function(q,d,a){return x(q,d,0,1,a)};b.projectPointClamp=x;b.wrap=k;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../support/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),
function(b,l,m,z,C,A,g,k,w){g=function(x){function y(p){var q=x.call(this,p.view)||this;q._angleCutoff=w.defaultAngleCutoff;q._style={};q._heightManifoldTarget=C.create();q._heightManifoldEnabled=!1;q._intersectsLine=A.create();q._intersectsLineEnabled=!1;q._intersectsLineInfinite=!1;q._lineVerticalPlaneSegment=null;q._pathVerticalPlaneBuffers=null;q._pointDistanceLine=null;q.applyProps(p);return q}l._inheritsLoose(y,x);var t=y.prototype;t.createResources=function(){this.ensureRenderer()};t.destroyResources=
function(){this.disposeRenderer()};t.updateVisibility=function(){this.syncHeightManifold();this.syncIntersectsLine();this.syncPathVerticalPlane();this.syncLineVerticalPlane();this.syncPointDistance()};t.syncRenderer=function(){this.attached&&(this._intersectsLineEnabled||this._heightManifoldEnabled||m.isSome(this._pointDistanceLine)||m.isSome(this._pathVerticalPlaneBuffers))?this.ensureRenderer():this.disposeRenderer()};t.ensureRenderer=function(){m.isSome(this.renderer)||(this.renderer=new k.LaserLineRenderer(this.view.renderCoordsHelper,
void 0,{contrastControlEnabled:!0}),this.syncStyle(),this.syncHeightManifold(),this.syncIntersectsLine(),this.syncIntersectsLineInfinite(),this.syncPathVerticalPlane(),this.syncLineVerticalPlane(),this.syncPointDistance(),this.syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))};t.syncStyle=function(){m.isNone(this.renderer)||(this.renderer.setParameterValues(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=
this._style.intersectsLineRadius))};t.syncAngleCutoff=function(){m.isNone(this.renderer)||this.renderer.setParameterValues({angleCutoff:this._angleCutoff})};t.syncHeightManifold=function(){m.isNone(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))};t.syncIntersectsLine=function(){m.isNone(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&
this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))};t.syncIntersectsLineInfinite=function(){m.isNone(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)};t.syncPathVerticalPlane=function(){m.isNone(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=m.isSome(this._pathVerticalPlaneBuffers)&&this.visible,m.isSome(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))};
t.syncLineVerticalPlane=function(){m.isNone(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=m.isSome(this._lineVerticalPlaneSegment)&&this.visible,m.isSome(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))};t.syncPointDistance=function(){m.isNone(this.renderer)||(this.renderer.pointDistanceEnabled=m.isSome(this._pointDistanceLine)&&this.visible,m.isSome(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,
this.renderer.pointDistanceTarget=this._pointDistanceLine.target))};t.disposeRenderer=function(){m.isSome(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)};l._createClass(y,[{key:"testData",get:function(){return this.renderer}},{key:"angleCutoff",get:function(){return this._angleCutoff},set:function(p){this._angleCutoff!==p&&(this._angleCutoff=p,this.syncAngleCutoff())}},{key:"style",get:function(){return this._style},set:function(p){this._style=
p;this.syncStyle()}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldEnabled?this._heightManifoldTarget:null},set:function(p){m.isSome(p)?(z.copy(this._heightManifoldTarget,p),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this.syncRenderer();this.syncHeightManifold()}},{key:"intersectsWorldUpAtLocation",set:function(p){if(m.isNone(p))this.intersectsLine=null;else{var q=this.view.renderCoordsHelper.worldUpAtPosition(p,u);this.intersectsLine=A.fromValues(p,q);
this.intersectsLineInfinite=!0}}},{key:"intersectsLine",get:function(){return this._intersectsLineEnabled?this._intersectsLine:null},set:function(p){m.isSome(p)?(A.copy(p,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1;this.syncIntersectsLine();this.syncRenderer()}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(p){this._intersectsLineInfinite=p;this.syncIntersectsLineInfinite()}},{key:"lineVerticalPlaneSegment",
get:function(){return this._lineVerticalPlaneSegment},set:function(p){this._lineVerticalPlaneSegment=m.isSome(p)?A.copy(p):null;this.syncLineVerticalPlane();this.syncRenderer()}},{key:"pathVerticalPlane",get:function(){return this._pathVerticalPlaneBuffers},set:function(p){this._pathVerticalPlaneBuffers=p;this.syncPathVerticalPlane();this.syncLineVerticalPlane();this.syncPointDistance();this.syncRenderer()}},{key:"pointDistanceLine",get:function(){return this._pointDistanceLine},set:function(p){this._pointDistanceLine=
m.isSome(p)?{origin:C.clone(p.origin),target:C.clone(p.target)}:null;this.syncPointDistance();this.syncRenderer()}}]);return y}(g.VisualElement);const u=C.create();b.LaserlineVisualElement=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,l){let m=function(){function z(A){this._resourcesCreated=this._attached=!1;this._visible=!0;this.view=A;this.view.watch("ready",
g=>{this._resourcesCreated&&(g?this._createResources():this._destroyResources())})}var C=z.prototype;C.applyProps=function(A){let g=!1;for(const k in A)k in this?"attached"===k?g=A[k]:this[k]=A[k]:console.error("Cannot set unknown property",k);this.attached=g};C.destroy=function(){this.attached=!1};C._createResources=function(){this.createResources();this._resourcesCreated=!0;this.visible||this.updateVisibility(!1)};C._destroyResources=function(){this.destroyResources();this._resourcesCreated=!1};
l._createClass(z,[{key:"attached",get:function(){return this._attached},set:function(A){A!==this._attached&&this.view._stage&&((this._attached=A)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(A){A!==this._visible&&(this._visible=A,this.attached&&this.updateVisibility(A))}}]);return z}();b.VisualElement=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../core/maybe ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/vec4 ../../../chunks/vec4f64 ../../../geometry/support/clipRay ../../../geometry/support/frustum ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./LaserlinePathData ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ../webgl-engine/shaders/LaserlineTechnique".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h){function v(P,R,K,J){const Q=E,F=n;A.transformMat4(Q,R,J);A.copy(F,K);F[3]=0;k.transformMat4(F,F,J);t.fromPositionAndNormal(Q,F,P)}const E=g.create(),n=w.create(),B={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:m.deg2rad(6),globalAlphaContrastBoost:2};m=function(){function P(K,J={},Q={contrastControlEnabled:!1}){this._renderCoordsHelper=K;this._config=Q;this._technique=null;this._projInfo=
w.create();this._zScale=C.create();this._heightManifoldEnabled=!1;this._heightManifoldTarget=g.create();this._pointDistanceEnabled=!1;this._pointDistanceOrigin=g.create();this._pointDistanceTarget=g.create();this._lineVerticalPlaneEnabled=!1;this._lineVerticalPlaneSegment=y.create();this._intersectsLineEnabled=!1;this._intersectsLineSegment=y.create();this._intersectsLineRadius=3;this._pathVerticalPlaneEnabled=this._intersectsLineInfinite=!1;this._pathTechnique=this._pathVerticalPlaneData=null;this.canRender=
!0;this._tempNormal=g.create();this._tempDir=g.create();this._tempUp=g.create();this._tempVec3A=g.create();this._tempVec3B=g.create();this._tempVec4=w.create();this._tempPlane=t.create();this._tempSphere=q.create();this._params=r.copyParameters(J,B)}var R=P.prototype;R.setParameterValues=function(K){r.updateParameters(this._params,K)&&this._requestRender()};R.initializeRenderContext=function(K){this._context=K;this._quadVAO=a.createQuadVAO(K.renderContext.rctx);this._techniqueRepository=K.shaderTechniqueRep;
this._techniqueConfig=new h.LaserlineTechniqueConfiguration;K=new e.LaserlinePathTechniqueConfiguration;K.contrastControlEnabled=this._config.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquire(e.LaserlinePathTechnique,K)};R.uninitializeRenderContext=function(){this._quadVAO=z.disposeMaybe(this._quadVAO);this._technique=z.releaseMaybe(this._technique);this._pathVerticalPlaneData=z.disposeMaybe(this._pathVerticalPlaneData);this._pathTechnique=z.releaseMaybe(this._pathTechnique)};
R.render=function(K){const J=this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled,Q=this.pathVerticalPlaneEnabled;if(!J&&!Q)return!0;const F=K.camera;c.inverseProjectionInfo(F.projectionMatrix,F.fullWidth,F.fullHeight,this._projInfo,this._zScale);J&&this.renderUnified(K);Q&&this.renderPath(K);return!0};R.renderUnified=function(K){const J=K.rctx,Q=this._selectTechnique(),F=Q.program;J.useProgram(F);Q.bindPipelineState(J);this._bindGlobalUniforms(K,
F);this.bindHeightManifoldUniforms(K,F);this.bindPointDistanceUniforms(K,F);this.bindLineVerticalPlaneUniforms(K,F);this.bindIntersectsLineUniforms(K,F);Q.bind(this._params,K.camera);J.bindVAO(this._quadVAO);J.drawArrays(5,0,4)};R.renderPath=function(K){if(!z.isNone(this._pathVerticalPlaneData)&&!z.isNone(this._pathTechnique)){var J=K.rctx,Q=this._pathTechnique,F=Q.program;J.useProgram(F);Q.bindPipelineState(J);this._bindGlobalUniforms(K,F);Q.bind(this._params,this._pathVerticalPlaneData.origin,K.camera);
this._pathVerticalPlaneData.draw(K.rctx)}};R.bindHeightManifoldUniforms=function(K,J){if(this.heightManifoldEnabled){var Q=this._tempVec3A,F=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,Q);v(F,this._heightManifoldTarget,Q,K.camera.viewMatrix);J.setUniform4fv("heightPlane",F)}};R.bindPointDistanceUniforms=function(K,J){if(this._pointDistanceEnabled){K=K.camera;var Q=this._tempSphere;A.copy(Q,this._pointDistanceOrigin);A.transformMat4(Q,Q,K.viewMatrix);Q[3]=
A.distance(this._pointDistanceOrigin,this._pointDistanceTarget);J.setUniform4f("pointDistanceSphere",Q[0],Q[1],Q[2],Q[3])}};R.bindLineVerticalPlaneUniforms=function(K,J){if(this._lineVerticalPlaneEnabled){var Q=this._renderCoordsHelper;K=K.camera;var F=this._tempPlane,O=this._tempVec3A,V=this._tempUp,M=this._tempDir,T=this._tempNormal;y.pointAt(this._lineVerticalPlaneSegment,.5,O);Q.worldUpAtPosition(O,V);A.normalize(M,this._lineVerticalPlaneSegment.vector);A.cross(T,V,M);A.normalize(T,T);v(F,this._lineVerticalPlaneSegment.origin,
T,K.viewMatrix);J.setUniform4fv("lineVerticalPlane",F);F=this._tempVec3A;A.copy(F,this._lineVerticalPlaneSegment.origin);Q.setAltitude(F,0);A.transformMat4(F,F,K.viewMatrix);J.setUniform3fv("lineVerticalStart",F);F=this._tempVec3B;A.add(F,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector);Q.setAltitude(F,0);A.transformMat4(F,F,K.viewMatrix);J.setUniform3fv("lineVerticalEnd",F)}};R.bindIntersectsLineUniforms=function(K,J){if(this._intersectsLineEnabled){var Q=D,F=H;if(this._intersectsLineInfinite){var O=
K.camera;u.fromRay(p.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),f);f.c0=-Number.MAX_VALUE;if(!x.intersectClipRay(O.frustum,f))return;u.getStart(f,Q);u.getEnd(f,F)}else A.copy(Q,this._intersectsLineSegment.origin),A.add(F,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);O=this._tempVec3A;A.transformMat4(O,Q,K.camera.viewMatrix);J.setUniform3fv("intersectsLineStart",O);Q=this._tempVec4;A.copy(Q,this._intersectsLineSegment.vector);this._tempVec4[3]=
0;k.transformMat4(this._tempVec4,this._tempVec4,K.camera.viewMatrix);A.transformMat4(F,F,K.camera.viewMatrix);J.setUniform3fv("intersectsLineEnd",F);A.normalize(Q,Q);J.setUniform3f("intersectsLineDirection",Q[0],Q[1],Q[2]);J.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}};R._bindGlobalUniforms=function(K,J){const Q=K.camera;J.setUniform4fv("projInfo",this._projInfo);J.setUniform2fv("zScale",this._zScale);J.setUniform2f("nearFar",Q.near,Q.far);this._heightManifoldEnabled?J.setUniform1f("maxPixelDistance",
2*Q.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?J.setUniform1f("maxPixelDistance",2*Q.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&J.setUniform1f("maxPixelDistance",2*Q.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin));J.bindTexture(K.offscreenRenderingHelper.linearDepthTexture,"depthMap");J.bindTexture(K.offscreenRenderingHelper.mainColorTexture,"frameColor")};R._requestRender=function(){this._context&&this._context.requestRender()};
R._selectTechnique=function(){this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled;this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled;this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled;this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled;this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled;return this._technique=this._techniqueRepository.releaseAndAcquire(h.LaserlineTechnique,this._techniqueConfig,
this._technique)};l._createClass(P,[{key:"renderSlots",get:function(){return[this._config.contrastControlEnabled?17:16]}},{key:"needsLinearDepth",get:function(){return!0}},{key:"heightManifoldEnabled",get:function(){return this._heightManifoldEnabled},set:function(K){this._heightManifoldEnabled!==K&&(this._heightManifoldEnabled=K,this._requestRender())}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldTarget},set:function(K){A.copy(this._heightManifoldTarget,K);this._requestRender()}},
{key:"pointDistanceEnabled",get:function(){return this._pointDistanceEnabled},set:function(K){K!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=K,this._requestRender())}},{key:"pointDistanceTarget",get:function(){return this._pointDistanceTarget},set:function(K){A.copy(this._pointDistanceTarget,K);this._requestRender()}},{key:"pointDistanceOrigin",get:function(){return this._pointDistanceOrigin},set:function(K){A.copy(this._pointDistanceOrigin,K);this._requestRender()}},{key:"lineVerticalPlaneEnabled",
get:function(){return this._lineVerticalPlaneEnabled},set:function(K){K!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=K,this._requestRender())}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},set:function(K){y.copy(K,this._lineVerticalPlaneSegment);this._requestRender()}},{key:"intersectsLineEnabled",get:function(){return this._intersectsLineEnabled},set:function(K){K!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=K,this._requestRender())}},
{key:"intersectsLineSegment",get:function(){return this._intersectsLineSegment},set:function(K){y.copy(K,this._intersectsLineSegment);this._requestRender()}},{key:"intersectsLineRadius",get:function(){return this._intersectsLineRadius},set:function(K){K!==this._intersectsLineRadius&&(this._intersectsLineRadius=K,this._requestRender())}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(K){K!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=
K,this._requestRender())}},{key:"pathVerticalPlaneEnabled",get:function(){return this._pathVerticalPlaneEnabled},set:function(K){K!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=K,z.isSome(this._pathVerticalPlaneData)&&this._requestRender())}},{key:"pathVerticalPlaneVertices",set:function(K){z.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new d.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.vertices=K;this.pathVerticalPlaneEnabled&&
this._requestRender()}},{key:"pathVerticalPlaneBuffers",set:function(K){z.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new d.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.buffers=K;this.pathVerticalPlaneEnabled&&this._requestRender()}}]);return P}();const f=u.create(),D=g.create(),H=g.create();b.LaserLineRenderer=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/shaders/LaserlinePathTechnique ../../webgl/BufferObject ../../webgl/VertexArrayObject".split(" "),
function(b,l,m,z,C,A,g,k,w,u){let x=function(){function q(a){this._renderCoordsHelper=a;this._buffers=null;this._origin=C.create();this._dirty=!1;this._count=0;this._vao=null}var d=q.prototype;d.draw=function(a){const c=this.ensureVAO(a);m.isSome(c)&&(a.bindVAO(c),a.drawArrays(4,0,this._count))};d.dispose=function(){m.isSome(this._vao)&&this._vao.dispose()};d.ensureVAO=function(a){if(m.isNone(this._buffers))return null;m.isNone(this._vao)&&(this._vao=this.createVAO(a,this._buffers));this.ensureVertexData(this._vao,
this._buffers);return this._vao};d.createVAO=function(a,c){c=this.createDataBuffer(c);this._dirty=!1;return new u(a,k.LaserlinePathTechnique.attributeLocations,{data:A.glLayout(p)},{data:w.createVertex(a,35044,c)})};d.ensureVertexData=function(a,c){this._dirty&&(c=this.createDataBuffer(c),a.vertexBuffers.data.setData(c),this._dirty=!1)};d.numberOfRenderVertices=function(a){return 6*(a.length/3-1)};d.createDataBuffer=function(a){var c=a.reduce((n,B)=>n+this.numberOfRenderVertices(B),0);this._count=
c;c=p.createBuffer(c);const r=this._origin;let e=0,h=0;for(const n of a){for(a=0;a<n.length;a+=3){var v=z.set(t,n[a+0],n[a+1],n[a+2]);0===a?h=this._renderCoordsHelper.getAltitude(v):this._renderCoordsHelper.setAltitude(v,h);var E=this._renderCoordsHelper.worldUpAtPosition(v,y);const B=e+2*a;v=z.subtract(t,v,r);if(a<n.length-3){c.up.setVec(B,E);c.up.setVec(B+3,E);c.up.setVec(B+5,E);for(let f=0;6>f;f++)c.start.setVec(B+f,v);c.extrude.setValues(B+0,0,-1);c.extrude.setValues(B+1,1,-1);c.extrude.setValues(B+
2,1,1);c.extrude.setValues(B+3,0,-1);c.extrude.setValues(B+4,1,1);c.extrude.setValues(B+5,0,1)}if(0<a)for(c.up.setVec(B-2,E),c.up.setVec(B-4,E),c.up.setVec(B-5,E),E=-6;0>E;E++)c.end.setVec(B+E,v)}e+=this.numberOfRenderVertices(n)}return c.buffer};l._createClass(q,[{key:"vertices",set:function(a){const c=new Float64Array(3*a.length);let r=0;for(const e of a)c[r++]=e[0],c[r++]=e[1],c[r++]=e[2];this.buffers=[c]}},{key:"buffers",set:function(a){this._buffers=a;if(0<this._buffers.length){a=this._buffers[0];
const c=3*Math.floor(a.length/3/2);z.set(this._origin,a[c+0],a[c+1],a[c+2])}else z.set(this._origin,0,0,0);this._dirty=!0}},{key:"origin",get:function(){return this._origin}}]);return q}();const y=C.create(),t=C.create(),p=g.newLayout().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude");b.LaserlinePathData=x;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/glUtil":function(){define(["exports"],function(b){const l={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,
f32:5126};b.glLayout=function(m,z=0){const C=m.stride;return m.fieldNames.filter(A=>{A=m.fields.get(A).optional;return!(A&&A.glPadding)}).map(A=>{const g=m.fields.get(A),k=g.constructor.ElementCount;var w=l[g.constructor.ElementType];if(!w)throw Error("BufferType not supported in WebGL");return{name:A,stride:C,count:k,type:w,offset:g.offset,normalized:!(!g.optional||!g.optional.glNormalized),divisor:z}})};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/support/buffer/InterleavedLayout":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../geometry/support/buffer/BufferView","../../../../geometry/support/buffer/types"],function(b,l,m,z){let C=function(){function g(w,u){this.layout=w;this.buffer="number"===typeof u?new ArrayBuffer(u*w.stride):u;for(const x of w.fieldNames)u=w.fields.get(x),this[x]=new u.constructor(this.buffer,u.offset,this.stride)}var k=g.prototype;k.getField=function(w,u){return(w=this[w])&&w.elementCount===u.ElementCount&&w.elementType===u.ElementType?w:
null};k.slice=function(w,u){return new g(this.layout,this.buffer.slice(w*this.stride,u*this.stride))};k.copyFrom=function(w,u,x,y){const t=this.stride;0===t%4?(w=new Uint32Array(w.buffer,u*t,y*t/4),(new Uint32Array(this.buffer,x*t,y*t/4)).set(w)):(w=new Uint8Array(w.buffer,u*t,y*t),(new Uint8Array(this.buffer,x*t,y*t)).set(w))};l._createClass(g,[{key:"stride",get:function(){return this.layout.stride}},{key:"count",get:function(){return this.buffer.byteLength/this.stride}},{key:"byteLength",get:function(){return this.buffer.byteLength}}]);
return g}(),A=function(){function g(){this.stride=0;this.fields=new Map;this.fieldNames=[]}var k=g.prototype;k.vec2f=function(w,u){this.appendField(w,m.BufferViewVec2f,u);return this};k.vec2f64=function(w,u){this.appendField(w,m.BufferViewVec2f64,u);return this};k.vec3f=function(w,u){this.appendField(w,m.BufferViewVec3f,u);return this};k.vec3f64=function(w,u){this.appendField(w,m.BufferViewVec3f64,u);return this};k.vec4f=function(w,u){this.appendField(w,m.BufferViewVec4f,u);return this};k.vec4f64=
function(w,u){this.appendField(w,m.BufferViewVec4f64,u);return this};k.mat3f=function(w,u){this.appendField(w,m.BufferViewMat3f,u);return this};k.mat3f64=function(w,u){this.appendField(w,m.BufferViewMat3f64,u);return this};k.mat4f=function(w,u){this.appendField(w,m.BufferViewMat4f,u);return this};k.mat4f64=function(w,u){this.appendField(w,m.BufferViewMat4f64,u);return this};k.vec4u8=function(w,u){this.appendField(w,m.BufferViewVec4u8,u);return this};k.f32=function(w,u){this.appendField(w,m.BufferViewFloat,
u);return this};k.f64=function(w,u){this.appendField(w,m.BufferViewFloat64,u);return this};k.u8=function(w,u){this.appendField(w,m.BufferViewUint8,u);return this};k.u16=function(w,u){this.appendField(w,m.BufferViewUint16,u);return this};k.i8=function(w,u){this.appendField(w,m.BufferViewInt8,u);return this};k.vec2i8=function(w,u){this.appendField(w,m.BufferViewVec2i8,u);return this};k.vec2i16=function(w,u){this.appendField(w,m.BufferViewVec2i16,u);return this};k.vec2u8=function(w,u){this.appendField(w,
m.BufferViewVec2u8,u);return this};k.vec4u16=function(w,u){this.appendField(w,m.BufferViewVec4u16,u);return this};k.u32=function(w,u){this.appendField(w,m.BufferViewUint32,u);return this};k.appendField=function(w,u,x){const y=u.ElementCount*z.elementTypeSize(u.ElementType);this.fields.set(w,{size:y,constructor:u,offset:this.stride,optional:x});this.stride+=y;this.fieldNames.push(w)};k.alignTo=function(w){this.stride=Math.floor((this.stride+w-1)/w)*w;return this};k.hasField=function(w){return 0<=this.fieldNames.indexOf(w)};
k.createBuffer=function(w){return new C(this,w)};k.createView=function(w){return new C(this,w)};k.clone=function(){const w=new g;w.stride=this.stride;w.fields=new Map;this.fields.forEach((u,x)=>w.fields.set(x,u));w.fieldNames=this.fieldNames.slice();w.BufferType=this.BufferType;return w};return g}();b.InterleavedBuffer=C;b.InterleavedLayout=A;b.newLayout=function(){return new A};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/BufferView":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./internals/Mat3 ./internals/Mat4 ./internals/Scalar ./internals/Vec2 ./internals/Vec3 ./internals/Vec4".split(" "),
function(b,l,m,z,C,A,g,k){let w=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);w.ElementType="f32";let u=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,
N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);u.ElementType="f32";let x=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);x.ElementType="f32";
let y=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);y.ElementType="f32";let t=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.prototype.slice=
function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(m.BufferViewMat3Impl);t.ElementType="f32";m=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType="f64";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(m.BufferViewMat3Impl);
m.ElementType="f64";let p=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float32Array,N,U,fa,ka)||this;N.elementType="f32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(z.BufferViewMat4Impl);p.ElementType="f32";z=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType="f64";return N}l._inheritsLoose(L,S);
L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(z.BufferViewMat4Impl);z.ElementType="f64";let q=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType="f64";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};
return L}(C.BufferViewScalarImpl);q.ElementType="f64";let d=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType="f64";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);d.ElementType="f64";let a=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType=
"f64";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);a.ElementType="f64";let c=function(S){function L(N,U=0,fa,ka){N=S.call(this,Float64Array,N,U,fa,ka)||this;N.elementType="f64";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,
N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);c.ElementType="f64";let r=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint8Array,N,U,fa,ka)||this;N.elementType="u8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);r.ElementType="u8";let e=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint8Array,
N,U,fa,ka)||this;N.elementType="u8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);e.ElementType="u8";let h=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint8Array,N,U,fa,ka)||this;N.elementType="u8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,
U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);h.ElementType="u8";let v=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint8Array,N,U,fa,ka)||this;N.elementType="u8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);v.ElementType="u8";let E=function(S){function L(N,U=0,fa,
ka){N=S.call(this,Uint16Array,N,U,fa,ka)||this;N.elementType="u16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);E.ElementType="u16";let n=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint16Array,N,U,fa,ka)||this;N.elementType="u16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,
N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);n.ElementType="u16";let B=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint16Array,N,U,fa,ka)||this;N.elementType="u16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);B.ElementType="u16";
let f=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint16Array,N,U,fa,ka)||this;N.elementType="u16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);f.ElementType="u16";let D=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint32Array,N,U,fa,ka)||this;N.elementType="u32";return N}l._inheritsLoose(L,S);L.prototype.slice=
function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);D.ElementType="u32";let H=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint32Array,N,U,fa,ka)||this;N.elementType="u32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);
H.ElementType="u32";let P=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint32Array,N,U,fa,ka)||this;N.elementType="u32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);P.ElementType="u32";let R=function(S){function L(N,U=0,fa,ka){N=S.call(this,Uint32Array,N,U,fa,ka)||this;N.elementType="u32";return N}l._inheritsLoose(L,
S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);R.ElementType="u32";let K=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int8Array,N,U,fa,ka)||this;N.elementType="i8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};
return L}(C.BufferViewScalarImpl);K.ElementType="i8";let J=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int8Array,N,U,fa,ka)||this;N.elementType="i8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);J.ElementType="i8";let Q=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int8Array,N,U,fa,ka)||this;N.elementType="i8";return N}
l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);Q.ElementType="i8";let F=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int8Array,N,U,fa,ka)||this;N.elementType="i8";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+
N.byteLength)};return L}(k.BufferViewVec4Impl);F.ElementType="i8";let O=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int16Array,N,U,fa,ka)||this;N.elementType="i16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);O.ElementType="i16";let V=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int16Array,N,U,fa,ka)||this;N.elementType=
"i16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);V.ElementType="i16";let M=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int16Array,N,U,fa,ka)||this;N.elementType="i16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,
N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);M.ElementType="i16";let T=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int16Array,N,U,fa,ka)||this;N.elementType="i16";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);T.ElementType="i16";C=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int32Array,
N,U,fa,ka)||this;N.elementType="i32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(C.BufferViewScalarImpl);C.ElementType="i32";A=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int32Array,N,U,fa,ka)||this;N.elementType="i32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,
U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(A.BufferViewVec2Impl);A.ElementType="i32";g=function(S){function L(N,U=0,fa,ka){N=S.call(this,Int32Array,N,U,fa,ka)||this;N.elementType="i32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(g.BufferViewVec3Impl);g.ElementType="i32";k=function(S){function L(N,U=0,fa,ka){N=
S.call(this,Int32Array,N,U,fa,ka)||this;N.elementType="i32";return N}l._inheritsLoose(L,S);L.prototype.slice=function(N,U){return this.sliceBuffer(L,N,U)};L.fromTypedArray=function(N,U){return new L(N.buffer,N.byteOffset,U,N.byteOffset+N.byteLength)};return L}(k.BufferViewVec4Impl);k.ElementType="i32";b.BufferViewFloat=w;b.BufferViewFloat64=q;b.BufferViewInt16=O;b.BufferViewInt32=C;b.BufferViewInt8=K;b.BufferViewMat3f=t;b.BufferViewMat3f64=m;b.BufferViewMat4f=p;b.BufferViewMat4f64=z;b.BufferViewUint16=
E;b.BufferViewUint32=D;b.BufferViewUint8=r;b.BufferViewVec2f=u;b.BufferViewVec2f64=d;b.BufferViewVec2i16=V;b.BufferViewVec2i32=A;b.BufferViewVec2i8=J;b.BufferViewVec2u16=n;b.BufferViewVec2u32=H;b.BufferViewVec2u8=e;b.BufferViewVec3f=x;b.BufferViewVec3f64=a;b.BufferViewVec3i16=M;b.BufferViewVec3i32=g;b.BufferViewVec3i8=Q;b.BufferViewVec3u16=B;b.BufferViewVec3u32=P;b.BufferViewVec3u8=h;b.BufferViewVec4f=y;b.BufferViewVec4f64=c;b.BufferViewVec4i16=T;b.BufferViewVec4i32=k;b.BufferViewVec4i8=F;b.BufferViewVec4u16=
f;b.BufferViewVec4u32=R;b.BufferViewVec4u8=v;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/internals/Mat3":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,l){let m=function(){function z(A,g,k=0,w,u){this.TypedArrayConstructor=A;this.elementCount=9;A=this.TypedArrayConstructor;void 0===w&&(w=9*A.BYTES_PER_ELEMENT);const x=0===g.byteLength?0:k;this.typedBuffer=null==u?new A(g,x):new A(g,x,(u-k)/A.BYTES_PER_ELEMENT);this.typedBufferStride=
w/A.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var C=z.prototype;C.sliceBuffer=function(A,g,k=this.count-g){g=this.typedBuffer.byteOffset+g*this.stride;return new A(this.buffer,g,this.stride,g+k*this.stride)};C.getMat=function(A,g){A*=this.typedBufferStride;for(let k=0;9>k;k++)g[k]=this.typedBuffer[A++];return g};C.setMat=function(A,g){A*=this.typedBufferStride;for(let k=0;9>
k;k++)this.typedBuffer[A++]=g[k]};C.get=function(A,g){return this.typedBuffer[A*this.typedBufferStride+g]};C.set=function(A,g,k){this.typedBuffer[A*this.typedBufferStride+g]=k};C.copyFrom=function(A,g,k){const w=this.typedBuffer,u=g.typedBuffer;A*=this.typedBufferStride;g=k*g.typedBufferStride;for(k=0;9>k;++k)w[A++]=u[g++]};l._createClass(z,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return z}();m.ElementCount=9;b.BufferViewMat3Impl=m;Object.defineProperty(b,"__esModule",{value:!0})})},
"esri/geometry/support/buffer/internals/Mat4":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,l){let m=function(){function z(A,g,k=0,w,u){this.TypedArrayConstructor=A;this.elementCount=16;A=this.TypedArrayConstructor;void 0===w&&(w=16*A.BYTES_PER_ELEMENT);const x=0===g.byteLength?0:k;this.typedBuffer=null==u?new A(g,x):new A(g,x,(u-k)/A.BYTES_PER_ELEMENT);this.typedBufferStride=w/A.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);
this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var C=z.prototype;C.sliceBuffer=function(A,g,k=this.count-g){g=this.typedBuffer.byteOffset+g*this.stride;return new A(this.buffer,g,this.stride,g+k*this.stride)};C.getMat=function(A,g){A*=this.typedBufferStride;for(let k=0;16>k;k++)g[k]=this.typedBuffer[A++];return g};C.setMat=function(A,g){A*=this.typedBufferStride;for(let k=0;16>k;k++)this.typedBuffer[A++]=g[k]};C.get=function(A,g){return this.typedBuffer[A*this.typedBufferStride+
g]};C.set=function(A,g,k){this.typedBuffer[A*this.typedBufferStride+g]=k};C.copyFrom=function(A,g,k){const w=this.typedBuffer,u=g.typedBuffer;A*=this.typedBufferStride;g=k*g.typedBufferStride;for(k=0;16>k;++k)w[A++]=u[g++]};l._createClass(z,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return z}();m.ElementCount=16;b.BufferViewMat4Impl=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/internals/Scalar":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],
function(b,l){let m=function(){function z(A,g,k=0,w,u){this.TypedArrayConstructor=A;this.elementCount=1;A=this.TypedArrayConstructor;void 0===w&&(w=A.BYTES_PER_ELEMENT);const x=0===g.byteLength?0:k;this.typedBuffer=null==u?new A(g,x):new A(g,x,(u-k)/A.BYTES_PER_ELEMENT);this.typedBufferStride=w/A.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var C=z.prototype;C.sliceBuffer=function(A,
g,k=this.count-g){g=this.typedBuffer.byteOffset+g*this.stride;return new A(this.buffer,g,this.stride,g+k*this.stride)};C.get=function(A){return this.typedBuffer[A*this.typedBufferStride]};C.set=function(A,g){this.typedBuffer[A*this.typedBufferStride]=g};l._createClass(z,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return z}();m.ElementCount=1;b.BufferViewScalarImpl=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/internals/Vec2":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec2"],function(b,l,m){let z=function(){function C(g,k,w=0,u,x){this.TypedArrayConstructor=g;this.elementCount=2;g=this.TypedArrayConstructor;void 0===u&&(u=2*g.BYTES_PER_ELEMENT);const y=0===k.byteLength?0:w;this.typedBuffer=null==x?new g(k,y):new g(k,y,(x-w)/g.BYTES_PER_ELEMENT);this.typedBufferStride=u/g.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
var A=C.prototype;A.sliceBuffer=function(g,k,w=this.count-k){k=this.typedBuffer.byteOffset+k*this.stride;return new g(this.buffer,k,this.stride,k+w*this.stride)};A.getVec=function(g,k){g*=this.typedBufferStride;return m.set(k,this.typedBuffer[g],this.typedBuffer[g+1])};A.setVec=function(g,k){g*=this.typedBufferStride;this.typedBuffer[g++]=k[0];this.typedBuffer[g]=k[1]};A.get=function(g,k){return this.typedBuffer[g*this.typedBufferStride+k]};A.set=function(g,k,w){this.typedBuffer[g*this.typedBufferStride+
k]=w};A.setValues=function(g,k,w){g*=this.typedBufferStride;this.typedBuffer[g++]=k;this.typedBuffer[g]=w};A.copyFrom=function(g,k,w){const u=this.typedBuffer,x=k.typedBuffer;g*=this.typedBufferStride;k=w*k.typedBufferStride;u[g++]=x[k++];u[g]=x[k]};l._createClass(C,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return C}();z.ElementCount=2;b.BufferViewVec2Impl=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/internals/Vec3":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec3"],function(b,l,m){let z=function(){function C(g,k,w=0,u,x){this.TypedArrayConstructor=g;this.elementCount=3;g=this.TypedArrayConstructor;void 0===u&&(u=3*g.BYTES_PER_ELEMENT);const y=0===k.byteLength?0:w;this.typedBuffer=null==x?new g(k,y):new g(k,y,(x-w)/g.BYTES_PER_ELEMENT);this.typedBufferStride=u/g.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
var A=C.prototype;A.sliceBuffer=function(g,k,w=this.count-k){k=this.typedBuffer.byteOffset+k*this.stride;return new g(this.buffer,k,this.stride,k+w*this.stride)};A.getVec=function(g,k){g*=this.typedBufferStride;return m.set(k,this.typedBuffer[g],this.typedBuffer[g+1],this.typedBuffer[g+2])};A.setVec=function(g,k){g*=this.typedBufferStride;this.typedBuffer[g++]=k[0];this.typedBuffer[g++]=k[1];this.typedBuffer[g]=k[2]};A.get=function(g,k){return this.typedBuffer[g*this.typedBufferStride+k]};A.set=function(g,
k,w){this.typedBuffer[g*this.typedBufferStride+k]=w};A.setValues=function(g,k,w,u){g*=this.typedBufferStride;this.typedBuffer[g++]=k;this.typedBuffer[g++]=w;this.typedBuffer[g]=u};A.copyFrom=function(g,k,w){const u=this.typedBuffer,x=k.typedBuffer;g*=this.typedBufferStride;k=w*k.typedBufferStride;u[g++]=x[k++];u[g++]=x[k++];u[g]=x[k]};l._createClass(C,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return C}();z.ElementCount=3;b.BufferViewVec3Impl=z;Object.defineProperty(b,"__esModule",
{value:!0})})},"esri/geometry/support/buffer/internals/Vec4":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec4"],function(b,l,m){let z=function(){function C(g,k,w=0,u,x){this.TypedArrayConstructor=g;this.elementCount=4;g=this.TypedArrayConstructor;void 0===u&&(u=4*g.BYTES_PER_ELEMENT);const y=0===k.byteLength?0:w;this.typedBuffer=null==x?new g(k,y):new g(k,y,(x-w)/g.BYTES_PER_ELEMENT);this.typedBufferStride=u/g.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/
this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}var A=C.prototype;A.sliceBuffer=function(g,k,w=this.count-k){k=this.typedBuffer.byteOffset+k*this.stride;return new g(this.buffer,k,this.stride,k+w*this.stride)};A.getVec=function(g,k){g*=this.typedBufferStride;return m.set(k,this.typedBuffer[g++],this.typedBuffer[g++],this.typedBuffer[g++],this.typedBuffer[g])};A.setVec=function(g,k){g*=this.typedBufferStride;this.typedBuffer[g++]=k[0];this.typedBuffer[g++]=
k[1];this.typedBuffer[g++]=k[2];this.typedBuffer[g]=k[3]};A.get=function(g,k){return this.typedBuffer[g*this.typedBufferStride+k]};A.set=function(g,k,w){this.typedBuffer[g*this.typedBufferStride+k]=w};A.setValues=function(g,k,w,u,x){g*=this.typedBufferStride;this.typedBuffer[g++]=k;this.typedBuffer[g++]=w;this.typedBuffer[g++]=u;this.typedBuffer[g]=x};A.copyFrom=function(g,k,w){const u=this.typedBuffer,x=k.typedBuffer;g*=this.typedBufferStride;k=w*k.typedBufferStride;u[g++]=x[k++];u[g++]=x[k++];u[g++]=
x[k++];u[g]=x[k]};l._createClass(C,[{key:"buffer",get:function(){return this.typedBuffer.buffer}}]);return C}();z.ElementCount=4;b.BufferViewVec4Impl=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/buffer/types":function(){define(["exports","../../../core/has"],function(b,l){b.elementTypeSize=function(m){switch(m){case "u8":return 1;case "u16":return 2;case "u32":return 4;case "i8":return 1;case "i16":return 2;case "i32":return 4;case "f32":return 4;case "f64":return 8}};
b.isInteger=function(m){switch(m){case "u8":case "u16":case "u32":case "i8":case "i16":case "i32":return!0;case "f32":case "f64":return!1}};b.isSigned=function(m){switch(m){case "u8":case "u16":case "u32":return!1;case "i8":case "i16":case "i32":case "f32":case "f64":return!0}};b.maximumValue=function(m){switch(m){case "u8":return 255;case "u16":return 65535;case "u32":return 4294967295;case "i8":return 127;case "i16":return 32767;case "i32":return 2147483647;case "f32":return 3.402823E38;case "f64":return 1.79769E308}};
Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/Program ../../../../chunks/LaserlinePath.glsl ../../../webgl/renderState".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){k=function(p){function q(){return p.apply(this,arguments)||this}m._inheritsLoose(q,p);var d=q.prototype;d.initializeProgram=function(a){const c=q.shader.get().build(this.configuration);return new u.Program(a.rctx,c,q.attributeLocations)};d.bind=function(a,c,r){this.program.setUniform3fv("innerColor",a.innerColor);this.program.setUniform1f("innerWidth",a.innerWidth*r.pixelRatio);this.program.setUniform3fv("glowColor",a.glowColor);this.program.setUniform1f("glowWidth",
a.glowWidth*r.pixelRatio);this.program.setUniform1f("glowFalloff",a.glowFalloff);this.program.setUniform1f("globalAlpha",a.globalAlpha);this.program.setUniform1f("perScreenPixelRatio",r.perScreenPixelRatio);this.program.setUniform2f("pixelToNDC",2/r.fullWidth,2/r.fullHeight);this.program.setUniformMatrix4fv("uProjectionMatrix",r.projectionMatrix);C.translate(t,r.viewMatrix,c);this.program.setUniformMatrix4fv("uModelViewMatrix",t);this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",
null!=a.globalAlphaContrastBoost?a.globalAlphaContrastBoost:1)};d.initializePipeline=function(){return y.makePipelineState({blending:y.simpleBlendingParams(1,771),colorWrite:y.defaultColorWriteParams})};d.bindPipelineState=function(a){a.setPipelineState(this.pipeline)};return q}(k.ShaderTechnique);k.shader=new g.ReloadableShaderModule(x.LaserlinePathShader,()=>new Promise(function(p,q){b(["./LaserlinePath.glsl"],p,q)}));k.attributeLocations=new Map([["start",0],["end",1],["up",2],["extrude",3]]);
g=function(p){function q(){var d=p.apply(this,arguments)||this;d.contrastControlEnabled=!1;return d}m._inheritsLoose(q,p);return q}(w.ShaderTechniqueConfiguration);z.__decorate([w.parameter()],g.prototype,"contrastControlEnabled",void 0);const t=A.create();l.LaserlinePathTechnique=k;l.LaserlinePathTechniqueConfiguration=g;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],
function(b,l){let m=function(){function z(A,g){this._module=A;this._loadModule=g}var C=z.prototype;C.get=function(){return this._module};C.reload=function(){var A=l._asyncToGenerator(function*(){return this._module=yield this._loadModule()});return function(){return A.apply(this,arguments)}}();return z}();b.ReloadableShaderModule=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe"],function(b,l,m){let z=function(){function C(g,k,w=()=>this.dispose()){this.release=w;k&&(this._config=k.snapshot());this._program=this.initializeProgram(g);this._pipeline=this.initializePipeline(g)}var A=C.prototype;A.dispose=function(){this._program=m.disposeMaybe(this._program);this._pipeline=this._config=null};A.reload=function(g){m.disposeMaybe(this._program);this._program=this.initializeProgram(g)};A.bindPass=function(g,k){};A.bindMaterial=function(g,k){};A.bindDraw=
function(g,k,w){};A.bindPipelineState=function(g){g.setPipelineState(this.pipeline)};A.ensureAttributeLocations=function(g){this.program.assertCompatibleVertexAttributeLocations(g)};l._createClass(C,[{key:"program",get:function(){return this._program}},{key:"pipeline",get:function(){return this._pipeline}},{key:"key",get:function(){return this._config.key}},{key:"configuration",get:function(){return this._config}},{key:"primitiveType",get:function(){return 4}}]);return C}();b.ShaderTechnique=z;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils"],function(b,l,m){let z=function(){function C(){this._key="";this._keyDirty=!1;this._parameterBits=this._parameterBits.map(()=>0)}C.prototype.snapshot=function(){const A=this._parameterNames,g={key:this.key};for(const k of A)g[k]=this[k];return g};l._createClass(C,[{key:"key",get:function(){this._keyDirty&&
(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits));return this._key}}]);return C}();b.ShaderTechniqueConfiguration=z;b.parameter=function(C={}){return(A,g)=>{var k,w;A._parameterNames=null!=(k=A._parameterNames)?k:[];A._parameterNames.push(g);const u=A._parameterNames.length-1;k=Math.ceil(m.log2(C.count||2));const x=null!=(w=A._parameterBits)?w:[0];let y=0;for(;16<x[y]+k;)y++,y>=x.length&&x.push(0);A._parameterBits=x;const t=x[y],p=(1<<k)-1<<t;x[y]+=k;Object.defineProperty(A,
g,{get(){return this[u]},set(q){if(this[u]!==q&&(this[u]=q,this._keyDirty=!0,this._parameterBits[y]=this._parameterBits[y]&~p|+q<<t&p,"number"!==typeof q&&"boolean"!==typeof q))throw"Configuration value for "+g+" must be boolean or number, got "+typeof q;}})}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Program":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/PooledArray ../../../webgl/Program ../../../webgl/RenderingContext".split(" "),
function(b,l,m,z,C,A){C=function(g){function k(u,x,y){u=g.call(this,u,x.generateSource("vertex"),x.generateSource("fragment"),y)||this;u._textures=new Map;u._freeTextureUnits=new z({deallocator:null});u._fragmentUniforms=A.webglDebugEnabled()?x.fragmentUniforms.entries:null;return u}l._inheritsLoose(k,g);var w=k.prototype;w.stop=function(){this._textures.clear();this._freeTextureUnits.clear()};w.bindTexture=function(u,x){if(m.isNone(u)||null==u.glName){if(u=this._textures.get(x))this._context.bindTexture(null,
u.unit),this._freeTextureUnit(u),this._textures.delete(x);return null}let y=this._textures.get(x);null==y?(y=this._allocTextureUnit(u),this._textures.set(x,y)):y.texture=u;this._context.useProgram(this);this.setUniform1i(x,y.unit);this._context.bindTexture(u,y.unit);return y.unit};w.rebindTextures=function(){this._context.useProgram(this);this._textures.forEach((u,x)=>{this._context.bindTexture(u.texture,u.unit);this.setUniform1i(x,u.unit)});m.isSome(this._fragmentUniforms)&&this._fragmentUniforms.forEach(u=>
{if(("sampler2D"===u.type||"samplerCube"===u.type)&&!this._textures.has(u.name))throw Error(`Texture sampler ${u.name} has no bound texture`);})};w._allocTextureUnit=function(u){return{texture:u,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}};w._freeTextureUnit=function(u){this._freeTextureUnits.push(u.unit)};return k}(C.Program);b.Program=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/Program":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ./enums ./RenderingContext ./ShaderTranspiler".split(" "),
function(b,l,m,z,C,A,g){function k(y,t){if(z.isNone(y)||y.length!==t.length)return!0;for(let p=0;p<y.length;++p)if(y[p]!==t[p])return!0;return!1}function w(y,t,p){const q="webgl2"===y.webglVersion?g.transpileShader(p,t):p,d=y.gl,a=d.createShader(t);d.shaderSource(a,q);d.compileShader(a);A.webglValidateShadersEnabled()&&!d.getShaderParameter(a,d.COMPILE_STATUS)&&(console.error("Compile error in ".concat(35633===t?"vertex":"fragment"," shader")),console.error(d.getShaderInfoLog(a)),console.error(u(q)),
"webgl2"===y.webglVersion&&(console.log("Shader source before transpilation:"),console.log(p)));return a}function u(y){let t=2;return y.replace(/\n/g,()=>{var p=t++;p=1E3<=p?p.toString():("  "+p).slice(-3);return"\n"+p+":"})}function x(y,t){for(let p=0;p<y.length;++p)t[p]=y[p]}m=function(){function y(p,q,d,a){this._context=p;this._locations=a;this._fShader=this._vShader=null;this._nameToUniformLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3=
{};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};p||console.error("RenderingContext isn't initialized!");0===q.length&&console.error("Shaders source should not be empty!");this._vShader=w(this._context,35633,q);this._fShader=w(this._context,35632,d);this._vShader&&this._fShader||console.error("Error loading shaders!");const c=this._context.gl,r=c.createProgram();c.attachShader(r,this._vShader);c.attachShader(r,this._fShader);a.forEach((e,h)=>c.bindAttribLocation(r,
e,h));c.linkProgram(r);A.webglValidateShadersEnabled()&&!c.getProgramParameter(r,c.LINK_STATUS)&&console.error("Could not initialize shader\nVALIDATE_STATUS: "+c.getProgramParameter(r,c.VALIDATE_STATUS)+", gl error ["+c.getError()+"]infoLog: "+c.getProgramInfoLog(r));this._glName=r;this._context.instanceCounter.increment(C.ResourceType.Program,this)}var t=y.prototype;t.dispose=function(){const p=this._context.gl;this._vShader&&(p.deleteShader(this._vShader),this._vShader=null);this._fShader&&(p.deleteShader(this._fShader),
this._fShader=null);this._glName&&(p.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(C.ResourceType.Program,this))};t._getUniformLocation=function(p){void 0===this._nameToUniformLocation[p]&&(this._nameToUniformLocation[p]=this._context.gl.getUniformLocation(this._glName,p));return this._nameToUniformLocation[p]};t.hasUniform=function(p){return null!==this._getUniformLocation(p)};t.setUniform1i=function(p,q){const d=this._nameToUniform1[p];if(void 0===d||q!==
d)this._context.useProgram(this),this._context.gl.uniform1i(this._getUniformLocation(p),q),this._nameToUniform1[p]=q};t.setUniform1iv=function(p,q){const d=this._nameToUniform1v[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform1iv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform1v[p]=Array.from(q):x(q,d))};t.setUniform2iv=function(p,q){const d=this._nameToUniform2[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform2iv(this._getUniformLocation(p),q),void 0===
d?this._nameToUniform2[p]=Array.from(q):x(q,d))};t.setUniform3iv=function(p,q){const d=this._nameToUniform3[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform3iv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform3[p]=Array.from(q):x(q,d))};t.setUniform4iv=function(p,q){const d=this._nameToUniform4[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform4iv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform4[p]=Array.from(q):x(q,d))};t.setUniform1f=
function(p,q){const d=this._nameToUniform1[p];if(void 0===d||q!==d)this._context.useProgram(this),this._context.gl.uniform1f(this._getUniformLocation(p),q),this._nameToUniform1[p]=q};t.setUniform1fv=function(p,q){const d=this._nameToUniform1v[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform1fv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform1v[p]=Array.from(q):x(q,d))};t.setUniform2f=function(p,q,d){const a=this._nameToUniform2[p];if(void 0===a||q!==a[0]||d!==a[1])this._context.useProgram(this),
this._context.gl.uniform2f(this._getUniformLocation(p),q,d),void 0===a?this._nameToUniform2[p]=[q,d]:(a[0]=q,a[1]=d)};t.setUniform2fv=function(p,q){const d=this._nameToUniform2[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform2fv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform2[p]=Array.from(q):x(q,d))};t.setUniform3f=function(p,q,d,a){const c=this._nameToUniform3[p];if(void 0===c||q!==c[0]||d!==c[1]||a!==c[2])this._context.useProgram(this),this._context.gl.uniform3f(this._getUniformLocation(p),
q,d,a),void 0===c?this._nameToUniform3[p]=[q,d,a]:(c[0]=q,c[1]=d,c[2]=a)};t.setUniform3fv=function(p,q){const d=this._nameToUniform3[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform3fv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform3[p]=Array.from(q):x(q,d))};t.setUniform4f=function(p,q,d,a,c){const r=this._nameToUniform4[p];if(void 0===r||q!==r[0]||d!==r[1]||a!==r[2]||c!==r[3])this._context.useProgram(this),this._context.gl.uniform4f(this._getUniformLocation(p),q,
d,a,c),void 0===r?this._nameToUniform4[p]=[q,d,a,c]:(r[0]=q,r[1]=d,r[2]=a,r[3]=c)};t.setUniform4fv=function(p,q){const d=this._nameToUniform4[p];k(d,q)&&(this._context.useProgram(this),this._context.gl.uniform4fv(this._getUniformLocation(p),q),void 0===d?this._nameToUniform4[p]=Array.from(q):x(q,d))};t.setUniformMatrix3fv=function(p,q,d=!1){const a=this._nameToUniformMatrix3[p];var c=z.isNone(a)?!0:9!==a.length?k(a,q):9!==a.length||a[0]!==q[0]||a[1]!==q[1]||a[2]!==q[2]||a[3]!==q[3]||a[4]!==q[4]||
a[5]!==q[5]||a[6]!==q[6]||a[7]!==q[7]||a[8]!==q[8];c&&(this._context.useProgram(this),this._context.gl.uniformMatrix3fv(this._getUniformLocation(p),d,q),void 0===a?this._nameToUniformMatrix3[p]=Array.from(q):x(q,a))};t.setUniformMatrix4fv=function(p,q,d=!1){const a=this._nameToUniformMatrix4[p];var c=z.isNone(a)?!0:16!==a.length?k(a,q):16!==a.length||a[0]!==q[0]||a[1]!==q[1]||a[2]!==q[2]||a[3]!==q[3]||a[4]!==q[4]||a[5]!==q[5]||a[6]!==q[6]||a[7]!==q[7]||a[8]!==q[8]||a[9]!==q[9]||a[10]!==q[10]||a[11]!==
q[11]||a[12]!==q[12]||a[13]!==q[13]||a[14]!==q[14]||a[15]!==q[15];c&&(this._context.useProgram(this),this._context.gl.uniformMatrix4fv(this._getUniformLocation(p),d,q),void 0===a?this._nameToUniformMatrix4[p]=Array.from(q):x(q,a))};t.assertCompatibleVertexAttributeLocations=function(p){p.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")};t.stop=function(){};l._createClass(y,[{key:"glName",get:function(){return this._glName}}]);return y}();b.Program=m;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/webgl/enums":function(){define(["exports"],function(b){b.ResourceType=void 0;var l=b.ResourceType||(b.ResourceType={});l[l.Texture=0]="Texture";l[l.Buffer=1]="Buffer";l[l.VAO=2]="VAO";l[l.Program=3]="Program";l[l.Framebuffer=4]="Framebuffer";l[l.Renderbuffer=5]="Renderbuffer";l[l.COUNT=6]="COUNT";b.BASE_TEXTURE_UNIT=33984;b.DepthStencilAttachment=33306;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./Texture ./capabilities/isWebGL2Context ./capabilities/load".split(" "),
function(b,l,m,z,C,A,g,k,w,u){function x(q,d,a,c){d?c!==d&&q.bindBuffer(a,d.glName):q.bindBuffer(a,null);return d}function y(q,d){switch(q){case 0:return 2*d;case 4:return d/3;case 5:return d-2;case 6:return d-2;default:return 0}}let t=function(){function q(a,c={}){this.gl=a;this.instanceCounter=new A.InstanceCounter;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};
this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap=[];this._numOfTriangles=this._numOfDrawCalls=0;this.webglVersion=w(a)?"webgl2":"webgl";a instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=u.loadCapabilities(a,c);this._parameters=
this._loadParameters(c);a=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]};this._stateTracker=new g.StateTracker({setBlending:r=>{r?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(r.opRgb,r.opAlpha),this.setBlendFunctionSeparate(r.srcRgb,r.dstRgb,r.srcAlpha,r.dstAlpha),r=r.color,this.setBlendColor(r.r,r.g,r.b,r.a)):this.setBlendingEnabled(!1)},setCulling:r=>{r?(this.setFaceCullingEnabled(!0),this.setCullFace(r.face),this.setFrontFace(r.mode)):
this.setFaceCullingEnabled(!1)},setPolygonOffset:r=>{r?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(r.factor,r.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:r=>{r?(this.setDepthTestEnabled(!0),this.setDepthFunction(r.func)):this.setDepthTestEnabled(!1)},setStencilTest:r=>{if(r){this.setStencilTestEnabled(!0);const e=r.function;this.setStencilFunction(e.func,e.ref,e.mask);r=r.operation;this.setStencilOp(r.fail,r.zFail,r.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:r=>
{r?(this.setDepthWriteEnabled(!0),this.setDepthRange(r.zNear,r.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:r=>{r?this.setColorMask(r.r,r.g,r.b,r.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:r=>{r?this.setStencilWriteMask(r.mask):this.setStencilWriteMask(0)}});this.enforceState()}var d=q.prototype;d.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap.length=0;p&&this.instanceCounter.printResourceCount()};d.setPipelineState=function(a){this._stateTracker.setPipeline(a)};
d.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a,this._stateTracker.invalidateBlending())};d.externalTextureUnitUpdate=function(a,c){for(let r=0;r<a.length;++r)this._textureUnitMap[a[r]]=null;0<=c&&(this._activeTextureUnit=c)};d.externalVertexArrayObjectUpdate=function(){const a=this.capabilities.vao;a&&(a.bindVertexArray(null),this._activeVertexArrayObject=null);this._activeIndexBuffer=this._activeVertexBuffer=
null};d.externalVertexBufferUpdate=function(){this._activeVertexBuffer=null};d.externalIndexBufferUpdate=function(){this._activeIndexBuffer=null};d.setBlendColor=function(a,c,r,e){if(a!==this._blendColorState.r||c!==this._blendColorState.g||r!==this._blendColorState.b||e!==this._blendColorState.a)this.gl.blendColor(a,c,r,e),this._blendColorState.r=a,this._blendColorState.g=c,this._blendColorState.b=r,this._blendColorState.a=e,this._stateTracker.invalidateBlending()};d.setBlendFunction=function(a,
c){if(a!==this._blendFunctionState.srcRGB||c!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=c,this._stateTracker.invalidateBlending()};d.setBlendFunctionSeparate=function(a,c,r,e){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==r||this._blendFunctionState.dstRGB!==c||this._blendFunctionState.dstAlpha!==e)this.gl.blendFuncSeparate(a,
c,r,e),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=r,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=e,this._stateTracker.invalidateBlending()};d.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending())};d.setBlendEquationSeparate=function(a,c){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==
c)this.gl.blendEquationSeparate(a,c),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=c,this._stateTracker.invalidateBlending()};d.setColorMask=function(a,c,r,e){if(this._colorMaskState.r!==a||this._colorMaskState.g!==c||this._colorMaskState.b!==r||this._colorMaskState.a!==e)this.gl.colorMask(a,c,r,e),this._colorMaskState.r=a,this._colorMaskState.g=c,this._colorMaskState.b=r,this._colorMaskState.a=e,this._stateTracker.invalidateColorWrite()};d.setClearColor=function(a,c,r,e){if(this._clearColor.r!==
a||this._clearColor.g!==c||this._clearColor.b!==r||this._clearColor.a!==e)this.gl.clearColor(a,c,r,e),this._clearColor.r=a,this._clearColor.g=c,this._clearColor.b=r,this._clearColor.a=e};d.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a,this._stateTracker.invalidateCulling())};d.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):
this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a,this._stateTracker.invalidatePolygonOffset())};d.setPolygonOffset=function(a,c){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==c)this._polygonOffset[0]=a,this._polygonOffset[1]=c,this.gl.polygonOffset(a,c),this._stateTracker.invalidatePolygonOffset()};d.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a,this._stateTracker.invalidateCulling())};d.setFrontFace=function(a){this._frontFace!==
a&&(this.gl.frontFace(a),this._frontFace=a,this._stateTracker.invalidateCulling())};d.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};d.setScissorRect=function(a,c,r,e){if(this._scissorRect.x!==a||this._scissorRect.y!==c||this._scissorRect.width!==r||this._scissorRect.height!==e)this.gl.scissor(a,c,r,e),this._scissorRect.x=a,this._scissorRect.y=c,this._scissorRect.width=
r,this._scissorRect.height=e};d.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a,this._stateTracker.invalidateDepthTest())};d.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};d.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a,this._stateTracker.invalidateDepthTest())};d.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==
a&&(this.gl.depthMask(a),this._depthWriteEnabled=a,this._stateTracker.invalidateDepthWrite())};d.setDepthRange=function(a,c){if(this._depthRange.zNear!==a||this._depthRange.zFar!==c)this.gl.depthRange(a,c),this._depthRange.zNear=a,this._depthRange.zFar=c,this._stateTracker.invalidateDepthWrite()};d.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a,this._stateTracker.invalidateStencilTest())};
d.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};d.setStencilFunction=function(a,c,r){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==r)this.gl.stencilFunc(a,c,r),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=r,this._stateTracker.invalidateStencilTest()};d.setStencilFunctionSeparate=function(a,c,r,e){if(this._stencilFunction.face!==
a||this._stencilFunction.func!==c||this._stencilFunction.ref!==r||this._stencilFunction.mask!==e)this.gl.stencilFuncSeparate(a,c,r,e),this._stencilFunction.face=a,this._stencilFunction.func=c,this._stencilFunction.ref=r,this._stencilFunction.mask=e,this._stateTracker.invalidateStencilTest()};d.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a,this._stateTracker.invalidateStencilWrite())};d.setStencilOp=function(a,c,r){if(this._stencilOperation.fail!==
a||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==r)this.gl.stencilOp(a,c,r),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=r,this._stateTracker.invalidateStencilTest()};d.setStencilOpSeparate=function(a,c,r,e){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==c||this._stencilOperation.zFail!==r||this._stencilOperation.zPass!==e)this.gl.stencilOpSeparate(a,c,r,e),this._stencilOperation.face=
a,this._stencilOperation.face=a,this._stencilOperation.fail=c,this._stencilOperation.zFail=r,this._stencilOperation.zPass=e,this._stateTracker.invalidateStencilTest()};d.setActiveTexture=function(a,c=!1){const r=this._activeTextureUnit;0<=a&&(c||a!==this._activeTextureUnit)&&(this.gl.activeTexture(C.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return r};d.clear=function(a){a&&this.gl.clear(a)};d.clearSafe=function(a,c=255){a&&(a&16384&&this.setColorMask(!0,!0,!0,!0),a&256&&this.setDepthWriteEnabled(!0),
a&1024&&this.setStencilWriteMask(c),this.gl.clear(a))};d.drawArrays=function(a,c,r){p&&(this._numOfDrawCalls++,this._numOfTriangles+=y(a,r));this.gl.drawArrays(a,c,r)};d.drawElements=function(a,c,r,e){p&&(this._numOfDrawCalls++,this._numOfTriangles+=y(a,c));this.gl.drawElements(a,c,r,e)};d.logIno=function(){p&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};d.setViewport=function(a,c,r,e){r=Math.max(Math.round(r),1);e=Math.max(Math.round(e),1);const h=this._viewport;
if(h.x!==a||h.y!==c||h.width!==r||h.height!==e)h.x=a,h.y=c,h.width=r,h.height=e,this.gl.viewport(a,c,r,e)};d.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};d.useProgram=function(a){var c;if(a)this._activeShaderProgram!==a&&(null==(c=this._activeShaderProgram)?void 0:c.stop(),this._activeShaderProgram=a,this.gl.useProgram(a.glName));else{var r;null==(r=this._activeShaderProgram)?void 0:r.stop();this._activeShaderProgram=
null;this.gl.useProgram(null)}};d.bindTexture=function(a,c,r=!1){(c>=this.parameters.maxTextureImageUnits||0>c)&&console.error("Input texture unit is out of range of available units!");const e=this._textureUnitMap[c];this.setActiveTexture(c,r);if(z.isNone(a)||null==a.glName)return z.isSome(e)&&this.gl.bindTexture(e.descriptor.target,null),this._textureUnitMap[c]=null,e;if(!r&&e===a)return a.applyChanges(),e;this.gl.bindTexture(a.descriptor.target,a.glName);a.applyChanges();this._textureUnitMap[c]=
a;return e};d.unbindTextureAllUnits=function(a){for(let c=0;c<this.parameters.maxTextureImageUnits;c++)this._textureUnitMap[c]===a&&(this.bindTexture(null,c),this._textureUnitMap[c]=null)};d.bindFramebuffer=function(a,c=!1){if(z.isNone(a))this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null;else if(c||this._activeFramebuffer!==a)a.initializeAndBind(),this._activeFramebuffer=a};d.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=x(this.gl,a,a.bufferType,
this._activeVertexBuffer):this._activeIndexBuffer=x(this.gl,a,a.bufferType,this._activeIndexBuffer))};d.bindRenderbuffer=function(a){const c=this.gl;a||(c.bindRenderbuffer(c.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==a&&(c.bindRenderbuffer(c.RENDERBUFFER,a.glName),this._activeRenderbuffer=a)};d.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=x(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=x(this.gl,null,a,this._activeIndexBuffer)};d.bindVAO=
function(a=null){z.isNone(a)?this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null):this._activeVertexArrayObject!==a&&(a.bind(),this._activeVertexArrayObject=a)};d.getBoundFramebufferObject=function(){return this._activeFramebuffer};d.getBoundVAO=function(){return this._activeVertexArrayObject};d.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(let a=
0;a<this.parameters.maxTextureImageUnits;++a)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);
this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};d.enforceState=function(){const a=this.gl;var c=this.capabilities.vao;c&&c.bindVertexArray(null);for(var r=0;r<this.parameters.maxVertexAttributes;r++)a.disableVertexAttribArray(r);
this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(c)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,
this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?
a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(1);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):
a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(c=0;c<this.parameters.maxTextureImageUnits;c++)a.activeTexture(C.BASE_TEXTURE_UNIT+c),a.bindTexture(3553,null),w(a)&&a.bindTexture(32879,
null),r=this._textureUnitMap[c],z.isSome(r)&&a.bindTexture(r.descriptor.target,r.glName);a.activeTexture(C.BASE_TEXTURE_UNIT+this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height);p&&(this._numOfTriangles=this._numOfDrawCalls=0)};d._loadParameters=function(a){var c;const r=this.capabilities.textureFilterAnisotropic;a=null!=(c=a.maxAnisotropy)?c:Infinity;c={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:r?Math.min(this.gl.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY),a):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)};k.TEXTURE_UNIT_FOR_UPDATES=c.maxTextureImageUnits-1;return c};l._createClass(q,[{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},
{key:"capabilities",get:function(){return this._capabilities}}]);return q}();const p=!!m("enable-feature:webgl-debug");b.default=t;b.webglDebugEnabled=function(){return p};b.webglValidateShadersEnabled=function(){return p};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./enums"],function(b,l,m){let z=function(){function C(){this._current=[];this._max=[];for(this._allocations=new Map;this._current.length<
m.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var A=C.prototype;A.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};A.increment=function(g,k){k=++this._current[g];this._max[g]=Math.max(k,this._max[g])};A.decrement=function(g,k){--this._current[g]};A.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let g=0;g<m.ResourceType.COUNT;++g){const k=this._current[g];0<k&&console.log(`${m.ResourceType[g]}: ${k}`)}}if(0<
this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const g=new Map;this._allocations.forEach(k=>{var w;g.set(k,(null!=(w=g.get(k))?w:0)+1)});g.forEach((k,w)=>console.log(k," : ",w))}};l._createClass(C,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((g,k)=>g+k,0)}}]);return C}();b.InstanceCounter=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/renderState":function(){define(["exports"],
function(b){function l(K){return v.intern(K)}function m(K){return E.intern(K)}function z(K){return n.intern(K)}function C(K){return B.intern(K)}function A(K){return f.intern(K)}function g(K){return D.intern(K)}function k(K){return H.intern(K)}function w(K){return P.intern(K)}function u(K){return"["+K.join(",")+"]"}function x(K){return K?u([K.srcRgb,K.srcAlpha,K.dstRgb,K.dstAlpha,K.opRgb,K.opAlpha,K.color.r,K.color.g,K.color.b,K.color.a]):null}function y(K){return K?u([K.face,K.mode]):null}function t(K){return K?
u([K.factor,K.units]):null}function p(K){return K?u([K.func]):null}function q(K){return K?u([K.function.func,K.function.ref,K.function.mask,K.operation.fail,K.operation.zFail,K.operation.zPass]):null}function d(K){return K?u([K.zNear,K.zFar]):null}function a(K){return K?u([K.r,K.g,K.b,K.a]):null}function c(K){return K?u([K.mask]):null}const r={face:1029,mode:2305},e={face:1028,mode:2305};var h=function(){function K(J,Q){this.makeKey=J;this.makeRef=Q;this.interns=new Map}K.prototype.intern=function(J){if(!J)return null;
const Q=this.makeKey(J),F=this.interns;F.has(Q)||F.set(Q,this.makeRef(J));return F.get(Q)};return K}();const v=new h(x,K=>({__tag:"Blending",...K})),E=new h(y,K=>({__tag:"Culling",...K})),n=new h(t,K=>({__tag:"PolygonOffset",...K})),B=new h(p,K=>({__tag:"DepthTest",...K})),f=new h(q,K=>({__tag:"StencilTest",...K})),D=new h(d,K=>({__tag:"DepthWrite",...K})),H=new h(a,K=>({__tag:"ColorWrite",...K})),P=new h(c,K=>({__tag:"StencilWrite",...K})),R=new h(function(K){return K?u([x(K.blending),y(K.culling),
t(K.polygonOffset),p(K.depthTest),q(K.stencilTest),d(K.depthWrite),a(K.colorWrite),c(K.stencilWrite)]):null},K=>({blending:l(K.blending),culling:m(K.culling),polygonOffset:z(K.polygonOffset),depthTest:C(K.depthTest),stencilTest:A(K.stencilTest),depthWrite:g(K.depthWrite),colorWrite:k(K.colorWrite),stencilWrite:w(K.stencilWrite)}));h=function(){function K(Q){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=
this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=Q}var J=K.prototype;J.setPipeline=function(Q){if(this._pipelineInvalid||Q!==this._pipeline)this.setBlending(Q.blending),this.setCulling(Q.culling),this.setPolygonOffset(Q.polygonOffset),this.setDepthTest(Q.depthTest),this.setStencilTest(Q.stencilTest),this.setDepthWrite(Q.depthWrite),this.setColorWrite(Q.colorWrite),this.setStencilWrite(Q.stencilWrite),this._pipeline=Q;this._pipelineInvalid=!1};J.invalidateBlending=
function(){this._pipelineInvalid=this._blendingInvalid=!0};J.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};J.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};J.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};J.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};J.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};J.invalidateColorWrite=
function(){this._pipelineInvalid=this._colorWriteInvalid=!0};J.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};J.setBlending=function(Q){this._blending=this.setSubState(Q,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};J.setCulling=function(Q){this._culling=this.setSubState(Q,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};J.setPolygonOffset=function(Q){this._polygonOffset=
this.setSubState(Q,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};J.setDepthTest=function(Q){this._depthTest=this.setSubState(Q,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};J.setStencilTest=function(Q){this._stencilTest=this.setSubState(Q,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};J.setDepthWrite=function(Q){this._depthWrite=
this.setSubState(Q,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};J.setColorWrite=function(Q){this._colorWrite=this.setSubState(Q,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};J.setStencilWrite=function(Q){this._stencilWrite=this.setSubState(Q,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};J.setSubState=function(Q,F,O,V){if(O||
Q!==F)V(Q),this._pipelineInvalid=!0;return Q};return K}();b.StateTracker=h;b.backFaceCullingParams=r;b.cullingParams=K=>2===K?r:1===K?e:null;b.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};b.defaultDepthWriteParams={zNear:0,zFar:1};b.frontFaceCullingParams=e;b.makeBlending=l;b.makeColorWrite=k;b.makeCulling=m;b.makeDepthTest=C;b.makeDepthWrite=g;b.makePipelineState=function(K){return R.intern(K)};b.makePolygonOffset=z;b.makeStencilTest=A;b.makeStencilWrite=w;b.separateBlendingParams=function(K,J,
Q,F,O=32774,V=32774,M=[0,0,0,0]){return{srcRgb:K,srcAlpha:J,dstRgb:Q,dstAlpha:F,opRgb:O,opAlpha:V,color:{r:M[0],g:M[1],b:M[2],a:M[3]}}};b.simpleBlendingParams=function(K,J,Q=32774,F=[0,0,0,0]){return{srcRgb:K,srcAlpha:K,dstRgb:J,dstAlpha:J,opRgb:Q,opAlpha:Q,color:{r:F[0],g:F[1],b:F[2],a:F[3]}}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/Texture":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/mathUtils","../../core/maybe","./enums","./capabilities/isWebGL2Context"],
function(b,l,m,z,C){let A=function(){function g(w,u,x=null){this._context=w;this.type="texture";this._glName=null;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;w.instanceCounter.increment(z.ResourceType.Texture,this);this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...u};this.setData(x)}var k=g.prototype;k.dispose=function(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),
this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(z.ResourceType.Texture,this))};k.release=function(){this.dispose()};k.resize=function(w,u){const x=this._descriptor;if(x.width!==w||x.height!==u)x.width=w,x.height=u,this.setData(null)};k.setData=function(w){if(this._context&&this._context.gl){var u=this._context.gl;this._glName||(this._glName=u.createTexture());void 0===w&&(w=null);null===w&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=
this._descriptor.height||4);var x=this._context.bindTexture(this,g.TEXTURE_UNIT_FOR_UPDATES),y=this._descriptor;g._validateTexture(this._context,y);u.pixelStorei(u.UNPACK_ALIGNMENT,y.unpackAlignment);u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,y.flipped?1:0);u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y.preMultiplyAlpha?1:0);var t=y.pixelFormat,p=y.internalFormat?y.internalFormat:t;if(w instanceof ImageData||w instanceof HTMLImageElement||w instanceof HTMLCanvasElement||w instanceof HTMLVideoElement){var q=
w.width,d=w.height;w instanceof HTMLVideoElement&&(q=w.videoWidth,d=w.videoHeight);u.texImage2D(u.TEXTURE_2D,0,p,t,y.dataType,w);y.hasMipmap&&this.generateMipmap();void 0===y.width&&(y.width=q);void 0===y.height&&(y.height=d)}else{null!=y.width&&null!=y.height||console.error("Width and height must be specified!");u.DEPTH24_STENCIL8&&p===u.DEPTH_STENCIL&&(p=u.DEPTH24_STENCIL8);q=y.width;d=y.height;var a=w;if(m.isSome(a)&&"type"in a&&"compressed"===a.type)for(t=Math.round(Math.log(Math.max(q,d))/Math.LN2)+
1,y.hasMipmap=y.hasMipmap&&t===w.levels.length,t=0;;++t){u.compressedTexImage2D(u.TEXTURE_2D,t,p,q,d,0,w.levels[Math.min(t,w.levels.length-1)]);if(1===q&&1===d||!y.hasMipmap)break;q=Math.max(1,q>>1);d=Math.max(1,d>>1)}else if(m.isSome(w))u.texImage2D(u.TEXTURE_2D,0,p,q,d,0,t,y.dataType,w),y.hasMipmap&&this.generateMipmap();else for(w=0;;++w){u.texImage2D(u.TEXTURE_2D,w,p,q,d,0,t,y.dataType,null);if(1===q&&1===d||!y.hasMipmap)break;q=Math.max(1,q>>1);d=Math.max(1,d>>1)}}g._applySamplingMode(u,this._descriptor);
g._applyWrapMode(u,this._descriptor);g._applyAnisotropicFilteringParameters(this._context,this._descriptor);this._context.bindTexture(x,g.TEXTURE_UNIT_FOR_UPDATES)}};k.updateData=function(w,u,x,y,t,p){p||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const q=this._context.gl,d=this._descriptor,a=this._context.bindTexture(this,g.TEXTURE_UNIT_FOR_UPDATES);(0>u||0>x||y>d.width||t>d.height||u+y>d.width||x+t>d.height)&&
console.error("An attempt to update out of bounds of the texture!");q.pixelStorei(q.UNPACK_ALIGNMENT,d.unpackAlignment);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,d.flipped?1:0);q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d.preMultiplyAlpha?1:0);p instanceof ImageData||p instanceof HTMLImageElement||p instanceof HTMLCanvasElement||p instanceof HTMLVideoElement?q.texSubImage2D(q.TEXTURE_2D,w,u,x,d.pixelFormat,d.dataType,p):q.texSubImage2D(q.TEXTURE_2D,w,u,x,y,t,d.pixelFormat,d.dataType,p);this._context.bindTexture(a,
g.TEXTURE_UNIT_FOR_UPDATES)};k.generateMipmap=function(){var w=this._descriptor;w.hasMipmap||(this._samplingModeDirty=w.hasMipmap=!0,g._validateTexture(this._context,w));9729===w.samplingMode?(this._samplingModeDirty=!0,w.samplingMode=9985):9728===w.samplingMode&&(this._samplingModeDirty=!0,w.samplingMode=9984);w=this._context.bindTexture(this,g.TEXTURE_UNIT_FOR_UPDATES);const u=this._context.gl;u.generateMipmap(u.TEXTURE_2D);this._context.bindTexture(w,g.TEXTURE_UNIT_FOR_UPDATES)};k.setSamplingMode=
function(w){w!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=w,this._samplingModeDirty=!0)};k.setWrapMode=function(w){w!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=w,g._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)};k.applyChanges=function(){const w=this._context.gl,u=this._descriptor;this._samplingModeDirty&&(g._applySamplingMode(w,u),this._samplingModeDirty=!1);this._wrapModeDirty&&(g._applyWrapMode(w,u),this._wrapModeDirty=!1)};g._validateTexture=
function(w,u){(0>u.width||0>u.height)&&console.error("Negative dimension parameters are not allowed!");const x=l.isPowerOfTwo(u.width)&&l.isPowerOfTwo(u.height);C(w.gl)||x||("number"===typeof u.wrapMode?33071!==u.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(33071!==u.wrapMode.s||33071!==u.wrapMode.t)&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),u.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};
g._applySamplingMode=function(w,u){let x=u.samplingMode,y=u.samplingMode;if(9985===x||9987===x)x=9729,u.hasMipmap||(y=9729);else if(9984===x||9986===x)x=9728,u.hasMipmap||(y=9728);w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,x);w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,y)};g._applyWrapMode=function(w,u){"number"===typeof u.wrapMode?(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,u.wrapMode),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,u.wrapMode)):(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,
u.wrapMode.s),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,u.wrapMode.t))};g._applyAnisotropicFilteringParameters=function(w,u){var x;const y=w.capabilities.textureFilterAnisotropic;y&&(w=w.gl,w.texParameterf(w.TEXTURE_2D,y.TEXTURE_MAX_ANISOTROPY,null!=(x=u.maxAnisotropy)?x:1))};b._createClass(g,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}}]);return g}();A.TEXTURE_UNIT_FOR_UPDATES=0;return A})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(b){return window.WebGL2RenderingContext&&
b instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("exports ./DisjointTimerQuery ./DrawBuffers ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(b,l,m,z,C,A,g){function k(w,u,x,y,t){if(y&&C(w))return!0;if(u[x])return!1;for(const p of t)if(w.getExtension(p))return!0;return!1}b.loadCapabilities=function(w,u){const x=u.disabledExtensions||{},y=u.debugWebGLExtensions||{};let t,p,q,d,a,c,r,e,h,v,E,n=null,B=null,f=null,
D=null;return{get drawBuffers(){E||(E=m.load(w,x));return E},get instancing(){t||(t=z.load(w));return t},get vao(){p||(p=g.load(w,x));return p},get compressedTextureETC(){if(!q)if(x.compressedTextureETC)q=null;else{var H=w.getExtension("WEBGL_compressed_texture_etc");q=H?{COMPRESSED_R11_EAC:H.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:H.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:H.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:H.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:H.COMPRESSED_RGB8_ETC2,
COMPRESSED_SRGB8_ETC2:H.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:H.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:H.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:H.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:H.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}return q},get compressedTextureS3TC(){if(!d)if(x.compressedTextureS3TC)d=null;else{var H=w.getExtension("WEBGL_compressed_texture_s3tc");d=H?{COMPRESSED_RGB_S3TC_DXT1:H.COMPRESSED_RGB_S3TC_DXT1_EXT,
COMPRESSED_RGBA_S3TC_DXT1:H.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:H.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:H.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}return d},get textureFilterAnisotropic(){if(!a)if(x.textureFilterAnisotropic)a=null;else{var H=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");a=H?{MAX_TEXTURE_MAX_ANISOTROPY:H.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:H.TEXTURE_MAX_ANISOTROPY_EXT}:
null}return a},get disjointTimerQuery(){c||(c=l.createDisjointTimerQuery(w,x));return c},get textureFloat(){if(!r)if(C(w))r={textureFloat:!0,textureFloatLinear:!x.textureFloatLinear&&!!w.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!x.textureHalfFloatLinear&&!!w.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:w.HALF_FLOAT};else if(w instanceof WebGLRenderingContext){const H=!x.textureHalfFloat&&w.getExtension("OES_texture_half_float");r={textureFloat:!x.textureFloat&&
!!w.getExtension("OES_texture_float"),textureFloatLinear:!x.textureFloatLinear&&!!w.getExtension("OES_texture_float_linear"),textureHalfFloat:!!H,textureHalfFloatLinear:!x.textureHalfFloatLinear&&!!w.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:H?H.HALF_FLOAT_OES:void 0}}else r=null;return r},get colorBufferFloat(){if(!e)if(C(w)){var H=!x.colorBufferFloat&&w.getExtension("EXT_color_buffer_half_float"),P=!x.colorBufferFloat&&w.getExtension("EXT_color_buffer_float"),R=!x.colorBufferFloat&&
w.getExtension("EXT_float_blend");e=H||P||R?{textureFloat:!!P,textureHalfFloat:!!H,R16F:w.R16F,RG16F:w.RG16F,RGBA16F:w.RGBA16F,R32F:w.R32F,RG32F:w.RG32F,RGBA32F:w.RGBA32F,R11F_G11F_B10F:w.R11F_G11F_B10F,RGB16F:w.RGB16F}:null}else w instanceof WebGLRenderingContext?(H=!x.colorBufferFloat&&w.getExtension("EXT_color_buffer_half_float"),P=!x.colorBufferFloat&&w.getExtension("WEBGL_color_buffer_float"),R=!x.colorBufferFloat&&w.getExtension("EXT_float_blend"),e=H||P||R?{textureFloat:!!P,textureHalfFloat:!!H,
RGBA16F:H?H.RGBA16F_EXT:void 0,RGB16F:H?H.RGB16F_EXT:void 0,RGBA32F:P?P.RGBA32F_EXT:void 0}:null):e=null;return e},get blendMinMax(){if(!h)if(C(w))h={MIN:w.MIN,MAX:w.MAX};else if(x.blendMinMax)h=null;else{{const H=w.getExtension("EXT_blend_minmax");h=H?{MIN:H.MIN_EXT,MAX:H.MAX_EXT}:null}}return h},get depthTexture(){null===n&&(n=k(w,x,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return n},get standardDerivatives(){null===B&&(B=k(w,x,"standardDerivatives",
!0,["OES_standard_derivatives"]));return B},get shaderTextureLOD(){null===f&&(f=k(w,x,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return f},get fragDepth(){null===D&&(D=k(w,x,"fragDepth",!0,["EXT_frag_depth"]));return D},get loseContext(){v||(v=A.load(w,y));return v},enable(H){return this[H]}}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(b,l){let m=function(z,C,A,g,k,w,u,x){this.createQuery=
z;this.resultAvailable=C;this.getResult=A;this.disjoint=g;this.beginTimeElapsed=k;this.endTimeElapsed=w;this.createTimestamp=u;this.timestampBits=x};b.DisjointTimerQuery=m;b.createDisjointTimerQuery=function(z,C){if(C.disjointTimerQuery)return null;let A=z.getExtension("EXT_disjoint_timer_query_webgl2");return A&&l(z)?new m(()=>z.createQuery(),g=>z.getQueryParameter(g,z.QUERY_RESULT_AVAILABLE),g=>z.getQueryParameter(g,z.QUERY_RESULT),()=>z.getParameter(A.GPU_DISJOINT_EXT),g=>z.beginQuery(A.TIME_ELAPSED_EXT,
g),()=>z.endQuery(A.TIME_ELAPSED_EXT),g=>A.queryCounterEXT(g,A.TIMESTAMP_EXT),()=>z.getQuery(A.TIMESTAMP_EXT,A.QUERY_COUNTER_BITS_EXT)):(A=z.getExtension("EXT_disjoint_timer_query"))?new m(()=>A.createQueryEXT(),g=>A.getQueryObjectEXT(g,A.QUERY_RESULT_AVAILABLE_EXT),g=>A.getQueryObjectEXT(g,A.QUERY_RESULT_EXT),()=>z.getParameter(A.GPU_DISJOINT_EXT),g=>A.beginQueryEXT(A.TIME_ELAPSED_EXT,g),()=>A.endQueryEXT(A.TIME_ELAPSED_EXT),g=>A.queryCounterEXT(g,A.TIMESTAMP_EXT),()=>A.getQueryEXT(A.TIMESTAMP_EXT,
A.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(b,l){b.load=function(m,z){return z.disjointTimerQuery?null:l(m)?{drawBuffers:m.drawBuffers.bind(m),MAX_DRAW_BUFFERS:m.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:m.MAX_COLOR_ATTACHMENTS}:z.drawBuffers?null:(m=m.getExtension("WEBGL_draw_buffers"))?{drawBuffers:m.drawBuffersWEBGL.bind(m),MAX_DRAW_BUFFERS:m.MAX_DRAW_BUFFERS_WEBGL,
MAX_COLOR_ATTACHMENTS:m.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(b,l){b.load=function(m){return l(m)?{drawArraysInstanced:m.drawArraysInstanced.bind(m),drawElementsInstanced:m.drawElementsInstanced.bind(m),vertexAttribDivisor:m.vertexAttribDivisor.bind(m)}:(m=m.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:m.drawArraysInstancedANGLE.bind(m),
drawElementsInstanced:m.drawElementsInstancedANGLE.bind(m),vertexAttribDivisor:m.vertexAttribDivisorANGLE.bind(m)}:null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(b){b.load=function(l,m){const z=m.loseContext&&l.getExtension("WEBGL_lose_context");return z?{loseRenderingContext:()=>z.loseContext()}:null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports",
"./isWebGL2Context"],function(b,l){b.load=function(m,z){return l(m)?{createVertexArray:m.createVertexArray.bind(m),deleteVertexArray:m.deleteVertexArray.bind(m),bindVertexArray:m.bindVertexArray.bind(m)}:z.vao?null:(m=m.getExtension("OES_vertex_array_object")||m.getExtension("MOZ_OES_vertex_array_object")||m.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:m.createVertexArrayOES.bind(m),deleteVertexArray:m.deleteVertexArrayOES.bind(m),bindVertexArray:m.bindVertexArrayOES.bind(m)}:
null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/ShaderTranspiler":function(){define(["exports","./reservedWordsGLSL3"],function(b,l){function m(){function d(M){M.length&&P.push({type:p[B],data:M,position:J,line:R,column:K})}function a(){H=H.length?[]:H;if("/"===D&&"*"===f)return J=n+E-1,B=0,D=f,E+1;if("/"===D&&"/"===f)return J=n+E-1,B=1,D=f,E+1;if("#"===f)return B=2,J=n+E,E;if(/\s/.test(f))return B=9,J=n+E,E;Q=/\d/.test(f);F=/[^\w_]/.test(f);J=n+E;B=Q?4:F?3:9999;return E}
function c(){if(("\r"===f||"\n"===f)&&"\\"!==D)return d(H.join("")),B=999,E;H.push(f);D=f;return E+1}function r(){if("."===D&&/\d/.test(f))return B=5,E;if("/"===D&&"*"===f)return B=0,E;if("/"===D&&"/"===f)return B=1,E;if("."===f&&H.length){for(;e(H););B=5;return E}if(";"===f||")"===f||"("===f){if(H.length)for(;e(H););d(f);B=999;return E+1}var M=2===H.length&&"\x3d"!==f;if(/[\w_\d\s]/.test(f)||M){for(;e(H););B=999;return E}H.push(f);D=f;return E+1}function e(M){var T=0;do{var S=y.indexOf(M.slice(0,
M.length+T).join(""));var L=y[S];if(-1===S){if(0<T--+M.length)continue;L=M.slice(0,1).join("")}d(L);J+=L.length;H=H.slice(L.length);return H.length}while(1)}function h(){if("."===f||/[eE]/.test(f))return H.push(f),B=5,D=f,E+1;if("x"===f&&1===H.length&&"0"===H[0])return B=11,H.push(f),D=f,E+1;if(/[^\d]/.test(f))return d(H.join("")),B=999,E;H.push(f);D=f;return E+1}function v(){"f"===f&&(H.push(f),D=f,E+=1);if(/[eE]/.test(f)||"-"===f&&/[eE]/.test(D))return H.push(f),D=f,E+1;if(/[^\d]/.test(f))return d(H.join("")),
B=999,E;H.push(f);D=f;return E+1}var E=0,n=0,B=999,f,D,H=[],P=[],R=1,K=0,J=0,Q=!1,F=!1,O="",V;return function(M){P=[];if(null!==M){M=M.replace?M.replace(/\r\n/g,"\n"):M;E=0;O+=M;for(V=O.length;f=O[E],E<V;){M=E;switch(B){case 0:"/"===f&&"*"===D?(H.push(f),d(H.join("")),B=999):(H.push(f),D=f);E+=1;break;case 1:E=c();break;case 2:E=c();break;case 3:E=r();break;case 4:E=h();break;case 11:/[^a-fA-F0-9]/.test(f)?(d(H.join("")),B=999):(H.push(f),D=f,E+=1);break;case 5:E=v();break;case 9999:if(/[^\d\w_]/.test(f)){var T=
H.join("");B=-1<x.indexOf(T)?8:-1<t.indexOf(T)?7:6;d(H.join(""));B=999}else H.push(f),D=f,E+=1;break;case 9:/[^\s]/g.test(f)?(d(H.join("")),B=999):(H.push(f),D=f,E+=1);break;case 999:E=a()}if(M!==E)switch(O[M]){case "\n":K=0;++R;break;default:++K}}n+=E;O=O.slice(E);return P}H.length&&d(H.join(""));B=10;d("(eof)");return P}}function z(d){return d.map(a=>"eof"!==a.type?a.data:"").join("")}function C(d,a="100",c="300 es"){const r=/^\s*#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const e of d)if("preprocessor"===
e.type){const h=r.exec(e.data);if(h){d=h[1].replace(/\s\s+/g," ");if(d===c)return d;if(d===a)return e.data="#version "+c,a;throw Error("unknown glsl version: "+d);}}d.splice(0,0,{type:"preprocessor",data:"#version "+c},{type:"whitespace",data:"\n"});return null}function A(d,a,c,r){r=r||c;for(const e of d)if("ident"===e.type&&e.data===c)return r in a?a[r]++:a[r]=0,A(d,a,r+"_"+a[r],r);return c}function g(d,a,c="afterVersion"){const r={data:"\n",type:"whitespace"},e=v=>v<d.length?/[^\r\n]$/.test(d[v].data):
!1;let h=function(v){let E=-1,n=0,B=-1;for(let D=0;D<v.length;D++){var f=v[D];"preprocessor"===f.type&&(f.data.match(/#(if|ifdef|ifndef)\s+.+/)?++n:f.data.match(/#endif\s*.*/)&&--n);("afterVersion"===c||"afterPrecision"===c)&&"preprocessor"===f.type&&/^#version/.test(f.data)&&(B=Math.max(B,D));if("afterPrecision"===c&&"keyword"===f.type&&"precision"===f.data){a:{for(f=D;f<v.length;f++){const H=v[f];if("operator"===H.type&&";"===H.data)break a}f=null}if(null===f)throw Error("precision statement not followed by any semicolons!");
B=Math.max(B,f)}E<B&&0===n&&(E=D)}return E+1}(d);e(h-1)&&d.splice(h++,0,r);for(const v of a)d.splice(h++,0,v);e(h-1)&&e(h)&&d.splice(h,0,r)}function k(d,a,c,r="lowp"){g(d,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"keyword",data:c},{type:"whitespace",data:" "},{type:"ident",data:a},{type:"operator",data:";"}],"afterPrecision")}function w(d,a,c,r,e="lowp"){g(d,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",
data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"\x3d"},{type:"whitespace",data:" "},{type:"integer",data:r.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:e},{type:"whitespace",data:" "},{type:"keyword",data:c},{type:"whitespace",data:" "},{type:"ident",data:a},{type:"operator",data:";"}],"afterPrecision")}var u={exports:{}};(function(d){(function(a){a=a();void 0!==a&&(d.exports=
a)})(function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})})(u);
var x=u.exports;u={exports:{}};(function(d){(function(a){a=a();void 0!==a&&(d.exports=a)})(function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})})(u);var y=u.exports;u={exports:{}};(function(d){(function(a){a=a();void 0!==a&&(d.exports=a)})(function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})})(u);
var t=u.exports,p="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");const q=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];b.transpileShader=function(d,a){var c=m(),r=[];r=r.concat(c(d));d=r=r.concat(c(null));if("300 es"===C(d,"100","300 es"))throw Error("shader is already glsl 300 es");r=c=null;const e={},h={};for(let B=0;B<d.length;++B){const f=d[B];switch(f.type){case "keyword":35633===
a&&"attribute"===f.data?f.data="in":"varying"===f.data&&(f.data=35633===a?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(f.data.trim())&&(f.data=f.data.replace(/(2D|Cube|EXT)/g,""));35632===a&&"gl_FragColor"===f.data&&(c||(c=A(d,e,"fragColor"),k(d,c,"vec4")),f.data=c);if(35632===a&&"gl_FragData"===f.data){{var v=void 0;let D=void 0;var E=d;var n=B+1;let H=-1;for(;n<E.length;n++){const P=E[n];if("operator"===P.type&&("["===P.data&&(D=n),"]"===P.data)){v=n;break}"integer"===
P.type&&(H=parseInt(P.data,10))}D&&v&&E.splice(D,v-D+1);E=H}v=A(d,e,"fragData");w(d,v,"vec4",E,"mediump");f.data=v}else 35632===a&&"gl_FragDepthEXT"===f.data&&(r||(r=A(d,e,"gl_FragDepth")),f.data=r);break;case "ident":if(0<=l.indexOf(f.data)){if(E=35633===a)a:{for(E=B-1;0<=E;E--)if(v=d[E],"whitespace"!==v.type&&"block-comment"!==v.type)if("keyword"===v.type){if("attribute"===v.data||"in"===v.data){E=!0;break a}}else break;E=!1}if(E)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");
f.data in h||(h[f.data]=A(d,e,f.data));f.data=h[f.data]}}}for(a=d.length-1;0<=a;--a)c=d[a],"preprocessor"===c.type&&((r=c.data.match(/#extension\s+(.*):/))&&r[1]&&0<=q.indexOf(r[1].trim())&&(r=d[a+1],d.splice(a,r&&"whitespace"===r.type?2:1)),(r=c.data.match(/#ifdef\s+(.*)/))&&r[1]&&0<=q.indexOf(r[1].trim())&&(c.data="#if 1"),(r=c.data.match(/#ifndef\s+(.*)/))&&r[1]&&0<=q.indexOf(r[1].trim())&&(c.data="#if 0"));return z(d)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/reservedWordsGLSL3":function(){define(function(){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/chunks/LaserlinePath.glsl":function(){define(["exports","../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl","../views/3d/webgl-engine/core/shaderModules/interfaces","../views/3d/webgl-engine/core/shaderModules/ShaderBuilder"],function(b,l,m,z){function C(g){const k=new z.ShaderBuilder;k.include(l.Laserline,g);k.vertex.uniforms.add("uModelViewMatrix","mat4");k.vertex.uniforms.add("uProjectionMatrix","mat4");k.attributes.add("start","vec3");k.attributes.add("end","vec3");k.attributes.add("up",
"vec3");k.attributes.add("extrude","vec2");k.varyings.add("uv","vec2");k.varyings.add("vViewStart","vec3");k.varyings.add("vViewEnd","vec3");k.varyings.add("vViewPlane","vec4");k.vertex.uniforms.add("glowWidth","float");k.vertex.uniforms.add("pixelToNDC","vec2");k.vertex.code.add(m.glsl`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = uModelViewMatrix * vec4(pos, 1);
vec4 projPos = uProjectionMatrix * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;
vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`);k.fragment.uniforms.add("globalAlpha","float");k.fragment.uniforms.add("perScreenPixelRatio","float");k.fragment.code.add(m.glsl`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`);return k}var A=Object.freeze({__proto__:null,build:C});b.LaserlinePathShader=A;b.build=C})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define(["exports","./output/ReadLinearDepth.glsl","./util/CameraSpace.glsl","../shaderModules/interfaces"],function(b,l,m,z){b.Laserline=function(C,A){C.extensions.add("GL_OES_standard_derivatives");C.fragment.include(l.ReadLinearDepth);C.include(m.CameraSpace);C.fragment.uniforms.add("glowColor","vec3");C.fragment.uniforms.add("glowWidth",
"float");C.fragment.uniforms.add("glowFalloff","float");C.fragment.uniforms.add("innerColor","vec3");C.fragment.uniforms.add("innerWidth","float");C.fragment.uniforms.add("depthMap","sampler2D");C.fragment.uniforms.add("nearFar","vec2");C.fragment.uniforms.add("frameColor","sampler2D");A.contrastControlEnabled&&C.fragment.uniforms.add("globalAlphaContrastBoost","float");C.fragment.code.add(z.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);C.fragment.code.add(z.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);C.fragment.code.add(z.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);C.fragment.code.add(z.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`);A.contrastControlEnabled?C.fragment.code.add(z.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`):C.fragment.code.add(z.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl":function(){define(["exports","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(b,l,m){b.ReadLinearDepth=function(z){z.include(l.RgbaFloatEncoding);z.code.add(m.glsl`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.RgbaFloatEncoding=function(m){m.code.add(l.glsl`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["exports"],function(b){function l(m,...z){let C="";for(let A=0;A<z.length;A++)C+=m[A]+z[A];return C+=m[m.length-1]}(function(m){m.int=function(z){return Math.round(z).toString()};m.float=function(z){return z.toPrecision(8)}})(l||(l={}));b.glsl=l;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/CameraSpace.glsl":function(){define(["exports",
"../../shaderModules/interfaces"],function(b,l){b.CameraSpace=function(m){m.fragment.uniforms.add("projInfo","vec4");m.fragment.uniforms.add("zScale","vec2");m.fragment.code.add(l.glsl`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Logger"],function(b,l,m){const z=m.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");m=function(){function t(){this.includedModules=new Map}t.prototype.include=function(p,q){this.includedModules.has(p)?this.includedModules.get(p)!==q&&z.error("Trying to include shader module multiple times with different sets of options."):
(this.includedModules.set(p,q),p(this.builder,q))};return t}();let C=function(t){function p(){var q=t.apply(this,arguments)||this;q.vertex=new k;q.fragment=new k;q.attributes=new w;q.varyings=new u;q.extensions=new x;q.constants=new y;return q}l._inheritsLoose(p,t);p.prototype.generateSource=function(q){const d=this.extensions.generateSource(q),a=this.attributes.generateSource(q),c=this.varyings.generateSource();var r="vertex"===q?this.vertex:this.fragment;const e=r.uniforms.generateSource(),h=r.code.generateSource();
q="vertex"===q?"precision highp float;\nprecision highp sampler2D;":"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif";r=this.constants.generateSource().concat(r.constants.generateSource());return`
${d.join("\n")}

${q}

${r.join("\n")}

${e.join("\n")}

${a.join("\n")}

${c.join("\n")}

${h.join("\n")}`};l._createClass(p,[{key:"fragmentUniforms",get:function(){return this.fragment.uniforms}},{key:"builder",get:function(){return this}}]);return p}(m),A=function(){function t(){this._entries=new Map}var p=t.prototype;p.add=function(q,d,a){this._entries.set(`${q}_${d}_${a}`,{name:q,type:d,arraySize:a});return this};p.generateSource=function(){return Array.from(this._entries.values()).map(q=>{var d=q.arraySize;return`uniform ${q.type} ${q.name}${d?`[${d}]`:""};`})};l._createClass(t,[{key:"entries",
get:function(){return Array.from(this._entries.values())}}]);return t}(),g=function(){function t(){this._entries=[]}var p=t.prototype;p.add=function(q){this._entries.push(q)};p.generateSource=function(){return this._entries};return t}(),k=function(t){function p(){var q=t.apply(this,arguments)||this;q.uniforms=new A;q.code=new g;q.constants=new y;return q}l._inheritsLoose(p,t);l._createClass(p,[{key:"builder",get:function(){return this}}]);return p}(m),w=function(){function t(){this._entries=[]}var p=
t.prototype;p.add=function(q,d){this._entries.push([q,d])};p.generateSource=function(q){return"fragment"===q?[]:this._entries.map(d=>`attribute ${d[1]} ${d[0]};`)};return t}(),u=function(){function t(){this._entries=[]}var p=t.prototype;p.add=function(q,d){this._entries.push([q,d])};p.generateSource=function(){return this._entries.map(q=>`varying ${q[1]} ${q[0]};`)};return t}(),x=function(){function t(){this._entries=new Set}var p=t.prototype;p.add=function(q){this._entries.add(q)};p.generateSource=
function(q){const d="vertex"===q?t.ALLOWLIST_VERTEX:t.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(a=>d.includes(a)).map(a=>`#extension ${a} : enable`)};return t}();x.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"];x.ALLOWLIST_VERTEX=[];let y=function(){function t(){this._entries=[]}var p=t.prototype;p.add=function(q,d,a){let c="ERROR_CONSTRUCTOR_STRING";switch(d){case "float":c=t.numberToFloatStr(a);break;case "int":c=t.numberToIntStr(a);break;case "bool":c=
a.toString();break;case "vec2":c=`vec2(${t.numberToFloatStr(a[0])},\
                            ${t.numberToFloatStr(a[1])})`;break;case "vec3":c=`vec3(${t.numberToFloatStr(a[0])},\
                            ${t.numberToFloatStr(a[1])},\
                            ${t.numberToFloatStr(a[2])})`;break;case "vec4":c=`vec4(${t.numberToFloatStr(a[0])},\
                            ${t.numberToFloatStr(a[1])},\
                            ${t.numberToFloatStr(a[2])},\
                            ${t.numberToFloatStr(a[3])})`;break;case "ivec2":c=`ivec2(${t.numberToIntStr(a[0])},\
                             ${t.numberToIntStr(a[1])})`;break;case "ivec3":c=`ivec3(${t.numberToIntStr(a[0])},\
                             ${t.numberToIntStr(a[1])},\
                             ${t.numberToIntStr(a[2])})`;break;case "ivec4":c=`ivec4(${t.numberToIntStr(a[0])},\
                             ${t.numberToIntStr(a[1])},\
                             ${t.numberToIntStr(a[2])},\
                             ${t.numberToIntStr(a[3])})`;break;case "mat2":case "mat3":case "mat4":c=`${d}(${Array.prototype.map.call(a,r=>t.numberToFloatStr(r)).join(", ")})`}this._entries.push(`const ${d} ${q} = ${c};`);return this};t.numberToIntStr=function(q){return q.toFixed(0)};t.numberToFloatStr=function(q){return Number.isInteger(q)?q.toFixed(1):q.toString()};p.generateSource=function(){return Array.from(this._entries)};return t}();b.Code=g;b.Includes=m;b.ShaderBuilder=C;b.Stage=k;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/webgl/BufferObject":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Logger","../../core/typedArrayUtil","./checkWebGLError","./enums"],function(b,l,m,z,C){const A=l.getLogger("esri.views.webgl.BufferObject");return function(){function g(w,u,x,y,t){this._context=w;this.bufferType=u;this.usage=x;this._glName=null;this._size=-1;this._indexType=void 0;w.instanceCounter.increment(C.ResourceType.Buffer,this);this._glName=this._context.gl.createBuffer();
z.checkWebGLError(this._context.gl);y&&this.setData(y,t)}g.createIndex=function(w,u,x,y){return new g(w,34963,u,x,y)};g.createVertex=function(w,u,x){return new g(w,34962,u,x)};var k=g.prototype;k.dispose=function(){var w;null!=(w=this._context)&&w.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(C.ResourceType.Buffer,this),this._context=null):this._glName&&A.warn("Leaked WebGL buffer object")};k.setData=function(w,u){if(w){if("number"===
typeof w){if(0>w&&A.error("Buffer size cannot be negative!"),34963===this.bufferType&&u)switch(this._indexType=u,this._size=w,u){case 5123:w*=2;break;case 5125:w*=4}}else u=w.byteLength,m.isUint16Array(w)&&(u/=2,this._indexType=5123),m.isUint32Array(w)&&(u/=4,this._indexType=5125),this._size=u;u=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);var x=this._context.gl;x.bufferData(this.bufferType,w,this.usage);z.checkWebGLError(x);this._context.bindVAO(u)}};k.setSubData=
function(w,u=0,x=0,y=w.byteLength){if(w){(0>u||u>=this._size)&&A.error("offset is out of range!");var t=u,p=x,q=y,d=w.byteLength;m.isUint16Array(w)&&(d/=2,t*=2,p*=2,q*=2);m.isUint32Array(w)&&(d/=4,t*=4,p*=4,q*=4);void 0===y&&(y=d-1);x>=y&&A.error("end must be bigger than start!");u+x-y>this._size&&A.error("An attempt to write beyond the end of the buffer!");u=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);x=this._context.gl;y=ArrayBuffer.isView(w)?w.buffer:
w;w=0===p&&q===w.byteLength?y:y.slice(p,q);x.bufferSubData(this.bufferType,t,w);z.checkWebGLError(x);this._context.bindVAO(u)}};b._createClass(g,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}}]);return g}()})},"esri/views/webgl/checkWebGLError":function(){define(["exports",
"../../core/Error","../../core/Logger","./RenderingContext"],function(b,l,m,z){function C(g,k){switch(k){case g.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case g.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case g.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case g.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";
case g.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case g.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const A=m.getLogger("esri/views/webgl");b.checkWebGLError=function(g){if(z.webglDebugEnabled()){const k=g.getError();k&&(g=C(g,k),A.error(new l("webgl-error","WebGL error occured",{message:g,stack:Error().stack})))}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/VertexArrayObject":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"../../core/Logger","../../core/maybe","./enums","./Util"],function(b,l,m,z,C){const A=l.getLogger("esri.views.webgl.VertexArrayObject");return function(){function g(w,u,x,y,t=null){this._context=w;this._locations=u;this._layout=x;this._buffers=y;this._indexBuffer=t;this._glName=null;this._initialized=!1;w.instanceCounter.increment(z.ResourceType.VAO,this)}var k=g.prototype;k.dispose=function(w=!0){if(this._context){if(this._glName){var u,x;const y=null==(u=this._context)?void 0:null==(x=u.capabilities)?
void 0:x.vao;y?(y.deleteVertexArray(this._glName),this._glName=null):A.warn("Leaked WebGL VAO")}this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(w){for(const y in this._buffers)this._buffers[y].dispose(),delete this._buffers[y];this._indexBuffer=m.disposeMaybe(this._indexBuffer)}this._context.instanceCounter.decrement(z.ResourceType.VAO,this);this._context=null}else(this._glName||w&&0<Object.getOwnPropertyNames(this._buffers).length)&&A.warn("Leaked WebGL VAO")};k.initialize=function(){if(!this._initialized){var w=
this._context.capabilities.vao;if(w){const u=w.createVertexArray();w.bindVertexArray(u);this._bindLayout();w.bindVertexArray(null);this._glName=u}this._initialized=!0}};k.bind=function(){this.initialize();const w=this._context.capabilities.vao;w?w.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};k._bindLayout=function(){const {_buffers:w,_layout:u,_indexBuffer:x}=this;w||A.error("Vertex buffer dictionary is empty!");const y=this._context.gl;for(const t in w){const p=
w[t];p||A.error("Vertex buffer is uninitialized!");const q=u[t];q||A.error("Vertex element descriptor is empty!");C.bindVertexBufferLayout(this._context,this._locations,p,q)}m.isSome(x)&&(this._context.capabilities.vao?y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,x.glName):this._context.bindBuffer(x))};k.unbind=function(){this.initialize();const w=this._context.capabilities.vao;w?w.bindVertexArray(null):this._unbindLayout()};k._unbindLayout=function(){const {_buffers:w,_layout:u}=this;w||A.error("Vertex buffer dictionary is empty!");
for(const x in w){const y=w[x];y||A.error("Vertex buffer is uninitialized!");C.unbindVertexBufferLayout(this._context,this._locations,y,u[x])}m.isSome(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)};b._createClass(g,[{key:"glName",get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){return Object.keys(this._buffers).reduce((w,u)=>w+this._buffers[u].size,
m.isSome(this._indexBuffer)?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}}]);return g}()})},"esri/views/webgl/Util":function(){define(["exports","../../core/has","../../core/maybe"],function(b,l,m){function z(g){return g[0].stride}function C(g){switch(g){case 6406:case 6409:case 36168:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;
case 33328:case 34842:return 8;case 34836:return 16;case 33776:case 33777:return.5;case 33778:case 33779:return 1;case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5;case 37490:case 37491:case 37496:case 37497:return 1}return 0}function A(g){if(m.isNone(g))return 0;if("descriptor"in g)return g.glName?A(g.descriptor):0;const k=g.internalFormat||"pixelFormat"in g&&g.pixelFormat;if(!k)return 0;const w="hasMipmap"in g&&g.hasMipmap?1.3:1;g=g.width*g.height;return C(k)*g*w}b.bindVertexBufferLayout=
function(g,k,w,u,x){const y=g.gl,t=g.capabilities.instancing;g.bindBuffer(w);for(const p of u)if(g=k.get(p.name),void 0===g&&console.error(`There is no location for vertex attribute '${p.name}' defined.`),p.baseInstance&&!p.divisor&&console.error(`Vertex attribute '${p.name}' uses baseInstanceOffset without divisor.`),w=(x?x:0+p.baseInstance?p.baseInstance:0)*p.stride,4>=p.count)y.vertexAttribPointer(g,p.count,p.type,p.normalized,p.stride,p.offset+w),y.enableVertexAttribArray(g),0<p.divisor&&t&&t.vertexAttribDivisor(g,
p.divisor);else if(9===p.count)for(u=0;3>u;u++)y.vertexAttribPointer(g+u,3,p.type,p.normalized,p.stride,p.offset+12*u+w),y.enableVertexAttribArray(g+u),0<p.divisor&&t&&t.vertexAttribDivisor(g+u,p.divisor);else if(16===p.count)for(u=0;4>u;u++)y.vertexAttribPointer(g+u,4,p.type,p.normalized,p.stride,p.offset+16*u+w),y.enableVertexAttribArray(g+u),0<p.divisor&&t&&t.vertexAttribDivisor(g+u,p.divisor);else console.error("Unsupported vertex attribute element count: "+p.count)};b.getBytesPerElementFormat=
C;b.getGpuMemoryUsage=A;b.getStride=z;b.unbindVertexBufferLayout=function(g,k,w,u){const x=g.gl,y=g.capabilities.instancing;g.bindBuffer(w);for(const t of u)if(w=k.get(t.name),4>=t.count)x.disableVertexAttribArray(w),t.divisor&&0<t.divisor&&y&&y.vertexAttribDivisor(w,0);else if(9===t.count)for(u=0;3>u;u++)x.disableVertexAttribArray(w+u),t.divisor&&0<t.divisor&&y&&y.vertexAttribDivisor(w+u,0);else if(16===t.count)for(u=0;4>u;u++)x.disableVertexAttribArray(w+u),t.divisor&&0<t.divisor&&y&&y.vertexAttribDivisor(w+
u,0);else console.error("Unsupported vertex attribute element count: "+t.count);g.unbindBuffer(34962)};b.vertexCount=function(g,k){return g.vertexBuffers[k].size/z(g.layout[k])};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/glUtil3D":function(){define("exports ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),function(b,l,m,z,C,A){b.createColorTexture=
function(g,k,w=4){const u=new Uint8Array(w*w*4);for(let x=0;x<u.length;x+=4)u[x+0]=255*k[0],u[x+1]=255*k[1],u[x+2]=255*k[2],u[x+3]=255*k[3];return new C(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:w,height:w},u)};b.createEmptyDepthTexture=function(g){return new C(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))};b.createEmptyTexture=function(g,k=4){return new C(g,{target:3553,pixelFormat:6408,dataType:5121,
samplingMode:9728,width:k,height:k})};b.createQuadVAO=function(g,k=m.Pos2,w=l.Default3D,u=-1,x=1){let y=null;switch(k){case m.Pos2Tex:y=new Float32Array([u,u,0,0,x,u,1,0,u,x,0,1,x,x,1,1]);break;default:y=new Float32Array([u,u,x,u,u,x,x,x])}return new A(g,w,{geometry:k},{geometry:z.createVertex(g,35044,y)})};b.createScreenSizeTriangleVAO=function(g,k=m.Pos2,w=l.Default3D){const u=new Float32Array([-1,-1,3,-1,-1,3]);return new A(g,w,{geometry:k},{geometry:z.createVertex(g,35044,u)})};Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["exports"],function(b){const l=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]]);b.Default3D=l;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["exports"],
function(b){b.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];b.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];b.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];b.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}];b.Pos3NormalTex=[{name:"position",count:3,
type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];b.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Util":function(){define("exports ../../../../core/mathUtils ../../../../chunks/mat4 ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64".split(" "),
function(b,l,m,z,C,A,g,k){function w(c,r){if(!c)throw r=r||"assert",c=Error(r),c.stack&&console.log(c.stack),new p(r);}function u(c,r){c[12]=r[0];c[13]=r[1];c[14]=r[2]}function x(c,r=0){let e=0;for(let h=0;4>h;h++)e+=c[r+h]*d[h];return e}function y(c){return c-Math.floor(c)}const t=k.create();let p=function(){function c(r){this.message=r}c.prototype.toString=function(){return`AssertException: ${this.message}`};return c}();const q=[1,256,65536,16777216],d=[1/256,1/65536,1/16777216,1/4294967296],a=
x(new Uint8ClampedArray([255,255,255,255]));b.AssertException=p;b.assert=w;b.createTranslationMatrix=function(c,r){c=m.identity(c);u(c,r);return c};b.dec2hex=function(c){c=c.toString(16);return"00000000".substr(0,8-c.length)+c};b.encodeInt16=function(c){return l.clamp(Math.round(32767*c),-32767,32767)};b.encodeNormal=function(c,r){const e=Math.abs(c[0]),h=Math.abs(c[1]),v=1/(e+h+Math.abs(c[2])),E=Math.min(c[2]*v,0);r[0]=(0>c[0]?-1:1)*(e*v-E);r[1]=(0>c[1]?-1:1)*(h*v-E)};b.fallbackIfUndefined=function(c,
r){return void 0===c?r:c};b.fovd2fovx=function(c,r,e){return 2*Math.atan(r*Math.tan(.5*c)/Math.sqrt(r*r+e*e))};b.fovd2fovy=function(c,r,e){return 2*Math.atan(e*Math.tan(.5*c)/Math.sqrt(r*r+e*e))};b.fovx2fovd=function(c,r,e){return 2*Math.atan(Math.sqrt(r*r+e*e)*Math.tan(.5*c)/r)};b.fovx2fovy=function(c,r,e){return 2*Math.atan(e*Math.tan(.5*c)/r)};b.fovy2fovd=function(c,r,e){return 2*Math.atan(Math.sqrt(r*r+e*e)*Math.tan(.5*c)/e)};b.fovy2fovx=function(c,r,e){return 2*Math.atan(r*Math.tan(.5*c)/e)};
b.getFirstObjectKey=function(c){for(const r in c)return r};b.getMatrixTranslation=function(c,r=A.create()){r[0]=c[12];r[1]=c[13];r[2]=c[14];return r};b.hex2rgb=function(c){c=Math.floor(c);return[(c>>16&255)/255,(c>>8&255)/255,(c&255)/255]};b.inverseProjectionInfo=function(c,r,e,h,v){0===c[11]?(h[0]=2/(r*c[0]),h[1]=2/(e*c[5]),h[2]=(1+c[12])/c[0],h[3]=(1+c[13])/c[5],z.set(v,0,1)):(h[0]=-2/(r*c[0]),h[1]=-2/(e*c[5]),h[2]=(1-c[8])/c[0],h[3]=(1-c[9])/c[5],z.set(v,1,0))};b.isTranslationMatrix=function(c){return 1===
c[0]&&0===c[1]&&0===c[2]&&0===c[3]&&0===c[4]&&1===c[5]&&0===c[6]&&0===c[7]&&0===c[8]&&0===c[9]&&1===c[10]&&0===c[11]&&1===c[15]};b.logWithBase=function(c,r){return Math.log(c)/Math.log(r)};b.objectEmpty=function(c){for(const r in c)return!1;return!0};b.packFloatRGBA=function(c,r,e=0){c=l.clamp(c,0,a);for(let h=0;4>h;h++)r[e+h]=Math.floor(256*y(c*q[h]))};b.project=function(c,r,e,h,v){v||(v=c);t[0]=c[0];t[1]=c[1];t[2]=c[2];t[3]=1;g.transformMat4(t,t,r);2<v.length&&(v[2]=-t[2]);g.transformMat4(t,t,e);
w(0!==t[3]);v[0]=t[0]/t[3];v[1]=t[1]/t[3];v[2]=t[2]/t[3];v[0]=(.5*v[0]+.5)*h[2]+h[0];v[1]=(.5*v[1]+.5)*h[3]+h[1]};b.rayBoxTest=function(c,r,e,h){let v,E=(e[0]-c[0])/r[0],n=(h[0]-c[0])/r[0];E>n&&(v=E,E=n,n=v);let B=(e[1]-c[1])/r[1],f=(h[1]-c[1])/r[1];B>f&&(v=B,B=f,f=v);if(E>f||B>n)return!1;B>E&&(E=B);f<n&&(n=f);e=(e[2]-c[2])/r[2];c=(h[2]-c[2])/r[2];e>c&&(v=e,e=c,c=v);if(E>c||e>n)return!1;c<n&&(n=c);return 0>n?!1:!0};b.rayRay2D=function(c,r,e,h,v,E=C.create()){const n=(h[v]-e[v])*(r[0]-c[0])-(h[0]-
e[0])*(r[v]-c[v]);if(0===n)return!1;e=((h[0]-e[0])*(c[v]-e[v])-(h[v]-e[v])*(c[0]-e[0]))/n;E[0]=c[0]+e*(r[0]-c[0]);E[1]=c[v]+e*(r[v]-c[v]);return!0};b.rayTriangle3D=function(c,r,e,h,v,E,n,B,f=A.create()){var D=h[n]-e[E];const H=h[n+1]-e[E+1],P=h[n+2]-e[E+2];h=v[B]-e[E];n=v[B+1]-e[E+1];v=v[B+2]-e[E+2];const R=r[1]*v-n*r[2],K=r[2]*h-v*r[0],J=r[0]*n-h*r[1];B=D*R+H*K+P*J;if(-1E-5<B&&1E-5>B)return!1;B=1/B;const Q=c[0]-e[E],F=c[1]-e[E+1];c=c[2]-e[E+2];f[1]=B*(Q*R+F*K+c*J);if(0>f[1]||1<f[1])return!1;e=F*
P-H*c;c=c*D-P*Q;D=Q*H-D*F;f[2]=B*(r[0]*e+r[1]*c+r[2]*D);if(0>f[2]||1<f[1]+f[2])return!1;f[0]=B*(h*e+n*c+v*D);return!0};b.rgb2hex=function(c){const r=l.clamp(Math.round(255*c[0]),0,255),e=l.clamp(Math.round(255*c[1]),0,255);c=l.clamp(Math.round(255*c[2]),0,255);return"0x"+((r<<16)+(e<<8)+c).toString(16)};b.setMatrixTranslation=u;b.setMatrixTranslation3=function(c,r,e,h){c[12]=r;c[13]=e;c[14]=h};b.unpackFloatRGBA=x;b.verify=function(c,r){c||console.warn("Verify failed: "+(r||"")+"\n"+Error("verify").stack)};
Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("exports ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/aaBoundingBox ../../lib/screenSizePerspectiveUtils ../../lib/Util ../renderers/utils".split(" "),function(b,l,m,z,C,A,g,k,w){function u(E,n,B,f,D,H){if(!m.isNone(E)){var P=t(n,B,r);A.setMin(c,E.getBBMin());A.setMax(c,
E.getBBMax());m.isSome(D)&&D.applyToAabb(c);if(p(c,n,P,f)){const {primitiveIndices:R,indices:K,position:J}=E;P=R?R.length:K.length/3;if(1E3<P&&(E=E.getChildren(),void 0!==E)){for(P=0;8>P;++P)void 0!==E[P]&&u(E[P],n,B,f,D,H);return}x(n,B,0,P,K,J,R,D,H)}}}function x(E,n,B,f,D,H,P,R,K){if(P){var J=H.data;H=H.stride||H.size;var Q=E[0],F=E[1];E=E[2];var O=n[0]-Q,V=n[1]-F;for(n=n[2]-E;B<f;++B){var M=P[B],T=3*M,S=H*D[T++],L=J[S++],N=J[S++],U=J[S];S=H*D[T++];var fa=J[S++],ka=J[S++],wa=J[S];S=H*D[T];T=J[S++];
var ya=J[S++];S=J[S];m.isSome(R)&&([L,N,U]=R.applyToVertex(L,N,U,B),[fa,ka,wa]=R.applyToVertex(fa,ka,wa,B),[T,ya,S]=R.applyToVertex(T,ya,S,B));fa-=L;ka-=N;wa-=U;T-=L;ya-=N;S-=U;var oa=V*S-ya*n,G=n*T-S*O;const Z=O*ya-T*V;var I=fa*oa+ka*G+wa*Z;if(!(Math.abs(I)<=Number.EPSILON)){L=Q-L;N=F-N;U=E-U;oa=L*oa+N*G+U*Z;if(0<I){if(0>oa||oa>I)continue}else if(0<oa||oa<I)continue;G=N*wa-ka*U;U=U*fa-wa*L;N=L*ka-fa*N;L=O*G+V*U+n*N;if(0<I){if(0>L||oa+L>I)continue}else if(0<L||oa+L<I)continue;U=(T*G+ya*U+S*N)/I;0<=
U&&(fa=y(fa,ka,wa,T,ya,S,e),K(U,fa,M))}}}else{P=H.data;J=H.stride||H.size;H=E[0];Q=E[1];F=E[2];E=n[0]-H;O=n[1]-Q;V=n[2]-F;for(let Z=B,ca=3*B;Z<f;++Z)if(T=J*D[ca++],N=P[T++],U=P[T++],wa=P[T],T=J*D[ca++],n=P[T++],B=P[T++],M=P[T],T=J*D[ca++],fa=P[T++],ka=P[T++],T=P[T],m.isSome(R)&&([N,U,wa]=R.applyToVertex(N,U,wa,Z),[n,B,M]=R.applyToVertex(n,B,M,Z),[fa,ka,T]=R.applyToVertex(fa,ka,T,Z)),n-=N,B-=U,M-=wa,fa-=N,ka-=U,T-=wa,S=O*T-ka*V,L=V*fa-T*E,I=E*ka-fa*O,ya=n*S+B*L+M*I,!(Math.abs(ya)<=Number.EPSILON)){N=
H-N;U=Q-U;wa=F-wa;S=N*S+U*L+wa*I;if(0<ya){if(0>S||S>ya)continue}else if(0<S||S<ya)continue;L=U*M-B*wa;wa=wa*n-M*N;U=N*B-n*U;N=E*L+O*wa+V*U;if(0<ya){if(0>N||S+N>ya)continue}else if(0<N||S+N<ya)continue;wa=(fa*L+ka*wa+T*U)/ya;0<=wa&&(n=y(n,B,M,fa,ka,T,e),K(wa,n,Z))}}}function y(E,n,B,f,D,H,P){z.set(h,E,n,B);z.set(v,f,D,H);z.cross(P,h,v);z.normalize(P,P);return P}function t(E,n,B){return z.set(B,1/(n[0]-E[0]),1/(n[1]-E[1]),1/(n[2]-E[2]))}function p(E,n,B,f){return q(E,n,B,f,Infinity)}function q(E,n,
B,f,D){var H=(E[0]-f-n[0])*B[0],P=(E[3]+f-n[0])*B[0];let R=Math.min(H,P);H=Math.max(H,P);P=(E[1]-f-n[1])*B[1];const K=(E[4]+f-n[1])*B[1];H=Math.min(H,Math.max(P,K));if(0>H)return!1;R=Math.max(R,Math.min(P,K));if(R>H)return!1;P=(E[2]-f-n[2])*B[2];E=(E[5]+f-n[2])*B[2];H=Math.min(H,Math.max(P,E));if(0>H)return!1;R=Math.max(R,Math.min(P,E));return R>H?!1:R<D}function d(E,n){n=n?d(n):{};for(const B in E){let f=E[B];f&&f.forEach&&(f=a(f));null==f&&B in n||(n[B]=f)}return n}function a(E){const n=[];E.forEach(B=>
n.push(B));return n}const c=A.create(),r=C.create(),e=C.create(),h=C.create(),v=C.create();b.bindScreenSizePerspective=function(E,n,B){if(E){var f=E.parameters;n.setUniform4f(B,f.divisor,f.offset,f.minPixelSize,E.paddingPixelsOverride)}};b.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};b.computeInvDir=t;b.computeNormal=y;b.copyParameters=d;b.intersectAabbInvDir=p;b.intersectAabbInvDirBefore=q;b.intersectDrapedRenderLineGeometry=function(E,n,B,f,D){if(n.options.selectionMode){n=E.vertexAttributes.get("position").data;
var H=E.vertexAttributes.get("size"),P=B[0];B=B[1];E=(((H&&H.data[0])+f)/2+4)*E.screenToWorldRatio;f=Number.MAX_VALUE;for(H=0;H<n.length-5;H+=3){var R=n[H],K=n[H+1],J=P-R,Q=B-K;R=n[H+3]-R;K=n[H+4]-K;const F=l.clamp((R*J+K*Q)/(R*R+K*K),0,1);J=R*F-J;Q=K*F-Q;Q=J*J+Q*Q;Q<f&&(f=Q)}f<E*E&&D()}};b.intersectTriangleGeometry=function(E,n,B,f,D,H,P){w.isInstanceHidden(n)||(E.boundingInfo?(k.assert(0===E.primitiveType),u(E.boundingInfo,f,D,B.tolerance,H,P)):(n=E.indices.get("position"),E=E.vertexAttributes.get("position"),
x(f,D,0,n.length/3,n,E,void 0,H,P)))};b.intersectTriangles=x;b.updateParameters=function(E,n){let B=!1;for(const f in n){const D=n[f];void 0!==D&&(B=!0,Array.isArray(D)?E[f]=D.slice():E[f]=D)}return B};b.verticalOffsetAtDistance=function(E,n,B,f,D){let H=(B.screenLength||0)*E.pixelRatio;D&&(H=g.scale(H,f,n,D));return l.clamp(H*Math.tan(.5*E.fovY)/(.5*E.fullHeight)*n,B.minWorldLength||0,null!=B.maxWorldLength?B.maxWorldLength:Infinity)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../core/mathUtils"],function(b,l,m){function z(x,y,t){const p=t.parameters;t=t.paddingPixelsOverride;w.scale=Math.min(p.divisor/(y-p.offset),1);w.factor=Math.abs(x*x*x);w.minPixelSize=p.minPixelSize;w.paddingPixels=t;return w}function C(x,y){return 0===x?y.minPixelSize:y.minPixelSize*(1+2*y.paddingPixels/x)}function A(x,y){return Math.max(m.lerp(x*y.scale,x,y.factor),C(x,y))}let g=function(){function x(t,p,q,d={camera:{distance:0,fovY:0},divisor:0,
offset:0,minPixelSize:0,paddingPixels:0},a){this.viewingMode=t;this.description=p;this.ellipsoidRadius=q;this.parameters=d;this._paddingPixelsOverride=a;2===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}var y=x.prototype;
y.update=function(t){if(this.parameters&&this.parameters.camera.fovY===t.fovY&&this.parameters.camera.distance===t.distance)return!1;this.calculateParameters(t,this.ellipsoidRadius,this.parameters);return!0};y.overridePadding=function(t){return t!==this.paddingPixelsOverride?new x(this.viewingMode,this.description,this.ellipsoidRadius,this.parameters,t):this};y.calculateParameters=function(t,p,q){const {scaleStart:d,scaleFallOffRange:a,minPixelSize:c}=this.description,{fovY:r,distance:e}=t;var h=
this.calculateCurvatureDependentParameters(t,p);p=this.coverageCompensation(t,p,h);const {tiltAngle:v,scaleFallOffFactor:E}=h,n=Math.sin(v)*e,B=.5*Math.PI-v-r*(.5-d*p);h=n/Math.cos(B);p=(h-n/Math.cos(B+r*a*p)*E)/(1-E);q.camera.fovY=t.fovY;q.camera.distance=t.distance;q.offset=p;q.divisor=h-p;q.minPixelSize=c;return q};y.calculateCurvatureDependentParametersLocal=function(t,p,q=u){q.tiltAngle=this.description.curvatureDependent.min.tiltAngle;q.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;
return q};y.calculateCurvatureDependentParametersGlobal=function(t,p,q=u){const d=this.description.curvatureDependent;t=1+t.distance/p;t=Math.sqrt(t*t-1);const [a,c]=[d.min.curvature,d.max.curvature];t=m.clamp((t-a)/(c-a),0,1);const [r,e]=[d.min,d.max];q.tiltAngle=m.lerp(r.tiltAngle,e.tiltAngle,t);q.scaleFallOffFactor=m.lerp(r.scaleFallOffFactor,e.scaleFallOffFactor,t);return q};y.surfaceCoverageCompensationLocal=function(t,p,q){return(t.fovY-q.tiltAngle)/t.fovY};y.surfaceCoverageCompensationGlobal=
function(t,p,q){const d=p*p;q=q.tiltAngle+.5*Math.PI;const {fovY:a,distance:c}=t;t=c*c+d-2*Math.cos(q)*c*p;const r=Math.sqrt(t);return(Math.acos(Math.sqrt(t-d)/r)-Math.asin(p/(r/Math.sin(q)))+.5*a)/a};l._createClass(x,[{key:"paddingPixelsOverride",get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels}}]);return x}();const k={curvatureDependent:{min:{curvature:m.deg2rad(10),tiltAngle:m.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:m.deg2rad(70),tiltAngle:m.deg2rad(40),
scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},w={scale:0,factor:0,minPixelSize:0,paddingPixels:0},u={tiltAngle:0,scaleFallOffFactor:0};b.applyPrecomputedScaleFactor=function(x,y,t=[0,0]){y=Math.min(Math.max(y.scale,C(x[1],y)/x[1]),1);t[0]=x[0]*y;t[1]=x[1]*y;return t};b.applyScaleFactor=A;b.applyScaleFactorVec2=function(x,y,t=[0,0]){const p=Math.min(Math.max(y.scale,C(x[1],y)/x[1]),1);t[0]=m.lerp(x[0]*p,x[0],y.factor);t[1]=m.lerp(x[1]*p,x[1],y.factor);return t};b.getLabelSettings=
function(x,y){const {curvatureDependent:t,scaleStart:p,scaleFallOffRange:q}=k;return new g(x,{curvatureDependent:{min:{curvature:t.min.curvature,tiltAngle:t.min.tiltAngle,scaleFallOffFactor:.7},max:{curvature:t.max.curvature,tiltAngle:t.max.tiltAngle,scaleFallOffFactor:.95}},scaleStart:p,scaleFallOffRange:q,minPixelSize:14},y)};b.getSettings=function(x,y){return new g(x,k,y)};b.precomputeScaleFactor=function(x,y,t,p){x=z(x,y,t);x.minPixelSize=0;x.paddingPixels=0;x=A(1,x);p.scale=x;p.factor=0;p.minPixelSize=
t.parameters.minPixelSize;p.paddingPixels=t.paddingPixelsOverride};b.scale=function(x,y,t,p){return A(x,z(y,t,p))};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("exports ../../../../../core/maybe ../../../../../chunks/mat4 ../../../../../chunks/mat4f64 ../../lib/doublePrecisionUtils ../../lib/Util".split(" "),function(b,l,m,z,C,A){const g=new Float64Array(3),k=new Float32Array(6),w=z.create();b.acquireMaterials=function(u,
x){const y=new Map;y.set(0,x.acquire(u,0));y.set(1,x.acquire(u,7));y.set(4,x.acquire(u,3));y.set(3,x.acquire(u,2));y.set(2,x.acquire(u,1));y.set(5,x.acquire(u,4));y.set(7,x.acquire(u,3));y.set(6,x.acquire(u,3));return y};b.addObject3DStateID=function(u,x){l.isNone(u)&&(u=[]);u.push(x);return u};b.calculateTransformRelativeToOrigin=function(u,x,y){const t=u.origin.vec3;A.setMatrixTranslation3(w,-t[0],-t[1],-t[2]);l.isSome(u.transformation)?m.multiply(x,w,u.transformation):m.copy(x,w);y&&(m.invert(y,
x),m.transpose(y,y))};b.encodeDoubleVec3=function(u,x,y,t,p){g[0]=u.get(x,0);g[1]=u.get(x,1);g[2]=u.get(x,2);C.encodeDoubleArray(g,k,3);y.set(p,0,k[0]);t.set(p,0,k[1]);y.set(p,1,k[2]);t.set(p,1,k[3]);y.set(p,2,k[4]);t.set(p,2,k[5])};b.isInstanceHidden=function(u){return l.isSome(u)?!u.visible:!1};b.releaseMaterials=function(u,x){x.release(u,0);x.release(u,7);x.release(u,3);x.release(u,2);x.release(u,1);x.release(u,4)};b.removeObject3DStateID=function(u,x){if(l.isNone(u))return u;u=u.filter(y=>y!==
x);return 0===u.length?null:u};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/doublePrecisionUtils":function(){define(["exports"],function(b){function l(C,A,g){for(let k=0;k<g;++k)A[2*k]=C[k],A[2*k+1]=C[k]-A[2*k]}const m=new Float64Array(1),z=new Float32Array(2);b.decodeDoubleArray=function(C,A,g){for(let k=0;k<g;++k)A[k]=C[2*k]+C[2*k+1]};b.encodeDouble=function(C,A){z[0]=C;z[1]=C-z[0];A[0]=z[0];A[1]=z[1]};b.encodeDoubleArray=l;b.encodeDoubleArraySplit=function(C,
A,g,k){for(let w=0;w<k;++w)m[0]=C[w],l(m,z,1),A[w]=z[0],g[w]=z[1]};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/mathUtils ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/Laserlines.glsl ../../../webgl/renderState".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){g=function(t){function p(){return t.apply(this,arguments)||this}m._inheritsLoose(p,t);var q=p.prototype;q.initializeProgram=function(d){const a=p.shader.get().build(this.configuration);return new u.Program(d.rctx,a,w.Default3D)};q.bind=function(d,a){this.program.setUniform3fv("innerColor",d.innerColor);this.program.setUniform1f("innerWidth",d.innerWidth*a.pixelRatio);this.program.setUniform3fv("glowColor",d.glowColor);this.program.setUniform1f("glowWidth",d.glowWidth*
a.pixelRatio);this.program.setUniform1f("glowFalloff",d.glowFalloff);this.program.setUniform1f("globalAlpha",d.globalAlpha);this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=d.globalAlphaContrastBoost?d.globalAlphaContrastBoost:1);d=null!=d.angleCutoff?d.angleCutoff:x.defaultAngleCutoff;this.program.setUniform2f("angleCutoff",Math.cos(d),Math.cos(Math.max(0,d-C.deg2rad(2))));this.configuration.intersectsLineEnabled&&this.program.setUniform1f("perScreenPixelRatio",
a.perScreenPixelRatio)};q.initializePipeline=function(){return y.makePipelineState({blending:y.simpleBlendingParams(1,771),colorWrite:y.defaultColorWriteParams})};return p}(g.ShaderTechnique);g.shader=new A.ReloadableShaderModule(x.LaserlinesShader,()=>new Promise(function(t,p){b(["./Laserlines.glsl"],t,p)}));A=function(t){function p(){var q=t.apply(this,arguments)||this;q.heightManifoldEnabled=!1;q.pointDistanceEnabled=!1;q.lineVerticalPlaneEnabled=!1;q.intersectsLineEnabled=!1;q.contrastControlEnabled=
!1;return q}m._inheritsLoose(p,t);return p}(k.ShaderTechniqueConfiguration);z.__decorate([k.parameter()],A.prototype,"heightManifoldEnabled",void 0);z.__decorate([k.parameter()],A.prototype,"pointDistanceEnabled",void 0);z.__decorate([k.parameter()],A.prototype,"lineVerticalPlaneEnabled",void 0);z.__decorate([k.parameter()],A.prototype,"intersectsLineEnabled",void 0);z.__decorate([k.parameter()],A.prototype,"contrastControlEnabled",void 0);l.LaserlineTechnique=g;l.LaserlineTechniqueConfiguration=
A;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),function(b,l,m,z,C,A){function g(w){const u=new A.ShaderBuilder;u.extensions.add("GL_OES_standard_derivatives");u.include(z.ScreenSpacePass);
u.include(m.Laserline,w);u.fragment.uniforms.add("angleCutoff","vec2");u.fragment.uniforms.add("globalAlpha","float");w.heightManifoldEnabled&&u.fragment.uniforms.add("heightPlane","vec4");w.pointDistanceEnabled&&u.fragment.uniforms.add("pointDistanceSphere","vec4");w.lineVerticalPlaneEnabled&&u.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart","vec3").add("lineVerticalEnd","vec3");(w.heightManifoldEnabled||w.pointDistanceEnabled||w.lineVerticalPlaneEnabled)&&u.fragment.uniforms.add("maxPixelDistance",
"float");w.intersectsLineEnabled&&u.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float");(w.lineVerticalPlaneEnabled||w.heightManifoldEnabled)&&u.fragment.code.add(C.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);w.pointDistanceEnabled&&u.fragment.code.add(C.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);w.intersectsLineEnabled&&u.fragment.code.add(C.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`);(w.lineVerticalPlaneEnabled||w.intersectsLineEnabled)&&u.fragment.code.add(C.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);u.fragment.code.add(C.glsl`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`);w.heightManifoldEnabled&&u.fragment.code.add(C.glsl`{
float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
color = max(color, heightManifoldColor * heightManifoldAlpha);
}`);w.pointDistanceEnabled&&u.fragment.code.add(C.glsl`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`);w.lineVerticalPlaneEnabled&&u.fragment.code.add(C.glsl`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`);w.intersectsLineEnabled&&u.fragment.code.add(C.glsl`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`);u.fragment.code.add(C.glsl`gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`);return u}l=l.deg2rad(6);var k=Object.freeze({__proto__:null,defaultAngleCutoff:l,build:g});b.LaserlinesShader=k;b.build=g;b.defaultAngleCutoff=l})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass":function(){define(["exports","../shaderModules/interfaces"],function(b,l){b.ScreenSpacePass=function(m){m.attributes.add("position","vec2");m.varyings.add("uv","vec2");m.vertex.code.add(l.glsl`
    void main(void) {
      gl_Position = vec4(position, 0.0, 1.0);
      uv = position * 0.5 + vec2(0.5);
    }
  `)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/Object3DVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ./VisualElement ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/WebGLLayer".split(" "),function(b,l,m,z,C,A,g,k){A=function(w){function u(y){y=w.call(this,y.view)||this;y._resources=null;y._transform=C.create();return y}l._inheritsLoose(u,
w);var x=u.prototype;x.recreate=function(){this.attached&&this.createResources()};x.recreateGeometry=function(){if(!m.isNone(this._resources)){var y=this._resources.object,t=this.view._stage;t.removeMany(y.geometries);y.removeAllGeometries();this.createGeometries(y);this.visible||y.setVisible(this.visible);t.addMany(y.geometries)}};x.createResources=function(){this.destroyResources();const y=this.view._stage;if(y){var t=new k.WebGLLayer({isPickable:!1,updatePolicy:1});y.add(t);var p=new g.Object3D({castShadow:!1});
p.transformation=this._transform;this.createExternalResources();this.createGeometries(p);y.addMany(p.geometries);this.forEachExternalMaterial(q=>y.add(q));y.add(p);t.add(p);this.visible||p.setVisible(!1);this._resources={layer:t,object:p}}};x.destroyResources=function(){const y=this.view._stage;!m.isNone(this._resources)&&y&&(y.remove(this._resources.object),y.remove(this._resources.layer),this.forEachExternalMaterial(t=>{y.remove(t);t.dispose()}),y.removeMany(this._resources.object.geometries),this._resources.object.dispose(),
this.destroyExternalResources(),this._resources=null)};x.updateVisibility=function(y){m.isNone(this._resources)||this._resources.object.setVisible(y)};l._createClass(u,[{key:"object",get:function(){return m.isSome(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(y){z.copy(this._transform,y);m.isSome(this._resources)&&(this._resources.object.transformation=this._transform)}}]);return u}(A.VisualElement);b.Object3DVisualElement=A;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/sphere ../../support/mathUtils ./ContentObject ./GeometryRecord ./Object3DStateID ./Util ../materials/renderers/utils".split(" "),function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){u=function(a){function c(e={}){var h=a.call(this)||
this;h.type=1;h._geometryRecords=[];h._geometries=[];h._objectTransformation=C.create();h._bvObjectSpace=new d;h._bvWorldSpace=new d;h._bvDirty=!0;h._hasVolatileTransformation=!1;h._visible=!0;h.castShadow=null!=e.castShadow?e.castShadow:!0;h.metadata=e.metadata;h.metadata&&h.metadata.isElevationSource&&(h.metadata.lastValidElevationBB=new q);h.transformation=C.create();const {geometries:v,materials:E,transformations:n,origins:B}=e;if(!Array.isArray(v))return l._assertThisInitialized(h);t.assert(E.length===
v.length,"Object3D: materials don't match geometries");t.assert(n.length===v.length,"Object3D: transformations don't match geometries");h._geometryRecords.length=v.length;h._geometries.length=v.length;for(e=0;e<v.length;e++)h._geometries[e]=v[e],h._geometryRecords[e]=x.GeometryRecord.pool.acquire(v[e],E[e],C.clone(n[e]),{highlights:null,occludees:null,visible:!0},B&&B[e]);return h}l._inheritsLoose(c,a);var r=c.prototype;r.dispose=function(){this._geometryRecords.length=0;this._geometries.length=0};
r.getNumGeometryRecords=function(){return this._geometryRecords.length};r.getGeometryRecord=function(e){t.assert(0<=e&&e<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this._geometryRecords[e]};r.addGeometry=function(e,h,v,E,n,B){v=v?v:C.IDENTITY;this._geometries.push(e);e=x.GeometryRecord.pool.acquire(e,h,v,E||{highlights:null,occludees:null,visible:!0},n,B);this._geometryRecords.push(e);this._hasVolatileTransformation=this._hasVolatileTransformation||
m.isSome(e.shaderTransformation);this._emit("objectGeometryAdded",{object:this,record:e});this._invalidateBoundingVolume();return e};r.removeGeometry=function(e){const h=this._geometryRecords.splice(e,1)[0];this._hasVolatileTransformation=m.isSome(h.shaderTransformation)?this._geometryRecords.some(v=>m.isSome(v.shaderTransformation)):this._hasVolatileTransformation;h.dispose();this._geometries.splice(e,1);this._emit("objectGeometryRemoved",{object:this,record:h});this._invalidateBoundingVolume();
return h};r.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)};r.geometryVertexAttrsUpdated=function(e){this._emit("vertexAttrsUpdated",{object:this,record:this._geometryRecords[e]});this._invalidateBoundingVolume()};r.setVisible=function(e){this._visible=e;for(const h of this._geometryRecords)h.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)};r.maskOccludee=function(){const e=new y.Object3DStateID(1);for(const h of this._geometryRecords)h.instanceParameters.occludees=
p.addObject3DStateID(h.instanceParameters.occludees,e);this._emit("occlusionChanged",this);return e};r.removeOcclude=function(e){for(const h of this._geometryRecords)h.instanceParameters.occludees=p.removeObject3DStateID(h.instanceParameters.occludees,e);this._emit("occlusionChanged",this)};r.highlight=function(){const e=new y.Object3DStateID(0);for(const h of this._geometryRecords)h.instanceParameters.highlights=p.addObject3DStateID(h.instanceParameters.highlights,e);this._emit("highlightChanged",
this);return e};r.removeHighlight=function(e){for(const h of this._geometryRecords)h.instanceParameters.highlights=p.removeObject3DStateID(h.instanceParameters.highlights,e);this._emit("highlightChanged",this)};r.getCombinedStaticTransformation=function(e,h){return z.multiply(m.unwrapOr(h,C.create()),this.transformation,e.getStaticTransformation())};r.getCombinedShaderTransformation=function(e,h){h=h||C.create();z.multiply(h,this.transformation,e.getShaderTransformation());return h};r.hasVolativeTransformation=
function(){return this._hasVolatileTransformation};r._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var e=0;e<this._geometryRecords.length;++e){var h=this._geometryRecords[e],v=this._geometries[e].boundingInfo;m.isSome(v)&&(this._calculateTransformedBoundingVolume(v,this._bvObjectSpace,h.getShaderTransformation()),this._calculateTransformedBoundingVolume(v,this._bvWorldSpace,this.getCombinedShaderTransformation(h)))}A.lerp(this._bvObjectSpace.bounds,
this._bvObjectSpace.min,this._bvObjectSpace.max,.5);A.lerp(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);e=g.create();h=g.create();v=w.maxScale(this.transformation);for(let f=0;f<this._geometryRecords.length;++f){var E=this._geometries[f].boundingInfo;if(!m.isNone(E)){var n=this._geometryRecords[f].getShaderTransformation(),B=w.maxScale(n);A.transformMat4(e,E.getCenter(),n);n=A.distance(e,this._bvObjectSpace.bounds);E=E.getBSRadius()*B;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],
n+E);A.transformMat4(h,e,this.transformation);B=A.distance(h,this._bvWorldSpace.bounds);this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],B+E*v)}}this._bvDirty=!1}};r._calculateTransformedBoundingVolume=function(e,h,v){const E=e.getBBMin();e=e.getBBMax();const n=g.clone(E),B=g.clone(e);A.transformMat4(n,n,v);A.transformMat4(B,B,v);for(var f=0;3>f;++f)h.min[f]=Math.min(h.min[f],n[f],B[f]),h.max[f]=Math.max(h.max[f],n[f],B[f]);for(f=0;3>f;++f){A.copy(n,E);A.copy(B,e);n[f]=e[f];B[f]=
E[f];A.transformMat4(n,n,v);A.transformMat4(B,B,v);for(let D=0;3>D;++D)h.min[D]=Math.min(h.min[D],n[D],B[D]),h.max[D]=Math.max(h.max[D],n[D],B[D])}};r._invalidateBoundingVolume=function(){this._bvDirty=!0;m.isSome(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)};r._emit=function(e,h){m.isSome(this._parentLayer)&&this._parentLayer.events.emit(e,h)};l._createClass(c,[{key:"geometryRecords",get:function(){return this._geometryRecords}},{key:"geometries",get:function(){return this._geometries}},
{key:"transformation",get:function(){return this._objectTransformation},set:function(e){z.copy(this._objectTransformation,e);this._invalidateBoundingVolume();this._emit("objectTransformation",this)}},{key:"parentLayer",get:function(){return this._parentLayer},set:function(e){t.assert(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer");this._parentLayer=e}},{key:"isVisible",get:function(){return this._visible}},{key:"boundingVolumeWorldSpace",get:function(){this._validateBoundingVolume();
return this._bvWorldSpace}},{key:"boundingVolumeObjectSpace",get:function(){this._validateBoundingVolume();return this._bvObjectSpace}},{key:"test",get:function(){const e=this;return{hasGeometry:h=>-1<e._geometries.indexOf(h),getGeometryIndex:h=>e._geometries.indexOf(h)}}}]);return c}(u.ContentObject);let q=function(){function a(){this.min=g.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this.max=g.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}a.prototype.isEmpty=
function(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]};return a}(),d=function(a){function c(){var r=a.apply(this,arguments)||this;r.bounds=k.create();return r}l._inheritsLoose(c,a);c.prototype.init=function(){A.set(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);A.set(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);k.clear(this.bounds)};return c}(q);b.Object3D=u;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/ContentObject":function(){define(["exports",
"../../../../core/uid"],function(b,l){let m=function(){function z(){this.id=l.generateUID()}z.prototype.unload=function(){};return z}();b.ContentObject=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/ObjectPool ../../../../core/uid ../../../../chunks/vec3".split(" "),function(b,l,m,z,C,A){let g=function(){function k(){this._disposed=
!1}var w=k.prototype;w.acquire=function(u,x,y,t,p,q){this.id=C.generateUID();this.geometry=u;this.material=x;this.transformation=y;this.instanceParameters=t;this.origin=p;this._shaderTransformation=q;this._disposed=!1};w.release=function(){this._disposed=!1};w.dispose=function(){this._disposed=!0};w.getStaticTransformation=function(){return this.transformation};w.getShaderTransformation=function(){return m.isSome(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation};
w.computeAttachmentOrigin=function(u){return(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,u):this.geometry.computeAttachmentOrigin(u))?(A.transformMat4(u,u,this.getStaticTransformation()),!0):!1};l._createClass(k,[{key:"disposed",get:function(){return this._disposed}},{key:"shaderTransformation",get:function(){return this._shaderTransformation}}]);return k}();g.pool=new z(g);b.GeometryRecord=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Object3DStateID":function(){define(["exports",
"../../../../core/uid"],function(b,l){b.Object3DStateID=function(m){this.channel=m;this.id=l.generateUID()};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/WebGLLayer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Evented ../../../../core/Handles ../../../../core/maybe ../../../../core/PooledArray ./ContentObject ./DirtyEvents ./Octree".split(" "),function(b,l,m,z,C,A,g,k,w){g=function(u){function x(t,p=""){var q,d,a;var c=
u.call(this)||this;c.apiLayerUid=p;c.type=0;c.events=new m;c.isSliceable=!1;c._objects=new A;c._stageHandles=new z;c.apiLayerUid=p;c.isVisible=null!=(q=null==t?void 0:t.isVisible)?q:!0;c.isPickable=null!=(d=null==t?void 0:t.isPickable)?d:!0;c.updatePolicy=null!=(a=null==t?void 0:t.updatePolicy)?a:0;return c}l._inheritsLoose(x,u);var y=x.prototype;y.destroy=function(){this.detachStage();this._stage=null};y.attachStage=function(t){this.detachStage();this._stage=t;for(const p of k.DirtyEventNames)this._stageHandles.add(this.events.on(p,
q=>t.handleEvent(p,q)))};y.detachStage=function(){this._stageHandles.removeAll();this.invalidateSpatialQueryAccelerator()};y.add=function(t){this._objects.push(t);t.parentLayer=this;this.events.emit("layerObjectAdded",{layer:this,object:t});C.isSome(this._octree)&&this._octree.add([t])};y.remove=function(t){this._objects.removeUnordered(t)&&(t.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:t}),C.isSome(this._octree)&&this._octree.remove([t]))};y.addMany=function(t){this._objects.pushArray(t);
for(const p of t)p.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:t});C.isSome(this._octree)&&this._octree.add(t)};y.removeMany=function(t){const p=[];this._objects.removeUnorderedMany(t,t.length,p);if(0!==p.length){for(const q of p)q.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:p});C.isSome(this._octree)&&this._octree.remove(p)}};y.sync=function(){C.isSome(this._stage)&&1!==this.updatePolicy&&this._stage.syncLayer(this.id)};y.notifyObjectBBChanged=
function(t,p){C.isSome(this._octree)&&this._octree.update(t,p)};y.getSpatialQueryAccelerator=function(){C.isNone(this._octree)&&50<this._objects.length&&this._createOctree();return this._octree};y.shaderTransformationChanged=function(){this.invalidateSpatialQueryAccelerator();this.events.emit("shaderTransformationChanged",this)};y.invalidateSpatialQueryAccelerator=function(){this._octree=C.destroyMaybe(this._octree)};y._createOctree=function(){this._octree=new w(t=>t.boundingVolumeWorldSpace.bounds);
this._octree.add(this._objects.data,this._objects.length)};l._createClass(x,[{key:"objects",get:function(){return this._objects}}]);return x}(g.ContentObject);b.WebGLLayer=g;b.isWebGLLayer=function(u){return C.isSome(u)&&0===u.type};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DirtyEvents":function(){define(["exports"],function(b){b.DirtyEventNames="layerObjectAdded layerObjectRemoved layerObjectsAdded layerObjectsRemoved shaderTransformationChanged objectTransformation visibilityChanged occlusionChanged highlightChanged objectGeometryAdded objectGeometryRemoved vertexAttrsUpdated".split(" ");
Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/ObjectPool ../../../../core/PooledArray ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/frustum ../../../../geometry/support/ray ../../../../chunks/sphere ./Util".split(" "),function(b,l,m,z,C,A,g,k,w,u){function x(O,V,M){M[0]=O[0]+V;M[1]=O[1]+V;M[2]=O[2]+V}function y(O,V,
M,T){if(1===V)O=M(O[0]),w.copy(O,T);else{B[0]=Infinity;B[1]=Infinity;B[2]=Infinity;f[0]=-Infinity;f[1]=-Infinity;f[2]=-Infinity;for(let U=0;U<V;U++){var S=M(O[U]);if(d(S[3])){var L=B,N=S;L[0]=Math.min(L[0],N[0]-N[3]);L[1]=Math.min(L[1],N[1]-N[3]);L[2]=Math.min(L[2],N[2]-N[3]);L=f;L[0]=Math.max(L[0],S[0]+S[3]);L[1]=Math.max(L[1],S[1]+S[3]);L[2]=Math.max(L[2],S[2]+S[3])}}C.lerp(T,B,f,.5);T[3]=Math.max(f[0]-B[0],f[1]-B[1],f[2]-B[2])/2}}function t(O,V,M){if(!Q.length)for(var T=0;8>T;++T)Q.push({index:0,
distance:0});for(T=0;8>T;++T){const S=r[T];Q.data[T].index=T;Q.data[T].distance=q(O,V,S)}Q.sort((S,L)=>S.distance-L.distance);for(O=0;8>O;++O)M[O]=Q.data[O].index}function p(O,V){let M=Infinity,T=null;for(let S=0;8>S;++S){const L=q(O,V,e[S]);L<M&&(M=L,T=e[S])}return T}function q(O,V,M){return V*(O[0]*M[0]+O[1]*M[1]+O[2]*M[2])}function d(O){return!isNaN(O)&&-Infinity!==O&&Infinity!==O&&0<O}let a=function(){function O(M,T){this._objectToBoundingSphere=M;this._maximumObjectsPerNode=10;this._maximumDepth=
20;this._degenerateObjects=new Set;this._root=new c;this._objectCount=0;T&&(void 0!==T.maximumObjectsPerNode&&(this._maximumObjectsPerNode=T.maximumObjectsPerNode),void 0!==T.maximumDepth&&(this._maximumDepth=T.maximumDepth))}var V=O.prototype;V.destroy=function(){this._degenerateObjects.clear();c.clearPool();v[0]=null;D.prune();Q.prune()};V.add=function(M,T=M.length){this._objectCount+=T;this._grow(M,T);const S=c.acquire();for(let L=0;L<T;L++){const N=M[L];this._isDegenerate(N)?this._degenerateObjects.add(N):
(S.init(this._root),this._add(N,S))}c.release(S)};V.remove=function(M,T=null){this._objectCount-=M.length;const S=c.acquire();for(const L of M)M=l.isSome(T)?T:w.copy(this._objectToBoundingSphere(L),H),d(M[3])?(S.init(this._root),this._remove(L,M,S)):this._degenerateObjects.delete(L);c.release(S);this._shrink()};V.update=function(M,T){if(d(T[3])||!this._isDegenerate(M))v[0]=M,M=v,this.remove(M,T),this.add(M)};V.forEachAlongRay=function(M,T,S){const L=k.wrap(M,T);this._forEachNode(this._root,N=>{if(!this._intersectsNode(L,
N))return!1;N=N.node;N.terminals.forAll(U=>{this._intersectsObject(L,U)&&S(U)});null!==N.residents&&N.residents.forAll(U=>{this._intersectsObject(L,U)&&S(U)});return!0})};V.forEachAlongRayWithVerticalOffset=function(M,T,S,L){const N=k.wrap(M,T);this._forEachNode(this._root,U=>{if(!this._intersectsNodeWithOffset(N,U,L))return!1;U=U.node;U.terminals.forAll(fa=>{this._intersectsObjectWithOffset(N,fa,L)&&S(fa)});null!==U.residents&&U.residents.forAll(fa=>{this._intersectsObjectWithOffset(N,fa,L)&&S(fa)});
return!0})};V.forEach=function(M){this._forEachNode(this._root,T=>{T=T.node;T.terminals.forAll(M);null!==T.residents&&T.residents.forAll(M);return!0});this._degenerateObjects.forEach(M)};V.forEachDegenerateObject=function(M){this._degenerateObjects.forEach(M)};V.findClosest=function(M,T,S,L=()=>!0,N=Infinity){let U=Infinity,fa=Infinity,ka=null;const wa=p(M,T),ya=oa=>{--N;if(L(oa)){var G=this._objectToBoundingSphere(oa);if(g.intersectsSphere(S,G)){var I=q(M,T,w.getCenter(G)),Z=I-G[3];G=I+G[3];Z<U&&
(U=Z,fa=G,ka=oa)}}};this._forEachNodeDepthOrdered(this._root,oa=>{if(0>=N||!g.intersectsSphere(S,oa.bounds))return!1;C.scale(n,wa,oa.halfSize);C.add(n,n,oa.bounds);if(q(M,T,n)>fa)return!1;oa=oa.node;oa.terminals.forAll(G=>ya(G));null!==oa.residents&&oa.residents.forAll(G=>ya(G));return!0},M,T);return ka};V.forEachInDepthRange=function(M,T,S,L,N,U,fa){let ka=-Infinity,wa=Infinity;const ya={setRange:ca=>{1===S?(ka=Math.max(ka,ca.near),wa=Math.min(wa,ca.far)):(ka=Math.max(ka,-ca.far),wa=Math.min(wa,
-ca.near))}};ya.setRange(L);const oa=q(T,S,M),G=p(T,S),I=p(T,-1*S),Z=ca=>{if(fa(ca)){var da=this._objectToBoundingSphere(ca),ba=w.getCenter(da);ba=q(T,S,ba)-oa;var ha=ba+da[3];ba-da[3]>wa||ha<ka||!g.intersectsSphere(U,da)||N(ca,ya)}};this._forEachNodeDepthOrdered(this._root,ca=>{if(!g.intersectsSphere(U,ca.bounds))return!1;C.scale(n,G,ca.halfSize);C.add(n,n,ca.bounds);if(q(T,S,n)-oa>wa)return!1;C.scale(n,I,ca.halfSize);C.add(n,n,ca.bounds);if(q(T,S,n)-oa<ka)return!1;ca=ca.node;ca.terminals.forAll(da=>
Z(da));null!==ca.residents&&ca.residents.forAll(da=>Z(da));return!0},T,S)};V.forEachNode=function(M){this._forEachNode(this._root,T=>M(T.node,T.bounds,T.halfSize))};V._intersectsNode=function(M,T){x(T.bounds,2*-T.halfSize,B);x(T.bounds,2*T.halfSize,f);return u.rayBoxTest(M.origin,M.direction,B,f)};V._intersectsNodeWithOffset=function(M,T,S){x(T.bounds,2*-T.halfSize,B);x(T.bounds,2*T.halfSize,f);S.applyToMinMax(B,f);return u.rayBoxTest(M.origin,M.direction,B,f)};V._intersectsObject=function(M,T){T=
this._objectToBoundingSphere(T);return 0<T[3]?w.intersectsRay(T,M):!0};V._intersectsObjectWithOffset=function(M,T,S){T=this._objectToBoundingSphere(T);return 0<T[3]?w.intersectsRay(S.applyToBoundingSphere(T),M):!0};V._forEachNode=function(M,T){M=c.acquire().init(M);const S=[M];for(;0!==S.length;){M=S.pop();if(T(M)&&!M.isLeaf())for(let L=0;L<M.node.children.length;L++)M.node.children[L]&&S.push(c.acquire().init(M).advance(L));c.release(M)}};V._forEachNodeDepthOrdered=function(M,T,S,L=1){M=c.acquire().init(M);
const N=[M];for(t(S,L,F);0!==N.length;){M=N.pop();if(T(M)&&!M.isLeaf())for(S=7;0<=S;--S)L=F[S],M.node.children[L]&&N.push(c.acquire().init(M).advance(L));c.release(M)}};V._remove=function(M,T,S){D.clear();T=S.advanceTo(T,(L,N)=>{D.push(L.node);D.push(N)})?S.node.terminals:S.node.residents;T.removeUnordered(M);if(0===T.length)for(M=D.length-2;0<=M&&this._purge(D.data[M],D.data[M+1]);M-=2);};V._nodeIsEmpty=function(M){if(0!==M.terminals.length)return!1;if(null!==M.residents)return 0===M.residents.length;
for(let T=0;T<M.children.length;T++)if(M.children[T])return!1;return!0};V._purge=function(M,T){0<=T&&(M.children[T]=null);return this._nodeIsEmpty(M)?(null===M.residents&&(M.residents=new z({shrink:!0})),!0):!1};V._add=function(M,T){T.advanceTo(this._objectToBoundingSphere(M))?T.node.terminals.push(M):(T.node.residents.push(M),T.node.residents.length>this._maximumObjectsPerNode&&T.depth<this._maximumDepth&&this._split(T))};V._split=function(M){const T=M.node.residents;M.node.residents=null;for(let S=
0;S<T.length;S++){const L=c.acquire().init(M);this._add(T.getItemAt(S),L);c.release(L)}};V._grow=function(M,T){0!==T&&(y(M,T,S=>this._objectToBoundingSphere(S),P),d(P[3])&&!this._fitsInsideTree(P)&&(this._nodeIsEmpty(this._root.node)?(w.copy(P,this._root.bounds),this._root.halfSize=1.25*P[3]):(M=this._rootBoundsForRootAsSubNode(P),this._placingRootViolatesMaxDepth(M)?this._rebuildTree(P,M):this._growRootAsSubNode(M),c.release(M))))};V._rebuildTree=function(M,T){C.copy(R,T.bounds);R[3]=T.halfSize;
y([M,R],2,S=>S,K);M=c.acquire().init(this._root);this._root.initFrom(null,K,1.25*K[3]);this._forEachNode(M,S=>{this.add(S.node.terminals.data,S.node.terminals.length);null!==S.node.residents&&this.add(S.node.residents.data,S.node.residents.length);return!0});c.release(M)};V._placingRootViolatesMaxDepth=function(M){const T=Math.log(M.halfSize/this._root.halfSize)*Math.LOG2E;let S=0;this._forEachNode(this._root,L=>{S=Math.max(S,L.depth);return S+T<=this._maximumDepth});return S+T>this._maximumDepth};
V._rootBoundsForRootAsSubNode=function(M){var T=M[3];let S=-Infinity;const L=this._root.bounds,N=this._root.halfSize;for(var U=0;3>U;U++){var fa=Math.max(0,Math.ceil((L[U]-N-(M[U]-T))/(2*N)));const ka=Math.max(0,Math.ceil((M[U]+T-(L[U]+N))/(2*N)))+1;S=Math.max(S,2**Math.ceil(Math.log(fa+ka)*Math.LOG2E));J[U].min=fa;J[U].max=ka}for(M=0;3>M;M++)T=J[M].min,U=J[M].max,fa=(S-(T+U))/2,T+=Math.ceil(fa),U+=Math.floor(fa),E[M]=L[M]-N-T*N*2+(U+T)*N;E[3]=S*N*h;return c.acquire().initFrom(null,E,S*N,0)};V._growRootAsSubNode=
function(M){const T=this._root.node;C.copy(P,this._root.bounds);P[3]=this._root.halfSize;this._root.init(M);M.advanceTo(P,null,!0);M.node.children=T.children;M.node.residents=T.residents;M.node.terminals=T.terminals};V._shrink=function(){for(;;){const M=this._findShrinkIndex();if(-1===M)break;this._root.advance(M);this._root.depth=0}};V._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let M=null;const T=this._root.node.children;let S=0,L=0;for(;L<T.length&&
null==M;)S=L++,M=T[S];for(;L<T.length;)if(T[L++])return-1;return S};V._isDegenerate=function(M){M=this._objectToBoundingSphere(M)[3];return!d(M)};V._fitsInsideTree=function(M){const T=this._root.bounds,S=this._root.halfSize;return M[3]<=S&&M[0]>=T[0]-S&&M[0]<=T[0]+S&&M[1]>=T[1]-S&&M[1]<=T[1]+S&&M[2]>=T[2]-S&&M[2]<=T[2]+S};b._createClass(O,[{key:"bounds",get:function(){return this._root.bounds}},{key:"halfSize",get:function(){return this._root.halfSize}},{key:"root",get:function(){return this._root.node}},
{key:"maximumObjectsPerNode",get:function(){return this._maximumObjectsPerNode}},{key:"maximumDepth",get:function(){return this._maximumDepth}},{key:"objectCount",get:function(){return this._objectCount}}]);return O}(),c=function(){function O(){this.bounds=w.create();this.halfSize=0;this.initFrom(null,null,0,0)}var V=O.prototype;V.init=function(M){return this.initFrom(M.node,M.bounds,M.halfSize,M.depth)};V.initFrom=function(M,T,S,L=this.depth){this.node=l.isSome(M)?M:O.createEmptyNode();l.isSome(T)&&
w.copy(T,this.bounds);this.halfSize=S;this.depth=L;return this};V.advance=function(M){let T=this.node.children[M];T||(T=O.createEmptyNode(),this.node.children[M]=T);this.node=T;this.halfSize/=2;this.depth++;M=r[M];this.bounds[0]+=M[0]*this.halfSize;this.bounds[1]+=M[1]*this.halfSize;this.bounds[2]+=M[2]*this.halfSize;this.bounds[3]=this.halfSize*h;return this};V.advanceTo=function(M,T,S=!1){for(;;){if(this.isTerminalFor(M))return T&&T(this,-1),!0;if(this.isLeaf()){if(!S)return T&&T(this,-1),!1;this.node.residents=
null}const L=this._childIndex(M);T&&T(this,L);this.advance(L)}};V.isLeaf=function(){return null!=this.node.residents};V.isTerminalFor=function(M){return M[3]>this.halfSize/2};V._childIndex=function(M){const T=this.bounds;return(T[0]<M[0]?1:0)+(T[1]<M[1]?2:0)+(T[2]<M[2]?4:0)};O.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new z({shrink:!0}),residents:new z({shrink:!0})}};O.acquire=function(){return O._pool.acquire()};O.release=function(M){O._pool.release(M)};
O.clearPool=function(){O._pool.prune()};return O}();c._pool=new m(c);const r=[A.fromValues(-1,-1,-1),A.fromValues(1,-1,-1),A.fromValues(-1,1,-1),A.fromValues(1,1,-1),A.fromValues(-1,-1,1),A.fromValues(1,-1,1),A.fromValues(-1,1,1),A.fromValues(1,1,1)],e=[A.fromValues(-1,-1,-1),A.fromValues(-1,-1,1),A.fromValues(-1,1,-1),A.fromValues(-1,1,1),A.fromValues(1,-1,-1),A.fromValues(1,-1,1),A.fromValues(1,1,-1),A.fromValues(1,1,1)],h=Math.sqrt(3),v=[null],E=w.create(),n=A.create(),B=A.create(),f=A.create(),
D=new z,H=w.create(),P=w.create(),R=w.create(),K=w.create(),J=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],Q=new z,F=[0,0,0,0,0,0,0,0];return a})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define("../../../../chunks/vec3 ../../../../chunks/vec3f32 ../../../../chunks/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/ray ./BufferVectorMath ./Geometry ./geometryDataUtils ./Util".split(" "),function(b,l,m,z,C,A,g,k,w){const u=A.Vec3Compact;var x;(function(d){const a=
[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],c=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],r=[0,0,1,0,1,1,0,1],e=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),h=new Uint16Array(36);for(var v=0;6>v;v++)for(let n=0;6>n;n++)h[6*v+n]=v;const E=new Uint16Array(36);for(v=0;6>v;v++)E[6*v]=0,E[6*v+1]=1,E[6*v+2]=2,E[6*v+3]=2,E[6*v+4]=3,E[6*v+5]=0;d.createGeometry=function(n){Array.isArray(n)||(n=[n,n,n]);const B=
Array(24);for(let f=0;8>f;f++)B[3*f]=a[f][0]*n[0],B[3*f+1]=a[f][1]*n[1],B[3*f+2]=a[f][2]*n[2];return new g.Geometry([["position",{size:3,data:B,exclusive:!0}],["normal",{size:3,data:c}],["uv0",{size:2,data:r}]],[["position",e],["normal",h],["uv0",E]])}})(x||(x={}));var y;(function(d){const a=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],c=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],r=new Uint16Array([5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),e=new Uint16Array([0,
0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);d.createGeometry=function(h){Array.isArray(h)||(h=[h,h,h]);const v=Array(18);for(let E=0;6>E;E++)v[3*E]=a[E][0]*h[0],v[3*E+1]=a[E][1]*h[1],v[3*E+2]=a[E][2]*h[2];return new g.Geometry([["position",{size:3,data:v,exclusive:!0}],["normal",{size:3,data:c}]],[["position",r],["normal",e]])}})(y||(y={}));var t;(function(d){const a=l.fromValues(-.5,0,-.5),c=l.fromValues(.5,0,-.5),r=l.fromValues(0,0,.5),e=l.fromValues(0,.5,0),h=l.create(),v=l.create(),E=l.create(),
n=l.create(),B=l.create();b.subtract(h,a,e);b.subtract(v,a,c);b.cross(E,h,v);b.normalize(E,E);b.subtract(h,c,e);b.subtract(v,c,r);b.cross(n,h,v);b.normalize(n,n);b.subtract(h,r,e);b.subtract(v,r,a);b.cross(B,h,v);b.normalize(B,B);const f=[a,c,r,e],D=[0,-1,0,E[0],E[1],E[2],n[0],n[1],n[2],B[0],B[1],B[2]],H=[0,1,2,3,1,0,3,2,1,3,0,2],P=[0,0,0,1,1,1,2,2,2,3,3,3];d.createGeometry=function(R){Array.isArray(R)||(R=[R,R,R]);const K=Array(12);for(let J=0;4>J;J++)K[3*J]=f[J][0]*R[0],K[3*J+1]=f[J][1]*R[1],K[3*
J+2]=f[J][2]*R[2];return new g.Geometry([["position",{size:3,data:K,exclusive:!0}],["normal",{size:3,data:D}]],[["position",new Uint16Array(H)],["normal",new Uint16Array(P)]])}})(t||(t={}));var p;(function(d){function a(e,h,v,E,n){if(Math.abs(b.dot(h,e))>n)return!1;b.cross(v,e,h);b.normalize(v,v);b.cross(E,v,e);b.normalize(E,E);return!0}function c(e,h,v,E,n,B,f){return a(e,h,n,B,f)||a(e,v,n,B,f)||a(e,E,n,B,f)}d.createBoxGeometry=x.createGeometry;d.createDiamondGeometry=y.createGeometry;d.createTetrahedronGeometry=
t.createGeometry;d.createSphereGeometry=function(e,h,v,E={uv:!0}){var n=-Math.PI,B=2*Math.PI,f=-Math.PI/2,D=Math.PI;h=Math.max(3,Math.floor(h));const H=Math.max(2,Math.floor(v));var P=(h+1)*(H+1);v=new Float32Array(3*P);const R=new Float32Array(3*P);P=new Float32Array(2*P);const K=[];let J=0;for(var Q=0;Q<=H;Q++){var F=[];const V=Q/H,M=f+V*D,T=Math.cos(M);for(let S=0;S<=h;S++){const L=S/h;var O=n+L*B;const N=Math.cos(O)*T,U=Math.sin(M);O=-Math.sin(O)*T;v[3*J]=N*e;v[3*J+1]=U*e;v[3*J+2]=O*e;R[3*J]=
N;R[3*J+1]=U;R[3*J+2]=O;P[2*J]=L;P[2*J+1]=V;F.push(J);++J}K.push(F)}e=new Uint32Array(2*h*(H-1)*3);J=0;for(n=0;n<H;n++)for(B=0;B<h;B++)f=K[n][B],D=K[n][B+1],Q=K[n+1][B+1],F=K[n+1][B],0===n?(e[J++]=f,e[J++]=Q,e[J++]=F):n===H-1?(e[J++]=f,e[J++]=D,e[J++]=Q):(e[J++]=f,e[J++]=D,e[J++]=Q,e[J++]=Q,e[J++]=F,e[J++]=f);h=[["position",e],["normal",e]];v=[["position",{size:3,data:v,exclusive:!0}],["normal",{size:3,data:R,exclusive:!0}]];E.uv&&(v.push(["uv0",{size:2,data:P,exclusive:!0}]),h.push(["uv0",e]));E.offset&&
(h[0][0]="offset",v[0][0]="offset",h.push(["position",new Uint32Array(e.length)]),v.push(["position",{size:3,data:Float64Array.from(E.offset),exclusive:!0}]));return new g.Geometry(v,h)};d.createPolySphereGeometry=function(e,h,v){function E(D,H){D>H&&([D,H]=[H,D]);const P=D.toString()+"."+H.toString();if(f[P])return f[P];let R=n.length;n.length+=3;u.add(n,3*D,n,3*H,n,R);u.scale(n,R,e/u.length(n,R));R/=3;return f[P]=R}let n;v?(n=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],v=new Uint32Array([0,1,2,0,2,
3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1])):(v=e*(1+Math.sqrt(5))/2,n=[-e,v,0,e,v,0,-e,-v,0,e,-v,0,0,-e,v,0,e,v,0,-e,-v,0,e,-v,v,0,-e,v,0,e,-v,0,-e,-v,0,e],v=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]));for(var B=0;B<n.length;B+=3)u.scale(n,B,e/u.length(n,B));let f={};for(B=0;B<h;B++){const D=v.length,H=new Uint32Array(4*D);for(let P=0;P<D;P+=3){const R=v[P],K=v[P+1],J=v[P+2],Q=E(R,K),F=E(K,J),O=
E(J,R),V=4*P;H[V]=R;H[V+1]=Q;H[V+2]=O;H[V+3]=K;H[V+4]=F;H[V+5]=Q;H[V+6]=J;H[V+7]=O;H[V+8]=F;H[V+9]=Q;H[V+10]=F;H[V+11]=O}v=H;f={}}h=new Float32Array(n);for(B=0;B<h.length;B+=3)u.normalize(h,B);v=[["position",v],["normal",v]];h=[["position",{size:3,data:new Float32Array(n),exclusive:!0}],["normal",{size:3,data:h,exclusive:!0}]];return new g.Geometry(h,v)};d.createPointGeometry=function(e,h,v,E,n,B,f){h=h?[h[0],h[1],h[2]]:[0,0,0];e=e?[e[0],e[1],e[2]]:[0,0,1];B=B||[0,0];v=[["position",{size:3,data:h,
exclusive:!0}],["normal",{size:3,data:e,exclusive:!0}],["uv0",{size:B.length,data:B}],["color",{size:4,data:v?[255*v[0],255*v[1],255*v[2],3<v.length?255*v[3]:255]:[255,255,255,255],exclusive:!0}],["size",{size:2,data:null!=E&&2===E.length?E:[1,1]}]];null!=n&&(n=new Float32Array([n[0],n[1],n[2],n[3]]),v.push(["auxpos1",{size:4,data:n}]));null!=f&&(f=new Float32Array([f[0],f[1],f[2],f[3]]),v.push(["auxpos2",{size:4,data:f}]));return new g.Geometry(v,null,1)};d.updatePointGeometry=function(e,h,v,E,n,
B,f,D){if(null!=e){const {data:H}=D.getMutableAttribute("normal");H[0]=e[0];H[1]=e[1];H[2]=e[2]}null!=h&&({data:e}=D.getMutableAttribute("position"),e[0]=h[0],e[1]=h[1],e[2]=h[2]);null!=v&&({data:h}=D.getMutableAttribute("color"),h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3]);null!=E&&({data:v}=D.getMutableAttribute("size"),v[0]=E[0],v[1]=E[1]);null!=n&&({data:E}=D.getMutableAttribute("auxpos1"),E[0]=n[0],E[1]=n[1],E[2]=n[2],E[3]=n[3]);null!=B&&({data:n}=D.getMutableAttribute("uv0"),n[0]=B[0],n[1]=B[1]);
null!=f&&({data:B}=D.getMutableAttribute("auxpos2"),B[0]=f[0],B[1]=f[1],B[2]=f[2],B[3]=f[3])};d.createPointArrayGeometry=function(e,h){const v=new Float32Array(3*e.length),E=new Float32Array(h?3*e.length:3),n=new Uint32Array(e.length),B=new Uint32Array(e.length);for(let f=0;f<e.length;f++)v[3*f]=e[f][0],v[3*f+1]=e[f][1],v[3*f+2]=e[f][2],h&&(E[3*f]=h[f][0],E[3*f+1]=h[f][1],E[3*f+2]=h[f][2]),n[f]=f,B[f]=0;h||(E[0]=0,E[1]=1,E[2]=0);return new g.Geometry([["position",{size:3,data:v,exclusive:!0}],["normal",
{size:3,data:E,exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",n],["normal",h?n:B],["uv0",B]],1)};d.createTriangleGeometry=function(){const e=new Uint16Array([0,1,2]),h=new Uint16Array([0,0,0]),v=new Uint16Array([0,0,0]);return new g.Geometry([["position",{size:3,data:[0,0,0,0,0,100,100,0,0],exclusive:!0}],["normal",{size:3,data:[0,1,0],exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",e],["normal",h],["uv0",v]])};const r=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,
0]];d.createSquareGeometry=function(e=r){const h=Array(12);for(var v=0;4>v;v++)for(let E=0;3>E;E++)h[3*v+E]=e[v][E];e=new Uint32Array([0,1,2,2,3,0]);v=new Uint32Array([0,0,0,0,0,0]);return new g.Geometry([["position",{size:3,data:h,exclusive:!0}],["normal",{size:3,data:[0,0,1],exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1],exclusive:!0}],["color",{size:4,data:[255,255,255,255],exclusive:!0}]],[["position",e],["normal",v],["uv0",e],["color",v]])};d.createConeGeometry=function(e,h,v,E,n=!0,B=
!0){var f=0,D=l.fromValues(0,f,0),H=l.fromValues(0,f+e,0),P=l.fromValues(0,-1,0),R=l.fromValues(0,1,0);E&&(f=e,H=l.fromValues(0,0,0),D=l.fromValues(0,f,0),P=l.fromValues(0,1,0),R=l.fromValues(0,-1,0));D=[H,D];P=[P,R];R=v+2;H=Math.sqrt(e*e+h*h);if(E)for(E=v-1;0<=E;E--){var K=2*Math.PI/v*E,J=l.fromValues(Math.cos(K)*h,f,Math.sin(K)*h);D.push(J);K=l.fromValues(e*Math.cos(K)/H,-h/H,e*Math.sin(K)/H);P.push(K)}else for(E=0;E<v;E++)K=2*Math.PI/v*E,J=l.fromValues(Math.cos(K)*h,f,Math.sin(K)*h),D.push(J),
K=l.fromValues(e*Math.cos(K)/H,h/H,e*Math.sin(K)/H),P.push(K);e=new Uint32Array(6*(v+2));v=new Uint32Array(6*(v+2));f=h=0;if(n){for(n=3;n<D.length;n++)e[h++]=1,e[h++]=n-1,e[h++]=n,v[f++]=0,v[f++]=0,v[f++]=0;e[h++]=D.length-1;e[h++]=2;e[h++]=1;v[f++]=0;v[f++]=0;v[f++]=0}if(B){for(B=3;B<D.length;B++)e[h++]=B,e[h++]=B-1,e[h++]=0,v[f++]=B,v[f++]=B-1,v[f++]=1;e[h++]=0;e[h++]=2;e[h++]=D.length-1;v[f++]=1;v[f++]=2;v[f++]=P.length-1}B=new Float32Array(3*R);for(n=0;n<R;n++)B[3*n]=D[n][0],B[3*n+1]=D[n][1],
B[3*n+2]=D[n][2];D=new Float32Array(3*R);for(n=0;n<R;n++)D[3*n]=P[n][0],D[3*n+1]=P[n][1],D[3*n+2]=P[n][2];return new g.Geometry([["position",{size:3,data:B,exclusive:!0}],["normal",{size:3,data:D,exclusive:!0}]],[["position",e],["normal",v]])};d.createCylinderGeometry=function(e,h,v,E,n,B){E=E?l.clone(E):l.fromValues(1,0,0);n=n?l.clone(n):l.fromValues(0,0,0);B=null==B?!0:B;var f=l.create();b.normalize(f,E);const D=l.create();b.scale(D,f,Math.abs(e));const H=l.create();b.scale(H,D,-.5);b.add(H,H,n);
const P=l.fromValues(0,1,0);.2>Math.abs(1-b.dot(f,P))&&b.set(P,0,0,1);const R=l.create();b.cross(R,f,P);b.normalize(R,R);b.cross(P,R,f);e=2*v+(B?2:0);n=v+(B?2:0);E=new Float32Array(3*e);const K=new Float32Array(3*n),J=new Float32Array(2*e),Q=new Uint32Array(3*v*(B?4:2)),F=new Uint32Array(3*v*(B?4:2));B&&(E[3*(e-2)]=H[0],E[3*(e-2)+1]=H[1],E[3*(e-2)+2]=H[2],J[2*(e-2)]=0,J[2*(e-2)+1]=0,E[3*(e-1)]=E[3*(e-2)]+D[0],E[3*(e-1)+1]=E[3*(e-2)+1]+D[1],E[3*(e-1)+2]=E[3*(e-2)+2]+D[2],J[2*(e-1)]=1,J[2*(e-1)+1]=
1,K[3*(n-2)]=-f[0],K[3*(n-2)+1]=-f[1],K[3*(n-2)+2]=-f[2],K[3*(n-1)]=f[0],K[3*(n-1)+1]=f[1],K[3*(n-1)+2]=f[2]);f=function(S,L,N){Q[S]=L;F[S]=N};let O=0;const V=l.create(),M=l.create();for(let S=0;S<v;S++){var T=2*Math.PI/v*S;b.scale(V,P,Math.sin(T));b.scale(M,R,Math.cos(T));b.add(V,V,M);K[3*S]=V[0];K[3*S+1]=V[1];K[3*S+2]=V[2];b.scale(V,V,h);b.add(V,V,H);E[3*S]=V[0];E[3*S+1]=V[1];E[3*S+2]=V[2];J[2*S]=S/v;J[2*S+1]=0;E[3*(S+v)]=E[3*S]+D[0];E[3*(S+v)+1]=E[3*S+1]+D[1];E[3*(S+v)+2]=E[3*S+2]+D[2];J[2*(S+
v)]=S/v;J[2*S+1]=1;T=(S+1)%v;f(O++,S,S);f(O++,S+v,S);f(O++,T,T);f(O++,T,T);f(O++,S+v,S);f(O++,T+v,T)}if(B){for(h=0;h<v;h++)B=(h+1)%v,f(O++,e-2,n-2),f(O++,h,n-2),f(O++,B,n-2);for(h=0;h<v;h++)B=(h+1)%v,f(O++,h+v,n-1),f(O++,e-1,n-1),f(O++,B+v,n-1)}return new g.Geometry([["position",{size:3,data:E,exclusive:!0}],["normal",{size:3,data:K,exclusive:!0}],["uv0",{size:2,data:J,exclusive:!0}]],[["position",Q],["normal",F],["uv0",Q]])};d.createTubeGeometry=function(e,h,v,E,n){v=v||10;E=null!=E?E:!0;w.assert(1<
e.length);const B=[],f=[];for(let D=0;D<v;D++){B.push([0,-D-1,-((D+1)%v)-1]);const H=D/v*2*Math.PI;f.push([Math.cos(H)*h,Math.sin(H)*h])}return d.createPathExtrusionGeometry(f,e,[[0,0,0]],B,E,n)};d.createPathExtrusionGeometry=function(e,h,v,E,n,B=l.fromValues(0,0,0)){var f=e.length;const D=new Float32Array(h.length*f*3+(6*v.length||0)),H=new Float32Array(h.length*f*3+(v?6:0));var P=(h.length-1)*f*6+6*E.length;const R=new Uint32Array(P);P=new Uint32Array(P);let K=0;var J=0;let Q=0,F=0;const O=l.create(),
V=l.create(),M=l.create(),T=l.create(),S=l.create(),L=l.create(),N=l.create(),U=m.create(),fa=l.create(),ka=l.create(),wa=l.create(),ya=l.create(),oa=l.create(),G=z.create();b.set(fa,0,1,0);b.subtract(V,h[1],h[0]);b.normalize(V,V);n?(b.add(U,h[0],B),b.normalize(M,U)):b.set(M,0,0,1);c(V,M,fa,fa,S,M,.99619469809);b.copy(T,M);b.copy(ya,S);for(var I=0;I<v.length;I++)b.scale(L,S,v[I][0]),b.scale(U,M,v[I][2]),b.add(L,L,U),b.add(L,L,h[0]),D[K++]=L[0],D[K++]=L[1],D[K++]=L[2];H[J++]=-V[0];H[J++]=-V[1];H[J++]=
-V[2];for(I=0;I<E.length;I++)R[Q++]=0<E[I][0]?E[I][0]:-E[I][0]-1+v.length,R[Q++]=0<E[I][1]?E[I][1]:-E[I][1]-1+v.length,R[Q++]=0<E[I][2]?E[I][2]:-E[I][2]-1+v.length,P[F++]=0,P[F++]=0,P[F++]=0;I=v.length;const Z=v.length-1;for(let da=0;da<h.length;da++){let ba=!1;0<da&&(b.copy(O,V),da<h.length-1?(b.subtract(V,h[da+1],h[da]),b.normalize(V,V)):ba=!0,b.add(ka,O,V),b.normalize(ka,ka),b.add(wa,h[da-1],T),z.fromPositionAndNormal(h[da],ka,G),z.intersectRay(G,C.wrap(wa,O),U)?(b.subtract(U,U,h[da]),b.normalize(M,
U),b.cross(S,ka,M),b.normalize(S,S)):c(ka,T,ya,fa,S,M,.99619469809),b.copy(T,M),b.copy(ya,S));n&&(b.add(U,h[da],B),b.normalize(oa,U));for(let ha=0;ha<f;ha++)if(b.scale(L,S,e[ha][0]),b.scale(U,M,e[ha][1]),b.add(L,L,U),b.normalize(N,L),H[J++]=N[0],H[J++]=N[1],H[J++]=N[2],b.add(L,L,h[da]),D[K++]=L[0],D[K++]=L[1],D[K++]=L[2],!ba){var ca=(ha+1)%f;R[Q++]=I+ha;R[Q++]=I+f+ha;R[Q++]=I+ca;R[Q++]=I+ca;R[Q++]=I+f+ha;R[Q++]=I+f+ca;for(ca=0;6>ca;ca++)P[F++]=R[Q-6+ca]-Z}I+=f}e=h[h.length-1];for(h=0;h<v.length;h++)b.scale(L,
S,v[h][0]),b.scale(U,M,v[h][1]),b.add(L,L,U),b.add(L,L,e),D[K++]=L[0],D[K++]=L[1],D[K++]=L[2];v=J/3;H[J++]=V[0];H[J++]=V[1];H[J++]=V[2];f=I-f;for(J=0;J<E.length;J++)R[Q++]=0<=E[J][0]?I+E[J][0]:-E[J][0]-1+f,R[Q++]=0<=E[J][2]?I+E[J][2]:-E[J][2]-1+f,R[Q++]=0<=E[J][1]?I+E[J][1]:-E[J][1]-1+f,P[F++]=v,P[F++]=v,P[F++]=v;return new g.Geometry([["position",{size:3,data:D,exclusive:!0}],["normal",{size:3,data:H,exclusive:!0}]],[["position",R],["normal",P]])};d.createPolylineGeometry=function(e,h,v){w.assert(1<
e.length,"createPolylineGeometry(): polyline needs at least 2 points");w.assert(3===e[0].length,"createPolylineGeometry(): malformed vertex");w.assert(null==h||h.length===e.length,"createPolylineGeometry: need same number of points and normals");w.assert(null==h||3===h[0].length,"createPolylineGeometry(): malformed normal");var E=new Float64Array(3*e.length);const n=new Uint32Array(2*(e.length-1));var B=0,f=0;for(var D=0;D<e.length;D++){for(var H=0;3>H;H++)E[B++]=e[D][H];0<D&&(n[f++]=D-1,n[f++]=D)}B=
[];f=[];B.push(["position",n]);f.push(["position",{size:3,data:E,exclusive:!0}]);if(h){E=new Float32Array(3*h.length);D=0;for(H=0;H<e.length;H++)for(let P=0;3>P;P++)E[D++]=h[H][P];B.push(["normal",n]);f.push(["normal",{size:3,data:E,exclusive:!0}])}v&&(f.push(["color",{size:4,data:v}]),B.push(["color",k.generateDefaultIndexArray(v.length/4)]));return new g.Geometry(f,B,2)};d.createExtrudedTriangle=function(e,h,v,E,n=0){const B=Array(18);e=[[-h,n,E/2],[v,n,E/2],[0,e+n,E/2],[-h,n,-E/2],[v,n,-E/2],[0,
e+n,-E/2]];h=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]);for(v=0;6>v;v++)B[3*v]=e[v][0],B[3*v+1]=e[v][1],B[3*v+2]=e[v][2];return new g.Geometry([["position",{size:3,data:B,exclusive:!0}]],[["position",h]])};d.transformInPlace=function(e,h){e=e.getMutableAttribute("position").data;for(let v=0;v<e.length;v+=3)b.set(q,e[v],e[v+1],e[v+2]),b.transformMat4(q,q,h),e[v]=q[0],e[v+1]=q[1],e[v+2]=q[2]};d.cgToGIS=function(e,h=e){var v=e.vertexAttributes;e=v.get("position").data;if(v=v.get("normal").data){var E=
h.getMutableAttribute("normal").data;for(var n=0;n<v.length;n+=3){const B=v[n+1];E[n+1]=-v[n+2];E[n+2]=B}}if(e)for(v=h.getMutableAttribute("position").data,E=0;E<e.length;E+=3)n=e[E+1],v[E+1]=-e[E+2],v[E+2]=n;return h};d.makeOrthoBasisDirUp=a;d.makeOrthoBasisDirUpFallback=c})(p||(p={}));const q=l.create();return p})},"esri/chunks/vec3f32":function(){define(["exports"],function(b){function l(){return new Float32Array(3)}function m(a){const c=new Float32Array(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c}
function z(a,c,r){const e=new Float32Array(3);e[0]=a;e[1]=c;e[2]=r;return e}function C(a,c){return new Float32Array(a,c,3)}function A(){return l()}function g(){return z(1,1,1)}function k(){return z(1,0,0)}function w(){return z(0,1,0)}function u(){return z(0,0,1)}const x=l(),y=g(),t=k(),p=w(),q=u();var d=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C,zeros:A,ones:g,unitX:k,unitY:w,unitZ:u,ZEROS:x,ONES:y,UNIT_X:t,UNIT_Y:p,UNIT_Z:q});b.ONES=y;b.UNIT_X=t;b.UNIT_Y=p;b.UNIT_Z=
q;b.ZEROS=x;b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.ones=g;b.unitX=k;b.unitY=w;b.unitZ=u;b.vec3f32=d;b.zeros=A})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["exports"],function(b){b.Vec3Compact=void 0;(function(l){l.length=function(m,z){const C=m[z],A=m[z+1];m=m[z+2];return Math.sqrt(C*C+A*A+m*m)};l.normalize=function(m,z){var C=m[z];const A=m[z+1],g=m[z+2];C=1/Math.sqrt(C*C+A*A+g*g);m[z]*=C;m[z+1]*=C;m[z+2]*=C};l.scale=function(m,z,C){m[z]*=C;m[z+1]*=C;m[z+
2]*=C};l.add=function(m,z,C,A,g,k=z){g=g||m;g[k]=m[z]+C[A];g[k+1]=m[z+1]+C[A+1];g[k+2]=m[z+2]+C[A+2]};l.subtract=function(m,z,C,A,g,k=z){g=g||m;g[k]=m[z]-C[A];g[k+1]=m[z+1]-C[A+1];g[k+2]=m[z+2]-C[A+2]}})(b.Vec3Compact||(b.Vec3Compact={}));Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./BoundingInfo ./ContentObject ./geometryDataUtils ./Util".split(" "),function(b,
l,m,z,C,A,g){function k(w){if(w.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return w;for(const u of w)if(65536<=u)return w;return new Uint16Array(w)}C=function(w){function u(y,t=[],p=0,q=-1){var d=w.call(this)||this;d._primitiveType=p;d.edgeIndicesLength=q;d.type=2;d._vertexAttributes=new Map;d._indices=new Map;d._boundingInfo=null;for(const [a,c]of y)c&&d._vertexAttributes.set(a,{...c});if(null==t||0===t.length){y=d._vertexAttributes.values().next().value;y=null==y?0:y.data.length/y.size;t=
A.generateDefaultIndexArray(y);d.edgeIndicesLength=0>d.edgeIndicesLength?y:d.edgeIndicesLength;for(const a of d._vertexAttributes.keys())d._indices.set(a,t)}else for(const [a,c]of t)c&&(d._indices.set(a,k(c)),"position"===a&&(d.edgeIndicesLength=0>d.edgeIndicesLength?d._indices.get(a).length:d.edgeIndicesLength));return d}l._inheritsLoose(u,w);var x=u.prototype;x.getMutableAttribute=function(y){(y=this._vertexAttributes.get(y))&&!y.exclusive&&(y.data=Array.from(y.data),y.exclusive=!0);return y};x.computeAttachmentOrigin=
function(y){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(y):this.computeAttachmentOriginPoints(y)};x.computeAttachmentOriginTriangles=function(y){const t=this.indices.get("position"),p=this.vertexAttributes.get("position");return A.computeAttachmentOriginTriangles(p,t,y)};x.computeAttachmentOriginPoints=function(y){const t=this.indices.get("position"),p=this.vertexAttributes.get("position");return A.computeAttachmentOriginPoints(p,t,y)};x.invalidateBoundingInfo=function(){this._boundingInfo=
null};x._calculateBoundingInfo=function(){const y=this.indices.get("position");if(0===y.length)return null;const t=0===this.primitiveType?3:1;g.assert(0===y.length%t,"Indexing error: "+y.length+" not divisible by "+t);const p=A.generateDefaultIndexArray(y.length/t),q=this.vertexAttributes.get("position");return new z.BoundingInfo(p,t,y,q)};l._createClass(u,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",
get:function(){const y=this._indices.values().next().value;return y?y.length:0}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){m.isNone(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo}}]);return u}(C.ContentObject);b.Geometry=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["exports",
"../../../../core/PooledArray","../../../../chunks/vec3","../../../../chunks/vec3f64","./Util"],function(b,l,m,z,C){let A=function(){function k(u,x,y,t){this.primitiveIndices=u;this._numIndexPerPrimitive=x;this.indices=y;this.position=t;this.center=z.create();C.assert(1<=u.length);C.assert(0===y.length%this._numIndexPerPrimitive);C.assert(y.length>=u.length*this._numIndexPerPrimitive);C.assert(3===t.size||4===t.size);const {data:p,size:q}=t;t=u.length;x=q*y[this._numIndexPerPrimitive*u[0]];g.clear();
g.push(x);this.bbMin=z.fromValues(p[x],p[x+1],p[x+2]);this.bbMax=z.clone(this.bbMin);for(var d=0;d<t;++d){var a=this._numIndexPerPrimitive*u[d];for(var c=0;c<this._numIndexPerPrimitive;++c){x=q*y[a+c];g.push(x);let r=p[x];this.bbMin[0]=Math.min(r,this.bbMin[0]);this.bbMax[0]=Math.max(r,this.bbMax[0]);r=p[x+1];this.bbMin[1]=Math.min(r,this.bbMin[1]);this.bbMax[1]=Math.max(r,this.bbMax[1]);r=p[x+2];this.bbMin[2]=Math.min(r,this.bbMin[2]);this.bbMax[2]=Math.max(r,this.bbMax[2])}}m.lerp(this.center,this.bbMin,
this.bbMax,.5);this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);u=this.radius*this.radius;for(y=0;y<g.length;++y)x=g.getItemAt(y),t=p[x]-this.center[0],d=p[x+1]-this.center[1],x=p[x+2]-this.center[2],a=t*t+d*d+x*x,a<=u||(a=Math.sqrt(a),c=.5*(a-this.radius),this.radius+=c,u=this.radius*this.radius,a=c/a,this.center[0]+=t*a,this.center[1]+=d*a,this.center[2]+=x*a);g.clear()}var w=k.prototype;w.getCenter=function(){return this.center};
w.getBSRadius=function(){return this.radius};w.getBBMin=function(){return this.bbMin};w.getBBMax=function(){return this.bbMax};w.getChildren=function(){if(this._children)return this._children;if(1<m.squaredDistance(this.bbMin,this.bbMax)){var u=m.lerp(z.create(),this.bbMin,this.bbMax,.5),x=this.primitiveIndices.length;const q=new Uint8Array(x),d=Array(8);for(var y=0;8>y;++y)d[y]=0;const {data:a,size:c}=this.position;for(y=0;y<x;++y){var t=0;const r=this._numIndexPerPrimitive*this.primitiveIndices[y];
var p=c*this.indices[r];let e=a[p],h=a[p+1],v=a[p+2];for(let E=1;E<this._numIndexPerPrimitive;++E){p=c*this.indices[r+E];const n=a[p],B=a[p+1];p=a[p+2];n<e&&(e=n);B<h&&(h=B);p<v&&(v=p)}e<u[0]&&(t|=1);h<u[1]&&(t|=2);v<u[2]&&(t|=4);q[y]=t;++d[t]}u=0;for(y=0;8>y;++y)0<d[y]&&++u;if(2>u)return;u=Array(8);for(y=0;8>y;++y)u[y]=0<d[y]?new Uint32Array(d[y]):void 0;for(y=0;8>y;++y)d[y]=0;for(y=0;y<x;++y)t=q[y],u[t][d[t]++]=this.primitiveIndices[y];this._children=Array(8);for(x=0;8>x;++x)void 0!==u[x]&&(this._children[x]=
new k(u[x],this._numIndexPerPrimitive,this.indices,this.position))}return this._children};k.prune=function(){g.prune()};return k}();const g=new l({deallocator:null});b.BoundingInfo=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["exports","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/triangle"],function(b,l,m,z){let C=(()=>{const y=new Uint32Array(131072);for(let t=0;t<y.length;++t)y[t]=
t;return y})();const A=new Uint16Array([0]),g=(()=>{const y=new Uint16Array(65536);for(let t=0;t<y.length;++t)y[t]=t;return y})(),k=m.create(),w=m.create(),u=m.create(),x=m.create();b.computeAttachmentOriginLines=function(y,t,p,q){if(!y)return!1;const {size:d,data:a}=y;l.set(q,0,0,0);l.set(x,0,0,0);let c=y=0;const r=t?t.length-1:a.length/d-1;p=r+(p?2:0);for(let v=0;v<p;v+=2){var e=v<r?v:r,h=v<r?v+1:0;e=(t?t[e]:e)*d;h=(t?t[h]:h)*d;k[0]=a[e+0];k[1]=a[e+1];k[2]=a[e+2];w[0]=a[h+0];w[1]=a[h+1];w[2]=a[h+
2];l.scale(k,l.add(k,k,w),.5);h=l.dist(k,w);0<h?(l.add(q,q,l.scale(k,k,h)),y+=h):(l.add(x,x,k),c++)}return 0!==y?(l.scale(q,q,1/y),!0):0!==c?(l.scale(q,x,1/c),!0):!1};b.computeAttachmentOriginPoints=function(y,t,p){if(!y||!t)return!1;const {size:q,data:d}=y;l.set(p,0,0,0);y=-1;let a=0;for(let c=0;c<t.length;c++){const r=t[c]*q;y!==r&&(p[0]+=d[r+0],p[1]+=d[r+1],p[2]+=d[r+2],a++);y=r}1<a&&l.scale(p,p,1/a);return 0<a};b.computeAttachmentOriginTriangles=function(y,t,p){if(!y)return!1;const {size:q,data:d}=
y;l.set(p,0,0,0);l.set(x,0,0,0);let a=y=0;for(let r=0;r<t.length-2;r+=3){var c=t[r+0]*q;const e=t[r+1]*q,h=t[r+2]*q;l.set(k,d[c+0],d[c+1],d[c+2]);l.set(w,d[e+0],d[e+1],d[e+2]);l.set(u,d[h+0],d[h+1],d[h+2]);(c=z.areaPoints3d(k,w,u))?(l.add(k,k,w),l.add(k,k,u),l.scale(k,k,1/3*c),l.add(p,p,k),y+=c):(l.add(x,x,k),l.add(x,x,w),l.add(x,x,u),a+=3)}return 0===a&&0===y?!1:0!==y?(l.scale(p,p,1/y),!0):0!==a?(l.scale(p,x,1/a),!0):!1};b.generateDefaultIndexArray=function(y){if(1===y)return A;if(y<g.length)return new Uint16Array(g.buffer,
0,y);if(y>C.length){C=new Uint32Array(Math.max(2*C.length,y));for(let t=0;t<C.length;t++)C[t]=t}return new Uint32Array(C.buffer,0,y)};b.generateIndexArray=function(y){if(1===y)return new Uint16Array(A);if(y<g.length)return new Uint16Array(g.slice(0,y));if(y>C.length){y=new Uint32Array(y);for(let t=0;t<y.length;t++)y[t]=t;return y}return new Uint32Array(C.slice(0,y))};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/geometry/support/triangle":function(){define("exports ../../core/ObjectStack ../../chunks/vec2 ../../chunks/vec3 ../../chunks/vec3f64 ./lineSegment ./vectorStacks".split(" "),
function(b,l,m,z,C,A,g){function k(q){return q?{p0:C.clone(q.p0),p1:C.clone(q.p1),p2:C.clone(q.p2)}:{p0:C.create(),p1:C.create(),p2:C.create()}}function w(q,d,a,c=k()){z.copy(c.p0,q);z.copy(c.p1,d);z.copy(c.p2,a);return c}function u(q,d,a){var c=m.distance(q,d);d=m.distance(d,a);q=m.distance(a,q);a=(c+d+q)/2;c=a*(a-c)*(a-d)*(a-q);return 0>=c?0:Math.sqrt(c)}const x=new l.ObjectStack(A.create),y=new l.ObjectStack(()=>({p0:null,p1:null,p2:null})),t=C.create(),p=C.create();b.area2d=function(q){return u(q.p0,
q.p1,q.p2)};b.areaPoints2d=u;b.areaPoints3d=function(q,d,a){z.subtract(t,d,q);z.subtract(p,a,q);return z.length(z.cross(t,t,p))/2};b.copy=function(q,d=k()){return w(q.p0,q.p1,q.p2,d)};b.create=k;b.distance2=function(q,d){var a=q.p0,c=q.p1;q=q.p2;const r=z.subtract(g.sv3d.get(),c,a),e=z.subtract(g.sv3d.get(),q,c),h=z.subtract(g.sv3d.get(),a,q),v=z.subtract(g.sv3d.get(),d,a);var E=z.subtract(g.sv3d.get(),d,c),n=z.subtract(g.sv3d.get(),d,q);const B=z.cross(r,r,h),f=z.dot(z.cross(g.sv3d.get(),r,B),v);
E=z.dot(z.cross(g.sv3d.get(),e,B),E);n=z.dot(z.cross(g.sv3d.get(),h,B),n);if(0<f&&0<E&&0<n)return d=z.dot(B,v),d*d/z.dot(B,B);a=A.distance2(A.fromValues(a,r,x.get()),d);c=A.distance2(A.fromValues(c,e,x.get()),d);d=A.distance2(A.fromValues(q,h,x.get()),d);return Math.min(a,c,d)};b.fromValues=w;b.intersectRay=function(q,d,a){const {direction:c,origin:r}=d,{p0:e,p1:h,p2:v}=q;var E=h[0]-e[0],n=h[1]-e[1],B=h[2]-e[2];q=v[0]-e[0];d=v[1]-e[1];const f=v[2]-e[2];var D=c[1]*f-d*c[2],H=c[2]*q-f*c[0];const P=
c[0]*d-q*c[1];var R=E*D+n*H+B*P;if(-1E-5<R&&1E-5>R)return!1;R=1/R;const K=r[0]-e[0],J=r[1]-e[1],Q=r[2]-e[2];D=R*(K*D+J*H+Q*P);if(0>D||1<D)return!1;H=J*B-n*Q;B=Q*E-B*K;E=K*n-E*J;n=R*(c[0]*H+c[1]*B+c[2]*E);if(0>n||1<D+n)return!1;a&&(z.scale(a,c,R*(q*H+d*B+f*E)),z.add(a,r,a));return!0};b.wrap=function(q,d,a){const c=y.get();c.p0=q;c.p1=d;c.p2=a;return c};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ../../../../geometry/support/plane ../../support/buffer/InterleavedLayout ../lib/geometryDataUtils ../lib/GLMaterial ../lib/Material ../lib/Util ./VisualVariableMaterialParameters ./renderers/utils ../shaders/RibbonLineTechnique".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r){function e(ya,oa,G,I,Z){for(let ca=0;ca<Z;ca++)G[I++]=ya[oa++];return I}function h(ya,oa,G){oa=oa.get("position").data;G=G?G.get("position"):null;return ya.isClosed?G?2<G.length:6<oa.length:!1}const v=m.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");m=function(ya){function oa(I){I=ya.call(this,I,n)||this;I._vertexAttributeLocations=r.ribbonVertexAttributeLocations;I.techniqueConfig=new r.RibbonLineTechniqueConfiguration;I.layout=
I.createLayout();return I}l._inheritsLoose(oa,ya);var G=oa.prototype;G.isClosed=function(I,Z){return this.params.isClosed?Z?2<Z.length:6<I.length:!1};G.dispose=function(){};G.getPassParameters=function(){return this.params};G.getTechniqueConfig=function(I,Z){this.techniqueConfig.output=I;I=C.isSome(this.params.stipplePattern);this.techniqueConfig.stippleEnabled=I;this.techniqueConfig.stippleIntegerRepeatsEnabled=I&&this.params.stippleIntegerRepeats;this.techniqueConfig.stippleOffColorEnabled=I&&C.isSome(this.params.stippleOffColor);
this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.roundJoins="round"===this.params.join;this.techniqueConfig.roundCaps="round"===this.params.cap;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.vvColor=this.params.vvColorEnabled;this.techniqueConfig.vvOpacity=
this.params.vvOpacityEnabled;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.innerColorEnabled=0<this.params.innerWidth&&C.isSome(this.params.innerColor);this.techniqueConfig.falloffEnabled=0<this.params.falloff;this.techniqueConfig.occluder=8===this.params.renderOccluded;this.techniqueConfig.transparencyPassType=Z?Z.transparencyPassType:3;this.techniqueConfig.multipassTerrainEnabled=Z?Z.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=Z?Z.cullAboveGround:
!1;return this.techniqueConfig};G.intersect=function(I,Z,ca,da,ba,ha,ea,W,X){X?this.intersectDrapedLineGeometry(I,da,ha,ea):this.intersectLineGeometry(I,Z,ca,da,this.params.width,ea)};G.intersectDrapedLineGeometry=function(I,Z,ca,da){if(Z.options.selectionMode){Z=I.vertexAttributes.get("position").data;var ba=I.vertexAttributes.get("size"),ha=this.params.width;this.params.vvSizeEnabled?(ba=I.vertexAttributes.get("sizeFeatureAttribute").data[0],ha*=z.clamp(this.params.vvSizeOffset[0]+ba*this.params.vvSizeFactor[0],
this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])):ba&&(ha*=ba.data[0]);ba=ca[0];ca=ca[1];I=(ha/2+4)*I.screenToWorldRatio;ha=Number.MAX_VALUE;for(let aa=0;aa<Z.length-5;aa+=3){var ea=Z[aa],W=Z[aa+1],X=ba-ea,Y=ca-W;ea=Z[aa+3]-ea;W=Z[aa+4]-W;const ia=z.clamp((ea*X+W*Y)/(ea*ea+W*W),0,1);X=ea*ia-X;Y=W*ia-Y;Y=X*X+Y*Y;Y<ha&&(ha=Y)}ha<I*I&&da()}};G.intersectLineGeometry=function(I,Z,ca,da,ba,ha){if(da.options.selectionMode&&!c.isInstanceHidden(Z))if(d.isTranslationMatrix(ca)){var ea=I.vertexAttributes;
Z=ea.get("position").data;if(this.params.vvSizeEnabled){var W=ea.get("sizeFeatureAttribute").data[0];ba*=z.clamp(this.params.vvSizeOffset[0]+W*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else ea.has("size")&&(ba*=ea.get("size").data[0]);W=da.camera;var X=R;g.copy(X,da.point);ba=ba*W.pixelRatio/2+4*W.pixelRatio;k.set(L[0],X[0]-ba,X[1]+ba,0);k.set(L[1],X[0]+ba,X[1]+ba,0);k.set(L[2],X[0]+ba,X[1]-ba,0);k.set(L[3],X[0]-ba,X[1]-ba,0);for(var Y=0;4>Y;Y++)if(!W.unprojectFromRenderScreen(L[Y],
N[Y]))return;x.fromPoints(W.eye,N[0],N[1],U);x.fromPoints(W.eye,N[1],N[2],fa);x.fromPoints(W.eye,N[2],N[3],ka);x.fromPoints(W.eye,N[3],N[0],wa);Y=Number.MAX_VALUE;I=h(this.params,ea,I.indices)?Z.length-2:Z.length-5;for(ea=0;ea<I;ea+=3){f[0]=Z[ea]+ca[12];f[1]=Z[ea+1]+ca[13];f[2]=Z[ea+2]+ca[14];var aa=(ea+3)%Z.length;D[0]=Z[aa]+ca[12];D[1]=Z[aa+1]+ca[13];D[2]=Z[aa+2]+ca[14];if(!(0>x.signedDistance(U,f)&&0>x.signedDistance(U,D)||0>x.signedDistance(fa,f)&&0>x.signedDistance(fa,D)||0>x.signedDistance(ka,
f)&&0>x.signedDistance(ka,D)||0>x.signedDistance(wa,f)&&0>x.signedDistance(wa,D))){W.projectToRenderScreen(f,K);W.projectToRenderScreen(D,J);if(0>K[2]&&0<J[2])k.subtract(H,f,D),aa=W.frustum,aa=-x.signedDistance(aa[4],f)/k.dot(H,x.normal(aa[4])),k.scale(H,H,aa),k.add(f,f,H),W.projectToRenderScreen(f,K);else if(0<K[2]&&0>J[2])k.subtract(H,D,f),aa=W.frustum,aa=-x.signedDistance(aa[4],D)/k.dot(H,x.normal(aa[4])),k.scale(H,H,aa),k.add(D,D,H),W.projectToRenderScreen(D,J);else if(0>K[2]&&0>J[2])continue;
K[2]=0;J[2]=0;aa=u.distance2(u.fromPoints(K,J,O),X);aa<Y&&(Y=aa,k.copy(Q,f),k.copy(F,D))}}ca=da.rayBeginPoint;da=da.rayEndPoint;Y<ba*ba&&(Z=Number.MAX_VALUE,u.closestLineSegmentPoint(u.fromPoints(Q,F,O),u.fromPoints(ca,da,V),P)&&(k.subtract(P,P,ca),Z=k.length(P),k.scale(P,P,1/Z),Z/=k.distance(ca,da)),ha(Z,P))}else v.error("intersection assumes a translation-only matrix")};G.computeAttachmentOrigin=function(I,Z){const ca=I.vertexAttributes;if(!ca)return null;I=I.indices;const da=ca.get("position");
return t.computeAttachmentOriginLines(da,I?I.get("position"):null,I&&h(this.params,ca,I),Z)};G.createLayout=function(){const I=y.newLayout().vec3f("position").f32("subdivisionFactor").vec2f("uv0").vec3f("auxpos1").vec3f("auxpos2");this.params.vvSizeEnabled?I.f32("sizeFeatureAttribute"):I.f32("size");this.params.vvColorEnabled?I.f32("colorFeatureAttribute"):I.vec4f("color");this.params.vvOpacityEnabled&&I.f32("opacityFeatureAttribute");return I};G.createBufferWriter=function(){return new B(this.layout,
this.params)};G.getGLMaterial=function(I){return 0===I.output||7===I.output||4===I.output||1===I.output?new E(I):void 0};G.validateParameterValues=function(I){"miter"!==I.join&&(I.miterLimit=0);this.requiresTransparent(I)&&(I.transparent=!0)};G.requiresTransparent=function(I){return!!(1>(I.color&&I.color[3])||0<I.innerWidth&&this.colorRequiresTransparent(I.innerColor)||I.stipplePattern&&this.colorRequiresTransparent(I.stippleOffColor)||0<I.falloff)};G.colorRequiresTransparent=function(I){return C.isSome(I)&&
1>I[3]&&0<I[3]};return oa}(q.Material);let E=function(ya){function oa(I){I=ya.call(this,I)||this;I.updateParameters();return I}l._inheritsLoose(oa,ya);var G=oa.prototype;G.updateParameters=function(I){this._technique=this._techniqueRep.releaseAndAcquire(r.RibbonLineTechnique,this._material.getTechniqueConfig(this._output,I),this._technique)};G.beginSlot=function(I){return this._technique.configuration.occluder?3===I||10===I||11===I:0===this._output||7===this._output?(this.targetSlot=this._technique.configuration.writeDepth?
5:8,I===this.targetSlot):3===I};G._updateOccludeeState=function(I){I.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:I.hasOccludees})};G.ensureParameters=function(I){0!==this._output&&7!==this._output||this._updateOccludeeState(I);this.updateParameters(I)};G.bind=function(I){this._technique.bindPass(this._material.getPassParameters(),I)};G.getPipelineState=function(I,Z){return this._technique.getPipelineState(I,Z)};return oa}(p);const n={width:0,
color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1,...q.materialParametersDefaults,...a.Default};let B=function(){function ya(G,I){this.params=I;this.numJoinSubdivisions=0;this.vertexBufferLayout=G;switch(this.params.join){case "miter":case "bevel":this.numJoinSubdivisions=I.stipplePattern?
1:0;break;case "round":this.numJoinSubdivisions=1}}var oa=ya.prototype;oa.isClosed=function(G){return h(this.params,G.vertexAttributes,G.indices)};oa.numCapSubdivisions=function(G){if(this.isClosed(G))return 0;switch(this.params.cap){case "butt":return 0;case "square":return 1;case "round":return 3}};oa.allocate=function(G){return this.vertexBufferLayout.createBuffer(G)};oa.elementCount=function(G){var I=2*this.numCapSubdivisions(G)+2,Z=G.indices.get("position").length/2+1;const ca=this.isClosed(G);
I=ca?2:2*I;var da=ca?0:1;Z=ca?Z:Z-1;if(G.vertexAttributes.has("subdivisions"))for(G=G.vertexAttributes.get("subdivisions").data;da<Z;++da)I+=4+2*G[da];else I+=(Z-da)*(2*this.numJoinSubdivisions+4);return I+2};oa.write=function(G,I,Z,ca){const da=M,ba=T,ha=S;var ea=I.vertexAttributes.get("position").data,W=I.indices&&I.indices.get("position");const X=this.numCapSubdivisions(I);W&&W.length!==2*(ea.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");W=null;I.vertexAttributes.has("subdivisions")&&
(W=I.vertexAttributes.get("subdivisions").data);let Y=1,aa=0;this.params.vvSizeEnabled?aa=I.vertexAttributes.get("sizeFeatureAttribute").data[0]:I.vertexAttributes.has("size")&&(Y=I.vertexAttributes.get("size").data[0]);let ia=[1,1,1,1],ja=0;this.params.vvColorEnabled?ja=I.vertexAttributes.get("colorFeatureAttribute").data[0]:I.vertexAttributes.has("color")&&(ia=I.vertexAttributes.get("color").data);let va=0;this.params.vvOpacityEnabled&&(va=I.vertexAttributes.get("opacityFeatureAttribute").data[0]);
const ma=ea.length/3;G=G.transformation;const ta=new Float32Array(Z.buffer);Z=this.vertexBufferLayout.stride/4;let sa=ca*Z;ca=sa;const ra=(Ca,Da,Ia,Pa,Oa,Qa,Ka)=>{ta[sa++]=Da[0];ta[sa++]=Da[1];ta[sa++]=Da[2];ta[sa++]=Pa;ta[sa++]=Oa;ta[sa++]=Qa;ta[sa++]=Ca[0];ta[sa++]=Ca[1];ta[sa++]=Ca[2];ta[sa++]=Ia[0];ta[sa++]=Ia[1];ta[sa++]=Ia[2];this.params.vvSizeEnabled?ta[sa++]=aa:ta[sa++]=Y;this.params.vvColorEnabled?ta[sa++]=ja:(Ca=Math.min(4*Ka,ia.length-4),ta[sa++]=ia[Ca+0],ta[sa++]=ia[Ca+1],ta[sa++]=ia[Ca+
2],ta[sa++]=ia[Ca+3]);this.params.vvOpacityEnabled&&(ta[sa++]=va)};sa+=Z;k.set(ba,ea[0],ea[1],ea[2]);G&&k.transformMat4(ba,ba,G);if(I=this.isClosed(I)){var na=ea.length-3;k.set(da,ea[na],ea[na+1],ea[na+2]);G&&k.transformMat4(da,da,G)}else{k.copy(da,ba);k.set(ha,ea[3],ea[4],ea[5]);G&&k.transformMat4(ha,ha,G);for(na=0;na<X;++na){var ua=1-na/X;ra(da,ba,ha,ua,1,-4,0);ra(da,ba,ha,ua,1,4,0)}ra(da,ba,ha,0,0,-4,0);ra(da,ba,ha,0,0,4,0);k.copy(da,ba);k.copy(ba,ha)}ua=I?0:1;for(na=I?ma:ma-1;ua<na;ua++){var za=
(ua+1)%ma*3;k.set(ha,ea[za+0],ea[za+1],ea[za+2]);G&&k.transformMat4(ha,ha,G);ra(da,ba,ha,0,1,-1,ua);ra(da,ba,ha,0,1,1,ua);za=W?W[ua]:this.numJoinSubdivisions;for(let Ca=0;Ca<za;++Ca){const Da=(Ca+1)/(za+1);ra(da,ba,ha,Da,1,-2,ua);ra(da,ba,ha,Da,1,2,ua)}ra(da,ba,ha,1,0,-2,ua);ra(da,ba,ha,1,0,2,ua);k.copy(da,ba);k.copy(ba,ha)}if(I)sa=e(ta,ca+Z,ta,sa,2*Z);else for(ra(da,ba,ha,0,1,-5,na),ra(da,ba,ha,0,1,5,na),ea=0;ea<X;++ea)W=(ea+1)/X,ra(da,ba,ha,W,1,-5,na),ra(da,ba,ha,W,1,5,na);e(ta,ca+Z,ta,ca,Z);sa=
e(ta,sa-Z,ta,sa,Z)};return ya}();const f=w.create(),D=w.create(),H=w.create(),P=w.create(),R=w.create(),K=A.createRenderScreenPointArray3(),J=A.createRenderScreenPointArray3(),Q=w.create(),F=w.create(),O=u.create(),V=u.create(),M=w.create(),T=w.create(),S=w.create(),L=[A.createRenderScreenPointArray3(),A.createRenderScreenPointArray3(),A.createRenderScreenPointArray3(),A.createRenderScreenPointArray3()],N=[w.create(),w.create(),w.create(),w.create()],U=x.create(),fa=x.create(),ka=x.create(),wa=x.create();
b.RibbonLineMaterial=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GLMaterial":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./AutoDisposable"],function(b,l){return function(m){function z(A){var g=m.call(this)||this;g._material=A.material;g._techniqueRep=A.techniqueRep;g._output=A.output;return g}b._inheritsLoose(z,m);var C=z.prototype;C.getPipelineState=function(A,g){return this.technique.pipeline};C.ensureResources=function(A){return 2};
C.ensureParameters=function(A){};b._createClass(z,[{key:"technique",get:function(){return this._technique}}]);return z}(l.AutoDisposable)})},"esri/views/3d/webgl-engine/lib/AutoDisposable":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,l){const m=C=>function(A){function g(){var k=A.apply(this,arguments)||this;k._isDisposed=!1;return k}l._inheritsLoose(g,A);g.prototype.dispose=function(){for(const w of null!=(k=this._managedDisposables)?k:[]){var k;k=this[w];
this[w]=null;k&&"function"===typeof k.dispose&&k.dispose()}this._isDisposed=!0};l._createClass(g,[{key:"isDisposed",get:function(){return this._isDisposed}}]);return g}(C);let z=function(C){function A(){return C.apply(this,arguments)||this}l._inheritsLoose(A,C);return A}(m(function(){return function(){}}()));b.AutoDisposable=z;b.AutoDisposableMixin=m;b.autoDispose=function(){return(C,A)=>{if(!C.hasOwnProperty("_managedDisposables")){var g,k;C._managedDisposables=null!=(g=null==(k=C._managedDisposables)?
void 0:k.slice())?g:[]}C._managedDisposables.unshift(A)}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Material":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./ContentObject ./DefaultVertexAttributeLocations ../materials/internal/MaterialUtil".split(" "),function(b,l,m,z,C,A){z=function(g){function k(u,x){var y=g.call(this)||this;y.type=3;y.supportsEdges=!1;y._visible=!0;y._renderPriority=0;y._insertOrder=0;y._vertexAttributeLocations=
C.Default3D;y._params=A.copyParameters(u,x);y.validateParameterValues(y._params);return y}l._inheritsLoose(k,g);var w=k.prototype;w.dispose=function(){};w.update=function(u){return!1};w.setParameterValues=function(u){A.updateParameters(this._params,u)&&(this.validateParameterValues(this._params),this.parametersChanged())};w.validateParameterValues=function(u){};w.isVisibleInPass=function(u){return!0};w.isVisible=function(){return this._visible};w.parametersChanged=function(){m.isSome(this.materialRepository)&&
this.materialRepository.materialChanged(this)};l._createClass(k,[{key:"params",get:function(){return this._params}},{key:"visible",get:function(){return this._visible},set:function(u){u!==this._visible&&(this._visible=u,this.parametersChanged())}},{key:"renderOccluded",get:function(){return this.params.renderOccluded}},{key:"renderPriority",get:function(){return this._renderPriority},set:function(u){u!==this._renderPriority&&(this._renderPriority=u,this.parametersChanged())}},{key:"insertOrder",get:function(){return this._insertOrder},
set:function(u){u!==this._insertOrder&&(this._insertOrder=u,this.parametersChanged())}},{key:"vertexAttributeLocations",get:function(){return this._vertexAttributeLocations}}]);return k}(z.ContentObject);b.Material=z;b.materialParametersDefaults={renderOccluded:1};b.materialPredicate=function(g,k){return g.isVisible()&&g.isVisibleInPass(k.pass)&&0!==(g.renderOccluded&k.renderOccludedMask)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":function(){define(["../../../../chunks/mat3f64",
"../../../../chunks/vec3f32"],function(b,l){var m;(m||(m={})).Default={vvSizeEnabled:!1,vvSizeMinSize:l.fromValues(1,1,1),vvSizeMaxSize:l.fromValues(100,100,100),vvSizeOffset:l.fromValues(0,0,0),vvSizeFactor:l.fromValues(1,1,1),vvSizeValue:l.fromValues(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,
0],vvSymbolRotationMatrix:b.create()};return m})},"esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/maybe ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../../../../chunks/RibbonLine.glsl ../../../webgl/renderState".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){const r=new Map([["position",0],["subdivisionFactor",1],["uv0",2],["auxpos1",3],["auxpos2",4],["size",6],["sizeFeatureAttribute",6],["color",5],["colorFeatureAttribute",5],["opacityFeatureAttribute",7]]);y=function(h){function v(n,B,f){B=h.call(this,n,B,f)||this;B.stippleTextureRepository=n.stippleTextureRepository;return B}m._inheritsLoose(v,h);var E=v.prototype;E.initializeProgram=function(n){var B=v.shader.get();const f=this.configuration;B=B.build({OITEnabled:0===
f.transparencyPassType,output:f.output,slicePlaneEnabled:f.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:f.stippleEnabled,stippleOffColorEnabled:f.stippleOffColorEnabled,stippleUVMaxEnabled:f.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:f.stippleIntegerRepeatsEnabled,roundCaps:f.roundCaps,roundJoins:f.roundJoins,vvColor:f.vvColor,vvSize:f.vvSize,vvInstancingEnabled:!0,vvOpacity:f.vvOpacity,falloffEnabled:f.falloffEnabled,innerColorEnabled:f.innerColorEnabled,
multipassTerrainEnabled:f.multipassTerrainEnabled,cullAboveGround:f.cullAboveGround});return new q.Program(n.rctx,B,r)};E.dispose=function(){h.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};E.bindPass=function(n,B){u.bindProjectionMatrix(this.program,B.camera.projectionMatrix);4===this.configuration.output&&g.bindOutputHighlight(this.program,B);B.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",
B.inverseViewport),k.bindMultipassTerrainTexture(this.program,B));this.program.setUniform1f("intrinsicWidth",n.width);this.program.setUniform4fv("intrinsicColor",n.color);this.program.setUniform1f("miterLimit","miter"!==n.join?0:n.miterLimit);this.program.setUniform2fv("cameraNearFar",B.camera.nearFar);this.program.setUniform1f("pixelRatio",B.camera.pixelRatio);this.program.setUniform2f("screenSize",B.camera.fullViewport[2],B.camera.fullViewport[3]);w.bindVisualVariablesUniformsWithOpacity(this.program,
n);if(this.stipplePattern!==n.stipplePattern){var f=n.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,f);this.stipplePattern=f}this.configuration.stippleEnabled&&(f=C.isSome(this.stippleTextureBind)?this.stippleTextureBind(this.program)*B.camera.pixelRatio:1,this.program.setUniform1f("stipplePatternPixelSizeInv",1/f),this.configuration.stippleOffColorEnabled&&(f=C.unwrap(n.stippleOffColor),this.program.setUniform4f("stippleOffColor",f[0],f[1],f[2],3<f.length?
f[3]:1)));this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",n.falloff);this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",C.unwrapOr(n.innerColor,n.color)),this.program.setUniform1f("innerWidth",n.innerWidth*B.camera.pixelRatio))};E.bindDraw=function(n){u.bindView(this.program,n);A.bindSliceUniformsWithOrigin(this.program,this.configuration,n);this.program.rebindTextures()};E.setPipelineState=function(n,B){const f=this.configuration,D=3===n,H=2===n;
return c.makePipelineState({blending:0===f.output||7===f.output?D?p.blendingDefault:p.OITBlending(n):null,depthTest:{func:p.OITDepthTest(n)},depthWrite:D?!f.transparent&&f.writeDepth&&c.defaultDepthWriteParams:p.OITDepthWrite(n),colorWrite:c.defaultColorWriteParams,stencilWrite:f.sceneHasOcludees?d.stencilWriteMaskOn:null,stencilTest:f.sceneHasOcludees?B?d.stencilToolMaskBaseParams:d.stencilBaseAllZerosParams:null,polygonOffset:D||H?f.polygonOffset&&e:p.OITPolygonOffset})};E.initializePipeline=function(){const n=
this.configuration,B=n.polygonOffset&&e;n.occluder&&(this._occluderPipelineTransparent=c.makePipelineState({blending:p.blendingDefault,polygonOffset:B,depthTest:d.depthCompareAlways,depthWrite:null,colorWrite:c.defaultColorWriteParams,stencilWrite:null,stencilTest:d.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=c.makePipelineState({blending:p.blendingDefault,polygonOffset:B,depthTest:d.depthCompareAlways,depthWrite:null,colorWrite:c.defaultColorWriteParams,stencilWrite:d.stencilWriteMaskOff,
stencilTest:d.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=c.makePipelineState({blending:null,polygonOffset:B,depthTest:d.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:d.stencilWriteMaskOn,stencilTest:d.stencilToolMaskBaseParams}));this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0);return this.setPipelineState(this.configuration.transparencyPassType,!1)};E.getPipelineState=function(n,B){return B?this._occludeePipelineState:
this.configuration.occluder?11===n?this._occluderPipelineTransparent:10===n?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline};m._createClass(v,[{key:"primitiveType",get:function(){return 5}}]);return v}(y.ShaderTechnique);y.shader=new x.ReloadableShaderModule(a.RibbonLineShader,()=>new Promise(function(h,v){b(["./RibbonLine.glsl"],h,v)}));const e={factor:0,units:-4};x=function(h){function v(){var E=h.apply(this,arguments)||this;E.output=0;E.occluder=!1;E.slicePlaneEnabled=
!1;E.transparent=!1;E.polygonOffset=!1;E.writeDepth=!1;E.stippleEnabled=!1;E.stippleOffColorEnabled=!1;E.stippleIntegerRepeatsEnabled=!1;E.roundCaps=!1;E.roundJoins=!1;E.vvSize=!1;E.vvColor=!1;E.vvOpacity=!1;E.falloffEnabled=!1;E.innerColorEnabled=!1;E.sceneHasOcludees=!1;E.transparencyPassType=3;E.multipassTerrainEnabled=!1;E.cullAboveGround=!1;return E}m._inheritsLoose(v,h);return v}(t.ShaderTechniqueConfiguration);z.__decorate([t.parameter({count:8})],x.prototype,"output",void 0);z.__decorate([t.parameter()],
x.prototype,"occluder",void 0);z.__decorate([t.parameter()],x.prototype,"slicePlaneEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"transparent",void 0);z.__decorate([t.parameter()],x.prototype,"polygonOffset",void 0);z.__decorate([t.parameter()],x.prototype,"writeDepth",void 0);z.__decorate([t.parameter()],x.prototype,"stippleEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"stippleOffColorEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"stippleIntegerRepeatsEnabled",
void 0);z.__decorate([t.parameter()],x.prototype,"roundCaps",void 0);z.__decorate([t.parameter()],x.prototype,"roundJoins",void 0);z.__decorate([t.parameter()],x.prototype,"vvSize",void 0);z.__decorate([t.parameter()],x.prototype,"vvColor",void 0);z.__decorate([t.parameter()],x.prototype,"vvOpacity",void 0);z.__decorate([t.parameter()],x.prototype,"falloffEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"innerColorEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"sceneHasOcludees",
void 0);z.__decorate([t.parameter({count:4})],x.prototype,"transparencyPassType",void 0);z.__decorate([t.parameter()],x.prototype,"multipassTerrainEnabled",void 0);z.__decorate([t.parameter()],x.prototype,"cullAboveGround",void 0);l.RibbonLineTechnique=y;l.RibbonLineTechniqueConfiguration=x;l.ribbonVertexAttributeLocations=r;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":function(){define(["exports","../../../../../core/maybe","../../../../../chunks/vec3",
"../../../../../chunks/vec3f64","../shaderModules/interfaces"],function(b,l,m,z,C){function A(k,w,u,x){w.slicePlaneEnabled&&(l.isSome(u)?(x?(m.subtract(g,u.origin,x),k.setUniform3fv("slicePlaneOrigin",g)):k.setUniform3fv("slicePlaneOrigin",u.origin),k.setUniform3fv("slicePlaneBasis1",u.basis1),k.setUniform3fv("slicePlaneBasis2",u.basis2)):(k.setUniform3fv("slicePlaneBasis1",z.ZEROS),k.setUniform3fv("slicePlaneBasis2",z.ZEROS),k.setUniform3fv("slicePlaneOrigin",z.ZEROS)))}const g=z.create();b.Slice=
function(k,w){if(w.slicePlaneEnabled){k.extensions.add("GL_OES_standard_derivatives");w.sliceEnabledForVertexPrograms&&(k.vertex.uniforms.add("slicePlaneOrigin","vec3"),k.vertex.uniforms.add("slicePlaneBasis1","vec3"),k.vertex.uniforms.add("slicePlaneBasis2","vec3"));k.fragment.uniforms.add("slicePlaneOrigin","vec3");k.fragment.uniforms.add("slicePlaneBasis1","vec3");k.fragment.uniforms.add("slicePlaneBasis2","vec3");var u=C.glsl`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,x=C.glsl`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
if (sliceByFactors(factors)) {
return color;
}
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`;x=w.sliceHighlightDisabled?C.glsl`#define highlightSlice(_color_, _pos_) (_color_)`:C.glsl`
        ${x}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;w.sliceEnabledForVertexPrograms&&k.vertex.code.add(u);k.fragment.code.add(u);k.fragment.code.add(x)}else u=C.glsl`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`,w.sliceEnabledForVertexPrograms&&k.vertex.code.add(u),k.fragment.code.add(u)};b.bindSliceUniforms=A;b.bindSliceUniformsWithOrigin=function(k,w,u){A(k,w,u.slicePlane,u.origin)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":function(){define(["exports","../../../../../../chunks/vec4f64","../../shaderModules/interfaces"],function(b,l,m){const z=l.fromValues(1,1,0,1),C=l.fromValues(1,
0,1,1);b.OutputHighlight=function(A){A.fragment.uniforms.add("depthTex","sampler2D");A.fragment.uniforms.add("highlightViewportPixelSz","vec4");A.fragment.constants.add("occludedHighlightFlag","vec4",z).add("unoccludedHighlightFlag","vec4",C);A.fragment.code.add(m.glsl`void outputHighlight() {
vec4 fragCoord = gl_FragCoord;
float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
if (fragCoord.z > sceneDepth + 5e-7) {
gl_FragColor = occludedHighlightFlag;
}
else {
gl_FragColor = unoccludedHighlightFlag;
}
}`)};b.bindOutputHighlight=function(A,g){A.bindTexture(g.highlightDepthTexture,"depthTex");A.setUniform4f("highlightViewportPixelSz",0,0,g.inverseViewport[0],g.inverseViewport[1])};b.occludedHighlightFlag=z;b.unoccludedHighlightFlag=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.bindMultipassTerrainTexture=function(m,z){z.multipassTerrainEnabled&&
z.terrainLinearDepthTexture&&m.bindTexture(z.terrainLinearDepthTexture,"terrainDepthTexture")};b.multipassTerrainTest=function(m,z){m.fragment.uniforms.add("terrainDepthTexture","sampler2D");m.fragment.uniforms.add("cameraNearFar","vec2");m.fragment.uniforms.add("inverseViewport","vec2");m.fragment.code.add(l.glsl`
    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){

      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);
      if(fragmentDepth ${z.cullAboveGround?"\x3e":"\x3c\x3d"} terrainDepth){
        discard;
      }
    }
  `)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){function m(z,C){C.vvSizeEnabled&&(z.setUniform3fv("vvSizeMinSize",C.vvSizeMinSize),z.setUniform3fv("vvSizeMaxSize",C.vvSizeMaxSize),z.setUniform3fv("vvSizeOffset",C.vvSizeOffset),z.setUniform3fv("vvSizeFactor",C.vvSizeFactor));C.vvColorEnabled&&(z.setUniform1fv("vvColorValues",C.vvColorValues),
z.setUniform4fv("vvColorColors",C.vvColorColors))}b.VisualVariables=function(z,C){C.vvInstancingEnabled&&(C.vvSize||C.vvColor)&&z.attributes.add("instanceFeatureAttribute","vec4");C.vvSize?(z.vertex.uniforms.add("vvSizeMinSize","vec3"),z.vertex.uniforms.add("vvSizeMaxSize","vec3"),z.vertex.uniforms.add("vvSizeOffset","vec3"),z.vertex.uniforms.add("vvSizeFactor","vec3"),z.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),z.vertex.uniforms.add("vvSymbolAnchor","vec3"),z.vertex.code.add(l.glsl`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),z.vertex.code.add(l.glsl`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${C.vvInstancingEnabled?l.glsl`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):z.vertex.code.add(l.glsl`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`);C.vvColor?(z.vertex.constants.add("vvColorNumber","int",8),z.vertex.code.add(l.glsl`
      uniform float vvColorValues[vvColorNumber];
      uniform vec4 vvColorColors[vvColorNumber];

      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${C.vvInstancingEnabled?l.glsl`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):z.vertex.code.add(l.glsl`vec4 vvColor() { return vec4(1.0); }`)};b.bindVisualVariablesUniforms=m;b.bindVisualVariablesUniformsForSymbols=function(z,C){m(z,C);C.vvSizeEnabled&&(z.setUniform3fv("vvSymbolAnchor",C.vvSymbolAnchor),z.setUniformMatrix3fv("vvSymbolRotationMatrix",C.vvSymbolRotationMatrix))};b.bindVisualVariablesUniformsWithOpacity=function(z,C){m(z,C);C.vvOpacityEnabled&&(z.setUniform1fv("vvOpacityValues",C.vvOpacityValues),z.setUniform1fv("vvOpacityOpacities",C.vvOpacityOpacities))};
Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl":function(){define(["exports","../../../../../../chunks/mat4","../../../../../../chunks/mat4f32"],function(b,l,m){function z(A,g,k){l.translate(C,k,g);A.setUniform3fv("localOrigin",g);A.setUniformMatrix4fv("view",C)}const C=m.create();b.bindCameraPosition=function(A,g,k){A.setUniform3f("camPos",k[3]-g[0],k[7]-g[1],k[11]-g[2])};b.bindNearFar=function(A,g){A.setUniform2fv("nearFar",g)};
b.bindProjectionMatrix=function(A,g){A.setUniformMatrix4fv("proj",g)};b.bindView=function(A,g){z(A,g.origin,g.camera.viewMatrix)};b.bindViewCustomOrigin=z;b.bindViewport=function(A,g){A.setUniform4fv("viewport",g.camera.fullViewport)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/mat4f32":function(){define(["exports"],function(b){function l(){const k=new Float32Array(16);k[0]=1;k[5]=1;k[10]=1;k[15]=1;return k}function m(k){const w=new Float32Array(16);w[0]=k[0];w[1]=k[1];w[2]=k[2];
w[3]=k[3];w[4]=k[4];w[5]=k[5];w[6]=k[6];w[7]=k[7];w[8]=k[8];w[9]=k[9];w[10]=k[10];w[11]=k[11];w[12]=k[12];w[13]=k[13];w[14]=k[14];w[15]=k[15];return w}function z(k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E){const n=new Float32Array(16);n[0]=k;n[1]=w;n[2]=u;n[3]=x;n[4]=y;n[5]=t;n[6]=p;n[7]=q;n[8]=d;n[9]=a;n[10]=c;n[11]=r;n[12]=e;n[13]=h;n[14]=v;n[15]=E;return n}function C(k,w){return new Float32Array(k,w,16)}const A=l();var g=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C,IDENTITY:A});
b.IDENTITY=A;b.clone=m;b.create=l;b.createView=C;b.fromValues=z;b.mat4f32=g})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports","../../../webgl/renderState"],function(b,l){const m=l.separateBlendingParams(770,1,771,771),z=l.simpleBlendingParams(1,1),C=l.simpleBlendingParams(0,771),A={factor:-1,units:-2};b.OITBlending=function(g){return 2===g?null:1===g?C:z};b.OITDepthTest=function(g){return 3===g||2===g?513:515};b.OITDepthWrite=function(g){return 2===g?l.defaultDepthWriteParams:
null};b.OITPolygonOffset=A;b.OITPolygonOffsetLimit=5E5;b.blendingAlpha=C;b.blendingColor=z;b.blendingDefault=m;b.getOITPolygonOffset=function(g){return g?A:null};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/StencilUtils":function(){define(["exports"],function(b){b.depthCompareAlways={func:519};b.depthCompareLess={func:513};b.renderWhenBitIsNotSet=l=>({function:{func:517,ref:l,mask:l},operation:{fail:7680,zFail:7680,zPass:7680}});b.replaceBitWhenDepthTestPasses=
l=>({function:{func:519,ref:l,mask:l},operation:{fail:7680,zFail:7680,zPass:7681}});b.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}};b.stencilToolMaskBaseParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};b.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};b.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,
zPass:7680}};b.stencilWriteMaskOff={mask:0};b.stencilWriteMaskOn={mask:255};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/RibbonLine.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){function t(q){const d=new y.ShaderBuilder;d.extensions.add("GL_OES_standard_derivatives");d.include(k.PiUtils);d.include(m.RibbonVertexPosition,q);d.include(A.LineStipple,q);1===q.output&&d.include(z.OutputDepth,q);d.vertex.uniforms.add("proj","mat4").add("view","mat4").add("cameraNearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2");d.attributes.add("position","vec3");d.attributes.add("subdivisionFactor","float");d.attributes.add("uv0",
"vec2");d.attributes.add("auxpos1","vec3");d.attributes.add("auxpos2","vec3");d.varyings.add("vColor","vec4");d.varyings.add("vpos","vec3");d.varyings.add("linearDepth","float");q.multipassTerrainEnabled&&d.varyings.add("depth","float");const a=q.falloffEnabled,c=q.innerColorEnabled;c&&d.varyings.add("vLineDistance","float");a&&d.varyings.add("vLineDistanceNorm","float");q.falloffEnabled&&d.fragment.uniforms.add("falloff","float");q.innerColorEnabled&&(d.fragment.uniforms.add("innerColor","vec4"),
d.fragment.uniforms.add("innerWidth","float"));d.vertex.code.add(x.glsl`#define PERPENDICULAR(v) vec2(v.y, -v.x);
#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0
float interp(float ncp, vec4 a, vec4 b) {
return (-ncp - a.z) / (b.z - a.z);
}
vec2 rotate(vec2 v, float a) {
float s = sin(a);
float c = cos(a);
mat2 m = mat2(c, -s, s, c);
return m * v;
}`);d.vertex.code.add(x.glsl`vec4 projectAndScale(vec4 pos) {
vec4 posNdc = proj * pos;
posNdc.xy *= screenSize / posNdc.w;
return posNdc;
}`);d.vertex.code.add(x.glsl`
    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {
      float vnp = cameraNearFar[0] * 0.99;

      //current pos behind ncp --> we need to clip
      if(pos.z > -cameraNearFar[0]) {
        if (!isStartVertex) {
          //previous in front of ncp
          if(prev.z < -cameraNearFar[0]) {
            pos = mix(prev, pos, interp(vnp, prev, pos));
            next = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
        //next in front of ncp
        if(isStartVertex) {
          if(next.z < -cameraNearFar[0]) {
            pos = mix(pos, next, interp(vnp, pos, next));
            prev = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
      } else {
        //current position visible
        //previous behind ncp
        if (prev.z > -cameraNearFar[0]) {
          prev = mix(pos, prev, interp(vnp, pos, prev));
        }
        //next behind ncp
        if (next.z > -cameraNearFar[0]) {
          next = mix(next, pos, interp(vnp, next, pos));
        }
      }

      ${q.multipassTerrainEnabled?"depth \x3d pos.z;":""}
      linearDepth = (-pos.z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);

      pos = projectAndScale(pos);
      next = projectAndScale(next);
      prev = projectAndScale(prev);
    }
`);d.vertex.code.add(x.glsl`void main(void) {
float coverage = 1.0;
vpos = position;
if (uv0.y == 0.0) {
gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
}
else {
bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;
bool isJoin = abs(uv0.y)-3.0 < 0.0;
float lineWidth = getSize() * pixelRatio;
if (lineWidth < 1.0) {
coverage = lineWidth;
lineWidth = 1.0;
}else{
lineWidth = floor(lineWidth + 0.5);
}
vec4 pos  = view * vec4(position.xyz, 1.0);
vec4 prev = view * vec4(auxpos1.xyz, 1.0);
vec4 next = view * vec4(auxpos2.xyz, 1.0);
clipAndTransform(pos, prev, next, isStartVertex);
vec2 left = (pos.xy - prev.xy);
vec2 right = (next.xy - pos.xy);
float leftLen = length(left);
float rightLen = length(right);`);q.stippleEnabled&&d.vertex.code.add(x.glsl`vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);
vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;
vec2 stippleSegmentDirection = stippleSegmentInfo.zw;`);d.vertex.code.add(x.glsl`left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);
right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);
vec2 capDisplacementDir = vec2(0, 0);
vec2 joinDisplacementDir = vec2(0, 0);
float displacementLen = lineWidth;
if (isJoin) {
bool isOutside = ISOUTSIDE;
joinDisplacementDir = normalize(left + right);
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
if (leftLen > 0.001 && rightLen > 0.001) {
float nDotSeg = dot(joinDisplacementDir, left);
displacementLen /= length(nDotSeg * left - joinDisplacementDir);
if (!isOutside) {
displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));
}
}
if (isOutside && (displacementLen > miterLimit * lineWidth)) {`);q.roundJoins?d.vertex.code.add(x.glsl`vec2 startDir;
vec2 endDir;
if (leftLen < 0.001) {
startDir = right;
}
else{
startDir = left;
}
startDir = normalize(startDir);
startDir = PERPENDICULAR(startDir);
if (rightLen < 0.001) {
endDir = left;
}
else{
endDir = right;
}
endDir = normalize(endDir);
endDir = PERPENDICULAR(endDir);
float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));
joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);`):d.vertex.code.add(x.glsl`if (leftLen < 0.001) {
joinDisplacementDir = right;
}
else if (rightLen < 0.001) {
joinDisplacementDir = left;
}
else {
joinDisplacementDir = isStartVertex ? right : left;
}
joinDisplacementDir = normalize(joinDisplacementDir);
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);`);d.vertex.code.add(x.glsl`displacementLen = lineWidth;
}
} else {
if (leftLen < 0.001) {
joinDisplacementDir = right;
}
else if (rightLen < 0.001) {
joinDisplacementDir = left;
}
else {
joinDisplacementDir = isStartVertex ? right : left;
}
joinDisplacementDir = normalize(joinDisplacementDir);
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
displacementLen = lineWidth;
capDisplacementDir = isStartVertex ? -right : left;`);q.roundCaps?d.vertex.code.add(x.glsl`float angle = subdivisionFactor*PI*0.5;
joinDisplacementDir *= cos(angle);
capDisplacementDir *= sin(angle);`):d.vertex.code.add(x.glsl`capDisplacementDir *= subdivisionFactor;`);d.vertex.code.add(x.glsl`
  }

  // Displacement (in pixels) caused by join/or cap
  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;

  ${a||c?x.glsl`float lineDist = lineWidth * sign(uv0.y) * pos.w;`:""}

  ${c?x.glsl`vLineDistance = lineDist;`:""}
  ${a?x.glsl`vLineDistanceNorm = lineDist / lineWidth;`:""}

  pos.xy += dpos;
  `);q.stippleEnabled&&(d.vertex.code.add(x.glsl`{
vec2 posVec = pos.xy - stippleSegmentOrigin;
float stippleSegmentDirectionLength = length(stippleSegmentDirection);`),q.stippleIntegerRepeatsEnabled&&d.vertex.code.add(x.glsl`float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;
float roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);
stipplePatternUvMax = roundedNumberOfPatternRepeats;`),d.vertex.code.add(x.glsl`
      if (stippleSegmentDirectionLength >= 0.001) {
        // Project the vertex position onto the line segment.
        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;
     ${q.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale \x3d roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale \x3d 1.0;"}
        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;
        } else {
          stipplePatternUv = 1.0;
        }
      }
    `));d.vertex.code.add(x.glsl`pos.xy = pos.xy / screenSize * pos.w;
vColor = getColor();
vColor.a *= coverage;
gl_Position = pos;
}
}`);q.multipassTerrainEnabled&&(d.fragment.include(C.ReadLinearDepth),d.include(g.multipassTerrainTest,q));d.include(l.Slice,q);d.fragment.uniforms.add("intrinsicColor","vec4");d.fragment.include(u.ColorConversion);d.fragment.code.add(x.glsl`
  void main() {
    discardBySlice(vpos);
    ${q.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    float stippleAlpha = getStippleAlpha();
    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);

    vec4 color = intrinsicColor * vColor;
  `);q.innerColorEnabled&&(d.fragment.uniforms.add("pixelRatio","float"),d.fragment.code.add(x.glsl`float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;
float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);
float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);
color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);`));d.fragment.code.add(x.glsl`vec4 finalColor = blendStipple(color, stippleAlpha);`);q.falloffEnabled&&d.fragment.code.add(x.glsl`finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);`);d.fragment.code.add(x.glsl`
    if (finalColor.a < ${x.glsl.float(w.symbolAlphaCutoff)}) {
      discard;
    }

    ${7===q.output?x.glsl`gl_FragColor = vec4(finalColor.a);`:""}
    ${0===q.output?x.glsl`gl_FragColor = highlightSlice(finalColor, vpos);`:""}
    ${0===q.output&&q.OITEnabled?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}
    ${4===q.output?x.glsl`gl_FragColor = vec4(1.0);`:""}
    ${1===q.output?x.glsl`outputDepth(linearDepth);`:""}
  }
  `);return d}var p=Object.freeze({__proto__:null,build:t});b.RibbonLineShader=p;b.build=t})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.RibbonVertexPosition=function(m,z){m.vertex.uniforms.add("intrinsicWidth","float");z.vvSize?(m.attributes.add("sizeFeatureAttribute","float"),m.vertex.uniforms.add("vvSizeMinSize","vec3"),m.vertex.uniforms.add("vvSizeMaxSize","vec3"),m.vertex.uniforms.add("vvSizeOffset",
"vec3"),m.vertex.uniforms.add("vvSizeFactor","vec3"),m.vertex.code.add(l.glsl`float getSize() {
return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;
}`)):(m.attributes.add("size","float"),m.vertex.code.add(l.glsl`float getSize(){
return intrinsicWidth * size;
}`));z.vvOpacity?(m.attributes.add("opacityFeatureAttribute","float"),m.vertex.constants.add("vvOpacityNumber","int",8),m.vertex.code.add(l.glsl`uniform float vvOpacityValues[vvOpacityNumber];
uniform float vvOpacityOpacities[vvOpacityNumber];
float interpolateOpacity( float value ){
if (value <= vvOpacityValues[0]) {
return vvOpacityOpacities[0];
}
for (int i = 1; i < vvOpacityNumber; ++i) {
if (vvOpacityValues[i] >= value) {
float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);
return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);
}
}
return vvOpacityOpacities[vvOpacityNumber - 1];
}
vec4 applyOpacity( vec4 color ){
return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));
}`)):m.vertex.code.add(l.glsl`vec4 applyOpacity( vec4 color ){
return color;
}`);z.vvColor?(m.attributes.add("colorFeatureAttribute","float"),m.vertex.constants.add("vvColorNumber","int",8),m.vertex.code.add(l.glsl`uniform float vvColorValues[vvColorNumber];
uniform vec4 vvColorColors[vvColorNumber];
vec4 interpolateColor( float value ) {
if (value <= vvColorValues[0]) {
return vvColorColors[0];
}
for (int i = 1; i < vvColorNumber; ++i) {
if (vvColorValues[i] >= value) {
float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
return mix(vvColorColors[i-1], vvColorColors[i], f);
}
}
return vvColorColors[vvColorNumber - 1];
}
vec4 getColor(){
return applyOpacity(interpolateColor(colorFeatureAttribute));
}`)):(m.attributes.add("color","vec4"),m.vertex.code.add(l.glsl`vec4 getColor(){
return applyOpacity(color);
}`))};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl":function(){define(["exports","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(b,l,m){b.OutputDepth=function(z,C){z.fragment.include(l.RgbaFloatEncoding);3===C.output?(z.extensions.add("GL_OES_standard_derivatives"),z.fragment.code.add(m.glsl`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 2.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`)):1===C.output&&z.fragment.code.add(m.glsl`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.LineStipple=function(m,z){m.constants.add("stippleAlphaColorDiscard","float",.001);m.constants.add("stippleAlphaHighlightDiscard","float",.5);z.stippleEnabled?(m.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),z.stippleUVMaxEnabled&&m.varyings.add("stipplePatternUvMax","float"),m.varyings.add("stipplePatternUv",
"float"),m.fragment.uniforms.add("stipplePatternTexture","sampler2D"),z.stippleOffColorEnabled&&m.fragment.uniforms.add("stippleOffColor","vec4"),m.fragment.code.add(l.glsl`
  float getStippleAlpha() {
    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;
    ${z.stippleUVMaxEnabled?"stipplePatternUvClamped \x3d clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":""}

    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;
  }`),z.stippleOffColorEnabled?m.fragment.code.add(l.glsl`#define discardByStippleAlpha(stippleAlpha, threshold) {}
#define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)`):m.fragment.code.add(l.glsl`#define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }
#define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)`)):m.fragment.code.add(l.glsl`float getStippleAlpha() { return 1.0; }
#define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}
#define blendStipple(color, _stippleAlpha_) color`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.PiUtils=function(m){m.vertex.code.add(l.glsl`const float PI = 3.141592653589793;`);m.fragment.code.add(l.glsl`const float PI = 3.141592653589793;
const float LIGHT_NORMALIZATION = 1.0 / PI;
const float INV_PI = 0.3183098861837907;
const float HALF_PI = 1.570796326794897;`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.DiscardOrAdjustAlpha=function(m,z){const C=m.fragment;switch(z.alphaDiscardMode){case 0:C.code.add(l.glsl`
        #define discardOrAdjustAlpha(color) { if (color.a < ${l.glsl.float(.001)}) { discard; } }
      `);break;case 1:C.code.add(l.glsl`void discardOrAdjustAlpha(inout vec4 color) {
color.a = 1.0;
}`);break;case 2:C.uniforms.add("textureAlphaCutoff","float");C.code.add(l.glsl`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }`);break;case 3:m.fragment.uniforms.add("textureAlphaCutoff","float"),m.fragment.code.add(l.glsl`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }`)}};b.defaultMaskAlphaCutoff=.1;b.symbolAlphaCutoff=.001;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl":function(){define(["exports",
"../../shaderModules/interfaces"],function(b,l){b.ColorConversion=function(m){m.code.add(l.glsl`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/ParallelLineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Handles ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ./Object3DVisualElement ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p){y=function(h){function v(n){var B=h.call(this,n)||this;B._handles=new m;B._location=w.create();B._direction=w.fromValues(1,0,0);B._width=1;B._offset=1;B._length=18;B._color=x.fromValues(1,0,1,1);B._renderOccluded=4;B.applyProps(n);return B}l._inheritsLoose(v,h);var E=v.prototype;E.setDirectionFromPoints=function(n,B){k.normalize(this._direction,k.subtract(this._direction,B,n));this.updateGeometry()};E.createExternalResources=function(){const n=new p.RibbonLineMaterial(this.materialParameters);
this._handles.add(this.view.state.watch("camera",()=>{this.updateGeometry()}));this._externalResources={material:n}};E.destroyExternalResources=function(){this._handles.removeAll();this._externalResources=null};E.createGeometries=function(n){const B=t.createPolylineGeometry([w.create(),w.create()]),f=t.createPolylineGeometry([w.create(),w.create()]),D=z.unwrap(this._externalResources).material;n.addGeometry(B,D,A.IDENTITY);n.addGeometry(f,D,A.IDENTITY);this.updateVertices(n)};E.forEachExternalMaterial=
function(n){z.isSome(this._externalResources)&&n(this._externalResources.material)};E.updateMaterial=function(){z.isNone(this._externalResources)||this._externalResources.material.setParameterValues(this.materialParameters)};E.updateGeometry=function(){const n=this.object;z.isNone(n)||this.updateVertices(n)};E.updateVertices=function(n){const B=this.view.state.camera;B.projectToScreen(this.location,d);k.add(q,this.location,this.direction);B.projectToScreen(q,a);g.normalize(a,g.subtract(a,a,d));this.updateVertexAttributes(B,
n,0,d,a,1);this.updateVertexAttributes(B,n,1,d,a,-1)};E.updateVertexAttributes=function(n,B,f,D,H,P){const R=B.geometryRecords[f].geometry.getMutableAttribute("position").data;P=g.scale(c,g.set(c,H[1]*P,H[0]*-P),this.offset+this.width/2);D=g.add(r,g.add(r,g.add(r,D,g.scale(r,H,this.length/2)),P),P);H=g.add(e,D,g.scale(e,H,-this.length));n.unprojectFromScreen(D,q);R[0]=q[0];R[1]=q[1];R[2]=q[2];n.unprojectFromScreen(H,q);R[3]=q[0];R[4]=q[1];R[5]=q[2];B.geometryVertexAttrsUpdated(f)};l._createClass(v,
[{key:"location",get:function(){return this._location},set:function(n){k.exactEquals(this._location,n)||(k.copy(this._location,n),this.updateGeometry())}},{key:"direction",get:function(){return this._direction},set:function(n){k.exactEquals(this._direction,n)||(k.copy(this._direction,n),this.updateGeometry())}},{key:"width",get:function(){return this._width},set:function(n){n!==this._width&&(this._width=n,this.updateMaterial())}},{key:"offset",get:function(){return this._offset},set:function(n){n!==
this._offset&&(this._offset=n,this.updateGeometry())}},{key:"length",get:function(){return this._length},set:function(n){n!==this._length&&(this._length=n,this.updateGeometry())}},{key:"color",get:function(){return this._color},set:function(n){u.exactEquals(n,this._color)||(u.copy(this._color,n),this.updateMaterial())}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(n){n!==this._renderOccluded&&(this._renderOccluded=n,this.updateMaterial())}},{key:"materialParameters",
get:function(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}}]);return v}(y.Object3DVisualElement);const q=w.create(),d=C.createScreenPointArray(),a=C.createScreenPointArray(),c=C.createScreenPointArray(),r=C.createScreenPointArray(),e=C.createScreenPointArray();b.ParallelLineVisualElement=y;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/PointVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./VisualElementResources ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../layers/graphics/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c){let r=function(){function v(n){this._geometry=this.view=null;this._size=3;this._color=k.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=k.fromValues(1,1,1,1);this._elevationInfo=null;this.resources=new y.VisualElementResources({view:n.view,createResources:f=>this.createResources(f),recreateGeometry:(f,D)=>{f.geometry=this.recreateGeometry(D,f.material);return z.isSome(f.geometry)?[f.geometry]:
[]}});let B=!0;for(const f in n)f in this?"attached"===f?B=n[f]:this[f]=n[f]:console.error("Cannot set unknown property",f);this.attached=B}var E=v.prototype;E.destroy=function(){this.resources.destroy()};E.updateMaterial=function(){const n=this.resources.resources;z.isNone(n)||n.material.setParameterValues(this.materialParameters(n.texture.id))};E.updateSizeAttribute=function(){var n=this.resources.resources;const B=this.resources.object;if(!z.isNone(n)&&!z.isNone(B)&&(n=n.geometry,!z.isNone(n))){n=
n.getMutableAttribute("size").data;var f=this.geometrySize;n[0]=f;n[1]=f;B.geometryVertexAttrsUpdated(0)}};E.materialParameters=function(n){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:e,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:n,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}};E.recreateGeometry=function(n,B){const f=this.createRenderGeometry();
z.isSome(f)&&n.addGeometry(f,B);return f};E.createResources=function(n){const B=this.createTexture(),f=new c.HUDMaterial(this.materialParameters(B.id));n=this.recreateGeometry(n,f);return{material:f,texture:B,geometry:n,forEach(D){D(B);D(f);z.isSome(this.geometry)&&D(this.geometry)}}};E.createTexture=function(){const n=this.preferredTextureSize;return new a.Texture(q.createType(this._primitive,n,.5*n),{mipmap:!1,wrap:{s:33071,t:33071},width:n,height:n,components:4,noUnpackFlip:!0})};E.calculateMapBounds=
function(n){if(z.isNone(this.resources.resources)||z.isNone(this.resources.resources.geometry))return!1;const B=this.resources.resources.geometry.vertexAttributes.get("position");w.projectVectorToVector(B.data,this.view.renderCoordsHelper.spatialReference,h,this.view.spatialReference);u.expandWithBuffer(n,h);return!0};E.createRenderGeometry=function(){var n=this.geometry;if(z.isNone(n))return null;const {renderCoordsHelper:B,elevationProvider:f}=this.view;var D=t.evaluateElevationAlignmentAtPoint(n,
f,p.ElevationContext.fromElevationInfo(this.elevationInfo),B);const H=C.set(x.sv3d.get(),n.x,n.y,D);D=x.sv3d.get();w.projectVectorToVector(H,n.spatialReference,D,B.spatialReference);n=this.geometrySize;return d.createPointGeometry(null,D,null,[n,n],[0,0,0,1])};l._createClass(v,[{key:"visible",get:function(){return this.resources.visible},set:function(n){this.resources.visible=n}},{key:"attached",get:function(){return this.resources.attached},set:function(n){this.resources.attached=n}},{key:"geometry",
get:function(){return this._geometry},set:function(n){this._geometry=n;this.resources.recreateGeometry()}},{key:"size",get:function(){return this._size},set:function(n){if(n!==this._size){const B=this.preferredTextureSize;this._size=n;B<this.preferredTextureSize?z.isSome(this.resources)&&this.resources.recreate():this.updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(n){g.exactEquals(n,this._color)||(g.copy(this._color,n),this.updateMaterial())}},{key:"pixelSnappingEnabled",
get:function(){return this._pixelSnappingEnabled},set:function(n){this._pixelSnappingEnabled!==n&&(this._pixelSnappingEnabled=n,this.updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(n){this._primitive!==n&&(this._primitive=n,z.isSome(this.resources)&&this.resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(n){n!==this._outlineSize&&(this._outlineSize=n,this.updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},
set:function(n){g.exactEquals(n,this._outlineColor)||(g.copy(this._outlineColor,n),this.updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(n){this._elevationInfo=n;this.resources&&this.resources.recreateGeometry()}},{key:"geometrySize",get:function(){return this._size/.5}},{key:"preferredTextureSize",get:function(){return m.clamp(m.nextHighestPowerOfTwo(2*this.geometrySize),16,128)}}]);return v}();const e=[.25,.25,.75,.75],h=A.create();b.PointVisualElement=
r;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/VisualElementResources":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/watchUtils ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/WebGLLayer".split(" "),function(b,l,m,z,C,A){let g=function(){function k(u){this.resourceFactory=u;this._resources=null;this._visible=!0;this._attached=!1}var w=k.prototype;w.destroy=function(){this._destroyResources()};
w.recreate=function(){this.attached&&this._createResources()};w.recreateGeometry=function(){if(this.resourceFactory.recreateGeometry){var u=this.resourceFactory.view._stage;if(!m.isNone(this._resources)&&u){var x=this._resources.object;this._resources.external.forEach(y=>{2===y.type&&u.remove(y)});x.removeAllGeometries();x=this.resourceFactory.recreateGeometry(this._resources.external,x,this._resources.layer);u.addMany(x)}}else this.recreate()};w._createOrDestroyResources=function(){this._attached?
this._resources||this._createResources():this._destroyResources()};w._createResources=function(){this._destroyResources();const u=this.resourceFactory.view._stage;if(u){var x=new A.WebGLLayer({isPickable:!1,updatePolicy:1});u.add(x);var y=new C.Object3D({castShadow:!1}),t=this.resourceFactory.createResources(y,x);t.forEach(q=>u.add(q));u.add(y);x.add(y);this._syncVisible();var p=this.resourceFactory.cameraChanged?z.init(this.resourceFactory.view.state,"camera",q=>this.resourceFactory.cameraChanged(q)):
null;this._resources={layer:x,object:y,external:t,cameraHandle:p}}};w._destroyResources=function(){if(!m.isNone(this._resources)){var u=this.resourceFactory.view._stage;null==u?void 0:u.remove(this._resources.object);null==u?void 0:u.remove(this._resources.layer);this._resources.external.forEach(x=>{null==u?void 0:u.remove(x);"dispose"in x&&x.dispose()});this._resources.object.dispose();this._resources.cameraHandle&&this._resources.cameraHandle.remove();this._resources=null}};w._syncVisible=function(){m.isNone(this._resources)||
this._resources.object.setVisible(this._visible)};l._createClass(k,[{key:"object",get:function(){return m.isSome(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return m.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(u){u!==this._visible&&(this._visible=u,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(u){u!==this._attached&&(this._attached=u,this._createOrDestroyResources())}}]);
return k}();b.VisualElementResources=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/elevationAlignmentUtils":function(){define("exports ../../../../core/compilerUtils ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../layers/graphics/dehydratedFeatureUtils ./graphicUtils ../../support/ElevationProvider".split(" "),function(b,l,m,z,C,A,g,k,w,u){function x(d,a,c,r,e){const h=
(k.isDehydratedPoint(d)?d.z:u.isSamplePosition(d)?d.array[d.offset+2]:d[2])||0;switch(c.mode){case "on-the-ground":return c=m.unwrapOr(u.getElevationAtPoint(a,d,"ground"),0),e&&(e.verticalDistanceToGround=0,e.sampledElevation=c),c;case "relative-to-ground":return d=m.unwrapOr(u.getElevationAtPoint(a,d,"ground"),0),c=c.geometryZWithOffset(h,r),e&&(e.verticalDistanceToGround=c,e.sampledElevation=d),c+d;case "relative-to-scene":return d=m.unwrapOr(u.getElevationAtPoint(a,d,"scene"),0),c=c.geometryZWithOffset(h,
r),e&&(e.verticalDistanceToGround=c,e.sampledElevation=d),c+d;case "absolute-height":return c=c.geometryZWithOffset(h,r),e&&(r=m.unwrapOr(u.getElevationAtPoint(a,d,"ground"),0),e.verticalDistanceToGround=c-r,e.sampledElevation=r),c;default:return l.neverReached(c.mode),0}}b.SymbolUpdateType=void 0;(function(d){d[d.NONE=0]="NONE";d[d.UPDATE=1]="UPDATE";d[d.RECREATE=2]="RECREATE"})(b.SymbolUpdateType||(b.SymbolUpdateType={}));const y={"absolute-height":{applyElevationAlignmentBuffer:function(d,a,c,
r,e,h,v,E){h=E.calculateOffsetRenderUnits(v);E=E.featureExpressionInfoContext;a*=3;r*=3;for(v=0;v<e;++v){const n=d[a+1],B=d[a+2];c[r+0]=d[a+0];c[r+1]=n;c[r+2]=null==E?B+h:h;a+=3;r+=3}return 0},requiresAlignment:function(d){const a=d.featureExpressionInfoContext;return 0!==d.meterUnitOffset||null!=a}},"on-the-ground":{applyElevationAlignmentBuffer:function(d,a,c,r,e,h){let v=0;const E=h.spatialReference;a*=3;r*=3;for(let n=0;n<e;++n){const B=d[a+0],f=d[a+1],D=m.unwrapOr(h.getElevation(B,f,d[a+2],E,
"ground"),0);v+=D;c[r+0]=B;c[r+1]=f;c[r+2]=D;a+=3;r+=3}return v/e},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(d,a,c,r,e,h,v,E){let n=0;v=E.calculateOffsetRenderUnits(v);E=E.featureExpressionInfoContext;const B=h.spatialReference;a*=3;r*=3;for(let f=0;f<e;++f){const D=d[a+0],H=d[a+1],P=d[a+2],R=m.unwrapOr(h.getElevation(D,H,P,B,"ground"),0);n+=R;c[r+0]=D;c[r+1]=H;c[r+2]=null==E?P+R+v:R+v;a+=3;r+=3}return n/e},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(d,
a,c,r,e,h,v,E){let n=0;v=E.calculateOffsetRenderUnits(v);E=E.featureExpressionInfoContext;const B=h.spatialReference;a*=3;r*=3;for(let f=0;f<e;++f){const D=d[a+0],H=d[a+1],P=d[a+2],R=m.unwrapOr(h.getElevation(D,H,P,B,"scene"),0);n+=R;c[r+0]=D;c[r+1]=H;c[r+2]=null==E?P+R+v:R+v;a+=3;r+=3}return n/e},requiresAlignment:()=>!0}},t=C.create(),p={verticalDistanceToGround:0,sampledElevation:0},q=A.create();b.applyElevationAlignmentForHUD=function(d,a,c,r,e){c=x(a,c,e,r,p);w.updateVertexAttributeAuxpos1w(d,
p.verticalDistanceToGround);e=p.sampledElevation;const h=z.copy(t,d.transformation);q[0]=a.x;q[1]=a.y;q[2]=c;g.computeLinearTransformation(a.spatialReference,q,h,r.spatialReference)?d.transformation=h:console.warn("Could not locate symbol object properly, it might be misplaced");return e};b.applyPerVertexElevationAlignment=function(d,a,c,r,e,h,v,E,n,B,f){const D=y[f.mode];let H=0;if(g.projectBuffer(d,a,c,r,n.spatialReference,e,E)&&(D.requiresAlignment(f)?(H=D.applyElevationAlignmentBuffer(r,e,h,v,
E,n,B,f),d=h,e=v):d=r,g.projectBuffer(d,n.spatialReference,e,h,B.spatialReference,v,E)))return H};b.elevationModeChangeUpdateType=function(d,a,c){return null==a||null==c?d.definedChanged:"on-the-ground"===a&&"on-the-ground"===c?d.staysOnTheGround:a===c||"on-the-ground"!==a&&"on-the-ground"!==c?b.SymbolUpdateType.UPDATE:d.onTheGroundChanged};b.evaluateElevationAlignmentAtPoint=x;b.needsElevationUpdates2D=function(d){return"relative-to-ground"===d||"relative-to-scene"===d};b.needsElevationUpdates3D=
function(d){return"absolute-height"!==d};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/layers/graphics/dehydratedFeatureUtils":function(){define(["exports"],function(b){b.isDehydratedPoint=function(l){return"point"===l.type};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("exports ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec2f64 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ../../../../layers/graphics/hydratedFeatures".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d){function a(e){var h=e.paths[0];if(!h||0===h.length)return null;h=p.getPointOnPath(h,p.getPathLength(h)/2);return q.makeDehydratedPoint(h[0],h[1],h[2],e.spatialReference)}function c(e,h,v){v=v?e:d.clonePoint(e);return h&&e?u.projectPoint(e,v,h)?v:null:v}function r(e){if(Array.isArray(e)){for(const h of e)if(!r(h))return!1;return!0}return null==e||0<=e}A={"bottom-left":A.fromValues(0,0),bottom:A.fromValues(.5,0),"bottom-right":A.fromValues(1,0),left:A.fromValues(0,
.5),center:A.fromValues(.5,.5),right:A.fromValues(1,.5),"top-left":A.fromValues(0,1),top:A.fromValues(.5,1),"top-right":A.fromValues(1,1)};b.computeCentroid=function(e,h){if("point"===e.type)return c(e,h,!1);if(d.isHydratedGeometry(e))switch(e.type){case "extent":return c(e.center,h,!1);case "polygon":return c(e.centroid,h,!1);case "polyline":return c(a(e),h,!0);case "mesh":return c(e.origin,h,!1)}else switch(e.type){case "extent":var v=l.isFinite(e.zmin);e=q.makeDehydratedPoint(.5*(e.xmax+e.xmin),
.5*(e.ymax+e.ymin),v?.5*(e.zmax+e.zmin):void 0,e.spatialReference);return c(e,h,!0);case "polygon":return(v=e.rings[0])&&0!==v.length?(v=t.ringsCentroid(e.rings,e.hasZ),e=q.makeDehydratedPoint(v[0],v[1],v[2],e.spatialReference)):e=null,c(e,h,!0);case "polyline":return c(a(e),h,!0)}};b.computeObjectRotation=function(e,h,v,E=C.create()){e=e||0;h=h||0;v=v||0;0!==e&&z.rotateZ(E,E,-e/180*Math.PI);0!==h&&z.rotateX(E,E,h/180*Math.PI);0!==v&&z.rotateY(E,E,v/180*Math.PI);return E};b.computeObjectScale=function(e=
g.ONES,h,v,E=1){const n=Array(3);if(m.isNone(h)||m.isNone(v))n[0]=1,n[1]=1,n[2]=1;else{let f=0;for(let D=2;0<=D;D--){const H=e[D];let P;const R=null!=H,K=0===D&&!B&&!R,J=v[D];"symbol-value"===H||K?P=0!==J?h[D]/J:1:R&&"proportional"!==H&&isFinite(H)&&(P=0!==J?H/J:1);if(null!=P){var B=n[D]=P;f=Math.max(f,Math.abs(P))}}for(e=2;0<=e;e--)null==n[e]?n[e]=B:0===n[e]&&(n[e]=.001*f)}for(B=2;0<=B;B--)n[B]/=E;return g.fromArray(n)};b.demResolutionForBoundingBox=function(e,h){return null!=h.minDemResolution?
h.minDemResolution:x.isPoint(e)?h.minDemResolutionForPoints:.01*x.maximumDimension(e)};b.enlargeExtent=function(e,h,v,E=0){if(e){h||(h=y.create());let n=.5*e.width*(v-1);v=.5*e.height*(v-1);e.width<1E-7*e.height?n+=v/20:e.height<1E-7*e.width&&(v+=n/20);k.set(h,e.xmin-n-E,e.ymin-v-E,e.xmax+n+E,e.ymax+v+E);return h}return null};b.isValidSize=r;b.mixinColorAndOpacity=function(e,h){const v=w.clone(w.ONES);m.isSome(e)&&(v[0]=e[0],v[1]=e[1],v[2]=e[2]);m.isSome(h)?v[3]=h:m.isSome(e)&&3<e.length&&(v[3]=e[3]);
return v};b.namedAnchorToHUDMaterialAnchorPos=A;b.overrideColor=function(e,h,v,E,n,B=[0,0,0,0]){for(let f=0;3>f;++f)m.isSome(e)&&null!=e[f]?B[f]=e[f]:m.isSome(v)&&null!=v[f]?B[f]=v[f]:B[f]=n[f];m.isSome(h)?B[3]=h:m.isSome(E)?B[3]=E:B[3]=n[3];return B};b.updateVertexAttributeAuxpos1w=function(e,h){for(let v=0;v<e.geometries.length;++v){const E=e.geometries[v].getMutableAttribute("auxpos1");E&&E.data[3]!==h&&(E.data[3]=h,e.geometryVertexAttrsUpdated(v))}};b.validateSymbolLayerSize=function(e){null!=
e.isPrimitive&&(e=[e.width,e.depth,e.height]);return r(e)?null:"Symbol sizes may not be negative values"};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/layers/graphics/hydratedFeatures":function(){define("exports ../../Graphic ../../core/has ../../core/lang ../../core/maybe ../../core/typedArrayUtil ../../geometry/support/jsonUtils ./dehydratedFeatures".split(" "),function(b,l,m,z,C,A,g,k){function w(c){return"declaredClass"in c}function u(c){return"declaredClass"in c}function x(c){return"declaredClass"in
c}function y(c){return C.isNone(c)?null:w(c)?c:g.fromJSON(t(c))}function t(c){const r=c.spatialReference.toJSON();switch(c.type){case "point":{const {x:e,y:h,z:v,m:E}=c;return{x:e,y:h,z:v,m:E,spatialReference:r}}case "polygon":{const {rings:e,hasZ:h,hasM:v}=c;return{rings:p(e),hasZ:h,hasM:v,spatialReference:r}}case "polyline":{const {paths:e,hasZ:h,hasM:v}=c;return{paths:p(e),hasZ:h,hasM:v,spatialReference:r}}case "extent":{const {xmin:e,xmax:h,ymin:v,ymax:E,zmin:n,zmax:B,mmin:f,mmax:D,hasZ:H,hasM:P}=
c;return{xmin:e,xmax:h,ymin:v,ymax:E,zmin:n,zmax:B,mmin:f,mmax:D,hasZ:H,hasM:P,spatialReference:r}}case "multipoint":{const {points:e,hasZ:h,hasM:v}=c;return{points:a(e)?q(e):e,hasZ:h,hasM:v,spatialReference:r}}}}function p(c){return d(c)?c.map(r=>q(r)):c}function q(c){return c.map(r=>A.toArray(r))}function d(c){for(const r of c)if(0!==r.length)return a(r);return!1}function a(c){return c.length&&(A.isFloat32Array(c[0])||A.isFloat64Array(c[0]))}b.clonePoint=function(c,r){if(!c)return null;if(u(c)){if(null==
r)return c.clone();if(u(r))return r.copy(c)}null!=r?(r.x=c.x,r.y=c.y,r.spatialReference=c.spatialReference,c.hasZ?(r.z=c.z,r.hasZ=c.hasZ):(r.z=null,r.hasZ=!1),c.hasM?(r.m=c.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=k.makeDehydratedPoint(c.x,c.y,c.z,c.spatialReference),c.hasM&&(r.m=c.m,r.hasM=!0));return r};b.hydrateGeometry=y;b.hydrateGraphic=function(c,r){if(!c)return null;if(x(c))return c;r=new l({layer:r,sourceLayer:r});r.visible=c.visible;r.symbol=z.clone(c.symbol);r.attributes=z.clone(c.attributes);
r.geometry=y(c.geometry);return r};b.isHydratedGeometry=w;b.isHydratedGraphic=x;b.isHydratedPoint=u;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/support/ElevationProvider":function(){define(["exports","../../../core/maybe","../../../layers/graphics/dehydratedFeatureUtils"],function(b,l,m){function z(C){return"array"in C}b.SamplePosition=function(C,A=null,g=0){this.array=C;this.spatialReference=A;this.offset=g};b.getElevationAtPoint=function(C,A,g="ground"){if(m.isDehydratedPoint(A))return C.getElevation(A.x,
A.y,A.z||0,A.spatialReference,g);if(z(A)){let k=A.offset;return C.getElevation(A.array[k++],A.array[k++],A.array[k]||0,l.unwrapOr(A.spatialReference,C.spatialReference),g)}return C.getElevation(A[0],A[1],A[2]||0,C.spatialReference,g)};b.isSamplePosition=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/ElevationContext":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../symbols/support/unitConversionUtils",
"./featureExpressionInfoUtils"],function(b,l,m,z,C){let A=function(){function g(){this._renderUnitOffset=this._meterUnitOffset=0;this._unit="meters";this._metersPerElevationInfoUnit=1;this.mode=this.centerPointInElevationSR=this._featureExpressionInfoContext=null}var k=g.prototype;k.reset=function(){this.mode=null;this._renderUnitOffset=this._meterUnitOffset=0;this._featureExpressionInfoContext=null;this.unit="meters"};k.addOffsetRenderUnits=function(w){this._renderUnitOffset+=w};k.geometryZWithOffset=
function(w,u){u=this.calculateOffsetRenderUnits(u);return null!=this.featureExpressionInfoContext?u:w+u};k.calculateOffsetRenderUnits=function(w){let u=this._meterUnitOffset;const x=this.featureExpressionInfoContext;null!=x&&(u+=C.execute(x)*this._metersPerElevationInfoUnit);return u/w.unitInMeters+this._renderUnitOffset};k.setFromElevationInfo=function(w){this.mode=w.mode;this.unit=z.supportsUnit(w.unit)?w.unit:"meters";this.offsetElevationInfoUnits=m.unwrapOr(w.offset,0)};k.updateFeatureExpressionInfoContext=
function(w,u,x){if(m.isNone(w))this._featureExpressionInfoContext=null;else{var y=w&&w.arcade;y&&m.isSome(u)&&m.isSome(x)?(this._featureExpressionInfoContext=C.clone(w),C.setContextFeature(this._featureExpressionInfoContext,C.createFeature(y.modules,u,x))):this._featureExpressionInfoContext=w}};g.fromElevationInfo=function(w){const u=new g;m.isSome(w)&&u.setFromElevationInfo(w);return u};l._createClass(g,[{key:"featureExpressionInfoContext",get:function(){return this._featureExpressionInfoContext}},
{key:"meterUnitOffset",get:function(){return this._meterUnitOffset}},{key:"unit",get:function(){return this._unit},set:function(w){this._unit=w;this._metersPerElevationInfoUnit=z.getMetersPerUnit(w)}},{key:"offsetMeters",set:function(w){this._meterUnitOffset=w;this._renderUnitOffset=0}},{key:"offsetElevationInfoUnits",set:function(w){this._meterUnitOffset=w*this._metersPerElevationInfoUnit;this._renderUnitOffset=0}}]);return g}();b.ElevationContext=A;Object.defineProperty(b,"__esModule",{value:!0})})},
"esri/views/3d/layers/graphics/featureExpressionInfoUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/Logger","../../../../layers/graphics/hydratedFeatures","../../../../support/arcadeOnDemand"],function(b,l,m,z,C){function A(){A=l._asyncToGenerator(function*(k,w,u){k=k&&k.expression;if("string"!==typeof k)return null;var x="0"===k?0:null;if(null!=x)return{cachedResult:x};x=yield C.loadArcade();const y=x.arcadeUtils;k=y.createSyntaxTree(k);return y.dependsOnView(k)?
(null!=u&&u.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:y.createFunction(k),context:y.createExecContext(null,{sr:w}),modules:x}}});return A.apply(this,arguments)}const g=m.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");b.clone=function(k){return{cachedResult:k.cachedResult,arcade:k.arcade?{func:k.arcade.func,context:k.arcade.modules.arcadeUtils.createExecContext(null,{sr:k.arcade.context.spatialReference}),modules:k.arcade.modules}:
null}};b.createContext=function(k,w,u){return A.apply(this,arguments)};b.createContextWithoutExpressionSupport=function(k){k=k&&k.expression;return"string"===typeof k&&(k="0"===k?0:null,null!=k)?{cachedResult:k}:null};b.createFeature=function(k,w,u){return k.arcadeUtils.createFeature(w.attributes,w.geometry,u)};b.execute=function(k){if(null!=k){if(null!=k.cachedResult)return k.cachedResult;var w=k.arcade;w=k.arcade.modules.arcadeUtils.executeFunction(w.func,w.context);"number"!==typeof w&&(w=k.cachedResult=
0);return w}return 0};b.extractExpressionInfo=function(k,w=!1){const u=(k=k&&k.featureExpressionInfo)&&k.expression;w||"0"===u||(k=null);return k};b.setContextFeature=function(k,w){null!=k&&null==k.cachedResult&&(w&&k.arcade?(w._geometry&&(w._geometry=z.hydrateGeometry(w._geometry)),k.arcade.modules.arcadeUtils.updateExecContext(k.arcade.context,w)):g.errorOncePerTick("Arcade support required but not provided"))};b.zeroContext={cachedResult:0};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/layers/graphics/sdfPrimitives":function(){define(["exports",
"../../../../core/has","../../webgl-engine/lib/Util"],function(b,l,m){function z(y,t){const p=new Uint8Array(4*y*y),q=y/2-.5;t/=2;for(let a=0;a<y;a++)for(let c=0;c<y;c++){const r=c+y*a;var d=c-q;const e=a-q;d=Math.sqrt(d*d+e*e)-t;d=d/y+.5;m.packFloatRGBA(d,p,4*r)}return p}function C(y,t){return u(y,t,!1)}function A(y,t){return u(y,t,!0)}function g(y,t){return x(y,t,!1)}function k(y,t){return x(y,t,!0)}function w(y,t){const p=new Uint8Array(4*y*y),q=Math.sqrt(1.25),d=(y-t)/2;for(let a=0;a<y;a++)for(let c=
0;c<y;c++){const r=(c-d)/t,e=(a-d+.75)/t;m.packFloatRGBA(Math.max(-(1*r+-.5*e)/q,(r-1+-.5*-e)/q,-e)*t/y+.5,p,4*(a*y+c))}return p}function u(y,t,p){p&&(t/=Math.SQRT2);const q=new Uint8Array(4*y*y);for(let a=0;a<y;a++)for(let c=0;c<y;c++){var d=c-.5*y+.25;let r=-a+.5*y-.75;const e=a*y+c;if(p){const h=(d+r)/Math.SQRT2;r=(r-d)/Math.SQRT2;d=h}d=Math.max(Math.abs(d),Math.abs(r))-.5*t;d=d/y+.5;m.packFloatRGBA(d,q,4*e)}return q}function x(y,t,p){p&&(t*=Math.SQRT2);t*=.5;const q=new Uint8Array(4*y*y);for(let a=
0;a<y;a++)for(let c=0;c<y;c++){var d=c-.5*y;let r=-a+.5*y-1;const e=a*y+c;if(p){const h=(d+r)/Math.SQRT2;r=(r-d)/Math.SQRT2;d=h}d=Math.abs(d);r=Math.abs(r);d=d>r?d>t?Math.sqrt((d-t)*(d-t)+r*r):r:r>t?Math.sqrt(d*d+(r-t)*(r-t)):d;d=d/y+.5;m.packFloatRGBA(d,q,4*e)}return q}b.createCircle=z;b.createCross=g;b.createKite=A;b.createSquare=C;b.createTriangle=w;b.createType=function(y,t,p){switch(y){case "circle":return z(t,p);case "square":return C(t,p);case "cross":return g(t,p);case "x":return k(t,p);case "kite":return A(t,
p);case "triangle":return w(t,p);default:return z(t,p)}};b.createX=k;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/compilerUtils ../../../../core/Error ../../../../core/Evented ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/typedArrayUtil ../../../../core/urlUtils ../../../../support/requestImageUtils ../../../../support/requestUtils ./BasisUtil ./ContentObject ./DDSUtil ./glUtil3D ./Util ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/capabilities/isWebGL2Context".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h){p=function(v){function E(B,f){var D=v.call(this)||this;D.data=B;D.type=4;D.glTexture=null;D.powerOfTwoStretchInfo=null;D.loadingPromise=null;D.loadingController=null;D.events=new C;D.params=f||{};D.params.mipmap=!1!==D.params.mipmap;D.params.noUnpackFlip=D.params.noUnpackFlip||!1;D.params.preMultiplyAlpha=D.params.preMultiplyAlpha||!1;D.params.wrap=D.params.wrap||{s:10497,t:10497};D.params.powerOfTwoResizeMode=D.params.powerOfTwoResizeMode||1;D.estimatedTexMemRequired=
E.estimateTexMemRequired(D.data,D.params);D.startPreload();return D}l._inheritsLoose(E,v);var n=E.prototype;n.startPreload=function(){const B=this.data;g.isNone(B)||(B instanceof HTMLVideoElement?this.startPreloadVideoElement(B):B instanceof HTMLImageElement&&this.startPreloadImageElement(B))};n.startPreloadVideoElement=function(B){u.isBlobProtocol(B.src)||"auto"===B.preload&&B.crossOrigin||(B.preload="auto",B.crossOrigin="anonymous",B.src=B.src)};n.startPreloadImageElement=function(B){u.isDataProtocol(B.src)||
u.isBlobProtocol(B.src)||B.crossOrigin||(B.crossOrigin="anonymous",B.src=B.src)};E.getDataDimensions=function(B){return B instanceof HTMLVideoElement?{width:B.videoWidth,height:B.videoHeight}:B};E.estimateTexMemRequired=function(B,f){if(g.isNone(B))return 0;if(w.isArrayBuffer(B)||w.isUint8Array(B))return f.encoding===E.KTX2_ENCODING?t.estimateMemoryKTX2(B,f.mipmap):f.encoding===E.BASIS_ENCODING?t.estimateMemoryBasis(B,f.mipmap):B.byteLength;const {width:D,height:H}=B instanceof Image||B instanceof
ImageData||B instanceof HTMLCanvasElement||B instanceof HTMLVideoElement?E.getDataDimensions(B):f;return(f.mipmap?4/3:1)*D*H*(f.components||4)||0};n.dispose=function(){this.data=void 0};n.createDescriptor=function(B){var f;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(f=this.params.maxAnisotropy)?f:
this.params.mipmap?B.parameters.maxMaxAnisotropy:1}};n.load=function(B,f){if(g.isSome(this.glTexture))return this.glTexture;if(g.isSome(this.loadingPromise))return this.loadingPromise;const D=this.data;return g.isNone(D)?this.glTexture=new r(B,this.createDescriptor(B),null):"string"===typeof D?this.loadFromURL(B,f,D):D instanceof Image?this.loadFromImageElement(B,f,D):D instanceof HTMLVideoElement?this.loadFromVideoElement(B,f,D):D instanceof ImageData||D instanceof HTMLCanvasElement?this.loadFromImage(B,
D,f):(w.isArrayBuffer(D)||w.isUint8Array(D))&&this.params.encoding===E.DDS_ENCODING?this.loadFromDDSData(B,D):(w.isArrayBuffer(D)||w.isUint8Array(D))&&this.params.encoding===E.KTX2_ENCODING?this.loadFromKTX2(B,D):(w.isArrayBuffer(D)||w.isUint8Array(D))&&this.params.encoding===E.BASIS_ENCODING?this.loadFromBasis(B,D):w.isUint8Array(D)?this.loadFromPixelData(B,D):w.isArrayBuffer(D)?this.loadFromPixelData(B,new Uint8Array(D)):null};n.frameUpdate=function(B,f,D){if(!(this.data instanceof HTMLVideoElement)||
g.isNone(this.glTexture)||2>this.data.readyState||D===this.data.currentTime)return D;if(g.isSome(this.powerOfTwoStretchInfo)){const {framebuffer:H,vao:P,sourceTexture:R}=this.powerOfTwoStretchInfo;R.setData(this.data);this.drawStretchedTexture(B,f,H,P,R,this.glTexture)}else{const {width:H,height:P}=this.data,{width:R,height:K}=this.glTexture.descriptor;H!==R||P!==K?this.glTexture.updateData(0,0,0,Math.min(H,R),Math.min(P,K),this.data):this.glTexture.setData(this.data)}this.glTexture.descriptor.hasMipmap&&
this.glTexture.generateMipmap();return this.data.currentTime};n.loadFromDDSData=function(B,f){return this.glTexture=q.createDDSTexture(B,this.createDescriptor(B),f)};n.loadFromKTX2=function(B,f){return this.loadAsync(()=>t.createTextureKTX2(B,this.createDescriptor(B),f).then(D=>this.glTexture=D))};n.loadFromBasis=function(B,f){return this.loadAsync(()=>t.createTextureBasis(B,this.createDescriptor(B),f).then(D=>this.glTexture=D))};n.loadFromPixelData=function(B,f){a.assert(0<this.params.width&&0<this.params.height);
const D=this.createDescriptor(B);D.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408;D.width=this.params.width;D.height=this.params.height;return this.glTexture=new r(B,D,f)};n.loadAsync=function(B){const f=k.createAbortController();this.loadingController=f;const D=B(f.signal);this.loadingPromise=D;B=()=>{this.loadingController===f&&(this.loadingController=null);this.loadingPromise===D&&(this.loadingPromise=null)};D.then(B,B);return D};n.loadFromURL=function(B,f,D){var H=
this;return this.loadAsync(function(){var P=l._asyncToGenerator(function*(R){R=yield x.requestImage(D,{signal:R});return H.loadFromImage(B,R,f)});return function(R){return P.apply(this,arguments)}}())};n.loadFromImageElement=function(B,f,D){var H=this;return D.complete?this.loadFromImage(B,D,f):this.loadAsync(function(){var P=l._asyncToGenerator(function*(R){R=yield y.loadImageAsync(D,D.src,!1,R);return H.loadFromImage(B,R,f)});return function(R){return P.apply(this,arguments)}}())};n.loadFromVideoElement=
function(B,f,D){return 2<=D.readyState?this.loadFromImage(B,D,f):this.loadFromVideoElementAsync(B,f,D)};n.loadFromVideoElementAsync=function(B,f,D){return this.loadAsync(H=>new Promise((P,R)=>{const K=()=>{D.removeEventListener("loadeddata",J);D.removeEventListener("error",Q);g.isSome(F)&&F.remove()},J=()=>{2<=D.readyState&&(K(),P(this.loadFromImage(B,D,f)))},Q=O=>{K();R(O||new z("Failed to load video"))};D.addEventListener("loadeddata",J);D.addEventListener("error",Q);const F=k.onAbort(H,()=>Q(k.createAbortError()))}))};
n.loadFromImage=function(B,f,D){const H=E.getDataDimensions(f);this.params.width=H.width;this.params.height=H.height;const P=this.createDescriptor(B);P.pixelFormat=3===this.params.components?6407:6408;if(this.requiresPowerOfTwo(B,P)&&(!A.isPowerOfTwo(H.width)||!A.isPowerOfTwo(H.height)))return this.glTexture=this.makePowerOfTwoTexture(B,f,H,P,D);P.width=H.width;P.height=H.height;return this.glTexture=new r(B,P,f)};n.requiresPowerOfTwo=function(B,f){const D="number"===typeof f.wrapMode?33071===f.wrapMode:
33071===f.wrapMode.s&&33071===f.wrapMode.t;return!h(B.gl)&&(f.hasMipmap||!D)};n.makePowerOfTwoTexture=function(B,f,D,H,P){const {width:R,height:K}=D;D=A.nextHighestPowerOfTwo(R);const J=A.nextHighestPowerOfTwo(K);H.width=D;H.height=J;let Q;switch(this.params.powerOfTwoResizeMode){case 2:H.textureCoordinateScaleFactor=[R/D,K/J];Q=new r(B,H);Q.updateData(0,0,0,R,K,f);break;case 1:case null:case void 0:Q=this.stretchToPowerOfTwo(B,f,H,P);break;default:m.neverReached(this.params.powerOfTwoResizeMode)}H.hasMipmap&&
Q.generateMipmap();return Q};n.stretchToPowerOfTwo=function(B,f,D,H){const P=new r(B,D),R=new c(B,{colorTarget:0,depthStencilTarget:0},P);f=new r(B,{target:3553,pixelFormat:D.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!D.flipped,maxAnisotropy:8,preMultiplyAlpha:D.preMultiplyAlpha},f);D=d.createQuadVAO(B);this.drawStretchedTexture(B,H,R,D,f,P);this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:D,sourceTexture:f,framebuffer:R}:(D.dispose(!0),f.dispose(),R.detachColorTexture(),
B.bindFramebuffer(null),R.dispose());return P};n.drawStretchedTexture=function(B,f,D,H,P,R){B.bindFramebuffer(D);D=B.getViewport();B.setViewport(0,0,R.descriptor.width,R.descriptor.height);R=f.program;B.useProgram(R);R.setUniform4f("color",1,1,1,1);R.bindTexture(P,"tex");B.bindVAO(H);B.setPipelineState(f.pipeline);B.drawArrays(5,0,e.vertexCount(H,"geometry"));B.bindFramebuffer(null);B.setViewport(D.x,D.y,D.width,D.height)};n.unload=function(){if(g.isSome(this.powerOfTwoStretchInfo)){const {framebuffer:B,
vao:f,sourceTexture:D}=this.powerOfTwoStretchInfo;f.dispose(!0);D.dispose();B.dispose();this.powerOfTwoStretchInfo=this.glTexture=null}g.isSome(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null);if(g.isSome(this.loadingController)){const B=this.loadingController;this.loadingPromise=this.loadingController=null;B.abort()}this.events.emit("unloaded")};l._createClass(E,[{key:"width",get:function(){return this.params.width}},{key:"height",get:function(){return this.params.height}},{key:"requiresFrameUpdates",
get:function(){return this.data instanceof HTMLVideoElement}}]);return E}(p.ContentObject);p.DDS_ENCODING="image/vnd-ms.dds";p.KTX2_ENCODING="image/ktx2";p.BASIS_ENCODING="image/x.basis";b.Texture=p;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(b,l,m){function z(){z=l._asyncToGenerator(function*(C,A){({data:C}=yield m(C,{responseType:"image",...A}));return C});return z.apply(this,
arguments)}b.requestImage=function(C,A){return z.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/BasisUtil":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../libs/basisu/BasisU ../../../webgl/Texture ../../../webgl/Util".split(" "),function(b,l,m,z,C,A){function g(){return k.apply(this,arguments)}function k(){k=l._asyncToGenerator(function*(){m.isNone(d)&&(d=z.getBasisTranscoder(),q=
yield d);return d});return k.apply(this,arguments)}function w(a,c,r,e,h){c=A.getBytesPerElementFormat(c?37496:37492);return Math.ceil(r*e*c*(h&&1<a?(4**a-1)/(3*4**(a-1)):1))}function u(a){return 1<=a.getNumImages()&&!a.isUASTC()}function x(a){return 1<=a.getFaces()&&a.isETC1S()}function y(){y=l._asyncToGenerator(function*(a,c,r){m.isNone(q)&&(q=yield g());const e=new q.BasisFile(new Uint8Array(r));if(!u(e))return null;e.startTranscoding();a=p(a,c,e.getNumLevels(0),e.getHasAlpha(),e.getImageWidth(0,
0),e.getImageHeight(0,0),(h,v)=>e.getImageTranscodedSizeInBytes(0,h,v),(h,v,E)=>e.transcodeImage(E,0,h,v,0,0));e.close();e.delete();return a});return y.apply(this,arguments)}function t(){t=l._asyncToGenerator(function*(a,c,r){m.isNone(q)&&(q=yield g());const e=new q.KTX2File(new Uint8Array(r));if(!x(e))return null;e.startTranscoding();a=p(a,c,e.getLevels(),e.getHasAlpha(),e.getWidth(),e.getHeight(),(h,v)=>e.getImageTranscodedSizeInBytes(h,0,0,v),(h,v,E)=>e.transcodeImage(E,h,0,0,v,0,-1,-1));e.close();
e.delete();return a});return t.apply(this,arguments)}function p(a,c,r,e,h,v,E,n){const {compressedTextureETC:B,compressedTextureS3TC:f}=a.capabilities,[D,H]=B?e?[1,37496]:[0,37492]:f?e?[3,33779]:[2,33776]:[13,6408];e=c.hasMipmap?r:Math.min(1,r);r=[];for(let P=0;P<e;P++)r.push(new Uint8Array(E(P,D))),n(P,D,r[P]);E=1<r.length;return new C(a,{...c,samplingMode:E?9987:9729,hasMipmap:E,internalFormat:H,width:h,height:v},{type:"compressed",levels:r})}let q=null,d=null;b.createTextureBasis=function(a,c,
r){return y.apply(this,arguments)};b.createTextureKTX2=function(a,c,r){return t.apply(this,arguments)};b.estimateMemoryBasis=function(a,c){if(m.isNone(q))return a.byteLength;a=new q.BasisFile(new Uint8Array(a));c=u(a)?w(a.getNumLevels(0),a.getHasAlpha(),a.getImageWidth(0,0),a.getImageHeight(0,0),c):0;a.close();a.delete();return c};b.estimateMemoryKTX2=function(a,c){if(m.isNone(q))return a.byteLength;a=new q.KTX2File(new Uint8Array(a));c=x(a)?w(a.getLevels(),a.getHasAlpha(),a.getWidth(),a.getHeight(),
c):0;a.close();a.delete();return c};b.loadBasis=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/libs/basisu/BasisU":function(){define(["require","exports","../../assets","../../core/maybe"],function(b,l,m,z){let C;l.getBasisTranscoder=function(){if(z.isNone(C)){const A=g=>m.getAssetUrl(`esri/libs/basisu/${g}`);C=(new Promise(function(g,k){b(["../../chunks/basis_transcoder"],g,k)})).then(function(g){return g.basis_transcoder}).then(({default:g})=>g({locateFile:A}).then(k=>{k.initializeBasis();
delete k.then;return k}))}return C};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["exports","../../../../core/Logger","../../../../core/mathUtils","../../../webgl/Texture"],function(b,l,m,z){function C(x){return x.charCodeAt(0)+(x.charCodeAt(1)<<8)+(x.charCodeAt(2)<<16)+(x.charCodeAt(3)<<24)}function A(x,y){var t=new Int32Array(x,0,31);if(542327876!==t[0])return g.error("Invalid magic number in DDS header"),null;if(!(t[20]&4))return g.error("Unsupported format, must contain a FourCC code"),
null;var p=t[21];let q;switch(p){case k:p=8;q=33776;break;case w:p=16;q=33778;break;case u:p=16;q=33779;break;default:return g.error("Unsupported FourCC code:",String.fromCharCode(p&255,p>>8&255,p>>16&255,p>>24&255)),null}let d=1,a=t[4],c=t[3];if(0!==(a&3)||0!==(c&3))g.warn("Rounding up compressed texture size to nearest multiple of 4."),a=a+3&-4,c=c+3&-4;const r=a,e=c;t[2]&131072&&!1!==y&&(d=Math.max(1,t[7]));1===d||m.isPowerOfTwo(a)&&m.isPowerOfTwo(c)||(g.warn("Ignoring mipmaps of non power of two sized compressed texture."),
d=1);let h=t[1]+4;const v=[];for(let E=0;E<d;++E)t=(a+3>>2)*(c+3>>2)*p,y=new Uint8Array(x,h,t),v.push(y),h+=t,a=Math.max(1,a>>1),c=Math.max(1,c>>1);return{textureData:{type:"compressed",levels:v},internalFormat:q,width:r,height:e}}const g=l.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),k=C("DXT1"),w=C("DXT3"),u=C("DXT5");b.createDDSTexture=function(x,y,t){const {textureData:p,internalFormat:q,width:d,height:a}=A(t,y.hasMipmap);y.samplingMode=1<p.levels.length?9987:9729;y.hasMipmap=1<p.levels.length;
y.internalFormat=q;y.width=d;y.height=a;return new z(x,y,p)};b.createDDSTextureData=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/webgl/FramebufferObject":function(){define("../../chunks/_rollupPluginBabelHelpers ../../core/Logger ./enums ./Renderbuffer ./RenderingContext ./Texture ./Util".split(" "),function(b,l,m,z,C,A,g){function k(x){return"type"in x&&"texture"===x.type}function w(x,y){void 0!==y.width&&0<=y.width&&void 0!==y.height&&0<=y.height?y.width===x.width&&y.height===
x.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(y.width=x.width,y.height=x.height)}const u=l.getLogger("esri.views.webgl.FrameBufferObject");l=function(){function x(t,p,q,d){this._context=t;this._stencilAttachment=this._depthAttachment=this._glName=null;this._colorAttachments=new Map;this._initialized=!1;this._desc={...p};t.instanceCounter.increment(m.ResourceType.Framebuffer,this);if(q)for(Array.isArray(q)||(q=[q]),p=0;p<q.length;++p){var a;const r=q[p];let e;k(r)?
(e=r.descriptor,this._colorAttachments.set(36064+p,r)):(e=r,this._colorAttachments.set(36064+p,new A(t,r)));0!==(null==(a=this._desc)?void 0:a.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!");this._validateColorAttachmentPoint(36064+p);this._validateTextureDimensions(e,this._desc)}if(d instanceof z){var c;t=null!=(c=this._desc.depthStencilTarget)?c:3;2===t?this._stencilAttachment=d:1===t||3===t?this._depthAttachment=
d:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER');w(d.descriptor,this._desc)}else if(d){this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");let r;k(d)?(this._depthStencilTexture=d,r=d.descriptor):this._depthStencilTexture=new A(this._context,d);this._validateTextureDimensions(r,
this._desc)}}var y=x.prototype;y.dispose=function(){if(this._desc){var t=this._context.getBoundFramebufferObject();this._disposeColorAttachments();this._disposeDepthStencilAttachments();this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null);this._context.bindFramebuffer(t);this._context.instanceCounter.decrement(m.ResourceType.Framebuffer,this);this._desc=null}};y.getColorTexture=function(t){return(t=this._colorAttachments.get(t))&&k(t)?t:null};y.attachColorTexture=function(t,
p=36064){if(t){this._validateColorAttachmentPoint(p);this._validateTextureDimensions(t.descriptor,this._desc);this._disposeColorAttachments();if(this._initialized){this._context.bindFramebuffer(this);const q=this._context.gl;q.framebufferTexture2D(q.FRAMEBUFFER,p,q.TEXTURE_2D,t.glName,0)}this._colorAttachments.set(p,t)}};y.detachColorTexture=function(t=36064){const p=this._colorAttachments.get(t);if(k(p)){if(this._initialized){this._context.bindFramebuffer(this);const q=this._context.gl;q.framebufferTexture2D(q.FRAMEBUFFER,
t,q.TEXTURE_2D,null,0)}this._colorAttachments.delete(t);return p}};y.attachDepthStencilTexture=function(t){if(t){var p=t.descriptor;34041!==p.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==p.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");
this._validateTextureDimensions(p,this._desc);this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),p=this._context.gl,p.framebufferTexture2D(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.TEXTURE_2D,t.glName,0));this._depthStencilTexture=t}};y.detachDepthStencilTexture=function(){const t=this._depthStencilTexture;if(t&&this._initialized){this._context.bindFramebuffer(this);
const p=this._context.gl;this._context.gl.framebufferTexture2D(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return t};y.attachDepthStencilBuffer=function(t){if(t){var p=t.descriptor;34041!==p.internalFormat&&33189!==p.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");w(p,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===p.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),
p=this._context.gl,p.framebufferRenderbuffer(p.FRAMEBUFFER,1===this._desc.depthStencilTarget?p.DEPTH_ATTACHMENT:p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,t.glName));this._depthAttachment=t}};y.detachDepthStencilBuffer=function(){const t=this._context.gl,p=this._depthAttachment;p&&this._initialized&&(this._context.bindFramebuffer(this),t.framebufferRenderbuffer(t.FRAMEBUFFER,1===this._desc.depthStencilTarget?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,null));this._depthAttachment=
null;return p};y.detachAll=function(){this.detachColorTexture();this.detachDepthStencilBuffer();this.detachDepthStencilTexture()};y.copyToTexture=function(t,p,q,d,a,c,r){(0>t||0>p||0>a||0>c)&&console.error("Offsets cannot be negative!");(0>=q||0>=d)&&console.error("Copy width and height must be greater than zero!");var e=this._desc;const h=r.descriptor;3553!==r.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(t+q>e.width||p+d>e.height||a+q>h.width||c+d>h.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");
e=this._context;r=e.bindTexture(r,A.TEXTURE_UNIT_FOR_UPDATES);e.bindFramebuffer(this);e.gl.copyTexSubImage2D(3553,0,a,c,t,p,q,d);e.bindTexture(r,A.TEXTURE_UNIT_FOR_UPDATES)};y.readPixels=function(t,p,q,d,a,c,r){(0>=q||0>=d)&&console.error("Copy width and height must be greater than zero!");r||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(t,p,q,d,a,c,r)};y.resize=function(t,p){const q=this._desc;if(q.width!==t||q.height!==p)if(this._initialized){q.width=
t;q.height=p;this._colorAttachments.forEach(d=>{d&&d.resize(t,p)});if(null!=this._depthStencilTexture)this._depthStencilTexture.resize(t,p);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(t,p),this._stencilAttachment&&this._stencilAttachment.resize(t,p);this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null);this._initialized=!1}else q.width=t,q.height=p,this._colorAttachments.forEach(d=>{d&&d.resize(t,p)}),this._depthStencilTexture&&
this._depthStencilTexture.resize(t,p)};y.initializeAndBind=function(){var t,p,q,d;const a=this._context.gl;if(this._initialized)a.bindFramebuffer(a.FRAMEBUFFER,this.glName);else{this._glName&&a.deleteFramebuffer(this._glName);var c=this._context,r=a.createFramebuffer(),e=this._desc,h=null!=(t=e.colorTarget)?t:1;t=null!=(p=e.width)?p:1;p=null!=(q=e.height)?q:1;a.bindFramebuffer(a.FRAMEBUFFER,r);0===this._colorAttachments.size&&(0===h?this._colorAttachments.set(36064,new A(c,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height})):(q=new z(c,{internalFormat:32854,width:t,height:p}),this._colorAttachments.set(36064,q)));this._colorAttachments.forEach((v,E)=>{v&&(k(v)?a.framebufferTexture2D(a.FRAMEBUFFER,E,a.TEXTURE_2D,v.glName,0):a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,v.glName))});q=null!=(d=e.depthStencilTarget)?d:0;switch(q){case 1:case 3:this._depthAttachment||(this._depthAttachment=new z(c,{internalFormat:1===
e.depthStencilTarget?33189:34041,width:t,height:p}));a.framebufferRenderbuffer(a.FRAMEBUFFER,1===q?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new z(c,{internalFormat:36168,width:t,height:p}));a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(c.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
this._depthStencilTexture=new A(c,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:t,height:p})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}C.webglValidateShadersEnabled()&&a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=r;this._initialized=!0}};y._disposeColorAttachments=function(){this._colorAttachments.forEach((t,p)=>
{if(k(t)){if(this._initialized){this._context.bindFramebuffer(this);var q=this._context.gl;q.framebufferTexture2D(q.FRAMEBUFFER,p,q.TEXTURE_2D,null,0)}t.dispose()}else t instanceof WebGLRenderbuffer&&(q=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),q.framebufferRenderbuffer(q.FRAMEBUFFER,p,q.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(t))});this._colorAttachments.clear()};y._disposeDepthStencilAttachments=function(){const t=this._context.gl;this._depthAttachment&&
(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferRenderbuffer(t.FRAMEBUFFER,1===this._desc.depthStencilTarget?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&
(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};y._validateTextureDimensions=function(t,p){3553!==t.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==p.width&&0<=p.width&&void 0!==p.height&&0<=p.height?p.width===t.width&&p.height===t.height||console.error("Color attachment texture must match the framebuffer's!"):(p.width=
t.width,p.height=t.height)};y._validateColorAttachmentPoint=function(t){if(-1===x._MAX_COLOR_ATTACHMENTS){const p=this._context.capabilities.drawBuffers;x._MAX_COLOR_ATTACHMENTS=p?this._context.gl.getParameter(p.MAX_COLOR_ATTACHMENTS):1}t-=36064;t+1>x._MAX_COLOR_ATTACHMENTS&&u.error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${t+1}. Implementation supports up to ${x._MAX_COLOR_ATTACHMENTS} color attachments`)};b._createClass(x,[{key:"glName",get:function(){return this._glName}},
{key:"descriptor",get:function(){return this._desc}},{key:"colorTexture",get:function(){const t=this._colorAttachments.get(36064);return t&&k(t)?t:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(36064)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},{key:"height",
get:function(){return this._desc.height}},{key:"gpuMemoryUsage",get:function(){return g.getGpuMemoryUsage(this.colorAttachment)+g.getGpuMemoryUsage(this.depthStencilAttachment)}}]);return x}();l._MAX_COLOR_ATTACHMENTS=-1;return l})},"esri/views/webgl/Renderbuffer":function(){define(["../../chunks/_rollupPluginBabelHelpers","./enums"],function(b,l){return function(){function m(C,A){this._context=C;this._desc=A;this._context.instanceCounter.increment(l.ResourceType.Renderbuffer,this);C=this._context.gl;
this.glName=C.createRenderbuffer();this._context.bindRenderbuffer(this);C.renderbufferStorage(C.RENDERBUFFER,A.internalFormat,A.width,A.height)}var z=m.prototype;z.resize=function(C,A){const g=this._desc;if(g.width!==C||g.height!==A)g.width=C,g.height=A,C=this._context.gl,this._context.bindRenderbuffer(this),C.renderbufferStorage(C.RENDERBUFFER,g.internalFormat,g.width,g.height)};z.dispose=function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(l.ResourceType.Renderbuffer,
this),this._context=null)};b._createClass(m,[{key:"descriptor",get:function(){return this._desc}}]);return m}()})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/mat3 ../../../../chunks/mat3f64 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../core/libs/gl-matrix-2/types/mat4 ../../../../geometry/support/aaBoundingRect ../../support/buffer/InterleavedLayout ../lib/geometryDataUtils ../lib/GLMaterialTexture ../lib/Material ../lib/screenSizePerspectiveUtils ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ./renderers/utils ../../../../chunks/HUDMaterial.glsl ../shaders/HUDMaterialTechnique".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E,n,B,f){function D(Z,ca,da,ba=Q){u.copy(ba,Z.anchorPos);ba[0]*=-ca[0];ba[1]*=-ca[1];ba[0]+=Z.screenOffset[0]*da;ba[1]+=Z.screenOffset[1]*da;return ba}function H(Z,ca,da,ba,ha,ea,W,X){ca=ca-ha-(0<X[0]?ba[0]*X[0]:0);let Y=ca+ba[0]+2*ha;da=da-ha-(0<X[1]?ba[1]*X[1]:0);ha=da+ba[1]+2*ha;W.textureIsSignedDistanceField&&(W=W.distanceFieldBoundingBox,ca+=ba[0]*W[0],da+=ba[1]*W[1],Y-=ba[0]*(1-W[2]),ha-=ba[1]*(1-W[3]),ca-=ea,Y+=ea,da-=ea,ha+=ea);return Z[0]>
ca&&Z[0]<Y&&Z[1]>da&&Z[1]<ha}let P=function(Z){function ca(ba){ba=Z.call(this,ba,oa)||this;ba.techniqueConfig=new f.HUDMaterialTechniqueConfiguration;return ba}l._inheritsLoose(ca,Z);var da=ca.prototype;da.getTechniqueConfig=function(ba,ha){this.techniqueConfig.output=ba;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.verticalOffset=!!this.params.verticalOffset;this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective;this.techniqueConfig.screenCenterOffsetUnitsEnabled=
"screen"===this.params.centerOffsetUnits?1:0;this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset;this.techniqueConfig.isDraped=this.params.isDraped;this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest;this.techniqueConfig.pixelSnappingEnabled=this.params.pixelSnappingEnabled;this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField;this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled;this.techniqueConfig.vvColor=!!this.params.vvColorEnabled;0===ba&&(this.techniqueConfig.debugDrawBorder=
!!this.params.debugDrawBorder);4===ba&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion);this.techniqueConfig.depthEnabled=this.params.depthEnabled;this.techniqueConfig.transparencyPassType=ha?ha.transparencyPassType:3;this.techniqueConfig.multipassGeometryEnabled=ha?ha.multipassGeometryEnabled:!1;this.techniqueConfig.multipassTerrainEnabled=ha?ha.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=ha?ha.cullAboveGround:!1;return this.techniqueConfig};
da.intersect=function(ba,ha,ea,W,X,Y,aa,ia,ja){ja?this.intersectDrapedHudGeometry(ba,Y,aa,ia):this.intersectHudGeometry(ba,ha,ea,W,aa,ia)};da.intersectDrapedHudGeometry=function(ba,ha,ea,W){const X=ba.vertexAttributes.get("position"),Y=ba.vertexAttributes.get("size"),aa=this.params,ia=B.calculateAnchorPosForRendering(aa);let ja=1;var va=1;z.isSome(W)&&(va=W(ka),ja=va[0],va=va[5]);ja*=ba.screenToWorldRatio;va*=ba.screenToWorldRatio;W=2*ba.screenToWorldRatio;for(let ta=0;ta<X.data.length/X.size;ta++){var ma=
ta*X.size;const sa=X.data[ma];ma=X.data[ma+1];const ra=ta*Y.size;wa[0]=Y.data[ra]*ja;wa[1]=Y.data[ra+1]*va;let na;aa.textureIsSignedDistanceField&&(na=aa.outlineSize*ba.screenToWorldRatio/2);H(ha,sa,ma,wa,W,na,aa,ia)&&ea()}};da.intersectHudGeometry=function(ba,ha,ea,W,X,Y){if(W.options.selectionMode&&W.options.hud&&!n.isInstanceHidden(ha)){ha=this.params;var aa=1,ia=1;A.fromMat4(S,ea);if(z.isSome(Y)){ia=Y(ka);aa=ia[0];ia=ia[5];{Y=S;var ja=Y[0],va=Y[1],ma=Y[2],ta=Y[3],sa=Y[4],ra=Y[5],na=Y[6],ua=Y[7],
za=Y[8],Ca=1/Math.sqrt(ja*ja+va*va+ma*ma);const Da=1/Math.sqrt(ta*ta+sa*sa+ra*ra),Ia=1/Math.sqrt(na*na+ua*ua+za*za);Y[0]=ja*Ca;Y[1]=va*Ca;Y[2]=ma*Ca;Y[3]=ta*Da;Y[4]=sa*Da;Y[5]=ra*Da;Y[6]=na*Ia;Y[7]=ua*Ia;Y[8]=za*Ia}}Y=ba.vertexAttributes.get("position");ja=ba.vertexAttributes.get("size");va=ba.vertexAttributes.get("normal");ba=ba.vertexAttributes.get("auxpos1");h.assert(3<=Y.size);ma=W.point;ta=W.camera;sa=B.calculateAnchorPosForRendering(ha);aa*=ta.pixelRatio;ia*=ta.pixelRatio;ra="screen"===this.params.centerOffsetUnits;
for(na=0;na<Y.data.length/Y.size;na++)if(ua=na*Y.size,y.set(F,Y.data[ua],Y.data[ua+1],Y.data[ua+2]),y.transformMat4(F,F,ea),ua=na*ja.size,wa[0]=ja.data[ua]*aa,wa[1]=ja.data[ua+1]*ia,y.transformMat4(F,F,ta.viewMatrix),ua=na*ba.size,y.set(U,ba.data[ua+0],ba.data[ua+1],ba.data[ua+2]),ra||(F[0]+=U[0],F[1]+=U[1],0!==U[2]&&(ua=U[2],y.normalize(U,F),y.subtract(F,F,y.scale(U,U,ua)))),ua=na*va.size,y.set(O,va.data[ua],va.data[ua+1],va.data[ua+2]),this.normalAndViewAngle(O,S,ta,fa),this.applyVerticalOffsetTransformationView(F,
fa,ta,J),ta.applyProjection(F,V),-1<V[0]){ua=Math.floor(V[0])+this.params.screenOffset[0];za=Math.floor(V[1])+this.params.screenOffset[1];ra&&(ua+=U[0],0!==U[1]&&(za+=e.applyScaleFactor(U[1],J.factorAlignment)));e.applyPrecomputedScaleFactor(wa,J.factor,wa);Ca=1*ta.pixelRatio;let Da;ha.textureIsSignedDistanceField&&(Da=ha.outlineSize*ta.pixelRatio/2);H(ma,ua,za,wa,Ca,Da,ha,sa)&&(za=W.ray,y.transformMat4(T,F,k.invert(N,ta.viewMatrix)),V[0]=ma[0],V[1]=ma[1],ta.unprojectFromRenderScreen(V,F)&&(ua=t.create(),
y.copy(ua,za.direction),Ca=1/y.length(ua),y.scale(ua,ua,Ca),za=y.distance(za.origin,F)*Ca,X(za,ua,-1,1,!0,T)))}}};da.computeAttachmentOrigin=function(ba,ha){var ea=ba.vertexAttributes;if(!ea)return!1;ea=ea.get("position");ba=ba.indices.get("position");return a.computeAttachmentOriginPoints(ea,ba,ha)};da.createBufferWriter=function(){return new I(this)};da.normalAndViewAngle=function(ba,ha,ea,W){p.isMat4(ha)&&(ha=A.fromMat4(L,ha));y.transformMat3(W.normal,ba,ha);y.transformMat4(W.normal,W.normal,ea.viewInverseTransposeMatrix);
W.cosAngle=y.dot(M,ya);return W};da.updateScaleInfo=function(ba,ha,ea){const W=this.params;W.screenSizePerspective?e.precomputeScaleFactor(ea,ha,W.screenSizePerspective,ba.factor):(ba.factor.scale=1,ba.factor.factor=0,ba.factor.minPixelSize=0,ba.factor.paddingPixels=0);W.screenSizePerspectiveAlignment?e.precomputeScaleFactor(ea,ha,W.screenSizePerspectiveAlignment,ba.factorAlignment):(ba.factorAlignment.factor=ba.factor.factor,ba.factorAlignment.scale=ba.factor.scale,ba.factorAlignment.minPixelSize=
ba.factor.minPixelSize,ba.factorAlignment.paddingPixels=ba.factor.paddingPixels)};da.applyShaderOffsetsView=function(ba,ha,ea,W,X,Y,aa){ha=this.normalAndViewAngle(ha,ea,X,fa);this.applyVerticalGroundOffsetView(ba,ha,X,aa);this.applyVerticalOffsetTransformationView(aa,ha,X,Y);this.applyPolygonOffsetView(aa,ha,W[3],X,aa);this.applyCenterOffsetView(aa,W,aa);return aa};da.applyShaderOffsetsNDC=function(ba,ha,ea,W,X){this.applyCenterOffsetNDC(ba,ha,ea,W);z.isSome(X)&&y.copy(X,W);this.applyPolygonOffsetNDC(W,
ha,ea,W);return W};da.applyPolygonOffsetView=function(ba,ha,ea,W,X){var Y=W.aboveGround?1:-1;ea=m.sign(ea);0===ea&&(ea=Y);Y*=ea;if(0>=this.params.shaderPolygonOffset)return y.copy(X,ba);ha=m.clamp(Math.abs(ha.cosAngle),.01,1);W=1-Math.sqrt(1-ha*ha)/ha/W.viewport[2];0<Y?y.scale(X,ba,W):y.scale(X,ba,1/W);return X};da.applyVerticalGroundOffsetView=function(ba,ha,ea,W){const X=y.length(ba),Y=ea.aboveGround?1:-1;ea=.5*ea.computeRenderPixelSizeAtDist(X);ha=y.scale(F,ha.normal,Y*ea);y.add(W,ba,ha);return W};
da.applyVerticalOffsetTransformationView=function(ba,ha,ea,W){const X=this.params;if(!X.verticalOffset||!X.verticalOffset.screenLength){if(X.screenSizePerspective||X.screenSizePerspectiveAlignment){var Y=y.length(ba);this.updateScaleInfo(W,Y,ha.cosAngle)}else W.factor.scale=1,W.factorAlignment.scale=1;return ba}Y=y.length(ba);ea=E.verticalOffsetAtDistance(ea,Y,X.verticalOffset,ha.cosAngle,X.screenSizePerspectiveAlignment||X.screenSizePerspective);this.updateScaleInfo(W,Y,ha.cosAngle);y.scale(ha.normal,
ha.normal,ea);return y.add(ba,ba,ha.normal)};da.applyCenterOffsetView=function(ba,ha,ea){const W="screen"!==this.params.centerOffsetUnits;ea!==ba&&y.copy(ea,ba);W&&(ea[0]+=ha[0],ea[1]+=ha[1],ha[2]&&(y.normalize(O,ea),y.add(ea,ea,y.scale(O,O,ha[2]))));return ea};da.applyCenterOffsetNDC=function(ba,ha,ea,W){const X="screen"!==this.params.centerOffsetUnits;W!==ba&&y.copy(W,ba);X||(W[0]+=ha[0]/ea.fullWidth*2,W[1]+=ha[1]/ea.fullHeight*2);return W};da.applyPolygonOffsetNDC=function(ba,ha,ea,W){const X=
this.params.shaderPolygonOffset;ba!==W&&y.copy(W,ba);X&&(ba=ea.aboveGround?1:-1,ha=ba*m.sign(ha[3]),W[2]-=(ha||ba)*X);return W};da.getGLMaterial=function(ba){if(0===ba.output||7===ba.output)return new R(ba);if(4===ba.output)return new K(ba)};da.calculateRelativeScreenBounds=function(ba,ha,ea=q.create()){D(this.params,ba,ha,ea);ea[2]=ea[0]+ba[0];ea[3]=ea[1]+ba[1];return ea};return ca}(r.Material);c=function(Z){function ca(ba){ba=Z.call(this,{...ba,...ba.material.params})||this;ba.updateParameters();
return ba}l._inheritsLoose(ca,Z);var da=ca.prototype;da.beginSlot=function(ba){return ba===(this._material.params.drawInSecondSlot?19:18)};da.updateParameters=function(ba){this.updateTexture(this._material.params.textureId);this.selectProgram(ba)};da.selectProgram=function(ba){this._technique=this._techniqueRep.releaseAndAcquire(f.HUDMaterialTechnique,this._material.getTechniqueConfig(this._output,ba),this._technique)};da.ensureParameters=function(ba){this.updateParameters(ba)};da.bind=function(ba){this.bindTextures(this._technique.program);
this.bindTextureScale(this._technique.program);this._technique.bindPass(this._material.params,ba)};return ca}(c);let R=function(Z){function ca(ba){ba=Z.call(this,ba)||this;ba._isOcclusionSlot=!1;return ba}l._inheritsLoose(ca,Z);var da=ca.prototype;da.beginSlot=function(ba){const ha=this._material.params.drawInSecondSlot?19:18;if(this._material.params.occlusionTest)return this._isOcclusionSlot=12===ba,12===ba||ba===ha;this._isOcclusionSlot=!1;return ba===ha};da.selectProgram=function(ba){this._technique=
this._techniqueRep.releaseAndAcquire(f.HUDMaterialTechnique,this._material.getTechniqueConfig(this._output,ba),this._technique);this._occlusionTechnique=this._techniqueRep.releaseAndAcquire(f.HUDMaterialTechnique,this._material.getTechniqueConfig(6,ba),this._occlusionTechnique)};da.bind=function(ba){const ha=this.technique;this._isOcclusionSlot||(this.bindTextures(ha.program),this.bindTextureScale(ha.program));ha.bindPass(this._material.params,ba)};l._createClass(ca,[{key:"technique",get:function(){return this._isOcclusionSlot?
this._occlusionTechnique:this._technique}}]);return ca}(c),K=function(Z){function ca(da){return Z.call(this,{...da,output:4})||this}l._inheritsLoose(ca,Z);return ca}(c);const J={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},Q=x.create(),F=t.create(),O=t.create(),V=C.createRenderScreenPointArray3(),M=t.create(),T=t.create(),S=g.create(),L=g.create(),N=w.create(),U=t.create(),fa={normal:M,cosAngle:0},ka=w.create(),wa=[0,0],
ya=t.fromValues(0,0,1),oa={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,
screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:x.fromValues(.5,.5),shaderPolygonOffset:1E-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",depthEnabled:!0,pixelSnappingEnabled:!0,debugDrawBorder:!1,isDraped:!1,...r.materialParametersDefaults},G=d.newLayout().vec3f("position").vec3f("normal").vec2f("uv0").vec4u8("color").vec2f("size").vec4f("auxpos1").vec4f("auxpos2");let I=function(){function Z(da){this.material=da;this.vertexBufferLayout=
G}var ca=Z.prototype;ca.allocate=function(da){return this.vertexBufferLayout.createBuffer(da)};ca.elementCount=function(da){return 6*da.indices.get("position").length};ca.write=function(da,ba,ha,ea){v.writePosition(ba.indices.get("position"),ba.vertexAttributes.get("position").data,da.transformation,ha.position,ea,6);v.writeNormal(ba.indices.get("normal"),ba.vertexAttributes.get("normal").data,da.invTranspTransformation,ha.normal,ea,6);var W=ba.vertexAttributes.get("uv0").data;if(null==W||4>W.length){W=
this.material.params;var X=da=0;var Y=W.texCoordScale[0];W=W.texCoordScale[1]}else da=W[0],X=W[1],Y=W[2],W=W[3];Y=Math.min(1.99999,Y+1);W=Math.min(1.99999,W+1);var aa=ba.indices.get("position").length,ia=ha.uv0,ja=ea;for(var va=0;va<aa;++va)ia.set(ja,0,da),ia.set(ja,1,X),ja+=1,ia.set(ja,0,Y),ia.set(ja,1,X),ja+=1,ia.set(ja,0,Y),ia.set(ja,1,W),ja+=1,ia.set(ja,0,Y),ia.set(ja,1,W),ja+=1,ia.set(ja,0,da),ia.set(ja,1,W),ja+=1,ia.set(ja,0,da),ia.set(ja,1,X),ja+=1;v.writeColor(ba.indices.get("color"),ba.vertexAttributes.get("color").data,
4,ha.color,ea,6);da=ba.indices.get("size");X=ba.vertexAttributes.get("size").data;Y=da.length;W=ha.size;aa=ea;for(ia=0;ia<Y;++ia){ja=X[2*da[ia]];va=X[2*da[ia]+1];for(let ma=0;6>ma;++ma)W.set(aa,0,ja),W.set(aa,1,va),aa+=1}ba.indices.get("auxpos1")&&ba.vertexAttributes.get("auxpos1")&&v.writeBufferVec4(ba.indices.get("auxpos1"),ba.vertexAttributes.get("auxpos1").data,ha.auxpos1,ea,6);ba.indices.get("auxpos2")&&ba.vertexAttributes.get("auxpos2")&&v.writeBufferVec4(ba.indices.get("auxpos2"),ba.vertexAttributes.get("auxpos2").data,
ha.auxpos2,ea,6)};return Z}();b.HUDMaterial=P;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/mat3":function(){define(["exports","./common"],function(b,l){function m(F,O){F[0]=O[0];F[1]=O[1];F[2]=O[2];F[3]=O[4];F[4]=O[5];F[5]=O[6];F[6]=O[8];F[7]=O[9];F[8]=O[10];return F}function z(F,O){F[0]=O[0];F[1]=O[1];F[2]=O[2];F[3]=O[3];F[4]=O[4];F[5]=O[5];F[6]=O[6];F[7]=O[7];F[8]=O[8];return F}function C(F,O,V,M,T,S,L,N,U,fa){F[0]=O;F[1]=V;F[2]=M;F[3]=T;F[4]=S;F[5]=L;F[6]=N;F[7]=U;F[8]=fa;return F}
function A(F){F[0]=1;F[1]=0;F[2]=0;F[3]=0;F[4]=1;F[5]=0;F[6]=0;F[7]=0;F[8]=1;return F}function g(F,O){if(F===O){const V=O[1],M=O[2],T=O[5];F[1]=O[3];F[2]=O[6];F[3]=V;F[5]=O[7];F[6]=M;F[7]=T}else F[0]=O[0],F[1]=O[3],F[2]=O[6],F[3]=O[1],F[4]=O[4],F[5]=O[7],F[6]=O[2],F[7]=O[5],F[8]=O[8];return F}function k(F,O){const V=O[0],M=O[1],T=O[2],S=O[3],L=O[4],N=O[5],U=O[6],fa=O[7];O=O[8];const ka=O*L-N*fa,wa=-O*S+N*U,ya=fa*S-L*U;let oa=V*ka+M*wa+T*ya;if(!oa)return null;oa=1/oa;F[0]=ka*oa;F[1]=(-O*M+T*fa)*oa;
F[2]=(N*M-T*L)*oa;F[3]=wa*oa;F[4]=(O*V-T*U)*oa;F[5]=(-N*V+T*S)*oa;F[6]=ya*oa;F[7]=(-fa*V+M*U)*oa;F[8]=(L*V-M*S)*oa;return F}function w(F,O){const V=O[0],M=O[1],T=O[2],S=O[3],L=O[4],N=O[5],U=O[6],fa=O[7];O=O[8];F[0]=L*O-N*fa;F[1]=T*fa-M*O;F[2]=M*N-T*L;F[3]=N*U-S*O;F[4]=V*O-T*U;F[5]=T*S-V*N;F[6]=S*fa-L*U;F[7]=M*U-V*fa;F[8]=V*L-M*S;return F}function u(F){const O=F[3],V=F[4],M=F[5],T=F[6],S=F[7],L=F[8];return F[0]*(L*V-M*S)+F[1]*(-L*O+M*T)+F[2]*(S*O-V*T)}function x(F,O,V){const M=O[0],T=O[1],S=O[2],L=
O[3],N=O[4],U=O[5],fa=O[6],ka=O[7];O=O[8];const wa=V[0],ya=V[1],oa=V[2],G=V[3],I=V[4],Z=V[5],ca=V[6],da=V[7];V=V[8];F[0]=wa*M+ya*L+oa*fa;F[1]=wa*T+ya*N+oa*ka;F[2]=wa*S+ya*U+oa*O;F[3]=G*M+I*L+Z*fa;F[4]=G*T+I*N+Z*ka;F[5]=G*S+I*U+Z*O;F[6]=ca*M+da*L+V*fa;F[7]=ca*T+da*N+V*ka;F[8]=ca*S+da*U+V*O;return F}function y(F,O,V){const M=O[0],T=O[1],S=O[2],L=O[3],N=O[4],U=O[5],fa=O[6],ka=O[7];O=O[8];const wa=V[0];V=V[1];F[0]=M;F[1]=T;F[2]=S;F[3]=L;F[4]=N;F[5]=U;F[6]=wa*M+V*L+fa;F[7]=wa*T+V*N+ka;F[8]=wa*S+V*U+O;
return F}function t(F,O,V){const M=O[0],T=O[1],S=O[2],L=O[3],N=O[4],U=O[5],fa=O[6],ka=O[7];O=O[8];const wa=Math.sin(V);V=Math.cos(V);F[0]=V*M+wa*L;F[1]=V*T+wa*N;F[2]=V*S+wa*U;F[3]=V*L-wa*M;F[4]=V*N-wa*T;F[5]=V*U-wa*S;F[6]=fa;F[7]=ka;F[8]=O;return F}function p(F,O,V){const M=V[0],T=V[1];V=V[2];F[0]=M*O[0];F[1]=M*O[1];F[2]=M*O[2];F[3]=T*O[3];F[4]=T*O[4];F[5]=T*O[5];F[6]=V*O[6];F[7]=V*O[7];F[8]=V*O[8];return F}function q(F,O,V){const M=V[0];V=V[1];F[0]=M*O[0];F[1]=M*O[1];F[2]=M*O[2];F[3]=V*O[3];F[4]=
V*O[4];F[5]=V*O[5];return F}function d(F,O){F[0]=1;F[1]=0;F[2]=0;F[3]=0;F[4]=1;F[5]=0;F[6]=O[0];F[7]=O[1];F[8]=1;return F}function a(F,O){const V=Math.sin(O);O=Math.cos(O);F[0]=O;F[1]=V;F[2]=0;F[3]=-V;F[4]=O;F[5]=0;F[6]=0;F[7]=0;F[8]=1;return F}function c(F,O){F[0]=O[0];F[1]=0;F[2]=0;F[3]=0;F[4]=O[1];F[5]=0;F[6]=0;F[7]=0;F[8]=1;return F}function r(F,O){F[0]=O[0];F[1]=O[1];F[2]=0;F[3]=O[2];F[4]=O[3];F[5]=0;F[6]=O[4];F[7]=O[5];F[8]=1;return F}function e(F,O){var V=O[0],M=O[1],T=O[2];O=O[3];var S=V+
V,L=M+M;const N=T+T;V*=S;const U=M*S;M*=L;const fa=T*S,ka=T*L;T*=N;S*=O;L*=O;O*=N;F[0]=1-M-T;F[3]=U-O;F[6]=fa+L;F[1]=U+O;F[4]=1-V-T;F[7]=ka-S;F[2]=fa-L;F[5]=ka+S;F[8]=1-V-M;return F}function h(F,O){const V=O[0],M=O[1],T=O[2],S=O[4],L=O[5],N=O[6],U=O[8],fa=O[9];O=O[10];const ka=O*L-N*fa,wa=-O*S+N*U,ya=fa*S-L*U;var oa=V*ka+M*wa+T*ya;if(!oa)return null;oa=1/oa;F[0]=ka*oa;F[1]=(-O*M+T*fa)*oa;F[2]=(N*M-T*L)*oa;F[3]=wa*oa;F[4]=(O*V-T*U)*oa;F[5]=(-N*V+T*S)*oa;F[6]=ya*oa;F[7]=(-fa*V+M*U)*oa;F[8]=(L*V-M*S)*
oa;return F}function v(F,O){const V=O[0],M=O[1],T=O[2],S=O[3],L=O[4],N=O[5],U=O[6],fa=O[7];var ka=O[8],wa=O[9],ya=O[10],oa=O[11];const G=O[12],I=O[13],Z=O[14];O=O[15];const ca=V*N-M*L,da=V*U-T*L,ba=V*fa-S*L,ha=M*U-T*N,ea=M*fa-S*N,W=T*fa-S*U,X=ka*I-wa*G,Y=ka*Z-ya*G;ka=ka*O-oa*G;const aa=wa*Z-ya*I;wa=wa*O-oa*I;ya=ya*O-oa*Z;oa=ca*ya-da*wa+ba*aa+ha*ka-ea*Y+W*X;if(!oa)return null;oa=1/oa;F[0]=(N*ya-U*wa+fa*aa)*oa;F[1]=(U*ka-L*ya-fa*Y)*oa;F[2]=(L*wa-N*ka+fa*X)*oa;F[3]=(T*wa-M*ya-S*aa)*oa;F[4]=(V*ya-T*ka+
S*Y)*oa;F[5]=(M*ka-V*wa-S*X)*oa;F[6]=(I*W-Z*ea+O*ha)*oa;F[7]=(Z*ba-G*W-O*da)*oa;F[8]=(G*ea-I*ba+O*ca)*oa;return F}function E(F,O,V){F[0]=2/O;F[1]=0;F[2]=0;F[3]=0;F[4]=-2/V;F[5]=0;F[6]=-1;F[7]=1;F[8]=1;return F}function n(F){return"mat3("+F[0]+", "+F[1]+", "+F[2]+", "+F[3]+", "+F[4]+", "+F[5]+", "+F[6]+", "+F[7]+", "+F[8]+")"}function B(F){return Math.sqrt(F[0]**2+F[1]**2+F[2]**2+F[3]**2+F[4]**2+F[5]**2+F[6]**2+F[7]**2+F[8]**2)}function f(F,O,V){F[0]=O[0]+V[0];F[1]=O[1]+V[1];F[2]=O[2]+V[2];F[3]=O[3]+
V[3];F[4]=O[4]+V[4];F[5]=O[5]+V[5];F[6]=O[6]+V[6];F[7]=O[7]+V[7];F[8]=O[8]+V[8];return F}function D(F,O,V){F[0]=O[0]-V[0];F[1]=O[1]-V[1];F[2]=O[2]-V[2];F[3]=O[3]-V[3];F[4]=O[4]-V[4];F[5]=O[5]-V[5];F[6]=O[6]-V[6];F[7]=O[7]-V[7];F[8]=O[8]-V[8];return F}function H(F,O,V){F[0]=O[0]*V;F[1]=O[1]*V;F[2]=O[2]*V;F[3]=O[3]*V;F[4]=O[4]*V;F[5]=O[5]*V;F[6]=O[6]*V;F[7]=O[7]*V;F[8]=O[8]*V;return F}function P(F,O,V,M){F[0]=O[0]+V[0]*M;F[1]=O[1]+V[1]*M;F[2]=O[2]+V[2]*M;F[3]=O[3]+V[3]*M;F[4]=O[4]+V[4]*M;F[5]=O[5]+
V[5]*M;F[6]=O[6]+V[6]*M;F[7]=O[7]+V[7]*M;F[8]=O[8]+V[8]*M;return F}function R(F,O){return F[0]===O[0]&&F[1]===O[1]&&F[2]===O[2]&&F[3]===O[3]&&F[4]===O[4]&&F[5]===O[5]&&F[6]===O[6]&&F[7]===O[7]&&F[8]===O[8]}function K(F,O){const V=F[0],M=F[1],T=F[2],S=F[3],L=F[4],N=F[5],U=F[6],fa=F[7];F=F[8];const ka=O[0],wa=O[1],ya=O[2],oa=O[3],G=O[4],I=O[5],Z=O[6],ca=O[7];O=O[8];return Math.abs(V-ka)<=l.EPSILON*Math.max(1,Math.abs(V),Math.abs(ka))&&Math.abs(M-wa)<=l.EPSILON*Math.max(1,Math.abs(M),Math.abs(wa))&&
Math.abs(T-ya)<=l.EPSILON*Math.max(1,Math.abs(T),Math.abs(ya))&&Math.abs(S-oa)<=l.EPSILON*Math.max(1,Math.abs(S),Math.abs(oa))&&Math.abs(L-G)<=l.EPSILON*Math.max(1,Math.abs(L),Math.abs(G))&&Math.abs(N-I)<=l.EPSILON*Math.max(1,Math.abs(N),Math.abs(I))&&Math.abs(U-Z)<=l.EPSILON*Math.max(1,Math.abs(U),Math.abs(Z))&&Math.abs(fa-ca)<=l.EPSILON*Math.max(1,Math.abs(fa),Math.abs(ca))&&Math.abs(F-O)<=l.EPSILON*Math.max(1,Math.abs(F),Math.abs(O))}function J(F){const O=l.EPSILON,V=F[0],M=F[1],T=F[2],S=F[3],
L=F[4],N=F[5],U=F[6],fa=F[7];F=F[8];return Math.abs(1-(V*V+S*S+U*U))<=O&&Math.abs(1-(M*M+L*L+fa*fa))<=O&&Math.abs(1-(T*T+N*N+F*F))<=O}var Q=Object.freeze({__proto__:null,fromMat4:m,copy:z,set:C,identity:A,transpose:g,invert:k,adjoint:w,determinant:u,multiply:x,translate:y,rotate:t,scale:p,scaleByVec2:q,fromTranslation:d,fromRotation:a,fromScaling:c,fromMat2d:r,fromQuat:e,normalFromMat4Legacy:h,normalFromMat4:v,projection:E,str:n,frob:B,add:f,subtract:D,multiplyScalar:H,multiplyScalarAndAdd:P,exactEquals:R,
equals:K,isOrthoNormal:J,mul:x,sub:D});b.add=f;b.adjoint=w;b.copy=z;b.determinant=u;b.equals=K;b.exactEquals=R;b.frob=B;b.fromMat2d=r;b.fromMat4=m;b.fromQuat=e;b.fromRotation=a;b.fromScaling=c;b.fromTranslation=d;b.identity=A;b.invert=k;b.isOrthoNormal=J;b.mat3=Q;b.mul=x;b.multiply=x;b.multiplyScalar=H;b.multiplyScalarAndAdd=P;b.normalFromMat4=v;b.normalFromMat4Legacy=h;b.projection=E;b.rotate=t;b.scale=p;b.scaleByVec2=q;b.set=C;b.str=n;b.sub=D;b.subtract=D;b.translate=y;b.transpose=g})},"esri/core/libs/gl-matrix-2/types/mat4":function(){define(["exports"],
function(b){function l(z){return z instanceof Float32Array&&16<=z.length}function m(z){return Array.isArray(z)&&16<=z.length}b.isMat4=function(z){return l(z)||m(z)};b.isMat4f32=l;b.isMat4f64=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/GLMaterialTexture":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./GLMaterial"],function(b,l,m){return function(z){function C(g){var k=z.call(this,g)||this;k._textureIDs=new Set;
k._textureRepository=g.textureRep;k._textureId=g.textureId;k._initTransparent=!!g.initTextureTransparent;k._texture=k._acquire(k._textureId);k._textureNormal=k._acquire(g.normalTextureId);k._textureEmissive=k._acquire(g.emissiveTextureId);k._textureOcclusion=k._acquire(g.occlusionTextureId);k._textureMetallicRoughness=k._acquire(g.metallicRoughnessTextureId);return k}b._inheritsLoose(C,z);var A=C.prototype;A.dispose=function(){this._textureIDs.forEach(g=>this._textureRepository.release(g));this._textureIDs.clear()};
A.updateTexture=function(g){g!==this._textureId&&(this._release(this._textureId),this._textureId=g,this._texture=this._acquire(this._textureId))};A.bindTextures=function(g){l.isSome(this._texture)&&g.bindTexture(this._texture.glTexture,"tex");l.isSome(this._textureNormal)&&g.bindTexture(this._textureNormal.glTexture,"normalTexture");l.isSome(this._textureEmissive)&&g.bindTexture(this._textureEmissive.glTexture,"texEmission");l.isSome(this._textureOcclusion)&&g.bindTexture(this._textureOcclusion.glTexture,
"texOcclusion");l.isSome(this._textureMetallicRoughness)&&g.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")};A.bindTextureScale=function(g){const k=l.isSome(this._texture)&&this._texture.glTexture;k&&k.descriptor.textureCoordinateScaleFactor?g.setUniform2fv("textureCoordinateScaleFactor",k.descriptor.textureCoordinateScaleFactor):g.setUniform2f("textureCoordinateScaleFactor",1,1)};A._acquire=function(g){if(!l.isNone(g))return this._textureIDs.add(g),this._textureRepository.acquire(g,
this._initTransparent)};A._release=function(g){l.isNone(g)||(this._textureIDs.delete(g),this._textureRepository.release(g))};return C}(m)})},"esri/views/3d/webgl-engine/materials/internal/bufferWriterUtils":function(){define(["exports","../../../../../chunks/mat4","../../../../../geometry/support/buffer/BufferView","../../lib/Util"],function(b,l,m,z){function C(y,t,p,q){const d=p.typedBuffer;p=p.typedBufferStride;const a=y.length;q*=p;for(let c=0;c<a;++c){const r=2*y[c];d[q]=t[r];d[q+1]=t[r+1];q+=
p}}function A(y,t,p,q,d){const a=p.typedBuffer;p=p.typedBufferStride;const c=y.length;q*=p;if(null==d||1===d)for(d=0;d<c;++d){var r=3*y[d];a[q]=t[r];a[q+1]=t[r+1];a[q+2]=t[r+2];q+=p}else for(r=0;r<c;++r){const e=3*y[r];for(let h=0;h<d;++h)a[q]=t[e],a[q+1]=t[e+1],a[q+2]=t[e+2],q+=p}}function g(y,t,p,q,d=1){const a=p.typedBuffer;p=p.typedBufferStride;const c=y.length;q*=p;if(1===d)for(d=0;d<c;++d){var r=4*y[d];a[q]=t[r];a[q+1]=t[r+1];a[q+2]=t[r+2];a[q+3]=t[r+3];q+=p}else for(r=0;r<c;++r){const e=4*
y[r];for(let h=0;h<d;++h)a[q]=t[e],a[q+1]=t[e+1],a[q+2]=t[e+2],a[q+3]=t[e+3],q+=p}}function k(y,t,p,q,d,a=1){if(p){var c=q.typedBuffer;q=q.typedBufferStride;var r=y.length,e=p[0],h=p[1],v=p[2],E=p[4],n=p[5],B=p[6],f=p[8],D=p[9],H=p[10],P=p[12],R=p[13];p=p[14];d*=q;if(1===a)for(a=0;a<r;++a){var K=3*y[a],J=t[K],Q=t[K+1];K=t[K+2];c[d]=e*J+E*Q+f*K+P;c[d+1]=h*J+n*Q+D*K+R;c[d+2]=v*J+B*Q+H*K+p;d+=q}else for(J=0;J<r;++J){Q=3*y[J];var F=t[Q],O=t[Q+1];const V=t[Q+2];Q=e*F+E*O+f*V+P;K=h*F+n*O+D*V+R;F=v*F+B*
O+H*V+p;for(O=0;O<a;++O)c[d]=Q,c[d+1]=K,c[d+2]=F,d+=q}}else A(y,t,q,d,a)}function w(y,t,p,q,d,a=1){if(p){var c=q.typedBuffer;q=q.typedBufferStride;var r=y.length,e=p[0],h=p[1],v=p[2],E=p[4],n=p[5],B=p[6],f=p[8],D=p[9],H=p[10];p=!l.isOrthoNormal(p);d*=q;if(1===a)for(a=0;a<r;++a){var P=3*y[a],R=t[P],K=t[P+1],J=t[P+2];P=e*R+E*K+f*J;var Q=h*R+n*K+D*J;R=v*R+B*K+H*J;p&&(K=P*P+Q*Q+R*R,.999999>K&&1E-6<K&&(K=1/Math.sqrt(K),P*=K,Q*=K,R*=K));c[d+0]=P;c[d+1]=Q;c[d+2]=R;d+=q}else for(P=0;P<r;++P){Q=3*y[P];K=t[Q];
J=t[Q+1];const F=t[Q+2];Q=e*K+E*J+f*F;R=h*K+n*J+D*F;K=v*K+B*J+H*F;p&&(J=Q*Q+R*R+K*K,.999999>J&&1E-6<J&&(J=1/Math.sqrt(J),Q*=J,R*=J,K*=J));for(J=0;J<a;++J)c[d+0]=Q,c[d+1]=R,c[d+2]=K,d+=q}}else A(y,t,q,d,a)}function u(y,t,p,q,d,a=1){if(p){var c=q.typedBuffer;q=q.typedBufferStride;var r=y.length,e=p[0],h=p[1],v=p[2],E=p[4],n=p[5],B=p[6],f=p[8],D=p[9],H=p[10];p=!l.isOrthoNormal(p);d*=q;if(1===a)for(a=0;a<r;++a){var P=4*y[a],R=t[P],K=t[P+1],J=t[P+2];P=t[P+3];var Q=e*R+E*K+f*J,F=h*R+n*K+D*J;R=v*R+B*K+H*
J;p&&(K=Q*Q+F*F+R*R,.999999>K&&1E-6<K&&(K=1/Math.sqrt(K),Q*=K,F*=K,R*=K));c[d+0]=Q;c[d+1]=F;c[d+2]=R;c[d+3]=P;d+=q}else for(P=0;P<r;++P){Q=4*y[P];K=t[Q];J=t[Q+1];const O=t[Q+2];Q=t[Q+3];F=e*K+E*J+f*O;R=h*K+n*J+D*O;K=v*K+B*J+H*O;p&&(J=F*F+R*R+K*K,.999999>J&&1E-6<J&&(J=1/Math.sqrt(J),F*=J,R*=J,K*=J));for(J=0;J<a;++J)c[d+0]=F,c[d+1]=R,c[d+2]=K,c[d+3]=Q,d+=q}}else g(y,t,q,d,a)}function x(y,t,p,q,d,a=1){const c=q.typedBuffer;q=q.typedBufferStride;const r=y.length;d*=q;if(1===a)if(4===p)for(a=0;a<r;++a)p=
4*y[a],c[d]=t[p],c[d+1]=t[p+1],c[d+2]=t[p+2],c[d+3]=t[p+3],d+=q;else{if(3===p)for(a=0;a<r;++a)p=3*y[a],c[d]=t[p],c[d+1]=t[p+1],c[d+2]=t[p+2],c[d+3]=255,d+=q}else if(4===p)for(p=0;p<r;++p){var e=4*y[p];for(var h=0;h<a;++h)c[d]=t[e],c[d+1]=t[e+1],c[d+2]=t[e+2],c[d+3]=t[e+3],d+=q}else if(3===p)for(p=0;p<r;++p)for(e=3*y[p],h=0;h<a;++h)c[d]=t[e],c[d+1]=t[e+1],c[d+2]=t[e+2],c[d+3]=255,d+=q}b.writeBufferMat3f=function(y,t,p,q){const d=p.typedBuffer;p=p.typedBufferStride;const a=y.length;q*=p;for(let c=0;c<
a;++c){const r=9*y[c];for(let e=0;9>e;++e)d[q+e]=t[r+e];q+=p}};b.writeBufferMat4f=function(y,t,p,q){const d=p.typedBuffer;p=p.typedBufferStride;const a=y.length;q*=p;for(let c=0;c<a;++c){const r=16*y[c];for(let e=0;16>e;++e)d[q+e]=t[r+e];q+=p}};b.writeBufferVec2=C;b.writeBufferVec3=A;b.writeBufferVec4=g;b.writeColor=x;b.writeDefaultAttributes=function(y,t,p,q,d,a){for(const r of t.fieldNames){t=y.vertexAttributes.get(r);const e=y.indices.get(r);if(t&&e)switch(r){case "position":z.assert(3===t.size);
var c=d.getField(r,m.BufferViewVec3f);c&&k(e,t.data,p,c,a);break;case "normal":z.assert(3===t.size);(c=d.getField(r,m.BufferViewVec3f))&&w(e,t.data,q,c,a);break;case "uv0":z.assert(2===t.size);(c=d.getField(r,m.BufferViewVec2f))&&C(e,t.data,c,a);break;case "color":z.assert(3===t.size||4===t.size);(c=d.getField(r,m.BufferViewVec4u8))&&x(e,t.data,t.size,c,a);break;case "symbolColor":z.assert(3===t.size||4===t.size);(c=d.getField(r,m.BufferViewVec4u8))&&x(e,t.data,t.size,c,a);break;case "tangent":z.assert(4===
t.size),(c=d.getField(r,m.BufferViewVec4f))&&u(e,t.data,q,c,a)}}};b.writeNormal=w;b.writePosition=k;b.writeTangent=u;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/HUDMaterial.glsl":function(){define("exports ./vec2 ./vec2f64 ./vec4f64 ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl ../views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d){function a(h){const v=new d.ShaderBuilder;var E=h.signedDistanceFieldEnabled;v.include(A.AlignPixel);v.include(g.HUD,h);v.include(C.Slice,h);if(6===h.output)return v.include(k.HUDOcclusionPass,h),v;v.include(p.ScreenSizePerspective);v.fragment.include(t.RgbaFloatEncoding);v.fragment.include(y.ColorConversion);v.include(u.VisualVariables,h);v.varyings.add("vcolor","vec4");v.varyings.add("vtc","vec2");v.varyings.add("vsize","vec2");h.binaryHighlightOcclusionEnabled&&
v.varyings.add("voccluded","float");v.vertex.uniforms.add("screenOffset","vec2").add("anchorPos","vec2").add("textureCoordinateScaleFactor","vec2").add("materialColor","vec4");E&&v.vertex.uniforms.add("outlineColor","vec4");h.screenSizePerspectiveEnabled&&v.vertex.uniforms.add("screenSizePerspective","vec4");(h.debugDrawBorder||h.binaryHighlightOcclusionEnabled)&&v.varyings.add("debugBorderCoords","vec4");v.attributes.add("uv0","vec2");v.attributes.add("color","vec4");v.attributes.add("size","vec2");
v.attributes.add("auxpos2","vec4");v.vertex.code.add(q.glsl`
    void main(void) {
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);

      if (rejectBySlice(projectAux.posModel)) {
        // Project outside of clip plane
        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
        return;
      }
      vec2 inputSize;
      ${h.screenSizePerspectiveEnabled?q.glsl`
      inputSize = screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);
      vec2 screenOffsetScaled = screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);
         `:q.glsl`
      inputSize = size;
      vec2 screenOffsetScaled = screenOffset;`}

      ${h.vvSize?"inputSize *\x3d vvScale(auxpos2).xx;":""}

      vec2 combinedSize = inputSize * pixelRatio;
      vec4 quadOffset = vec4(0.0);

      ${h.occlusionTestEnabled||h.binaryHighlightOcclusionEnabled?"bool visible \x3d testVisibilityHUD(posProj);":""}

      ${h.binaryHighlightOcclusionEnabled?"voccluded \x3d visible ? 0.0 : 1.0;":""}
    `);var n=q.glsl`vec2 uv01 = floor(uv0);
vec2 uv = uv0 - uv01;
quadOffset.xy = ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;`;const B=h.pixelSnappingEnabled?E?q.glsl`posProj = alignToPixelOrigin(posProj, viewport.zw) + quadOffset;`:q.glsl`posProj += quadOffset;
if (inputSize.x == size.x) {
posProj = alignToPixelOrigin(posProj, viewport.zw);
}`:q.glsl`posProj += quadOffset;`;v.vertex.code.add(q.glsl`
      ${h.occlusionTestEnabled?"if (visible) {":""}
      ${n}
      ${h.vvColor?"vcolor \x3d vvGetColor(auxpos2, vvColorValues, vvColorColors) * materialColor;":"vcolor \x3d color / 255.0 * materialColor;"}

      bool alphaDiscard = vcolor.a < ${q.glsl.float(x.symbolAlphaCutoff)};
      ${E?`alphaDiscard = alphaDiscard && outlineColor.a < ${q.glsl.float(x.symbolAlphaCutoff)};`:""}
      if (alphaDiscard) {
        // "early discard" if both symbol color (= fill) and outline color (if applicable) are transparent
        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
        return;
      } else {
        ${B}
        gl_Position = posProj;
      }

      vtc = uv * textureCoordinateScaleFactor;

      ${h.debugDrawBorder?"debugBorderCoords \x3d vec4(uv01, 1.5 / combinedSize);":""}
      vsize = inputSize;
      ${h.occlusionTestEnabled?q.glsl`} else { vtc = vec2(0.0);
        ${h.debugDrawBorder?"debugBorderCoords \x3d vec4(0.5, 0.5, 1.5 / combinedSize);}":"}"}`:""}
    }
    `);v.fragment.uniforms.add("tex","sampler2D");E&&(v.fragment.uniforms.add("outlineColor","vec4"),v.fragment.uniforms.add("outlineSize","float"));n=h.debugDrawBorder?q.glsl`(isBorder > 0.0 ? 0.0 : ${q.glsl.float(x.defaultMaskAlphaCutoff)})`:q.glsl.float(x.defaultMaskAlphaCutoff);E=q.glsl`
    ${h.debugDrawBorder?q.glsl`
      float isBorder = float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));`:""}

    ${E?q.glsl`
      vec4 fillPixelColor = vcolor;

      // Attempt to sample texel centers to avoid that thin cross outlines
      // disappear with large symbol sizes.
      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041
      const float txSize = 128.0;
      const float texelSize = 1.0 / txSize;
      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel
      vec2 scaleFactor = (vsize - txSize) * texelSize;
      vec2 samplePos = vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;

      // Get distance and map it into [-0.5, 0.5]
      float d = rgba2float(texture2D(tex, samplePos)) - 0.5;

      // Distance in output units (i.e. pixels)
      float dist = d * vsize.x;

      // Create smooth transition from the icon into its outline
      float fillAlphaFactor = clamp(0.5 - dist, 0.0, 1.0);
      fillPixelColor.a *= fillAlphaFactor;

      if (outlineSize > 0.25) {
        vec4 outlinePixelColor = outlineColor;
        float clampedOutlineSize = min(outlineSize, 0.5*vsize.x);

        // Create smooth transition around outline
        float outlineAlphaFactor = clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);
        outlinePixelColor.a *= outlineAlphaFactor;

        if (
          outlineAlphaFactor + fillAlphaFactor < ${n} ||
          fillPixelColor.a + outlinePixelColor.a < ${q.glsl.float(x.symbolAlphaCutoff)}
        ) {
          discard;
        }

        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)
        float compositeAlpha = outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);
        vec3 compositeColor = vec3(outlinePixelColor) * outlinePixelColor.a +
          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);

        gl_FragColor = vec4(compositeColor, compositeAlpha);
      } else {
        if (fillAlphaFactor < ${n}) {
          discard;
        }

        gl_FragColor = premultiplyAlpha(fillPixelColor);
      }

      // visualize SDF:
      // gl_FragColor = vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);
      `:q.glsl`
          vec4 texColor = texture2D(tex, vtc, -0.5);
          if (texColor.a < ${n}) {
            discard;
          }
          gl_FragColor = texColor * premultiplyAlpha(vcolor);
          `}

    ${h.debugDrawBorder?q.glsl`gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);`:""}
  `;7===h.output&&v.fragment.code.add(q.glsl`
      void main() {
        ${E}
        gl_FragColor = vec4(gl_FragColor.a);
      }
      `);0===h.output&&v.fragment.code.add(q.glsl`
    void main() {
      ${E}
      ${h.FrontFacePass?"gl_FragColor.rgb /\x3d gl_FragColor.a;":""}
    }
    `);4===h.output&&(v.include(w.OutputHighlight),v.fragment.code.add(q.glsl`
    void main() {
      ${E}
      ${h.binaryHighlightOcclusionEnabled?q.glsl`
          if (voccluded == 1.0) {
            gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
          } else {
            gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
          }`:"outputHighlight();"}
    }
    `));return v}function c(h,v,E){h.setUniform4fv("materialColor",v.color);v.textureIsSignedDistanceField&&(0>=v.outlineColor[3]||0>=v.outlineSize?(h.setUniform4fv("outlineColor",z.ZEROS),h.setUniform1f("outlineSize",0)):(h.setUniform4fv("outlineColor",v.outlineColor),h.setUniform1f("outlineSize",v.outlineSize)));h.setUniform2f("screenOffset",2*v.screenOffset[0]*E,2*v.screenOffset[1]*E);h.setUniform2fv("anchorPos",r(v))}function r(h,v=e){if(h.textureIsSignedDistanceField){var E=h.anchorPos;h=h.distanceFieldBoundingBox;
v[0]=E[0]*(h[2]-h[0])+h[0];v[1]=E[1]*(h[3]-h[1])+h[1]}else l.copy(v,h.anchorPos);return v}const e=m.create();m=Object.freeze({__proto__:null,build:a,bindHUDMaterialUniforms:c,calculateAnchorPosForRendering:r});b.HUDMaterialShader=m;b.bindHUDMaterialUniforms=c;b.build=a;b.calculateAnchorPosForRendering=r})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.AlignPixel=function(m){const z=l.glsl`vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {
vec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`,C=l.glsl`vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {
vec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`;m.vertex.code.add(z);m.vertex.code.add(C);m.fragment.code.add(z);m.fragment.code.add(C)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl":function(){define(["exports","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(b,l,m){b.HUD=function(z,C){z.include(l.ScreenSizePerspective);z.attributes.add("position","vec3");z.attributes.add("normal","vec3");z.attributes.add("auxpos1","vec4");z.vertex.uniforms.add("proj",
"mat4");z.vertex.uniforms.add("view","mat4");z.vertex.uniforms.add("viewNormal","mat4");z.vertex.uniforms.add("viewport","vec4");z.vertex.uniforms.add("camPos","vec3");z.vertex.uniforms.add("polygonOffset","float");z.vertex.uniforms.add("cameraGroundRelative","float");z.vertex.uniforms.add("pixelRatio","float");z.vertex.uniforms.add("perDistancePixelRatio","float");z.vertex.uniforms.add("uRenderTransparentlyOccludedHUD","float");C.verticalOffsetEnabled&&z.vertex.uniforms.add("verticalOffset","vec4");
C.screenSizePerspectiveEnabled&&z.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4");z.vertex.uniforms.add("hudVisibilityTexture","sampler2D");z.vertex.constants.add("smallOffsetAngle","float",.984807753012208);z.vertex.code.add(m.glsl`struct ProjectHUDAux {
vec3 posModel;
vec3 posView;
vec3 vnormal;
float distanceToCamera;
float absCosAngle;
};`);z.vertex.code.add(m.glsl`float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {
float pointGroundSign = sign(pointGroundDistance);
if (pointGroundSign == 0.0) {
pointGroundSign = cameraGroundRelative;
}
float groundRelative = cameraGroundRelative * pointGroundSign;
if (polygonOffset > .0) {
float cosAlpha = clamp(absCosAngle, 0.01, 1.0);
float tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;
float factor = (1.0 - tanAlpha / viewport[2]);
if (groundRelative > 0.0) {
posView *= factor;
}
else {
posView /= factor;
}
}
return groundRelative;
}`);C.isDraped||z.vertex.code.add(m.glsl`void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {
float distanceToCamera = length(posView);
float pixelOffset = distanceToCamera * perDistancePixelRatio * 0.5;
vec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;
vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
posModel += modelOffset;
posView += viewOffset;
}`);z.vertex.code.add(m.glsl`
    vec4 projectPositionHUD(out ProjectHUDAux aux) {
      // centerOffset is in view space and is used to implement world size offsetting
      // of labels with respect to objects. It also pulls the label towards the viewer
      // so that the label is visible in front of the object.
      vec3 centerOffset = auxpos1.xyz;

      // The pointGroundDistance is the distance of the geometry to the ground and is
      // negative if the point is below the ground, or positive if the point is above
      // ground.
      float pointGroundDistance = auxpos1.w;

      aux.posModel = position;
      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;
      aux.vnormal = normal;
      ${C.isDraped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);"}

      // Screen sized offset in world space, used for example for line callouts
      // Note: keep this implementation in sync with the CPU implementation, see
      //   - MaterialUtil.verticalOffsetAtDistance
      //   - HUDMaterial.applyVerticalOffsetTransformation

      aux.distanceToCamera = length(aux.posView);

      vec3 viewDirObjSpace = normalize(camPos - aux.posModel);
      float cosAngle = dot(aux.vnormal, viewDirObjSpace);

      aux.absCosAngle = abs(cosAngle);

      ${C.screenSizePerspectiveEnabled?C.verticalOffsetEnabled||1===C.screenCenterOffsetUnitsEnabled?"vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":"":""}

      ${C.verticalOffsetEnabled?C.screenSizePerspectiveEnabled?"float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight \x3d verticalOffset.x;":""}

      ${C.verticalOffsetEnabled?m.glsl`
            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);
            vec3 modelOffset = aux.vnormal * worldOffset;
            aux.posModel += modelOffset;
            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
            aux.posView += viewOffset;
            // Since we elevate the object, we need to take that into account
            // in the distance to ground
            pointGroundDistance += worldOffset;`:""}

      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);

      ${1!==C.screenCenterOffsetUnitsEnabled?m.glsl`
            // Apply x/y in view space, but z in screen space (i.e. along posView direction)
            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);

            // Same material all have same z != 0.0 condition so should not lead to
            // branch fragmentation and will save a normalization if it's not needed
            if (centerOffset.z != 0.0) {
              aux.posView -= normalize(aux.posView) * centerOffset.z;
            }
          `:""}

      vec4 posProj = proj * vec4(aux.posView, 1.0);

      ${1===C.screenCenterOffsetUnitsEnabled?C.screenSizePerspectiveEnabled?"float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY \x3d centerOffset.y;":""}

      ${1===C.screenCenterOffsetUnitsEnabled?"posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""}

      // constant part of polygon offset emulation
      posProj.z -= groundRelative * polygonOffset * posProj.w;
      return posProj;
    }
  `);z.vertex.code.add(m.glsl`bool testVisibilityHUD(vec4 posProj) {
vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);
vec4 occlusionPixel = texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);
if (uRenderTransparentlyOccludedHUD > 0.5) {
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * uRenderTransparentlyOccludedHUD < 1.0;
}
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
}`)};b.bindHUDUniforms=function(z,C){z.setUniform1f("uRenderTransparentlyOccludedHUD",0===C.renderTransparentlyOccludedHUD?1:1===C.renderTransparentlyOccludedHUD?0:.75)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl":function(){define(["exports","../../shaderModules/interfaces","../../../materials/internal/MaterialUtil"],function(b,l,m){b.ScreenSizePerspective=function(z){z.vertex.code.add(l.glsl`float screenSizePerspectiveMinSize(float size, vec4 factor) {
float nonZeroSize = 1.0 - step(size, 0.0);
return (
factor.z * (
1.0 +
nonZeroSize *
2.0 * factor.w / (
size + (1.0 - nonZeroSize)
)
)
);
}`);z.vertex.code.add(l.glsl`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`);z.vertex.code.add(l.glsl`vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
return vec4(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z,
params.w
);
}`);z.vertex.code.add(l.glsl`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
}`);z.vertex.code.add(l.glsl`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`);z.vertex.code.add(l.glsl`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);
}`);z.vertex.code.add(l.glsl`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)};b.bindScreenSizePerspectiveUniforms=function(z,C){C.screenSizePerspective&&(m.bindScreenSizePerspective(C.screenSizePerspective,z,"screenSizePerspective"),m.bindScreenSizePerspective(C.screenSizePerspectiveAlignment||C.screenSizePerspective,z,"screenSizePerspectiveAlignment"))};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl":function(){define(["exports","../output/ReadLinearDepth.glsl","../shading/MultipassGeometryTest.glsl",
"../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(b,l,m,z,C){b.HUDOcclusionPass=function(A,g){g.multipassGeometryEnabled&&A.vertex.include(m.multipassGeometryTest);g.multipassTerrainEnabled&&A.varyings.add("depth","float");A.vertex.code.add(C.glsl`
  void main(void) {
    vec4 posProjCenter;
    if (dot(position, position) > 0.0) {
      // Render single point to center of the pixel to avoid subpixel
      // filtering to affect the marker color
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);
      posProjCenter = alignToPixelCenter(posProj, viewport.zw);

      ${g.multipassGeometryEnabled?C.glsl`
        // Don't draw vertices behind geometry
        if(geometryDepthTest(.5 + .5 * posProjCenter.xy / posProjCenter.w, projectAux.posView.z)){
          posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
        }`:""}

      ${g.multipassTerrainEnabled?"depth \x3d projectAux.posView.z;":""}
      vec3 vpos = projectAux.posModel;
      if (rejectBySlice(vpos)) {
        // Project out of clip space
        posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
      }

    } else {
      // Project out of clip space
      posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
    }

    gl_Position = posProjCenter;
    gl_PointSize = 1.0;
  }
  `);g.multipassTerrainEnabled&&A.fragment.include(l.ReadLinearDepth);A.fragment.uniforms.add("terrainDepthTexture","sampler2D");A.fragment.uniforms.add("cameraNearFar","vec2");A.fragment.uniforms.add("inverseViewport","vec2");A.fragment.include(z.RgbaFloatEncoding);A.fragment.code.add(C.glsl`
  void main() {
    gl_FragColor = vec4(1, 1, 1, 1);
    ${g.multipassTerrainEnabled?C.glsl`

          vec2 uv = gl_FragCoord.xy * inverseViewport;

          //Read the rgba data from the texture linear depth
          vec4 terrainDepthData = texture2D(terrainDepthTexture, uv);

          float terrainDepth = linearDepthFromFloat(rgba2float(terrainDepthData), cameraNearFar);

          //If HUD vertex is behind terrain and the terrain depth is not the initialize value (e.g. we are not looking at the sky)
          //Mark the HUD vertex as occluded by transparent terrain
          if(depth < terrainDepth && terrainDepthData != vec4(0,0,0,1)){
            gl_FragColor.g = 0.5;
          }`:""}
  }
  `)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassGeometryTest.glsl":function(){define(["exports","../output/ReadLinearDepth.glsl","../../shaderModules/interfaces"],function(b,l,m){b.bindMultipassGeometryTexture=function(z,C){C.multipassGeometryEnabled&&C.geometryLinearDepthTexture&&z.bindTexture(C.geometryLinearDepthTexture,"geometryDepthTexture")};b.multipassGeometryTest=function(z){z.include(l.ReadLinearDepth);z.uniforms.add("geometryDepthTexture",
"sampler2D");z.uniforms.add("cameraNearFar","vec2");z.code.add(m.glsl`bool geometryDepthTest(vec2 pos, float elementDepth) {
float geometryDepth = linearDepthFromTexture(geometryDepthTexture, pos, cameraNearFar);
return (elementDepth < (geometryDepth - 1.0));
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/HUDMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/MultipassGeometryTest.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/OrderIndependentTransparency ../lib/Program ../../../../chunks/HUDMaterial.glsl ../../../webgl/renderState".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h){q=function(n){function B(){return n.apply(this,arguments)||this}m._inheritsLoose(B,n);var f=B.prototype;f.initializeProgram=function(D){var H=B.shader.get();const P=this.configuration;H=H.build({output:P.output,FrontFacePass:2===P.transparencyPassType,viewingMode:D.viewingMode,occlusionTestEnabled:P.occlusionTestEnabled,signedDistanceFieldEnabled:P.sdf,slicePlaneEnabled:P.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,
debugDrawBorder:P.debugDrawBorder,binaryHighlightOcclusionEnabled:P.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:P.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:P.screenSizePerspective,verticalOffsetEnabled:P.verticalOffset,pixelSnappingEnabled:P.pixelSnappingEnabled,vvSize:P.vvSize,vvColor:P.vvColor,vvInstancingEnabled:!1,isDraped:P.isDraped,multipassGeometryEnabled:P.multipassGeometryEnabled,multipassTerrainEnabled:P.multipassTerrainEnabled,cullAboveGround:P.cullAboveGround});
return new r.Program(D.rctx,H,a.Default3D)};f.bindPass=function(D,H){t.bindProjectionMatrix(this.program,H.camera.projectionMatrix);this.program.setUniform1f("cameraGroundRelative",H.camera.aboveGround?1:-1);this.program.setUniform1f("perDistancePixelRatio",Math.tan(H.camera.fovY/2)/(H.camera.fullViewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",H.camera.viewInverseTransposeMatrix);this.program.setUniform1f("polygonOffset",D.shaderPolygonOffset);A.bindVerticalOffsetUniforms(this.program,
D,H);y.bindScreenSizePerspectiveUniforms(this.program,D);this.program.setUniform1f("pixelRatio",H.camera.pixelRatio||1);t.bindViewport(this.program,H);6===this.configuration.output?(this.program.setUniform2fv("cameraNearFar",H.camera.nearFar),this.program.setUniform2fv("inverseViewport",H.inverseViewport),w.bindMultipassGeometryTexture(this.program,H),u.bindMultipassTerrainTexture(this.program,H)):(g.bindHUDUniforms(this.program,H),e.bindHUDMaterialUniforms(this.program,D,H.camera.pixelRatio||1),
x.bindVisualVariablesUniforms(this.program,D),this.configuration.occlusionTestEnabled&&this.program.bindTexture(H.hudVisibilityTexture,"hudVisibilityTexture"));4===this.configuration.output&&k.bindOutputHighlight(this.program,H)};f.bindDraw=function(D){t.bindView(this.program,D);t.bindCameraPosition(this.program,D.origin,D.camera.viewInverseTransposeMatrix);C.bindSliceUniformsWithOrigin(this.program,this.configuration,D);this.program.rebindTextures()};f.setPipelineState=function(D){const H=this.configuration,
P=3===D,R=this.configuration.polygonOffsetEnabled&&v,K=!P&&2!==D||4===H.output?null:(H.depthEnabled||6===H.output)&&h.defaultDepthWriteParams;return h.makePipelineState({blending:0===H.output||7===H.output||4===H.output?P?E:c.OITBlending(D):null,depthTest:{func:515},depthWrite:K,colorWrite:h.defaultColorWriteParams,polygonOffset:R})};f.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)};m._createClass(B,[{key:"primitiveType",get:function(){return 6===
this.configuration.output?0:4}}]);return B}(q.ShaderTechnique);q.shader=new p.ReloadableShaderModule(e.HUDMaterialShader,()=>new Promise(function(n,B){b(["./HUDMaterial.glsl"],n,B)}));const v={factor:0,units:-4},E=h.simpleBlendingParams(1,771);p=function(n){function B(){var f=n.apply(this,arguments)||this;f.output=0;f.occlusionTestEnabled=!0;f.sdf=!1;f.vvSize=!1;f.vvColor=!1;f.verticalOffset=!1;f.screenSizePerspective=!1;f.screenCenterOffsetUnitsEnabled=0;f.debugDrawBorder=!0;f.binaryHighlightOcclusion=
!0;f.slicePlaneEnabled=!1;f.polygonOffsetEnabled=!1;f.depthEnabled=!0;f.transparencyPassType=3;f.pixelSnappingEnabled=!0;f.isDraped=!1;f.multipassGeometryEnabled=!1;f.multipassTerrainEnabled=!1;f.cullAboveGround=!1;return f}m._inheritsLoose(B,n);return B}(d.ShaderTechniqueConfiguration);z.__decorate([d.parameter({count:8})],p.prototype,"output",void 0);z.__decorate([d.parameter()],p.prototype,"occlusionTestEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"sdf",void 0);z.__decorate([d.parameter()],
p.prototype,"vvSize",void 0);z.__decorate([d.parameter()],p.prototype,"vvColor",void 0);z.__decorate([d.parameter()],p.prototype,"verticalOffset",void 0);z.__decorate([d.parameter()],p.prototype,"screenSizePerspective",void 0);z.__decorate([d.parameter({count:2})],p.prototype,"screenCenterOffsetUnitsEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"debugDrawBorder",void 0);z.__decorate([d.parameter()],p.prototype,"binaryHighlightOcclusion",void 0);z.__decorate([d.parameter()],p.prototype,
"slicePlaneEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"polygonOffsetEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"depthEnabled",void 0);z.__decorate([d.parameter({count:4})],p.prototype,"transparencyPassType",void 0);z.__decorate([d.parameter()],p.prototype,"pixelSnappingEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"isDraped",void 0);z.__decorate([d.parameter()],p.prototype,"multipassGeometryEnabled",void 0);z.__decorate([d.parameter()],p.prototype,"multipassTerrainEnabled",
void 0);z.__decorate([d.parameter()],p.prototype,"cullAboveGround",void 0);l.HUDMaterialTechnique=q;l.HUDMaterialTechniqueConfiguration=p;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl":function(){define(["exports","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(b,l,m){function z(A,g,k,w=C){w.screenLength=A.screenLength;w.perDistance=Math.tan(.5*g)/(.5*k);w.minWorldLength=A.minWorldLength;
w.maxWorldLength=A.maxWorldLength;return w}const C={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0};b.VerticalOffset=function(A,g){const k=A.vertex.code;g.verticalOffsetEnabled?(A.vertex.uniforms.add("verticalOffset","vec4"),g.screenSizePerspectiveEnabled&&(A.include(l.ScreenSizePerspective),A.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),k.add(m.glsl`
    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
      ${1===g.viewingMode?m.glsl`vec3 worldNormal = normalize(worldPos + localOrigin);`:m.glsl`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
      ${g.screenSizePerspectiveEnabled?m.glsl`
          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));
          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:m.glsl`
          float verticalOffsetScreenHeight = verticalOffset.x;`}
      // Screen sized offset in world space, used for example for line callouts
      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
      return worldNormal * worldOffset;
    }

    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      return worldPos + calculateVerticalOffset(worldPos, localOrigin);
    }
    `)):k.add(m.glsl`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)};b.bindVerticalOffsetUniforms=function(A,g,k){g.verticalOffset&&(g=z(g.verticalOffset,k.camera.fovY,k.camera.fullViewport[3]),A.setUniform4f("verticalOffset",g.screenLength*(k.camera.pixelRatio||1),g.perDistance,g.minWorldLength,g.maxWorldLength))};b.calculateVerticalOffsetFactors=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/RightAngleQuadVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Handles ../../../../core/maybe ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f32 ../../../../geometry/support/vectorStacks ./Object3DVisualElement ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d){y=function(c){function r(h){var v=c.call(this,h)||this;v._handles=new m;v._quadMaterial=null;v._outlineMaterial=null;v._maxSize=0;v._position=k.create();v._up=k.create();v._right=k.create();v._renderOccluded=4;v._color=u.fromValues(1,0,0,1);v._outlineColor=u.fromValues(0,0,0,1);v._outlineSize=0;v._size=32;v._outlineRenderOccluded=16;v.applyProps(h);return v}l._inheritsLoose(r,c);var e=r.prototype;e.createExternalResources=function(){this._quadMaterial=new q.ColorMaterial(this.quadMaterialParameters);
this._outlineMaterial=new d.RibbonLineMaterial(this.outlineMaterialParameters);this._handles.add(this.view.state.watch("camera",()=>this._updateTransform()))};e.destroyExternalResources=function(){this._outlineMaterial=this._quadMaterial=null;this._handles.removeAll()};e.forEachExternalMaterial=function(h){h(this._quadMaterial);h(this._outlineMaterial)};e.createGeometries=function(h){this._createQuadGeometry(h);this._createOutlineGeometry(h);this._updateTransform(h)};e._createQuadGeometry=function(h){const v=
this._quadGeometryData(this._up,this._right);h.addGeometry(v,this._quadMaterial)};e._createOutlineGeometry=function(h){if(0!==this._outlineSize){var v=g.add(x.sv3d.get(),this._up,this._right);v=p.createPolylineGeometry([this._up,v,this._right]);h.addGeometry(v,this._outlineMaterial)}};e._updateTransform=function(h=this.object){var v=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position);v=Math.min(this._maxSize,v);C.identity(a);C.translate(a,a,this._position);C.scale(a,a,[v,v,
v]);z.isSome(h)&&(h.transformation=a)};e._quadGeometryData=function(h,v){const E=g.add(x.sv3d.get(),h,v);return new t.Geometry([["position",{size:3,data:[0,0,0,...v,...h,...E],exclusive:!0}]],[["position",new Uint16Array([0,1,2,1,2,3])]])};e._updateQuadMaterial=function(){this._quadMaterial&&this._quadMaterial.setParameterValues(this.quadMaterialParameters)};e._updateOutlineMaterial=function(){this._outlineMaterial&&this._outlineMaterial.setParameterValues(this.outlineMaterialParameters)};l._createClass(r,
[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(h){h!==this._renderOccluded&&(this._renderOccluded=h,this._updateQuadMaterial())}},{key:"color",get:function(){return this._color},set:function(h){w.copy(this._color,h);this._updateQuadMaterial()}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(h){w.copy(this._outlineColor,h);this._updateOutlineMaterial()}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(h){const v=
0===this._outlineSize!==(0===h);this._outlineSize=h;v?this.recreateGeometry():this._updateOutlineMaterial()}},{key:"size",get:function(){return this._size},set:function(h){h!==this._size&&(this._size=h,this._updateTransform())}},{key:"outlineRenderOccluded",get:function(){return this._outlineRenderOccluded},set:function(h){this._outlineRenderOccluded=h;this._updateOutlineMaterial()}},{key:"geometry",set:function({previous:h,center:v,next:E}){this._maxSize=Math.min(g.distance(v,h),g.distance(v,E))/
3;g.normalize(this._up,g.subtract(this._up,h,v));g.normalize(this._right,g.subtract(this._right,E,v));g.copy(this._position,v);this.recreateGeometry()}},{key:"quadMaterialParameters",get:function(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}},{key:"outlineMaterialParameters",get:function(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}}]);return r}(y.Object3DVisualElement);const a=
A.create();b.RightAngleQuadVisualElement=y;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../lib/GLMaterial ../lib/Material ../lib/OrderIndependentTransparency ./internal/DefaultBufferWriter ./internal/MaterialUtil ../shaders/ColorMaterialTechnique".split(" "),function(b,l,m,z,C,A,g,k){let w=function(y){function t(q){q=y.call(this,q,x)||this;q.supportsEdges=!0;q.techniqueConfig=
new k.ColorMaterialTechniqueConfiguration;return q}l._inheritsLoose(t,y);var p=t.prototype;p.getTechniqueConfig=function(q,d){this.techniqueConfig.output=q;this.techniqueConfig.cullFace=this.params.cullFace;this.techniqueConfig.vertexColors=this.params.vertexColors;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;
this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.transparencyPassType=d?d.transparencyPassType:3;this.techniqueConfig.enableOffset=d?d.camera.relativeElevation<C.OITPolygonOffsetLimit:!0;this.techniqueConfig.multipassTerrainEnabled=d?d.multipassTerrainEnabled:!1;this.techniqueConfig.cullAboveGround=d?d.cullAboveGround:!1;return this.techniqueConfig};p.getPassParameters=function(){return this.params};p.intersect=function(q,d,a,c,r,e,h){g.intersectTriangleGeometry(q,
d,c,r,e,void 0,h)};p.getGLMaterial=function(q){return 0===q.output||7===q.output||4===q.output||1===q.output&&this.params.writeLinearDepth?new u(q):void 0};p.createBufferWriter=function(){return new A.DefaultBufferWriter(A.PositionColorLayout)};return t}(z.Material),u=function(y){function t(q){q=y.call(this,q)||this;q.updateParameters();return q}l._inheritsLoose(t,y);var p=t.prototype;p.updateParameters=function(q){this._technique=this._techniqueRep.releaseAndAcquire(k.ColorMaterialTechnique,this._material.getTechniqueConfig(this._output,
q),this._technique)};p.beginSlot=function(q){return 4===this._output?3===q:q===(this._technique.configuration.transparent?this._technique.configuration.writeDepth?5:8:3)};p._updateOccludeeState=function(q){q.hasOccludees!==this._material.params.sceneHasOcludees&&this._material.setParameterValues({sceneHasOcludees:q.hasOccludees})};p.ensureParameters=function(q){0!==this._output&&7!==this._output||this._updateOccludeeState(q);this.updateParameters(q)};p.bind=function(q){this._technique.bindPass(this._material.getPassParameters(),
q)};p.getPipelineState=function(q,d){return this._technique.getPipelineState(d)};return t}(m);const x={color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,...z.materialParametersDefaults};b.ColorMaterial=w;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/internal/DefaultBufferWriter":function(){define(["exports","../../../support/buffer/InterleavedLayout","./bufferWriterUtils"],
function(b,l,m){const z=l.newLayout().vec3f("position"),C=l.newLayout().vec3f("position").vec2f("uv0");l=l.newLayout().vec3f("position").vec4u8("color");let A=function(){function g(w){this.vertexBufferLayout=w}var k=g.prototype;k.allocate=function(w){return this.vertexBufferLayout.createBuffer(w)};k.elementCount=function(w){return w.indices.get("position").length};k.write=function(w,u,x,y){m.writeDefaultAttributes(u,this.vertexBufferLayout,w.transformation,w.invTranspTransformation,x,y)};return g}();
b.DefaultBufferWriter=A;b.PositionColorLayout=l;b.PositionLayout=z;b.PositionUVLayout=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/ColorMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../../../../chunks/ColorMaterial.glsl ../../../webgl/renderState".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a){u=function(r){function e(){return r.apply(this,arguments)||this}m._inheritsLoose(e,r);var h=e.prototype;h.initializeProgram=function(v){var E=e.shader.get();const n=this.configuration;E=E.build({output:n.output,OITEnabled:0===n.transparencyPassType,attributeColor:n.vertexColors,slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});
return new p.Program(v.rctx,E,y.Default3D)};h.bindPass=function(v,E){k.bindProjectionMatrix(this.program,E.camera.projectionMatrix);this.program.setUniform4fv("eColor",v.color);4===this.configuration.output&&A.bindOutputHighlight(this.program,E);(1===this.configuration.output||E.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",E.camera.nearFar);E.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",E.inverseViewport),g.bindMultipassTerrainTexture(this.program,
E))};h.bindDraw=function(v){k.bindView(this.program,v);this.program.rebindTextures();C.bindSliceUniformsWithOrigin(this.program,this.configuration,v)};h.setPipelineState=function(v,E){const n=this.configuration,B=3===v,f=2===v;return a.makePipelineState({blending:0!==n.output&&7!==n.output||!n.transparent?null:B?t.blendingDefault:t.OITBlending(v),culling:a.cullingParams(n.cullFace),depthTest:{func:t.OITDepthTest(v)},depthWrite:B||f?n.writeDepth&&a.defaultDepthWriteParams:null,colorWrite:a.defaultColorWriteParams,
stencilWrite:n.sceneHasOcludees?q.stencilWriteMaskOn:null,stencilTest:n.sceneHasOcludees?E?q.stencilToolMaskBaseParams:q.stencilBaseAllZerosParams:null,polygonOffset:B||f?n.polygonOffset&&c:t.getOITPolygonOffset(n.enableOffset)})};h.initializePipeline=function(){this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0);return this.setPipelineState(this.configuration.transparencyPassType,!1)};h.getPipelineState=function(v){return v?this._occludeePipelineState:this.pipeline};
return e}(u.ShaderTechnique);u.shader=new w.ReloadableShaderModule(d.ColorMaterialShader,()=>new Promise(function(r,e){b(["./ColorMaterial.glsl"],r,e)}));const c={factor:1,units:1};w=function(r){function e(){var h=r.apply(this,arguments)||this;h.output=0;h.cullFace=0;h.slicePlaneEnabled=!1;h.vertexColors=!1;h.transparent=!1;h.polygonOffset=!1;h.enableOffset=!0;h.writeDepth=!0;h.sceneHasOcludees=!1;h.transparencyPassType=3;h.multipassTerrainEnabled=!1;h.cullAboveGround=!1;return h}m._inheritsLoose(e,
r);return e}(x.ShaderTechniqueConfiguration);z.__decorate([x.parameter({count:8})],w.prototype,"output",void 0);z.__decorate([x.parameter({count:3})],w.prototype,"cullFace",void 0);z.__decorate([x.parameter()],w.prototype,"slicePlaneEnabled",void 0);z.__decorate([x.parameter()],w.prototype,"vertexColors",void 0);z.__decorate([x.parameter()],w.prototype,"transparent",void 0);z.__decorate([x.parameter()],w.prototype,"polygonOffset",void 0);z.__decorate([x.parameter()],w.prototype,"enableOffset",void 0);
z.__decorate([x.parameter()],w.prototype,"writeDepth",void 0);z.__decorate([x.parameter()],w.prototype,"sceneHasOcludees",void 0);z.__decorate([x.parameter({count:4})],w.prototype,"transparencyPassType",void 0);z.__decorate([x.parameter()],w.prototype,"multipassTerrainEnabled",void 0);z.__decorate([x.parameter()],w.prototype,"cullAboveGround",void 0);l.ColorMaterialTechnique=u;l.ColorMaterialTechniqueConfiguration=w;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/chunks/ColorMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y){function t(q){const d=new y.ShaderBuilder,a=1===q.output;d.include(m.Transform,{linearDepth:a});d.include(z.VertexColor,q);d.vertex.uniforms.add("proj","mat4").add("view","mat4");d.attributes.add("position","vec3");d.varyings.add("vpos","vec3");q.multipassTerrainEnabled&&d.varyings.add("depth","float");a&&(d.include(C.OutputDepth,q),d.vertex.uniforms.add("cameraNearFar","vec2"),d.varyings.add("linearDepth","float"));d.vertex.code.add(x.glsl`
    void main(void) {
      vpos = position;
      forwardNormalizedVertexColor();
      ${q.multipassTerrainEnabled?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
      gl_Position = ${a?x.glsl`transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);`:x.glsl`transformPosition(proj, view, vpos);`}
    }
  `);d.include(l.Slice,q);d.fragment.include(u.ColorConversion);q.multipassTerrainEnabled&&(d.fragment.include(g.ReadLinearDepth),d.include(k.multipassTerrainTest,q));d.fragment.uniforms.add("eColor","vec4");4===q.output&&d.include(A.OutputHighlight);d.fragment.code.add(x.glsl`
  void main() {
    discardBySlice(vpos);
    ${q.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    vec4 color = ${q.attributeColor?"vColor * eColor;":"eColor;"}

    if (color.a < ${x.glsl.float(w.symbolAlphaCutoff)}) {
      discard;
    }

    ${7===q.output?x.glsl`gl_FragColor = vec4(color.a);`:""}

    ${0===q.output?x.glsl`gl_FragColor = highlightSlice(color, vpos); ${q.OITEnabled?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}`:""}
    ${4===q.output?x.glsl`outputHighlight();`:""};
    ${1===q.output?x.glsl`outputDepth(linearDepth);`:""};
  }
  `);return d}var p=Object.freeze({__proto__:null,build:t});b.ColorMaterialShader=p;b.build=t})},"esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":function(){define(["exports","../shaderModules/interfaces"],function(b,l){b.Transform=function(m,z){z.linearDepth?m.vertex.code.add(l.glsl`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):m.vertex.code.add(l.glsl`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":function(){define(["exports","../../shaderModules/interfaces"],function(b,l){b.VertexColor=function(m,z){z.attributeColor?(m.attributes.add("color","vec4"),m.varyings.add("vColor","vec4"),m.vertex.code.add(l.glsl`void forwardVertexColor() { vColor = color; }`),m.vertex.code.add(l.glsl`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):m.vertex.code.add(l.glsl`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/DrawManipulator":function(){define(["exports","../../../../../core/Evented"],function(b,l){let m=function(){function z({grabbableForEvent:A}){this.events=new l;this.interactive=!0;this.selectable=!1;this.cursor=null;this.grabbable=!0;this.grabbableForEvent=A}var C=z.prototype;C.intersectionDistance=function(A,g){return 0};C.attach=function(){};C.detach=function(){};
return z}();b.DrawManipulator=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/DrawingMode":function(){define(["exports"],function(b){b.defaultDrawingMode="click";b.drawingModes=["freehand","hybrid","click"];Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/draw/drawSurfaces":function(){define(["exports","../../../../../core/maybe","../../../../../core/screenUtils","../../../../../layers/graphics/dehydratedFeatures","../../../../../support/elevationInfoUtils"],
function(b,l,m,z,C){let A=function(){function k(u,x,y,t=null){this.elevationInfo=u;this.defaultZ=x;this.view=y;this.excludeGraphics=t}var w=k.prototype;w.screenToMap=function(u){if(l.isSome(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen(m.createScreenPointArray(u.x,u.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);u=this.view.sceneIntersectionHelper.intersectElevationFromScreen(m.createScreenPointArray(u.x,u.y),this.elevationInfo,0,this.excludeGraphics);
l.isSome(u)&&(u.z=void 0);return u};w.mapToScreen=function(u){u=z.makeDehydratedPoint(u.x,u.y,C.getConvertedElevation(this.view,u,this.elevationInfo),u.spatialReference);return this.view.toScreen(u)};return k}(),g=function(){function k(u,x,y=[]){this.view=u;this.elevationInfo=x;this.exclude=y}var w=k.prototype;w.screenToMap=function(u){u=this.view.toMap(u,{exclude:this.exclude});l.isSome(u)&&(u.z=C.getZForElevationMode(u,this.view,this.elevationInfo));return u};w.mapToScreen=function(u){let x=u;l.isSome(this.elevationInfo)&&
(x=z.makeDehydratedPoint(u.x,u.y,C.getConvertedElevation(this.view,u,this.elevationInfo),u.spatialReference));return this.view.toScreen(x)};return k}();b.ElevationDrawSurface=A;b.SceneDrawSurface=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./interactiveToolUtils ./ManipulatorCollection".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t){b.InteractiveToolBase=function(p){function q(a){a=p.call(this,a)||this;a.toolState="pending";a.attached=!1;a.created=!1;a.completed=!1;a.manipulators=new t.ManipulatorCollection;a.updating=!1;a._editableFlags=[];a._creationStartedResolver=C.createResolver();a._creationFinishedResolver=C.createResolver();return a}l._inheritsLoose(q,p);var d=q.prototype;d.attach=function(){if(!this.attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();
this._set("attached",!0)}};d.detach=function(){this.attached&&(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))};d.handleInputEvent=function(a){if(this.attached)this.onInputEvent(a)};d.handleInputEventAfter=function(a){if(this.attached)this.onInputEventAfter(a)};d.destroy=function(){switch(this.toolState){case "creating":case "created":this.manipulators.destroy()}this.toolState="destroyed";this._set("view",null);this._set("created",!1);this._set("completed",!1)};
d.setEditableFlag=function(a,c){this._editableFlags[a]=c;this.manipulators.isToolEditable=this._editableFlags.every(r=>null==r||r);this._updateManipulatorAttachment();0===a&&this.notifyChange("editable");this.onEditableChange()};d.hasEditableFlag=function(a){a=this._editableFlags[a];return null==a?!0:a};d.whenCreationStarted=function(){return this._creationStartedResolver.promise};d.when=function(){return this._creationFinishedResolver.promise};d.rejectCreation=function(a){switch(this.toolState){case "pending":case "creating":this._creationStartedResolver.resolve(this)}this._creationFinishedResolver.reject(a)};
d.initialize=function(){};d.onAttach=function(){};d.onDetach=function(){};d.onShow=function(){};d.onHide=function(){};d.onEditableChange=function(){};d.onInputEvent=function(a){};d.onInputEventAfter=function(a){};d.startToolCreation=function(){switch(this.toolState){case "pending":this._creationStartedResolver.resolve(this);this.toolState="creating";break;default:throw Error(`unexpected tool state ${this.toolState}`);}};d.finishToolCreation=function(){switch(this.toolState){case "pending":this.startToolCreation();
case "creating":this.created||(this._set("created",!0),this._creationFinishedResolver.resolve(this));this.toolState="created";break;case "created":if(!this.created)throw Error(`expected this.created to match toolstate ${this.toolState}`);break;default:throw Error(`unexpected tool state ${this.toolState}`);}};d.complete=function(){this.finishToolCreation();this._set("completed",!0)};d._show=function(){this._updateManipulatorAttachment();this.onShow()};d._hide=function(){this._updateManipulatorAttachment();
this.onHide()};d._updateManipulatorAttachment=function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()};l._createClass(q,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"isSupported",get:function(){return!0}},{key:"visible",set:function(a){this._set("visible",a);a||y.setActive(this,!1);this.attached&&(a?this._show():this._hide())}},{key:"editable",get:function(){return this.hasEditableFlag(0)},set:function(a){this.setEditableFlag(0,
a)}},{key:"internallyEditable",get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)}}]);return q}(z);m.__decorate([A.property()],b.InteractiveToolBase.prototype,"toolState",void 0);m.__decorate([A.property({constructOnly:!0})],b.InteractiveToolBase.prototype,"view",void 0);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"active",null);m.__decorate([A.property({value:!0})],b.InteractiveToolBase.prototype,"visible",null);m.__decorate([A.property({value:!0})],
b.InteractiveToolBase.prototype,"editable",null);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"attached",void 0);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"created",void 0);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"completed",void 0);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"manipulators",void 0);m.__decorate([A.property({readOnly:!0})],b.InteractiveToolBase.prototype,"updating",
void 0);b.InteractiveToolBase=m.__decorate([x.subclass("esri.views.interactive.InteractiveToolBase")],b.InteractiveToolBase);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection","../../core/maybe"],function(b,l,m,z){let C=function(){function A(){this._isToolEditable=!0;this._manipulators=new m;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};
this._attached=!1}var g=A.prototype;g.add=function(k,w=0){return this.addMany([k],w)[0]};g.addMany=function(k,w=0){return k.map(u=>{const x=this._nextManipulatorId++;u={id:x,manipulator:u,visibilityPredicate:w,attached:!1};this._manipulators.add(u);this._attached&&this._updateManipulatorAttachment(u);return x})};g.remove=function(k){if("number"===typeof k){for(var w=0;w<this._manipulators.length;w++)if(this._manipulators.getItemAt(w).id===k)return k=this._manipulators.splice(w,1)[0],this._detachManipulator(k),
k.id;return null}for(w=0;w<this._manipulators.length;w++)if(this._manipulators.getItemAt(w).manipulator===k)return k=this._manipulators.splice(w,1)[0],this._detachManipulator(k),k.id;return null};g.removeAll=function(){this._manipulators.forEach(k=>{this._detachManipulator(k)});this._manipulators.removeAll()};g.attach=function(){this._manipulators.forEach(k=>{this._updateManipulatorAttachment(k)});this._attached=!0};g.detach=function(){this._manipulators.forEach(k=>{this._detachManipulator(k)});this._attached=
!1};g.destroy=function(){this._manipulators.forEach(({manipulator:k})=>{k.destroy&&k.destroy()});this._manipulators.destroy();this._resourceContexts=null};g.on=function(k,w){return this._manipulators.on(k,u=>{w(u)})};g.forEach=function(k){for(const w of this._manipulators.items)k(w)};g.some=function(k){return this._manipulators.items.some(k)};g.toArray=function(){const k=[];this.forEach(w=>k.push(w.manipulator));return k};g.intersect=function(k,w){let u=null,x=Number.MAX_VALUE;this._manipulators.forEach(({id:y,
manipulator:t,attached:p})=>{p&&t.interactive&&(p=t.intersectionDistance(k,w),z.isSome(p)&&p<x&&(x=p,u={id:y,manipulator:t}))});return u};g.findById=function(k){if(z.isNone(k))return null;for(const w of this._manipulators.items)if(k===w.id)return w.manipulator;return null};g._updateManipulatorAttachment=function(k){this._isManipulatorItemVisible(k)?this._attachManipulator(k):this._detachManipulator(k)};g._attachManipulator=function(k){k.attached||(k.manipulator.attach&&k.manipulator.attach(this._resourceContexts),
k.attached=!0)};g._detachManipulator=function(k){if(k.attached){var w=k.manipulator;w.grabbing=!1;w.dragging=!1;w.hovering=!1;w.selected=!1;w.detach&&w.detach(this._resourceContexts);k.attached=!1}};g._isManipulatorItemVisible=function(k){return 2===k.visibilityPredicate?!0:this._isToolEditable?0===k.visibilityPredicate:1===k.visibilityPredicate};l._createClass(A,[{key:"isToolEditable",set:function(k){this._isToolEditable=k}},{key:"length",get:function(){return this._manipulators.length}}]);return A}();
b.ManipulatorCollection=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/PolygonDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/Handles ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../3d/interactive/editingTools/draw/DrawTool ./DrawingMode ./DrawAction ./input/DrawEvents ../input/InputManager ../interactive/keybindings ../support/screenUtils ../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e){b.PolygonDrawAction=function(h){function v(n){n=h.call(this,n)||this;n._panEnabled=!1;n._popVertexOnPointerMove=!1;n._addVertexOnPointerUp=!1;n._activePointerId=null;n._viewHandles=new C;n._undoRedoHandles=new C;n.mode=p.defaultDrawingMode;return n}l._inheritsLoose(v,h);var E=v.prototype;E.initialize=function(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)};E.destroy=function(){"2d"===this.view.type?
(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool();this.emit("destroy")};E.undo=function(){h.prototype.undo.call(this);this.notifyChange("vertices")};E.redo=function(){h.prototype.redo.call(this);this.notifyChange("vertices")};E.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};E.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?
this.vertices[0][2]:this._get("defaultZ")};E._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("click",n=>{n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("pointer-down",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=n.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=r.createScreenPointFromEvent(n),"touch"===n.pointerType&&this._updateCursor(n.native))},a.ViewEventPriorities.TOOL),
this.view.on("pointer-move",n=>{this._snappingTask=A.abortMaybe(this._snappingTask);this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1);this._cursorScreenPoint=r.createScreenPointFromEvent(n);"touch"!==n.pointerType&&this._updateCursor(n.native)},a.ViewEventPriorities.TOOL),this.view.on("pointer-drag",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._cursorScreenPoint=r.createScreenPointFromEvent(n),this._dragEnabled&&!this._panEnabled?
this._vertexAddHandler(n):this._addVertexOnPointerUp=!1)},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._clickEnabled?this._vertexAddHandler(n):(1===this.vertices.length&&this.vertices.pop(),this._drawCompleteHandler(n)):this._updateCursor(n.native,"touch"===n.pointerType))},a.ViewEventPriorities.TOOL),this.view.on("drag",n=>{this._dragEnabled&&
A.isSome(this._activePointerId)&&!this._panEnabled&&n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],n=>{n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("double-click",n=>{n.stopPropagation();this._drawCompleteHandler(n)},a.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],n=>{n.stopPropagation();this._drawCompleteHandler(n)},a.ViewEventPriorities.TOOL),this.view.on("key-down",n=>{const {key:B,repeat:f}=n;B===c.SKETCH_KEYS.vertexAdd&&!f&&
this._cursorScreenPoint?(n.stopPropagation(),this._snappingTask=A.abortMaybe(this._snappingTask),this._vertexAddHandler(n)):B!==c.SKETCH_KEYS.complete||f?B!==c.SKETCH_KEYS.undo||this.interactiveUndoDisabled||f?B!==c.SKETCH_KEYS.redo||this.interactiveUndoDisabled||f?B!==c.SKETCH_KEYS.pan||f||(n.stopPropagation(),this._panEnabled=!0):(n.stopPropagation(),this.redo()):(n.stopPropagation(),this.undo()):(n.stopPropagation(),this._drawCompleteHandler(n))},a.ViewEventPriorities.TOOL),this.view.on("key-up",
n=>{n.key===c.SKETCH_KEYS.pan&&(n.stopPropagation(),this._panEnabled=!1)},a.ViewEventPriorities.TOOL)])};E._addUndoRedoHandles=function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",n=>{this.notifyChange("vertices");if("undo"===n.operation){const B=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(B);const f=[...this._committedVertices];A.isSome(this._stagedVertex)&&f.push(this._coordinateHelper.pointToArray(this._stagedVertex));
this.emit("undo",new d.VertexRemoveEvent(this.view,B,n.vertices[0].index,f))}}),this._editGeometry.on("vertex-add",n=>{this.notifyChange("vertices");if("apply"===n.operation)n=new d.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",n),n.defaultPrevented&&(this._popVertexOnPointerMove=!0);else if("redo"===n.operation){const B=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(B);
const f=[...this._committedVertices];A.isSome(this._stagedVertex)&&f.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("redo",new d.VertexAddEvent(this.view,B,n.vertices[0].index,f))}})])};E._removeViewHandles=function(){this._viewHandles.removeAll()};E._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};E._addDrawTool=function(n){this._drawTool=new t.DrawTool({view:n,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);
this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",B=>{1===B.vertices.length&&this.emit("vertex-add",new d.VertexAddEvent(this.view,null,B.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",B=>{1===B.vertices.length&&this.emit("cursor-update",new d.CursorUpdateEvent(this.view,null,B.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",B=>{this.emit("draw-complete",new d.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));
this._removeDrawTool()})};E._removeDrawTool=function(){A.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};E._addVertex=function(n,B){n=this._coordinateHelper.fromArray(n);this._isDuplicateOfLastVertex(n)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(n),B=B||new Event("placeholder"),this._nativeEventHistory.undoStack.push(B))};E._updateCursor=function(n,B=!1){this._popCursorVertex();
if(this._cursorScreenPoint){var f=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(A.isSome(f)&&!B){this._pushCursorVertex(f.vertex);const D=()=>new d.CursorUpdateEvent(this.view,n,this._activeComponent.vertices.length,this.vertices,A.isSome(this._stagedVertex)?new e(this._stagedVertex):null);this.emit("cursor-update",D());A.isSome(this._snappingTask)&&this._snappingTask.promise.then(H=>{H.valid&&this.emit("cursor-update",D())},()=>{})}}};E._completeDrawing=function(n){this._activePointerId=
null;this._popCursorVertex();3>this._committedVertices.length||(this._snappingTask=A.abortMaybe(this._snappingTask),A.isSome(this._snappingManager)&&this._snappingManager.doneSnapping(),n=new d.DrawCompleteEvent(n,this.vertices),this.emit("draw-complete",n),n.defaultPrevented||this._removeViewHandles())};E._shouldHandlePointerEvent=function(n){return("mouse"!==n.pointerType||0===n.button)&&(A.isNone(this._activePointerId)||this._activePointerId===n.pointerId)};l._createClass(v,[{key:"_dragEnabled",
get:function(){return"freehand"===this.mode||"hybrid"===this.mode}},{key:"_clickEnabled",get:function(){return"click"===this.mode||"hybrid"===this.mode}}]);return v}(q);m.__decorate([g.property()],b.PolygonDrawAction.prototype,"_dragEnabled",null);m.__decorate([g.property()],b.PolygonDrawAction.prototype,"_clickEnabled",null);m.__decorate([g.property({type:p.drawingModes})],b.PolygonDrawAction.prototype,"mode",void 0);b.PolygonDrawAction=m.__decorate([y.subclass("esri.views.draw.PolygonDrawAction")],
b.PolygonDrawAction);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/PolylineDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/Handles ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../3d/interactive/editingTools/draw/DrawTool ./DrawingMode ./DrawAction ./input/DrawEvents ../input/InputManager ../interactive/keybindings ../support/screenUtils ../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e){b.PolylineDrawAction=function(h){function v(n){n=h.call(this,n)||this;n._panEnabled=!1;n._popVertexOnPointerMove=!1;n._addVertexOnPointerUp=!1;n._activePointerId=null;n._viewHandles=new C;n._undoRedoHandles=new C;n.mode=p.defaultDrawingMode;return n}l._inheritsLoose(v,h);var E=v.prototype;E.initialize=function(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)};E.destroy=function(){"2d"===this.view.type?
(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool();this.emit("destroy")};E.undo=function(){h.prototype.undo.call(this);this.notifyChange("vertices")};E.redo=function(){h.prototype.redo.call(this);this.notifyChange("vertices")};E.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};E._addViewHandles=function(){this._removeViewHandles();this._viewHandles.add([this.view.on("click",
n=>{n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("pointer-down",n=>{this._shouldHandlePointerEvent(n)&&!this._panEnabled&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=n.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=r.createScreenPointFromEvent(n),"touch"===n.pointerType&&this._updateCursor(n.native))},a.ViewEventPriorities.TOOL),this.view.on("pointer-move",n=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1);
this._snappingTask=A.abortMaybe(this._snappingTask);this._cursorScreenPoint=r.createScreenPointFromEvent(n);"touch"!==n.pointerType&&this._updateCursor(n.native)},a.ViewEventPriorities.TOOL),this.view.on("pointer-drag",n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._cursorScreenPoint=r.createScreenPointFromEvent(n),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(n):this._addVertexOnPointerUp=!1)},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",
n=>{this._shouldHandlePointerEvent(n)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=null,this._addVertexOnPointerUp?this._clickEnabled?this._vertexAddHandler(n):(1===this.vertices.length&&this.vertices.pop(),this._drawCompleteHandler(n)):this._updateCursor(n.native,"touch"===n.pointerType))},a.ViewEventPriorities.TOOL),this.view.on("drag",n=>{this._dragEnabled&&A.isSome(this._activePointerId)&&!this._panEnabled&&n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("drag",
["Shift"],n=>{n.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("double-click",n=>{n.stopPropagation();this._drawCompleteHandler(n)},a.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],n=>{n.stopPropagation();this._drawCompleteHandler(n)},a.ViewEventPriorities.TOOL),this.view.on("key-down",n=>{const {key:B,repeat:f}=n;B===c.SKETCH_KEYS.vertexAdd&&!f&&this._cursorScreenPoint?(n.stopPropagation(),this._snappingTask=A.abortMaybe(this._snappingTask),this._vertexAddHandler(n)):
B!==c.SKETCH_KEYS.complete||f?B!==c.SKETCH_KEYS.undo||this.interactiveUndoDisabled||f?B!==c.SKETCH_KEYS.redo||this.interactiveUndoDisabled||f?B!==c.SKETCH_KEYS.pan||f||(n.stopPropagation(),this._panEnabled=!0):(n.stopPropagation(),this.redo()):(n.stopPropagation(),this.undo()):(n.stopPropagation(),this._drawCompleteHandler(n))},a.ViewEventPriorities.TOOL),this.view.on("key-up",n=>{n.key===c.SKETCH_KEYS.pan&&(n.stopPropagation(),this._panEnabled=!1)},a.ViewEventPriorities.TOOL)])};E._addUndoRedoHandles=
function(){this._removeUndoRedoHandles();this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",n=>{this.notifyChange("vertices");if("undo"===n.operation){const B=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(B);const f=[...this._committedVertices];A.isSome(this._stagedVertex)&&f.push(this._coordinateHelper.pointToArray(this._stagedVertex));this.emit("undo",new d.VertexRemoveEvent(this.view,B,n.vertices[0].index,f))}}),this._editGeometry.on("vertex-add",
n=>{this.notifyChange("vertices");if("apply"===n.operation)n=new d.VertexAddEvent(this.view,this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],this._committedVertices.length-1,this.vertices),this.emit("vertex-add",n),n.defaultPrevented&&(this._popVertexOnPointerMove=!0);else if("redo"===n.operation){const B=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(B);const f=[...this._committedVertices];A.isSome(this._stagedVertex)&&f.push(this._coordinateHelper.pointToArray(this._stagedVertex));
this.emit("redo",new d.VertexAddEvent(this.view,B,n.vertices[0].index,f))}})])};E._removeViewHandles=function(){this._viewHandles.removeAll()};E._removeUndoRedoHandles=function(){this._undoRedoHandles.removeAll()};E._addDrawTool=function(n){this._drawTool=new t.DrawTool({view:n,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",B=>{1===B.vertices.length&&
this.emit("vertex-add",new d.VertexAddEvent(this.view,null,B.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",B=>{1===B.vertices.length&&this.emit("cursor-update",new d.CursorUpdateEvent(this.view,null,B.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("complete",B=>{this.emit("draw-complete",new d.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));this._removeDrawTool()})};E._removeDrawTool=function(){A.isSome(this._drawTool)&&
(this.view.tools.remove(this._drawTool),this._drawTool=A.destroyMaybe(this._drawTool))};E._addVertex=function(n,B){n=this._coordinateHelper.fromArray(n);this._isDuplicateOfLastVertex(n)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometry.appendVertex(n),B=B||new Event("placeholder"),this._nativeEventHistory.undoStack.push(B))};E._updateCursor=function(n,B=!1){this._popCursorVertex();if(this._cursorScreenPoint){var f=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
if(A.isSome(f)&&!B){this._pushCursorVertex(f.vertex);const D=()=>new d.CursorUpdateEvent(this.view,n,this._activeComponent.vertices.length,this.vertices,A.isSome(this._stagedVertex)?new e(this._stagedVertex):null);this.emit("cursor-update",D());A.isSome(this._snappingTask)&&this._snappingTask.promise.then(H=>{H.valid&&this.emit("cursor-update",D())},()=>{})}}};E._completeDrawing=function(n){this._activePointerId=null;this._popCursorVertex();2>this._committedVertices.length||(this._snappingTask=A.abortMaybe(this._snappingTask),
A.isSome(this._snappingManager)&&this._snappingManager.doneSnapping(),n=new d.DrawCompleteEvent(n,this.vertices),this.emit("draw-complete",n),n.defaultPrevented||this._removeViewHandles())};E._shouldHandlePointerEvent=function(n){return("mouse"!==n.pointerType||0===n.button)&&(A.isNone(this._activePointerId)||this._activePointerId===n.pointerId)};l._createClass(v,[{key:"_clickEnabled",get:function(){return"click"===this.mode||"hybrid"===this.mode}},{key:"_dragEnabled",get:function(){return"freehand"===
this.mode||"hybrid"===this.mode}}]);return v}(q);m.__decorate([g.property()],b.PolylineDrawAction.prototype,"_clickEnabled",null);m.__decorate([g.property()],b.PolylineDrawAction.prototype,"_dragEnabled",null);m.__decorate([g.property({type:p.drawingModes})],b.PolylineDrawAction.prototype,"mode",void 0);b.PolylineDrawAction=m.__decorate([y.subclass("esri.views.draw.PolylineDrawAction")],b.PolylineDrawAction);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/SegmentDrawAction":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/Handles ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ./support/surfaceCoordinateSystems ../input/InputManager ../interactive/keybindings ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryHelper ../support/screenUtils ../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v){b.SegmentDrawAction=function(E){function n(f){f=E.call(this,f)||this;f._isDragging=!1;f._panEnabled=!1;f._viewHandles=new C;f._activePointerId=null;f._addVertexOnPointerUp=!1;f.viewAlignedCoordinateSystem=null;f.mode="freehand";return f}l._inheritsLoose(n,E);var B=n.prototype;B.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};B.destroy=function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):
this._removeDrawTool();this.emit("destroy")};B.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};B.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};B._addViewHandles=function(){this._removeViewHandles();"click"===this.mode?this._viewHandles.add(this._getClickModeViewHandles()):this._viewHandles.add(this._getDragModeViewHandles())};B._getDragModeViewHandles=function(){return[this.view.on("immediate-click",
f=>{f.stopPropagation();if(f.mapPoint&&!this._panEnabled){const D=this.getCoordsFromScreenPoint(h.createScreenPointFromEvent(f));A.isSome(D)&&(this._vertexAddHandler(f),this._drawCompleteHandler(f))}},a.ViewEventPriorities.TOOL),this.view.on("pointer-down",f=>{this._shouldHandlePointerEvent(f)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._panEnabled||(this._resetGeometry(),this._addVertexOnPointerUp=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(f),this._activePointerId=f.pointerId,
this._vertexAddHandler(f),this._isDragging=!1,"touch"===f.pointerType&&this._updateCursor(f.native)))},a.ViewEventPriorities.TOOL),this.view.on("pointer-move",f=>{this._snappingTask=A.abortMaybe(this._snappingTask);A.isNone(this._activePointerId)&&"touch"!==f.pointerType&&(this._cursorScreenPoint=h.createScreenPointFromEvent(f),this._updateCursor(f.native))},a.ViewEventPriorities.TOOL),this.view.on("pointer-drag",f=>{this._shouldHandlePointerEvent(f)&&(this._snappingTask=A.abortMaybe(this._snappingTask),
this._isDragging=!0,this._cursorScreenPoint=h.createScreenPointFromEvent(f),this._updateCursor(f.native))},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",f=>{this._shouldHandlePointerEvent(f)&&this._addVertexOnPointerUp&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=null,this._isDragging&&this._vertexAddHandler(f),2===this._committedVertices.length&&this._drawCompleteHandler(f),this._isDragging=!1)},a.ViewEventPriorities.TOOL),this.view.on("key-down",f=>{f.key===
c.SKETCH_KEYS.complete&&this._cursorScreenPoint?(this._snappingTask=A.abortMaybe(this._snappingTask),this._vertexAddHandler(f),this._drawCompleteHandler(f)):f.key===c.SKETCH_KEYS.pan&&(this._panEnabled=!0)},a.ViewEventPriorities.TOOL),this.view.on("key-up",f=>{f.key===c.SKETCH_KEYS.pan&&(this._panEnabled=!1)},a.ViewEventPriorities.TOOL),this.view.on("drag",f=>{A.isSome(this._activePointerId)&&f.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],f=>{f.stopPropagation()},a.ViewEventPriorities.TOOL)]};
B._getClickModeViewHandles=function(){return[this.view.on("pointer-down",f=>{this._snappingTask=A.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(f);this._activePointerId=f.pointerId;this._isDragging=!1;"touch"===f.pointerType&&this._updateCursor(f.native)},a.ViewEventPriorities.TOOL),this.view.on("pointer-move",f=>{this._snappingTask=A.abortMaybe(this._snappingTask);this._cursorScreenPoint=h.createScreenPointFromEvent(f);A.isNone(this._activePointerId)&&"touch"!==
f.pointerType&&this._updateCursor(f.native)},a.ViewEventPriorities.TOOL),this.view.on("pointer-drag",f=>{this._shouldHandlePointerEvent(f)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._isDragging=!0)},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",f=>{this._shouldHandlePointerEvent(f)&&(this._snappingTask=A.abortMaybe(this._snappingTask),this._activePointerId=null,f.stopPropagation(),this._isDragging||this._vertexAddHandler(f),2!==this.vertices.length||this._isDragging||this._drawCompleteHandler(f),
this._isDragging=!1)},a.ViewEventPriorities.TOOL),this.view.on("key-down",f=>{f.key===c.SKETCH_KEYS.vertexAdd&&this._cursorScreenPoint&&(this._vertexAddHandler(f),2===this.vertices.length&&this._drawCompleteHandler(f));f.key===c.SKETCH_KEYS.complete&&this._cursorScreenPoint&&2===this.vertices.length&&(this._vertexAddHandler(f),this._drawCompleteHandler(f))},a.ViewEventPriorities.TOOL)]};B._removeViewHandles=function(){this._viewHandles.removeAll()};B._addDrawTool=function(f){this._drawTool=new t.DrawTool({view:f,
elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",D=>{1===D.vertices.length&&this.emit("vertex-add",new q.VertexAddEvent(this.view,null,D.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",D=>{1===D.vertices.length&&this.emit("cursor-update",new q.CursorUpdateEvent(this.view,null,D.vertices[0].vertexIndex,
this._drawTool.getVertexCoords()))});this._drawTool.on("complete",D=>{this.emit("draw-complete",new q.DrawCompleteEvent(null,this._drawTool.getVertexCoords()));this._removeDrawTool()})};B._removeDrawTool=function(){A.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};B._addVertex=function(f,D){f=this._coordinateHelper.fromArray(f);this._isDuplicateOfLastVertex(f)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),
this._editGeometry.appendVertex(f),1===this._committedVertices.length&&(this.viewAlignedCoordinateSystem=d.createViewAlignedCoordinateSystem(this.view,this._committedVertices[0])),D=new q.VertexAddEvent(this.view,D,this._committedVertices.length-1,this.vertices),this.emit("vertex-add",D))};B._updateCursor=function(f){this._popCursorVertex();if(this._cursorScreenPoint){var D=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);if(A.isSome(D)){this._pushCursorVertex(D.vertex);const H=()=>
new q.CursorUpdateEvent(this.view,f,this._activeComponent.vertices.length,this.vertices,A.isSome(this._stagedVertex)?new v(this._stagedVertex):null);this.emit("cursor-update",H());A.isSome(this._snappingTask)&&this._snappingTask.promise.then(P=>{P.valid&&this.emit("cursor-update",H())},()=>{})}}};B._completeDrawing=function(f){this._activePointerId=null;this._popCursorVertex();this._cursorScreenPoint=null;this._isDragging=!1;this._snappingTask=A.abortMaybe(this._snappingTask);A.isSome(this._snappingManager)&&
this._snappingManager.doneSnapping();1>this.vertices.length||(f=new q.DrawCompleteEvent(f,this.vertices),this.emit("draw-complete",f),f.defaultPrevented||this._removeViewHandles())};B._resetGeometry=function(){this._editGeometry.destroy();this._editGeometry=new e.EditGeometryHelper(new r.EditGeometry(this._coordinateHelper),"polygon");this._activeComponent=new r.Component(this._editGeometry.editGeometry);this._editGeometry.editGeometry.components.push(this._activeComponent)};B._shouldHandlePointerEvent=
function(f){return("mouse"!==f.pointerType||0===f.button)&&(A.isNone(this._activePointerId)||this._activePointerId===f.pointerId)};return n}(p);m.__decorate([g.property({type:["freehand","click"]})],b.SegmentDrawAction.prototype,"mode",void 0);b.SegmentDrawAction=m.__decorate([y.subclass("esri/views/2d/engine/markup/SegmentDrawAction")],b.SegmentDrawAction);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/quat ../../../chunks/quatf64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/Point".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x){function y(d,a,c=null){return z.isSome(c)?[d,a,c]:[d,a]}function t(d,a,c=null){return z.isSome(c)?{x:d,y:a,z:c}:{x:d,y:a}}m=function(){function d(a){this.spatialReference=a}d.prototype.mapToLocalMultiple=function(a){return z.filterNones(a.map(c=>this.mapToLocal(c)))};l._createClass(d,[{key:"doUnnormalization",get:function(){return!1}}]);return d}();let p=function(d){function a(r,e,h=null){e=d.call(this,e)||this;e.defaultZ=h;e.transform=A.create();e.transformInv=A.create();
e.transform=A.clone(r);C.invert(e.transformInv,e.transform);return e}l._inheritsLoose(a,d);var c=a.prototype;c.makeMapPoint=function(r,e){return y(r,e,this.defaultZ)};c.mapToLocal=function(r){return t(this.transform[0]*r[0]+this.transform[2]*r[1]+this.transform[4],this.transform[1]*r[0]+this.transform[3]*r[1]+this.transform[5])};c.localToMap=function(r){return y(this.transformInv[0]*r.x+this.transformInv[2]*r.y+this.transformInv[4],this.transformInv[1]*r.x+this.transformInv[3]*r.y+this.transformInv[5],
this.defaultZ)};return a}(m),q=function(d){function a(r,e){var h=d.call(this,r.spatialReference)||this;h.view=r;h.defaultZ=null;h.pWS=u.create();h.tangentFrameUpWS=u.create();h.tangentFrameRightWS=u.create();h.tangentFrameForwardWS=u.create();h.localFrameRightWS=u.create();h.localFrameUpWS=u.create();h.worldToLocalTransform=k.create();h.localToWorldTransform=k.create();h.scale=1;h.scale=r.resolution;h.referenceMapPoint=e;h.defaultZ=e.hasZ?e.z:null;r=r.state.camera.viewRight;h.view.renderCoordsHelper.toRenderCoords(h.referenceMapPoint,
h.pWS);h.view.renderCoordsHelper.worldBasisAtPosition(h.pWS,0,h.tangentFrameRightWS);h.view.renderCoordsHelper.worldBasisAtPosition(h.pWS,1,h.tangentFrameUpWS);h.view.renderCoordsHelper.worldBasisAtPosition(h.pWS,2,h.tangentFrameForwardWS);e=u.create();w.scale(e,h.tangentFrameForwardWS,w.dot(r,h.tangentFrameForwardWS));w.subtract(h.localFrameRightWS,r,e);w.normalize(h.localFrameRightWS,h.localFrameRightWS);w.cross(h.localFrameUpWS,h.tangentFrameForwardWS,h.localFrameRightWS);g.rotationTo(h.worldToLocalTransform,
h.localFrameRightWS,h.tangentFrameRightWS);g.invert(h.localToWorldTransform,h.worldToLocalTransform);return h}l._inheritsLoose(a,d);var c=a.prototype;c.makeMapPoint=function(r,e){return y(r,e,this.defaultZ)};c.mapToLocal=function(r){const e=u.create();this.view.renderCoordsHelper.toRenderCoords(new x({x:r[0],y:r[1],spatialReference:this.spatialReference}),e);w.transformQuat(e,e,this.worldToLocalTransform);r=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return z.isSome(r)?
t(r.x/this.scale,r.y/this.scale):null};c.localToMap=function(r){const e=u.create();this.view.renderCoordsHelper.toRenderCoords(new x({x:r.x*this.scale,y:r.y*this.scale,spatialReference:this.spatialReference}),e);w.transformQuat(e,e,this.localToWorldTransform);r=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return z.isSome(r)?y(r.x,r.y,this.defaultZ):null};l._createClass(a,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}}]);return a}(m);
b.AffineCoordinateSystem=p;b.SceneViewCoordinateSystem=q;b.SurfaceCoordinateSystem=m;b.createViewAlignedCoordinateSystem=function(d,a){return"2d"===d.type?new p(d.state.transform,d.spatialReference,2<a.length?a[2]:null):"3d"===d.type?(a=2<a.length?new x({x:a[0],y:a[1],z:a[2],spatialReference:d.spatialReference}):new x({x:a[0],y:a[1],spatialReference:d.spatialReference}),new q(d,a)):null};b.makeMapPoint=y;b.makeSurfacePoint=t;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/chunks/mat2d":function(){define(["exports",
"./common"],function(b,l){function m(n,B){n[0]=B[0];n[1]=B[1];n[2]=B[2];n[3]=B[3];n[4]=B[4];n[5]=B[5];return n}function z(n){n[0]=1;n[1]=0;n[2]=0;n[3]=1;n[4]=0;n[5]=0;return n}function C(n,B,f,D,H,P,R){n[0]=B;n[1]=f;n[2]=D;n[3]=H;n[4]=P;n[5]=R;return n}function A(n,B){const f=B[0],D=B[1],H=B[2],P=B[3],R=B[4];B=B[5];let K=f*P-D*H;if(!K)return null;K=1/K;n[0]=P*K;n[1]=-D*K;n[2]=-H*K;n[3]=f*K;n[4]=(H*B-P*R)*K;n[5]=(D*R-f*B)*K;return n}function g(n){return n[0]*n[3]-n[1]*n[2]}function k(n,B,f){const D=
B[0],H=B[1],P=B[2],R=B[3],K=B[4];B=B[5];const J=f[0],Q=f[1],F=f[2],O=f[3],V=f[4];f=f[5];n[0]=D*J+P*Q;n[1]=H*J+R*Q;n[2]=D*F+P*O;n[3]=H*F+R*O;n[4]=D*V+P*f+K;n[5]=H*V+R*f+B;return n}function w(n,B,f){const D=B[0],H=B[1],P=B[2],R=B[3],K=B[4];B=B[5];const J=Math.sin(f);f=Math.cos(f);n[0]=D*f+P*J;n[1]=H*f+R*J;n[2]=D*-J+P*f;n[3]=H*-J+R*f;n[4]=K;n[5]=B;return n}function u(n,B,f){const D=B[1],H=B[2],P=B[3],R=B[4],K=B[5],J=f[0];f=f[1];n[0]=B[0]*J;n[1]=D*J;n[2]=H*f;n[3]=P*f;n[4]=R;n[5]=K;return n}function x(n,
B,f){const D=B[0],H=B[1],P=B[2],R=B[3],K=B[4];B=B[5];const J=f[0];f=f[1];n[0]=D;n[1]=H;n[2]=P;n[3]=R;n[4]=D*J+P*f+K;n[5]=H*J+R*f+B;return n}function y(n,B){const f=Math.sin(B);B=Math.cos(B);n[0]=B;n[1]=f;n[2]=-f;n[3]=B;n[4]=0;n[5]=0;return n}function t(n,B){n[0]=B[0];n[1]=0;n[2]=0;n[3]=B[1];n[4]=0;n[5]=0;return n}function p(n,B){n[0]=1;n[1]=0;n[2]=0;n[3]=1;n[4]=B[0];n[5]=B[1];return n}function q(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"}function d(n){return Math.sqrt(n[0]**
2+n[1]**2+n[2]**2+n[3]**2+n[4]**2+n[5]**2+1)}function a(n,B,f){n[0]=B[0]+f[0];n[1]=B[1]+f[1];n[2]=B[2]+f[2];n[3]=B[3]+f[3];n[4]=B[4]+f[4];n[5]=B[5]+f[5];return n}function c(n,B,f){n[0]=B[0]-f[0];n[1]=B[1]-f[1];n[2]=B[2]-f[2];n[3]=B[3]-f[3];n[4]=B[4]-f[4];n[5]=B[5]-f[5];return n}function r(n,B,f){n[0]=B[0]*f;n[1]=B[1]*f;n[2]=B[2]*f;n[3]=B[3]*f;n[4]=B[4]*f;n[5]=B[5]*f;return n}function e(n,B,f,D){n[0]=B[0]+f[0]*D;n[1]=B[1]+f[1]*D;n[2]=B[2]+f[2]*D;n[3]=B[3]+f[3]*D;n[4]=B[4]+f[4]*D;n[5]=B[5]+f[5]*D;return n}
function h(n,B){return n[0]===B[0]&&n[1]===B[1]&&n[2]===B[2]&&n[3]===B[3]&&n[4]===B[4]&&n[5]===B[5]}function v(n,B){const f=n[0],D=n[1],H=n[2],P=n[3],R=n[4];n=n[5];const K=B[0],J=B[1],Q=B[2],F=B[3],O=B[4];B=B[5];return Math.abs(f-K)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(K))&&Math.abs(D-J)<=l.EPSILON*Math.max(1,Math.abs(D),Math.abs(J))&&Math.abs(H-Q)<=l.EPSILON*Math.max(1,Math.abs(H),Math.abs(Q))&&Math.abs(P-F)<=l.EPSILON*Math.max(1,Math.abs(P),Math.abs(F))&&Math.abs(R-O)<=l.EPSILON*Math.max(1,
Math.abs(R),Math.abs(O))&&Math.abs(n-B)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(B))}var E=Object.freeze({__proto__:null,copy:m,identity:z,set:C,invert:A,determinant:g,multiply:k,rotate:w,scale:u,translate:x,fromRotation:y,fromScaling:t,fromTranslation:p,str:q,frob:d,add:a,subtract:c,multiplyScalar:r,multiplyScalarAndAdd:e,exactEquals:h,equals:v,mul:k,sub:c});b.add=a;b.copy=m;b.determinant=g;b.equals=v;b.exactEquals=h;b.frob=d;b.fromRotation=y;b.fromScaling=t;b.fromTranslation=p;b.identity=z;b.invert=
A;b.mat2d=E;b.mul=k;b.multiply=k;b.multiplyScalar=r;b.multiplyScalarAndAdd=e;b.rotate=w;b.scale=u;b.set=C;b.str=q;b.sub=c;b.subtract=c;b.translate=x})},"esri/chunks/mat2df64":function(){define(["exports"],function(b){function l(){return[1,0,0,1,0,0]}function m(g){return[g[0],g[1],g[2],g[3],g[4],g[5]]}function z(g,k,w,u,x,y){return[g,k,w,u,x,y]}function C(g,k){return new Float64Array(g,k,6)}var A=Object.freeze({__proto__:null,create:l,clone:m,fromValues:z,createView:C});b.clone=m;b.create=l;b.createView=
C;b.fromValues=z;b.mat2df64=A})},"esri/chunks/quat":function(){define("exports ./mat3f64 ./quatf64 ./vec3f64 ./common ./vec3 ./vec4".split(" "),function(b,l,m,z,C,A,g){function k(U){U[0]=0;U[1]=0;U[2]=0;U[3]=1;return U}function w(U,fa,ka){ka*=.5;const wa=Math.sin(ka);U[0]=wa*fa[0];U[1]=wa*fa[1];U[2]=wa*fa[2];U[3]=Math.cos(ka);return U}function u(U,fa){const ka=2*Math.acos(fa[3]),wa=Math.sin(ka/2);wa>C.EPSILON?(U[0]=fa[0]/wa,U[1]=fa[1]/wa,U[2]=fa[2]/wa):(U[0]=1,U[1]=0,U[2]=0);return ka}function x(U,
fa,ka){const wa=fa[0],ya=fa[1],oa=fa[2];fa=fa[3];const G=ka[0],I=ka[1],Z=ka[2];ka=ka[3];U[0]=wa*ka+fa*G+ya*Z-oa*I;U[1]=ya*ka+fa*I+oa*G-wa*Z;U[2]=oa*ka+fa*Z+wa*I-ya*G;U[3]=fa*ka-wa*G-ya*I-oa*Z;return U}function y(U,fa,ka){ka*=.5;const wa=fa[0],ya=fa[1],oa=fa[2];fa=fa[3];const G=Math.sin(ka);ka=Math.cos(ka);U[0]=wa*ka+fa*G;U[1]=ya*ka+oa*G;U[2]=oa*ka-ya*G;U[3]=fa*ka-wa*G;return U}function t(U,fa,ka){ka*=.5;const wa=fa[0],ya=fa[1],oa=fa[2];fa=fa[3];const G=Math.sin(ka);ka=Math.cos(ka);U[0]=wa*ka-oa*G;
U[1]=ya*ka+fa*G;U[2]=oa*ka+wa*G;U[3]=fa*ka-ya*G;return U}function p(U,fa,ka){ka*=.5;const wa=fa[0],ya=fa[1],oa=fa[2];fa=fa[3];const G=Math.sin(ka);ka=Math.cos(ka);U[0]=wa*ka+ya*G;U[1]=ya*ka-wa*G;U[2]=oa*ka+fa*G;U[3]=fa*ka-oa*G;return U}function q(U,fa){const ka=fa[0],wa=fa[1];fa=fa[2];U[0]=ka;U[1]=wa;U[2]=fa;U[3]=Math.sqrt(Math.abs(1-ka*ka-wa*wa-fa*fa));return U}function d(U,fa,ka,wa){const ya=fa[0],oa=fa[1],G=fa[2];fa=fa[3];let I=ka[0],Z=ka[1],ca=ka[2];ka=ka[3];let da;let ba;var ha=ya*I+oa*Z+G*ca+
fa*ka;0>ha&&(ha=-ha,I=-I,Z=-Z,ca=-ca,ka=-ka);1-ha>C.EPSILON?(da=Math.acos(ha),ba=Math.sin(da),ha=Math.sin((1-wa)*da)/ba,wa=Math.sin(wa*da)/ba):ha=1-wa;U[0]=ha*ya+wa*I;U[1]=ha*oa+wa*Z;U[2]=ha*G+wa*ca;U[3]=ha*fa+wa*ka;return U}function a(U){var fa=C.RANDOM();const ka=C.RANDOM(),wa=C.RANDOM(),ya=Math.sqrt(1-fa);fa=Math.sqrt(fa);U[0]=ya*Math.sin(2*Math.PI*ka);U[1]=ya*Math.cos(2*Math.PI*ka);U[2]=fa*Math.sin(2*Math.PI*wa);U[3]=fa*Math.cos(2*Math.PI*wa);return U}function c(U,fa){const ka=fa[0],wa=fa[1],
ya=fa[2];fa=fa[3];var oa=ka*ka+wa*wa+ya*ya+fa*fa;oa=oa?1/oa:0;U[0]=-ka*oa;U[1]=-wa*oa;U[2]=-ya*oa;U[3]=fa*oa;return U}function r(U,fa){U[0]=-fa[0];U[1]=-fa[1];U[2]=-fa[2];U[3]=fa[3];return U}function e(U,fa){var ka=fa[0]+fa[4]+fa[8];if(0<ka)ka=Math.sqrt(ka+1),U[3]=.5*ka,ka=.5/ka,U[0]=(fa[5]-fa[7])*ka,U[1]=(fa[6]-fa[2])*ka,U[2]=(fa[1]-fa[3])*ka;else{let wa=0;fa[4]>fa[0]&&(wa=1);fa[8]>fa[3*wa+wa]&&(wa=2);const ya=(wa+1)%3,oa=(wa+2)%3;ka=Math.sqrt(fa[3*wa+wa]-fa[3*ya+ya]-fa[3*oa+oa]+1);U[wa]=.5*ka;ka=
.5/ka;U[3]=(fa[3*ya+oa]-fa[3*oa+ya])*ka;U[ya]=(fa[3*ya+wa]+fa[3*wa+ya])*ka;U[oa]=(fa[3*oa+wa]+fa[3*wa+oa])*ka}return U}function h(U,fa,ka,wa){var ya=.5*Math.PI/180;fa*=ya;ka*=ya;wa*=ya;ya=Math.sin(fa);fa=Math.cos(fa);const oa=Math.sin(ka);ka=Math.cos(ka);const G=Math.sin(wa);wa=Math.cos(wa);U[0]=ya*ka*wa-fa*oa*G;U[1]=fa*oa*wa+ya*ka*G;U[2]=fa*ka*G-ya*oa*wa;U[3]=fa*ka*wa+ya*oa*G;return U}function v(U){return"quat("+U[0]+", "+U[1]+", "+U[2]+", "+U[3]+")"}function E(U,fa,ka){const wa=A.dot(fa,ka);if(-.999999>
wa)return A.cross(V,M,fa),1E-6>A.len(V)&&A.cross(V,T,fa),A.normalize(V,V),w(U,V,Math.PI),U;if(.999999<wa)return U[0]=0,U[1]=0,U[2]=0,U[3]=1,U;A.cross(V,fa,ka);U[0]=V[0];U[1]=V[1];U[2]=V[2];U[3]=1+wa;return F(U,U)}function n(U,fa,ka,wa,ya,oa){d(S,fa,ya,oa);d(L,ka,wa,oa);d(U,S,L,2*oa*(1-oa));return U}function B(U,fa,ka,wa){const ya=N;ya[0]=ka[0];ya[3]=ka[1];ya[6]=ka[2];ya[1]=wa[0];ya[4]=wa[1];ya[7]=wa[2];ya[2]=-fa[0];ya[5]=-fa[1];ya[8]=-fa[2];return F(U,e(U,ya))}const f=g.copy,D=g.set,H=g.add,P=g.scale,
R=g.dot,K=g.lerp,J=g.length,Q=g.squaredLength,F=g.normalize,O=g.exactEquals;g=g.equals;const V=z.create(),M=z.fromValues(1,0,0),T=z.fromValues(0,1,0),S=m.create(),L=m.create(),N=l.create();l=Object.freeze({__proto__:null,identity:k,setAxisAngle:w,getAxisAngle:u,multiply:x,rotateX:y,rotateY:t,rotateZ:p,calculateW:q,slerp:d,random:a,invert:c,conjugate:r,fromMat3:e,fromEuler:h,str:v,copy:f,set:D,add:H,mul:x,scale:P,dot:R,lerp:K,length:J,len:J,squaredLength:Q,sqrLen:Q,normalize:F,exactEquals:O,equals:g,
rotationTo:E,sqlerp:n,setAxes:B});b.add=H;b.calculateW=q;b.conjugate=r;b.copy=f;b.dot=R;b.equals=g;b.exactEquals=O;b.fromEuler=h;b.fromMat3=e;b.getAxisAngle=u;b.identity=k;b.invert=c;b.len=J;b.length=J;b.lerp=K;b.mul=x;b.multiply=x;b.normalize=F;b.quat=l;b.random=a;b.rotateX=y;b.rotateY=t;b.rotateZ=p;b.rotationTo=E;b.scale=P;b.set=D;b.setAxes=B;b.setAxisAngle=w;b.slerp=d;b.sqlerp=n;b.sqrLen=Q;b.squaredLength=Q;b.str=v})},"esri/views/draw/support/createUtilsAsync":function(){define(["require","exports",
"../../../chunks/_rollupPluginBabelHelpers"],function(b,l,m){function z(){z=m._asyncToGenerator(function*(){C||(C=yield new Promise(function(A,g){b(["./createUtils"],A,g)}));return C});return z.apply(this,arguments)}let C=null;l.loadCreateUtils=function(){return z.apply(this,arguments)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(b){b.addUniqueLayer=function(l,m,z){if(m&&l&&l.map){({map:l}=l);var C=l.layers.find(A=>
A===m);C||l.add(m,z);void 0!==z&&null!==z&&l.layers.reorder(C,z)}};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/trackingUtils ../../../chunks/vec2 ../../../geometry/SpatialReference ./FeatureSnappingEngine ./SelfSnappingEngine ./SnappingOptions ./snappingUtils ./candidates/IntersectionSnappingCandidate".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v){b.SnappingManager=function(E){function n(f){f=E.call(this,f)||this;f.options=new e;f.engines=[];f._currentMainCandidate=null;f._currentOtherActiveCandidates=[];return f}l._inheritsLoose(n,E);var B=n.prototype;B.initialize=function(){this.handles.add([q.reaction(()=>{const {effectiveFeatureEnabled:f,effectiveSelfEnabled:D,touchSensitivityMultiplier:H,distance:P}=this.options;return{effectiveFeatureEnabled:f,effectiveSelfEnabled:D,touchSensitivityMultiplier:H,
distance:P}},()=>{this.doneSnapping();this.emit("changed")}),this.watch("options",f=>{for(const D of this.engines)D.options=f},!0),k.init(this.view,"ready",f=>this.onViewReady(f),!0)])};B.destroy=function(){this.destroyEngines()};B.onViewReady=function(f){this.destroyEngines();if(f){var D,H;this.engines=[new r.SelfSnappingEngine({view:this.view,options:this.options}),new c.FeatureSnappingEngine({view:this.view,spatialReference:null!=(D=null==(H=this.view)?void 0:H.spatialReference)?D:a.WGS84,options:this.options})]}};
B.destroyEngines=function(){for(const f of this.engines)f.destroy();this.engines.length=0};B.snap=function(){var f=l._asyncToGenerator(function*(D,H,P){const R=H.coordinateHelper.fromPoint(D),K=yield this.fetchCandidates(R,H,P);return{get valid(){return!g.isAborted(P)},apply:()=>{const {snappedPoint:J,hints:Q}=this.processCandidates(R,K,H);this.removeVisualization();A.isSome(H.visualizer)&&this.handles.add(H.visualizer.draw(Q,{coordinateHelper:H.coordinateHelper,elevationInfo:H.elevationInfo,view:this.view}),
"visualization-handle");return J}}});return function(D,H,P){return f.apply(this,arguments)}}();B.update=function(f,D){this.removeVisualization();let H=f;const P=[];if(A.isSome(this._currentMainCandidate)){const R=D.coordinateHelper;f=R.fromPoint(f);const K=this._currentMainCandidate.constraint.closestTo(f);if(h.squareDistance(h.anyMapPointToScreenPoint(f,R,D.elevationInfo,this.view),h.anyMapPointToScreenPoint(K,R,D.elevationInfo,this.view))<this.squaredPointProximityThreshold(D.pointer)){H=R.createDehydratedPoint(K);
this._currentMainCandidate.targetPoint=K;P.push(...this._currentMainCandidate.hints);for(const J of this._currentOtherActiveCandidates)J.targetPoint=K,P.push(...J.hints)}else this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}A.isSome(D.visualizer)&&this.handles.add(D.visualizer.draw(P,{coordinateHelper:D.coordinateHelper,elevationInfo:D.elevationInfo,view:this.view}),"visualization-handle");return H};B.doneSnapping=function(){this.removeVisualization();this._currentMainCandidate=
null;this._currentOtherActiveCandidates=[]};B.removeVisualization=function(){this.handles.remove("visualization-handle")};B.fetchCandidates=function(){var f=l._asyncToGenerator(function*(D,H,P){return(yield Promise.all(this.engines.map(R=>R.fetchCandidates(D,H,P)))).flat()});return function(D,H,P){return f.apply(this,arguments)}}();B.processCandidates=function(f,D,H){if(1>D.length)return this.doneSnapping(),{snappedPoint:H.coordinateHelper.createDehydratedPoint(f),hints:[]};h.sortCandidatesInPlace(f,
D);const P=this._currentMainCandidate;if(A.isSome(P)){const R=this.findOldConstraintInNewCandidates(P,D);if(0<=R)if(D[R]instanceof v.IntersectionSnappingCandidate){if(d.squaredDistance(f,P.targetPoint)<this.squaredPointProximityThreshold(H.pointer))return this.updateSnappingCandidate(P,D,H)}else return this.intersectWithOtherCandidates(R,D,f,H)}return this.intersectWithOtherCandidates(0,D,f,H)};B.findOldConstraintInNewCandidates=function(f,D){return f instanceof v.IntersectionSnappingCandidate?0<=
this.findOldCandidateIndex(D,f.first)&&0<=this.findOldCandidateIndex(D,f.second)?0:-1:this.findOldCandidateIndex(D,f)};B.intersectWithOtherCandidates=function(f,D,H,P){const R=D[f],K=[],J=P.coordinateHelper;for(let Q=0;Q<D.length;++Q){if(Q===f)continue;const F=D[Q];for(const O of R.constraint.intersect(F.constraint)){const V=J.fromXYZ(O.intersection,R.targetPoint[2]);K.push([new v.IntersectionSnappingCandidate(J,V,R,F),h.squareDistance(h.anyMapPointToScreenPoint(H,P.coordinateHelper,P.elevationInfo,
this.view),h.anyMapPointToScreenPoint(V,P.coordinateHelper,P.elevationInfo,this.view))])}}return 0<K.length&&(K.sort((Q,F)=>Q[1]-F[1]),K[0][1]<this.squaredPointProximityThreshold(P.pointer))?this.updateSnappingCandidate(K[0][0],D,P):this.updateSnappingCandidate(R,D,P)};B.updateSnappingCandidate=function(f,D,H){this.doneSnapping();this._currentMainCandidate=f;const P=this._currentMainCandidate.targetPoint,R=[];R.push(...f.hints);for(const K of D){if(f instanceof v.IntersectionSnappingCandidate){if(K.constraint.objectEqual(f.first.constraint)||
K.constraint.objectEqual(f.second.constraint))continue}else if(K.constraint.objectEqual(f.constraint))continue;K.constraint.check(P)&&(K.targetPoint=P,this._currentOtherActiveCandidates.push(K),R.push(...K.hints))}return{snappedPoint:H.coordinateHelper.createDehydratedPoint(P),hints:R}};B.squaredPointProximityThreshold=function(f){return"touch"===f?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};B.findOldCandidateIndex=function(f,D){let H=-1;for(let P=0;P<f.length;++P)if(D.constraint.objectEqual(f[P].constraint)){H=
P;break}return H};l._createClass(n,[{key:"updating",get:function(){return this.engines.some(f=>f.updating)}},{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:f,touchSensitivityMultiplier:D}=this.options,H=f*D;return H*H}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this.engines}}}]);return n}(z.EventedMixin(C.HandleOwner));
m.__decorate([w.property({constructOnly:!0})],b.SnappingManager.prototype,"view",void 0);m.__decorate([w.property()],b.SnappingManager.prototype,"options",void 0);m.__decorate([w.property({readOnly:!0})],b.SnappingManager.prototype,"updating",null);m.__decorate([w.property()],b.SnappingManager.prototype,"engines",void 0);m.__decorate([w.property()],b.SnappingManager.prototype,"squaredMouseProximityTreshold",null);m.__decorate([w.property()],b.SnappingManager.prototype,"squaredTouchProximityThreshold",
null);b.SnappingManager=m.__decorate([p.subclass("esri.views.interactive.snapping.SnappingManager")],b.SnappingManager);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec3f64 ./SnappingConstraint ./snappingUtils ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v){l.FeatureSnappingEngine=function(B){function f(H){H=B.call(this,H)||this;H.sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null}};return H}m._inheritsLoose(f,B);var D=f.prototype;D.initialize=function(){this.updatingHandles.add(this,"snappingSources",()=>{this.notifyChange("updating")},1);if(k.isSome(this.view)){var H;this.handles.add([null==(H=this.view.refreshManager)?
void 0:H.on("refresh",P=>{"interval"===P.trigger&&this.refreshSourceOfLayer(P.layerView.layer)}),this.view.on("layerview-create",P=>this.updateLayerView(P.layer,P.layerView)),this.view.on("layerview-destroy",P=>this.updateLayerView(P.layer,null))])}};D.refreshSourceOfLayer=function(H){for(const [,{snappingSource:P}]of this.snappingSources)P.layerSource.layer===H&&P.refresh()};D.updateLayerView=function(H,P){for(const [,R]of this.snappingSources)R.snappingSource.layerSource.layer===H&&(R.layerView=
P)};D.destroy=function(){this._set("options",null);for(const [,H]of this.snappingSources)H.destroy()};D.fetchCandidates=function(){var H=m._asyncToGenerator(function*(P,R,K){if(!this.options.effectiveFeatureEnabled)return[];var J=[];const Q=this.computeScreeenSizeDistanceParameters(P,R),F={distance:Q,point:P,coordinateHelper:R.coordinateHelper,types:this.types,filter:null};for(const [,{snappingSource:O,layerView:V}]of this.snappingSources)!O.layerSource.enabled||k.isSome(V)&&V.suspended||J.push(O.fetchCandidates(F,
K).then(M=>M.filter(T=>!this.candidateIsExcluded(O,T,R.excludeFeature))));J=(yield w.eachAlwaysValues(J)).flat();this.addRightAngleCandidates(J,P,Q,R);w.throwIfAborted(K);r.sortCandidatesInPlace(P,J);return J});return function(P,R,K){return H.apply(this,arguments)}}();D.addRightAngleCandidates=function(H,P,R,K){var J,Q,F,O,V,M,T,S;const L=k.isSome(K.vertexHandle)?null==(J=K.vertexHandle.right)?void 0:null==(Q=J.right)?void 0:Q.pos:k.isSome(K.geometry)&&"polygon"===K.geometry.type?null==(F=k.unwrap(null==
(O=K.geometry.editGeometry.components[0])?void 0:O.getFirstVertex()))?void 0:F.pos:null;J=k.isSome(K.vertexHandle)?null==(V=K.vertexHandle.left)?void 0:null==(M=V.left)?void 0:M.pos:k.isSome(K.geometry)?null==(T=k.unwrap(null==(S=K.geometry.editGeometry.components[0])?void 0:S.getLastVertex()))?void 0:T.pos:null;V=H.length;for(M=0;M<V;M++)this.addRightAngleCandidate(H[M],J,P,R,K,H),this.addRightAngleCandidate(H[M],L,P,R,K,H)};D.addRightAngleCandidate=function(H,P,R,K,J,Q){if(!k.isNone(P)&&H instanceof
e.EdgeSnappingCandidate){var F=H.constraint.closestTo(P),O=(F[0]-R[0])/K.x;R=(F[1]-R[1])/K.y;1>=O*O+R*R&&(J=J.coordinateHelper,Q.push(new v.RightAngleSnappingCandidate({coordinateHelper:J,targetPoint:F,otherVertex:P,otherVertexType:0,previousVertex:H.constraint.start,constraint:new c.RayConstraint(J,P,F),objectId:H.objectId})))}};D.computeScreeenSizeDistanceParameters=function(H,P){const R=this.options.distance*("touch"===P.pointer?this.options.touchSensitivityMultiplier:1);return k.isNone(this.view)?
{x:R,y:R}:"2d"===this.view.type?{x:R*this.view.resolution,y:R*this.view.resolution}:this.computeScreeenSizeDistanceParameters3D(H,R,this.view,P)};D.computeScreeenSizeDistanceParameters3D=function(H,P,R,K){const {coordinateHelper:J,elevationInfo:Q}=K,F=R.state.camera.computeScreenPixelSizeAt(r.anyMapPointToRender(H,J,Q,R,n))*R.renderCoordsHelper.unitInMeters/R.mapCoordsHelper.unitInMeters;P*=F;const O=this.computeScreenMagnitudeOfMapOffset(H,F,0,R,K);H=this.computeScreenMagnitudeOfMapOffset(H,0,F,
R,K);return{x:P/O,y:P/H}};D.computeScreenMagnitudeOfMapOffset=function(H,P,R,K,{coordinateHelper:J,elevationInfo:Q}){const F=J.clone(H);F[0]+=P;F[1]+=R;H=r.anyMapPointToScreenPoint(H,J,Q,K);J=r.anyMapPointToScreenPoint(F,J,Q,K);K=J.x-H.x;J=J.y-H.y;return Math.sqrt(K*K+J*J)};D.candidateIsExcluded=function(H,P,R){if(k.isNone(R))return!1;P=this.getCandidateObjectId(P);if(k.isNone(P))return!1;H=H.layerSource.layer;return"graphics"===H.type?R.uid===P:R.sourceLayer===H&&R.attributes&&"objectIdField"in H?
R.attributes[H.objectIdField]===P:!1};D.getCandidateObjectId=function(H){return H instanceof h.FeatureSnappingCandidate?H.objectId:null};D.createSourceInfo=function(H){const P=this.createFeatureSnappingSourceType(H);if(k.isNone(P))return null;if("loading"in P)return this.updatingHandles.addPromise(P.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const R=k.isSome(this.view)?this.view.allLayerViews.find(K=>K.layer===H.layer):null;return new E(P.source,R)};D.createFeatureSnappingSourceType=
function(H){switch(H.layer.type){case "feature":case "geojson":case "csv":case "wfs":return this.createFeatureSnappingSourceFeatureLayer(H);case "graphics":return this.createFeatureSnappingSourceGraphicsLayer(H)}return null};D.createFeatureSnappingSourceFeatureLayer=function(H){switch(H.layer.source.type){case "feature-layer":var P=this.getSourceModule("featureService");return k.isSome(P.module)?{source:new P.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,
layerSource:H})}:{loading:P.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==H.layer.geometryType)return P=this.getSourceModule("featureCollection"),k.isSome(P.module)?{source:new P.module.FeatureCollectionSnappingSource({layerSource:H})}:{loading:P.loader}}return null};D.createFeatureSnappingSourceGraphicsLayer=function(H){const P=this.getSourceModule("graphics");return k.isSome(P.module)?{source:new P.module.GraphicsSnappingSource({spatialReference:this.spatialReference,view:this.view,
layerSource:H})}:{loading:P.loader}};D.getSourceModule=function(H){const P=this.sourceModules[H];return k.isNone(P.loader)?(H=this.loadSourceModule(H).then(R=>{P.module=R}),P.loader=H,{module:P.module,loader:H}):{module:P.module,loader:P.loader}};D.loadSourceModule=function(H){switch(H){case "featureService":return this.updatingHandles.addPromise(new Promise(function(P,R){b(["./featureSources/FeatureServiceSnappingSource"],P,R)}));case "featureCollection":return this.updatingHandles.addPromise(new Promise(function(P,
R){b(["./featureSources/FeatureCollectionSnappingSource"],P,R)}));case "graphics":return this.updatingHandles.addPromise(new Promise(function(P,R){b(["./featureSources/GraphicsSnappingSource"],P,R)}))}return null};m._createClass(f,[{key:"updating",get:function(){return g.someMap(this.snappingSources,({snappingSource:H})=>H.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){var H;const P=this._get("snappingSources")||new Map,R=new Map;if(null!=(H=this.options)&&H.featureSources)for(const J of this.options.featureSources.items){H=
J.layer.uid;var K=P.get(H);K?(P.delete(H),R.set(H,K)):J.layer.loaded?(K=this.createSourceInfo(J),k.isSome(K)&&R.set(H,K)):this.updatingHandles.addPromise(J.layer.load())}for(const [,J]of P)J.destroy();return R}},{key:"types",get:function(){return 3}}]);return f}(C.HandleOwner);z.__decorate([x.property({constructOnly:!0})],l.FeatureSnappingEngine.prototype,"spatialReference",void 0);z.__decorate([x.property({constructOnly:!0})],l.FeatureSnappingEngine.prototype,"view",void 0);z.__decorate([x.property()],
l.FeatureSnappingEngine.prototype,"options",void 0);z.__decorate([x.property({readOnly:!0})],l.FeatureSnappingEngine.prototype,"updating",null);z.__decorate([x.property({readOnly:!0})],l.FeatureSnappingEngine.prototype,"snappingSources",null);l.FeatureSnappingEngine=z.__decorate([d.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],l.FeatureSnappingEngine);let E=function(){function B(f,D){this.snappingSource=f;this.layerView=D;this.handles=new A;D=this.snappingSource.layerSource.layer;
"refresh"in D&&this.handles.add(D.on("refresh",()=>f.refresh()));this.handles.add([u.init(f,"updating",H=>f.layerSource.updating=H,!0),u.init(f,"availability",H=>f.layerSource.availability=H,!0)])}B.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return B}();const n=a.create();Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ./Settings ./snappingUtils ../../support/geometry2dUtils".split(" "),
function(b,l,m,z,C,A,g){let k=function(q){this.coordinateHelper=q},w=function(q){function d(c,r){c=q.call(this,c)||this;c.point=r;return c}l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?A.objectEqual(this.point,c.point):!1};a.check=function(c){return m.squaredDistance(c,this.point)<C.defaults.pointThreshold};a.closestTo=function(){return this.coordinateHelper.clone(this.point)};a.intersect=function(c){const r=[];c instanceof u?r.push(...g.intersectLineAndPoint({start:c.start,
end:c.end,type:c instanceof y?1:0},this.point)):c instanceof p&&r.push(...g.intersectCircleAndPoint(c.center,c.radius,this.point));return r.map(e=>new t(this.coordinateHelper,e,this,c))};return d}(k),u=function(q){function d(c,r,e){c=q.call(this,c)||this;c.start=r;c.end=e;return c}l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?A.objectEqual(this.start,c.start)&&A.objectEqual(this.end,c.end):!1};a.intersect=function(c){const r=[];c instanceof w?r.push(...g.intersectLineAndPoint({start:this.start,
end:this.end,type:this instanceof y?1:0},c.point)):c instanceof d?r.push(...g.intersectLineAndRay({start:this.start,end:this.end,type:this instanceof y?1:0},{start:c.start,end:c.end,type:c instanceof y?1:0})):c instanceof p&&r.push(...g.intersectLineLikeAndCircle({start:this.start,end:this.end,type:this instanceof y?1:0},c.center,c.radius));return r.map(e=>new t(this.coordinateHelper,e,this,c))};return d}(k),x=function(q){function d(c,r,e){c=q.call(this,c,r,e)||this;c.dir=z.create();c.p=z.create();
return c}l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?q.prototype.objectEqual.call(this,c):!1};a.check=function(c){m.subtract(this.dir,this.end,this.start);m.subtract(this.p,c,this.start);return 0<=m.dot(this.dir,this.p)?g.pointToLineDistance(c,this.start,this.end)<C.defaults.pointOnLineThreshold:!1};a.closestTo=function(c){const r=this.coordinateHelper.clone(c);g.projectPointToRay(r,c,this.start,this.end);return r};return d}(u),y=function(q){function d(c,
r,e){return q.call(this,c,r,e)||this}l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?q.prototype.objectEqual.call(this,c):!1};a.check=function(c){return g.pointToLineDistance(c,this.start,this.end)<C.defaults.pointOnLineThreshold};a.closestTo=function(c){const r=this.coordinateHelper.clone(c);g.projectPointToLine(r,c,this.start,this.end);return r};return d}(u),t=function(q){function d(c,r,e,h){c=q.call(this,c)||this;c.intersection=r;c.first=e;c.second=h;return c}
l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?this.first.objectEqual(c.first)&&this.second.objectEqual(c.second):!1};a.check=function(){return!1};a.closestTo=function(c){c=this.coordinateHelper.clone(c);m.copy(c,this.intersection);return c};a.intersect=function(){return[]};return d}(k),p=function(q){function d(c,r,e){c=q.call(this,c)||this;c.center=r;c.radius=e;return c}l._inheritsLoose(d,q);var a=d.prototype;a.objectEqual=function(c){return c instanceof d?
this.center[0]===c.center[0]&&this.center[1]===c.center[1]&&this.radius===c.radius:!1};a.check=function(){return!1};a.closestTo=function(c){const r=this.coordinateHelper.clone(c);g.projectPointToCircle(r,c,this.center,this.radius);return r};a.intersect=function(c){const r=[];c instanceof u?r.push(...g.intersectLineLikeAndCircle({start:c.start,end:c.end,type:c instanceof y?1:0},this.center,this.radius)):c instanceof w&&r.push(...g.intersectCircleAndPoint(this.center,this.radius,c.point));return r.map(e=>
new t(this.coordinateHelper,e,this,c))};return d}(k);b.IntersectionConstraint=t;b.LineConstraint=y;b.LineLikeConstraint=u;b.PlanarCircleConstraint=p;b.PointConstraint=w;b.RayConstraint=x;b.SnappingConstraint=k;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingConstraint","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(b,l,m,
z,C){z=function(A){function g(k){return A.call(this,{...k,constraint:new m.LineConstraint(k.coordinateHelper,k.edgeStart,k.edgeEnd)})||this}l._inheritsLoose(g,A);l._createClass(g,[{key:"hints",get:function(){return[new C.LineSnappingHint(1,this.constraint.start,this.constraint.end)]}}]);return g}(z.FeatureSnappingCandidate);b.EdgeSnappingCandidate=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","./SnappingCandidate"],function(b,l,m){m=function(z){function C({coordinateHelper:A,targetPoint:g,objectId:k,constraint:w}){A=z.call(this,A,g,w)||this;A.objectId=k;return A}l._inheritsLoose(C,z);return C}(m.SnappingCandidate);b.FeatureSnappingCandidate=m;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(b){b.SnappingCandidate=function(l,m,z){this.coordinateHelper=
l;this.targetPoint=m;this.constraint=z};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./SnappingCandidate","../hints/LineSnappingHint","../hints/RightAngleSnappingHint"],function(b,l,m,z,C){m=function(A){function g({coordinateHelper:k,targetPoint:w,constraint:u,previousVertex:x,otherVertex:y,otherVertexType:t,objectId:p}){k=A.call(this,k,w,u)||
this;k.previousVertex=x;k.otherVertex=y;k.otherVertexType=t;k.objectId=p;return k}l._inheritsLoose(g,A);l._createClass(g,[{key:"hints",get:function(){const k=this.previousVertex,w=1===this.otherVertexType?this.otherVertex:this.targetPoint,u=1===this.otherVertexType?this.targetPoint:this.otherVertex;return[new z.LineSnappingHint(0,w,u),new z.LineSnappingHint(1,k,w),new C.RightAngleSnappingHint(this.previousVertex,w,u)]}}]);return g}(m.SnappingCandidate);b.RightAngleSnappingCandidate=m;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./snappingUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x,y,t,p,q,d){b.SelfSnappingEngine=function(a){function c(e){e=a.call(this,e)||this;e.updating=!1;e._snappers=new C;return e}l._inheritsLoose(c,a);var r=c.prototype;r.initialize=function(){this._snappers.push(new t.ParallelLineSnapper(this.view,this.options),new y.LineSnapper(this.view,this.options),new p.RightAngleSnapper(this.view,this.options),new q.RightAngleTriangleSnapper(this.view,this.options))};r.fetchCandidates=function(){var e=l._asyncToGenerator(function*(h,
v){if(!this.options.effectiveSelfEnabled)return[];const E=[];for(const n of this._snappers.items)E.push(...n.snap(h,v));d.sortCandidatesInPlace(h,E);return E});return function(h,v){return e.apply(this,arguments)}}();l._createClass(c,[{key:"options",set:function(e){this._set("options",e);for(const h of this._snappers)h.options=e}}]);return c}(z);m.__decorate([A.property({readOnly:!0})],b.SelfSnappingEngine.prototype,"updating",void 0);m.__decorate([A.property({constructOnly:!0})],b.SelfSnappingEngine.prototype,
"view",void 0);m.__decorate([A.property()],b.SelfSnappingEngine.prototype,"options",null);b.SelfSnappingEngine=m.__decorate([x.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],b.SelfSnappingEngine);Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2f64 ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../../support/geometry2dUtils".split(" "),
function(b,l,m,z,C,A,g,k){C=function(w){function u(){return w.apply(this,arguments)||this}l._inheritsLoose(u,w);var x=u.prototype;x.snapNewVertex=function(y,t){var p=t.geometry.editGeometry.components[0],q=p.edges.length;const d=[];if(1>q)return d;const a=A.anyMapPointToScreenPoint(y,t.coordinateHelper,t.elevationInfo,this.view);q=p=p.edges[q-1];do this.edgeExceedsShortLineThreshold(q,t)&&this._processCandidateProposal(q.left.pos,q.right.pos,y,a,t,d),q=q.left.left;while(q&&q!==p);return d};x.snapExistingVertex=
function(y,t){const p=[],q=m.unwrap(t.vertexHandle);var d=q.component;if(2>d.edges.length)return p;const a=A.anyMapPointToScreenPoint(y,t.coordinateHelper,t.elevationInfo,this.view);var c=q.left;const r=q.right;c&&r&&this.edgeExceedsShortLineThreshold(c,t)&&this.edgeExceedsShortLineThreshold(r,t)&&this._processCandidateProposal(c.left.pos,r.right.pos,y,a,t,p);c=d=d.edges[0];do c!==q.left&&c!==q.right&&this.edgeExceedsShortLineThreshold(c,t)&&this._processCandidateProposal(c.left.pos,c.right.pos,y,
a,t,p),c=c.right.right;while(c&&c!==d);return p};x._processCandidateProposal=function(y,t,p,q,d,a){const c=k.projectPointToLine(z.create(),p,y,t),r=d.coordinateHelper;p=r.fromXYZ(c,r.getZ(p,0));A.squareDistance(q,A.anyMapPointToScreenPoint(p,r,d.elevationInfo,this.view))<this.squaredProximityTreshold(d.pointer)&&a.push(new g.LineSnappingCandidate({coordinateHelper:d.coordinateHelper,lineStart:y,lineEnd:t,targetPoint:p}))};return u}(C.SnappingAlgorithm);b.LineSnapper=C;Object.defineProperty(b,"__esModule",
{value:!0})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","./Settings","./snappingUtils"],function(b,l,m,z,C){let A=function(){function g(w,u){this.view=w;this.options=u;this.squaredShortLineThreshold=z.defaults.shortLineThreshold*z.defaults.shortLineThreshold}var k=g.prototype;k.snap=function(w,u){return m.isSome(u.vertexHandle)?"vertex"!==u.vertexHandle.type?[]:this.snapExistingVertex(w,u):this.snapNewVertex(w,
u)};k.edgeExceedsShortLineThreshold=function(w,u){return this.exceedsShortLineThreshold(w.left.pos,w.right.pos,u)};k.exceedsShortLineThreshold=function(w,u,{elevationInfo:x,geometry:y}){y=y.editGeometry.coordinateHelper;return 0===this.squaredShortLineThreshold||C.squareDistance(C.anyMapPointToScreenPoint(u,y,x,this.view),C.anyMapPointToScreenPoint(w,y,x,this.view))>this.squaredShortLineThreshold};k.squaredProximityTreshold=function(w){return"touch"===w?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};
l._createClass(g,[{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:w,touchSensitivityMultiplier:u}=this.options,x=w*u;return x*x}}]);return g}();b.SnappingAlgorithm=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,l,m,z,C,A,g,k){g=function(x){function y({coordinateHelper:t,lineStart:p,lineEnd:q,targetPoint:d}){t=x.call(this,t,d,new A.LineConstraint(t,p,q))||this;t.referenceLineHint=new k.LineSnappingHint(2,p,q);return t}l._inheritsLoose(y,x);y.prototype.lineEndClosestToTarget=function(){const t=this.constraint.start,p=this.constraint.end;return 0<m.sign(z.dot(z.subtract(u,p,t),z.subtract(w,this.targetPoint,t)))?p:t};l._createClass(y,[{key:"hints",get:function(){return[this.referenceLineHint,new k.LineSnappingHint(0,
this.lineEndClosestToTarget(),this.targetPoint)]}}]);return y}(g.SnappingCandidate);const w=C.create(),u=C.create();b.LineSnappingCandidate=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../../support/geometry2dUtils".split(" "),
function(b,l,m,z,C,A,g,k,w,u){g=function(x){function y(){var p=x.apply(this,arguments)||this;p._tmpProjection=C.create();return p}l._inheritsLoose(y,x);var t=y.prototype;t.snapNewVertex=function(p,q){var d=q.geometry.editGeometry.components[0],a=d.edges.length,c=d.vertices.length;const r=[];if(2>a)return r;const e=k.anyMapPointToScreenPoint(p,q.coordinateHelper,q.elevationInfo,this.view);c=d.vertices[c-1];const h=d.vertices[0];a=d=d.edges[a-1];do this.edgeExceedsShortLineThreshold(a,q)&&(this._checkEdgeForParalleLines(a,
c.pos,p,e,q,r),this._checkEdgeForParalleLines(a,h.pos,p,e,q,r)),a=a.left.left;while(a&&a!==d);return r};t.snapExistingVertex=function(p,q){const d=[],a=m.unwrap(q.vertexHandle);var c=a.component;if(3>c.edges.length)return d;const r=k.anyMapPointToScreenPoint(p,q.coordinateHelper,q.elevationInfo,this.view),e=a.left,h=a.right,v=c.vertices[0],E=c.vertices[c.vertices.length-1];let n=c=c.edges[0];do n!==e&&n!==h&&this.edgeExceedsShortLineThreshold(n,q)&&(e&&this._checkEdgeForParalleLines(n,e.left.pos,
p,r,q,d),h&&this._checkEdgeForParalleLines(n,h.right.pos,p,r,q,d),a===v?this._checkEdgeForParalleLines(n,E.pos,p,r,q,d):a===E&&this._checkEdgeForParalleLines(n,v.pos,p,r,q,d)),n=n.right.right;while(n&&n!==c);return d};t._checkEdgeForParalleLines=function(p,q,d,a,c,r){var e=p.left.pos;const h=p.right.pos;u.projectPointToLine(this._tmpProjection,q,e,h);z.squaredDistance(this._tmpProjection,q)<A.defaults.parallelLineThreshold||(u.projectPointToLine(this._tmpProjection,d,e,h,q),e=c.coordinateHelper,d=
e.fromXYZ(this._tmpProjection,e.getZ(d,0)),k.squareDistance(a,k.anyMapPointToScreenPoint(d,e,c.elevationInfo,this.view))<this.squaredProximityTreshold(c.pointer)&&!this.parallelToPreviousCandidate(p,r)&&r.push(new w.ParallelLineSnappingCandidate({coordinateHelper:e,referenceLine:p,lineStart:q,targetPoint:d})))};t.parallelToPreviousCandidate=function(p,q){const d=p.left.pos,a=p.right.pos;for(const c of q)if(u.projectPointToLine(this._tmpProjection,a,c.constraint.start,c.constraint.end,d),z.squaredDistance(this._tmpProjection,
a)<A.defaults.parallelLineThreshold)return c.addReferenceLine(p),!0;return!1};return y}(g.SnappingAlgorithm);b.ParallelLineSnapper=g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(b,l,m,z,C,A,g){C=function(k){function w({coordinateHelper:u,
referenceLine:x,lineStart:y,targetPoint:t}){const p=u.clone(y);m.subtract(p,m.add(p,p,x.right.pos),x.left.pos);u=k.call(this,u,t,new z.LineConstraint(u,y,p))||this;u._referenceLines=[{edge:x,fadeLeft:!0,fadeRight:!0}];return u}l._inheritsLoose(w,k);w.prototype.addReferenceLine=function(u){const x={edge:u,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(y=>{u.right.right===y.edge&&(y.fadeLeft=!1,x.fadeRight=!1);u.left.left===y.edge&&(y.fadeRight=!1,x.fadeLeft=!1)});this._referenceLines.push(x)};
l._createClass(w,[{key:"hints",get:function(){return[new A.LineSnappingHint(0,this.constraint.start,this.targetPoint),new g.ParallelSnappingHint(this.constraint.start,this.targetPoint),...this._referenceLines.map(u=>new A.LineSnappingHint(1,u.edge.left.pos,u.edge.right.pos,u.fadeLeft,u.fadeRight))]}}]);return w}(C.SnappingCandidate);b.ParallelLineSnappingCandidate=C;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./SnappingAlgorithm ./SnappingConstraint ./snappingUtils ./candidates/RightAngleSnappingCandidate".split(" "),
function(b,l,m,z,C,A,g,k,w,u){g=function(x){function y(){var p=x.apply(this,arguments)||this;p._tmp=A.create();return p}l._inheritsLoose(y,x);var t=y.prototype;t.snapNewVertex=function(p,q){var d=q.geometry.editGeometry.components[0],a=d.vertices.length;const c=[];if(2>a)return c;const r=w.anyMapPointToScreenPoint(p,q.coordinateHelper,q.elevationInfo,this.view);a=d.vertices[a-1];this._checkForSnappingCandidate(c,a.left,a.pos,p,a.left.left.pos,a.pos,q,p,r);d=d.vertices[0];this._checkForSnappingCandidate(c,
d.right,d.pos,p,d.right.right.pos,d.pos,q,p,r);return c};t.snapExistingVertex=function(p,q){const d=[];var a=z.unwrap(q.vertexHandle),c=a.component;const r=c.vertices.length;if(3>r)return d;const e=w.anyMapPointToScreenPoint(p,q.coordinateHelper,q.elevationInfo,this.view);var h=a.left;a=a.right;const v=c.vertices[0];c=c.vertices[r-1];if(!h)return this._checkForSnappingCandidate(d,v.right.right.right,v.right.right.pos,p,v.right.right.right.right.pos,v.right.right.pos,q,p,e),d;if(!a)return this._checkForSnappingCandidate(d,
c.left.left.left,c.left.left.pos,p,c.left.left.left.left.pos,c.left.left.pos,q,p,e),d;h&&h.left.left&&(c=h.left.left,this._checkForSnappingCandidate(d,c,h.left.pos,p,c.left.pos,h.left.pos,q,p,e));a&&a.right.right&&(h=a.right.right,this._checkForSnappingCandidate(d,h,a.right.pos,p,h.right.pos,a.right.pos,q,p,e));return d};t._checkForSnappingCandidate=function(p,q,d,a,c,r,e,h,v){this.edgeExceedsShortLineThreshold(q,e)&&(C.subtract(this._tmp,q.right.pos,q.left.pos),q=A.fromValues(this._tmp[1],-this._tmp[0]),
d=C.dot(q,C.subtract(this._tmp,a,d))/C.squaredLength(q),a=e.coordinateHelper,h=a.fromXYZ(C.scaleAndAdd(A.create(),r,q,d),a.getZ(h,0)),w.squareDistance(v,w.anyMapPointToScreenPoint(h,a,e.elevationInfo,this.view))<this.squaredProximityTreshold(e.pointer)&&p.push(new u.RightAngleSnappingCandidate({coordinateHelper:a,targetPoint:h,constraint:new k.RayConstraint(a,r,C.scaleAndAdd(a.createNew(),r,q,m.sign(d))),previousVertex:c,otherVertex:r,otherVertexType:1})))};return y}(g.SnappingAlgorithm);b.RightAngleSnapper=
g;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../../support/geometry2dUtils".split(" "),function(b,l,m,z,C,A,g,k,w){A=function(u){function x(){return u.apply(this,arguments)||this}l._inheritsLoose(x,u);var y=x.prototype;
y.snapNewVertex=function(t,p){const q=p.geometry.editGeometry.components[0],d=[],a=q.vertices.length;if("polygon"!==p.geometry.type||2>a)return d;this._processCandidateProposal(q.vertices[0].pos,q.vertices[a-1].pos,t,p,d);return d};y.snapExistingVertex=function(t,p){const q=[],d=m.unwrap(p.vertexHandle),a=d.component;if(2>a.edges.length||"polyline"===p.geometry.type&&(0===d.index||d.index===a.vertices.length-1))return q;this._processCandidateProposal(d.left.left.pos,d.right.right.pos,t,p,q);return q};
y._processCandidateProposal=function(t,p,q,d,a){if(this.exceedsShortLineThreshold(t,p,d)){var c=z.lerp(C.create(),t,p,.5),r=.5*z.distance(t,p);r=w.projectPointToCircle(C.create(),q,c,r);c=d.coordinateHelper;r=c.fromXYZ(r,c.getZ(q,0));q=g.anyMapPointToScreenPoint(q,c,d.elevationInfo,this.view);g.squareDistance(q,g.anyMapPointToScreenPoint(r,c,d.elevationInfo,this.view))<this.squaredProximityTreshold(d.pointer)&&a.push(new k.RightAngleTriangleSnappingCandidate({coordinateHelper:c,targetPoint:r,point1:t,
point2:p}))}};return x}(A.SnappingAlgorithm);b.RightAngleTriangleSnapper=A;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),function(b,l,m,z,C,A,g,k){A=function(u){function x({coordinateHelper:y,
targetPoint:t,point1:p,point2:q}){y=u.call(this,y,t,new C.PlanarCircleConstraint(y,m.lerp(w,p,q,.5),.5*m.distance(p,q)))||this;y.p1=p;y.p2=q;return y}l._inheritsLoose(x,u);l._createClass(x,[{key:"hints",get:function(){return[new g.LineSnappingHint(1,this.targetPoint,this.p1),new g.LineSnappingHint(1,this.targetPoint,this.p2),new k.RightAngleSnappingHint(this.p1,this.targetPoint,this.p2)]}}]);return x}(A.SnappingCandidate);const w=z.create();b.RightAngleTriangleSnappingCandidate=A;Object.defineProperty(b,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingConstraint","./SnappingCandidate","../hints/IntersectionSnappingHint"],function(b,l,m,z,C){z=function(A){function g(k,w,u,x){k=A.call(this,k,w,new m.IntersectionConstraint(k,w,u.constraint,x.constraint))||this;k.first=u;k.second=x;return k}l._inheritsLoose(g,A);l._createClass(g,[{key:"hints",get:function(){this.first.targetPoint=
this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new C.IntersectionSnappingHint(this.targetPoint)]}}]);return g}(z.SnappingCandidate);b.IntersectionSnappingCandidate=z;Object.defineProperty(b,"__esModule",{value:!0})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,l,m,z,C,A,g,k,w,u,x){b.OperationHandle=function(y){function t(q){q=y.call(this,q)||this;q.cancelled=!1;q.history={undo:[],redo:[]};q.type=null;return q}l._inheritsLoose(t,y);var p=t.prototype;p.addToHistory=function(q){this.history.redo=[];this.history.undo.push(q)};p.resetHistory=function(){this.history.redo=[];this.history.undo=[]};p.canUndo=function(){return 0<this.history.undo.length};p.canRedo=function(){return 0<this.history.redo.length};p.complete=function(){this.reset();this.onEnd();
this.emit("complete")};p.cancel=function(){this.cancelled=!0;this.complete()};p.reset=function(){this.activeComponent.reset()};p.refreshComponent=function(){const q=this.activeComponent;q&&("box"!==q.type&&"reshape"!==q.type&&"graphic-mover"!==q.type||q.refresh())};l._createClass(t,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw":case "draw-3d":break;default:z.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(q){this._set("undo",()=>{this.canUndo()&&q()})}},{key:"redo",set:function(q){this._set("redo",()=>{this.canRedo()&&q()})}}]);return t}(C.EventedAccessor);m.__decorate([A.property()],b.OperationHandle.prototype,"activeComponent",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"cancelled",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"history",void 0);
m.__decorate([A.property()],b.OperationHandle.prototype,"tool",null);m.__decorate([A.property()],b.OperationHandle.prototype,"type",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"canUndo",null);m.__decorate([A.property()],b.OperationHandle.prototype,"canRedo",null);m.__decorate([A.property()],b.OperationHandle.prototype,"onEnd",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"undo",null);m.__decorate([A.property()],b.OperationHandle.prototype,"redo",null);m.__decorate([A.property()],
b.OperationHandle.prototype,"toggleTool",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"addToSelection",void 0);m.__decorate([A.property()],b.OperationHandle.prototype,"removeFromSelection",void 0);b.OperationHandle=m.__decorate([x.subclass("esri.widgets.Sketch.support.OperationHandle")],b.OperationHandle);Object.defineProperty(b,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/events ../core/HandleOwner ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ../views/interactive/snapping/SnappingOptions ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/Heading ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ../intl/substitute".split(" "),function(b,
l,m,z,C,A,g,k,w,u,x,y,t,p,q,d,a,c,r,e,h,v,E,n,B,f,D,H,P){function R(K){K.focus()}m=function(K){function J(F,O){var V=K.call(this,F,O)||this;V._candidateCommitted=!1;V._featureForm=new a;V._attachments=new d({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});V._featureTemplates=new c;V._filterText="";V._prompt=null;V._spinner=new r;V.activeWorkflow=null;V.allowedWorkflows=null;V.headingLevel=4;V.iconClass=
"esri-icon-edit";V.label=void 0;V.layerInfos=null;V.messages=null;V.messagesCommon=null;V.messagesTemplates=null;V.snappingOptions=new q;V.supportingWidgetDefaults=null;V.view=null;V.viewModel=new h;V._handleHeaderClickOrKeyDown=M=>{M.currentTarget["data-prevent-back"]||V._handleBack.call(b._assertThisInitialized(V),M)};V._setCandidateFeature=(M,T=!1)=>{if(!V._candidateCommitted){var S=V._assertActiveUpdateWorkflow();S.data.edits.feature=M;T&&(S.next(),V._candidateCommitted=!0)}};V._handleSave=V._handleSave.bind(b._assertThisInitialized(V));
V._handleBack=V._handleBack.bind(b._assertThisInitialized(V));V._handleDone=V._handleDone.bind(b._assertThisInitialized(V));V._handleDelete=V._handleDelete.bind(b._assertThisInitialized(V));V._handleAdd=V._handleAdd.bind(b._assertThisInitialized(V));V._handleEdit=V._handleEdit.bind(b._assertThisInitialized(V));V._handleAttachmentAdd=V._handleAttachmentAdd.bind(b._assertThisInitialized(V));V._handleAttachmentUpdate=V._handleAttachmentUpdate.bind(b._assertThisInitialized(V));V._handleAttachmentDelete=
V._handleAttachmentDelete.bind(b._assertThisInitialized(V));return V}b._inheritsLoose(J,K);var Q=J.prototype;Q.initialize=function(){this.own([A.init(this,"headingLevel",F=>{this._featureForm.headingLevel=F+1;this._featureTemplates.headingLevel=F+1}),A.init(this,"viewModel",F=>{this._featureForm.viewModel=F?F.featureFormViewModel:null;this._attachments.viewModel=F?F.attachmentsViewModel:null;this._featureTemplates.viewModel=F?F.featureTemplatesViewModel:null;this._spinner.viewModel=F?F.spinnerViewModel:
null}),A.init(this,"view",(F,O)=>{const V=`editor-${this.id}-spinner`;O&&O.ui.remove(this._spinner,V);F&&F.ui.add(this._spinner,{key:V,position:"manual"})}),A.on(this,"viewModel.sketchViewModel","create",()=>{this.scheduleRender()}),A.on(this,"viewModel.activeWorkflow","cancel-request",({controller:F})=>{const {messages:O,messagesCommon:V}=this;this._prompt={title:O.cancelRequestTitle,message:O.cancelRequestWarningMessage,options:[{label:V.form.no,type:"neutral",action:()=>{F.deny();return this._prompt=
null}},{label:V.form.yes,type:"negative",action:()=>{F.allow();this._prompt=null}}]};this.scheduleRender()}),A.init(this,"supportingWidgetDefaults",F=>{F&&(this._featureForm.set(F.featureForm),this._attachments.set(F.attachments),this._featureTemplates.set(F.featureTemplates),this.viewModel.sketchViewModel.set(F.sketch))}),A.watch(this,"_attachments.error",F=>{if(F){var {messages:O,messagesCommon:V}=this;this._prompt={title:O.errorWarningTitle,message:F.message,options:[{label:V.form.ok,type:"neutral",
action:()=>{this._prompt=null}}]}}}),A.watch(this,"viewModel.failures",F=>{if(F){var {messages:O}=this,[{error:V,retry:M,cancel:T}]=F;this._prompt={title:O.errorWarningTitle,message:P.substitute(O.errorWarningMessageTemplate,{errorMessage:V.message}),options:[{label:O.retry,type:"positive",action:()=>{M();this._prompt=null}},{label:O.ignore,type:"neutral",action:()=>{T();return this._prompt=null}}]}}}),A.watch(this,"viewModel.state",F=>{"awaiting-update-feature-candidate"===F&&(this._candidateCommitted=
!1)}),A.watch(this,["_attachments.selectedFile","_attachments.submitting"],()=>this.scheduleRender()),A.whenNot(this,"viewModel.activeWorkflow",()=>this._featureTemplates.filterText="")])};Q.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};Q.startCreateWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};Q.startCreateWorkflowAtFeatureCreation=function(F){return this.viewModel.startCreateWorkflowAtFeatureCreation(F)};
Q.startCreateWorkflowAtFeatureEdit=function(F){return this.viewModel.startCreateWorkflowAtFeatureEdit(F)};Q.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};Q.startUpdateWorkflowAtMultipleFeatureSelection=function(F){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(F)};Q.startUpdateWorkflowAtFeatureEdit=function(F){return this.viewModel.startUpdateWorkflowAtFeatureEdit(F)};Q.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};
Q.cancelWorkflow=function(F){return this.viewModel.cancelWorkflow(F)};Q.render=function(){const {_attachments:F,viewModel:O}=this;if(!O)return D.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"});const {state:V}=O,M=this._prompt?D.tsx("div",{class:"esri-editor__overlay",key:"overlay"},this.renderPrompt({message:this._prompt.message,title:this._prompt.title,options:this._prompt.options})):null;return D.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"},O.syncing||F.submitting?
this.renderProgressBar():null,"disabled"===V?null:"ready"===V?this.renderLanding():"awaiting-feature-creation-info"===V?this.renderTemplates():"editing-new-feature"===V||"editing-existing-feature"===V?this.renderAttributeEditing():"awaiting-feature-to-update"===V?this.renderFeatureUpdating():"awaiting-update-feature-candidate"===V?this.renderFeatureList():"awaiting-feature-to-create"===V?this.renderFeatureCreation():"adding-attachment"===V?this.renderAttachmentAdding():"editing-attachment"===V?this.renderAttachmentEditing():
null,M)};Q.renderTemplates=function(){return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(this.messages.selectTemplate,!0),D.tsx("div",{key:"content",class:"esri-editor__content"},this._featureTemplates.render()))};Q.renderAttributeEditing=function(){const F=this.viewModel.featureFormViewModel;var O=this._assertActiveCreateOrUpdateWorklow();const V=O.data.edits.feature;var M="update"===O.type&&!O.data.edits.modified||0<F.inputFields.length&&!F.valid;const {messages:T,
messagesCommon:S}=this,L="create"===O.type?S.add:S.update;M=[{label:L,type:"primary",disabled:M,clickHandler:this._handleSave}];let N=!1;"update"===O.type&&(O.data.editableItem.hasAttachments&&(N=!0),O.data.editableItem.supports.includes("delete")&&M.push({label:S.delete,type:"tertiary",clickHandler:this._handleDelete}));O=this._getLabel(V);return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(O,!0),D.tsx("div",{key:"content",class:this.classes("esri-editor__content",
"esri-editor__scroller")},D.tsx("div",{class:"esri-editor__content-group"},0<F.inputFields.length?this._featureForm.render():this.renderMessage(P.substitute(T.clickToFinishTemplate,{button:L})),N?D.tsx("div",{key:"attachments"},D.tsx("div",null,T.attachments),this._attachments.render()):null)),this.renderControls(M))};Q.renderAttachmentAdding=function(){const {_attachments:F,messages:O,messagesCommon:V}=this,M=[{label:F.submitting?V.cancel:V.add,disabled:F.submitting||!F.selectedFile,type:"primary",
clickHandler:this._handleAttachmentAdd}];return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(O.addAttachment,!0,F.submitting),D.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},F.render()),this.renderControls(M))};Q.renderAttachmentEditing=function(){const {_attachments:F,messages:O,messagesCommon:V}=this,M=[{label:V.update,disabled:F.submitting||!F.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate},
{label:V.delete,disabled:F.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete}];return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(O.editAttachment,!0,F.submitting),D.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},F.render()),this.renderControls(M))};Q.renderFeatureUpdating=function(){const {messages:F}=this;return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(F.selectFeature,
!0),D.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},this.renderMessage(F.selectFeatureToEdit)))};Q.renderMessage=function(F){return D.tsx("div",{class:"esri-editor__message"},F)};Q.renderFeatureCreation=function(){const {messages:F,viewModel:O}=this;var V=O.sketchViewModel,M=this._assertActiveCreateWorkflow().data.creationInfo.layer;V=V.canUndo()&&V.createGraphic?V.createGraphic:null;M=this._getSketchingTip(M.geometryType,V);return D.tsx("div",{class:"esri-editor__temp-wrapper",
key:"wrapper"},this.renderHeader(F.placeFeature,!0),D.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},this.renderMessage(M)))};Q.renderControls=function(F){return D.tsx("div",{class:"esri-editor__controls",key:"controls"},F.map(({disabled:O=!1,label:V,type:M,clickHandler:T},S)=>this.renderButton({label:V,class:this.classes("esri-editor__control-button","esri-button","secondary"===M?"esri-button--secondary":"tertiary"===M?"esri-button--tertiary":null,O?
"esri-button--disabled":null),disabled:O,clickHandler:T,key:S})))};Q.renderPrompt=function({title:F,message:O,options:V=[]}){return D.tsx("div",{class:"esri-editor__warning-card",role:"alert"},D.tsx("div",{class:"esri-editor__warning-header"},D.tsx("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),D.tsx(E.Heading,{class:"esri-editor__warning-heading",level:this.headingLevel},F)),D.tsx("div",{class:"esri-editor__warning-message"},O),D.tsx("div",{class:"esri-editor__warning-divider"}),
V.map(({label:M,action:T,type:S},L)=>{const N=0===L;return D.tsx("div",{afterCreate:N?R:null,class:this.classes("esri-editor__warning-option",N?"esri-editor__warning-option--primary":null,"positive"===S?"esri-editor__warning-option--positive":"negative"===S?"esri-editor__warning-option--negative":null),key:L,onclick:T,onkeydown:U=>{const fa=z.eventKey(U);H.isActivationKey(fa)&&(U.preventDefault(),T.call(null))},tabIndex:0,role:"button"},M)}))};Q.renderProgressBar=function(){return D.tsx("div",{class:this.classes("esri-editor__progress-bar"),
key:"progress-bar"})};Q.renderButton=function(F){return D.tsx("button",{class:F.class,disabled:F.disabled,key:F.key,onclick:F.clickHandler,type:"button"},F.label)};Q.renderHeader=function(F,O=!1,V=!1){const {messagesCommon:M}=this;return D.tsx("header",{class:"esri-editor__header",key:"header"},O?D.tsx("div",{"aria-label":M.back,class:this.classes("esri-editor__back-button","esri-interactive",V?"esri-button--disabled":null),key:"back-button","data-prevent-back":V,onclick:this._handleHeaderClickOrKeyDown,
onkeydown:this._handleHeaderClickOrKeyDown,role:"button",tabIndex:0,title:M.back},D.tsx("span",{"aria-hidden":"true",class:H.isRTL()?"esri-icon-right":"esri-icon-left"})):null,D.tsx(E.Heading,{class:"esri-editor__title",level:this.headingLevel},F))};Q.renderLanding=function(){const {messages:F}=this,{allowedWorkflows:O,canCreate:V,canUpdate:M}=this.viewModel,T=H.isRTL()?"esri-icon-left":"esri-icon-right";return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(F.widgetLabel),
D.tsx("div",{key:"content",class:"esri-editor__content",role:"group"},D.tsx("div",{class:"esri-editor__mode-selection",key:"mode-selection"},-1<O.indexOf("update")?D.tsx("div",{"aria-disabled":M?"false":"true",class:this.classes("esri-editor__feature-list-item",M?null:"esri-editor__feature-list-item--disabled"),key:"update",onclick:this._handleEdit,onkeydown:this._handleEdit,role:"button",tabIndex:M?0:-1},D.tsx("span",{class:"esri-editor__feature-list-name"},F.editFeature),D.tsx("span",{"aria-hidden":"true",
class:this.classes("esri-editor__feature-list-icon",T)})):null,-1<O.indexOf("create")?D.tsx("div",{class:this.classes("esri-editor__feature-list-item",V?null:"esri-editor__feature-list-item--disabled"),key:"create",onclick:this._handleAdd,onkeydown:this._handleAdd,role:"button",tabIndex:V?0:-1},D.tsx("span",{class:"esri-editor__feature-list-name"},F.addFeature),D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",T)})):null)))};Q.renderFeatureList=function(){const {messages:F,
messagesTemplates:O,viewModel:{editableItems:V}}=this;var M=this._assertActiveUpdateWorkflow().data.candidates;const T=P.substitute(F.multipleFeaturesTemplate,{total:M.length}),S=new Map;M.map(L=>({label:this._getLabel(L),id:L.attributes[L.layer.objectIdField],data:L})).filter(L=>{const {label:N,data:U}=L;L=this._filterText.toLowerCase();const {title:fa}=U.layer;return-1<this.viewModel.editableItems.find(ka=>ka.layer===U.layer).supports.indexOf("update")&&(!L||-1<N.toLowerCase().indexOf(L)||-1<fa.toLowerCase().indexOf(L))}).forEach(L=>
{const N=L.data.layer;S.has(N)?S.get(N).items.push(L):S.set(N,{id:`${N.id}`,label:N.title,items:[L]})});M=V.filter(({layer:L})=>S.has(L)).map(({layer:L})=>S.get(L)).toArray();return D.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(T,!0),D.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},v.ItemList({id:this.id,filterText:this._filterText,items:M,messages:{filterPlaceholder:O.filterPlaceholder,noItems:O.noItems,noMatches:O.noMatches},
onItemMouseEnter:({data:L})=>this._setCandidateFeature(L),onItemMouseLeave:()=>this._setCandidateFeature(null),onItemSelect:({data:L})=>this._setCandidateFeature(L,!0),onFilterChange:L=>this._filterText=L})))};Q._getSketchingTip=function(F,O){const {messages:V}=this;if("point"===F)return V.tips.clickToAddPoint;if("polygon"===F||"polyline"===F){if(!O)return V.tips.clickToStart;[O]=O.geometry["polygon"===F?"rings":"paths"];return"polygon"===F&&4>O?V.tips.clickToContinue:V.tips.clickToContinueThenDoubleClickToEnd}return V.tips.clickToAddFeature};
Q._getLabel=function(F){var O=F.layer;const {objectIdField:V}=O;({attributes:F}=F);return(O=p.getDisplayFieldName(O))&&F[O]&&`${F[O]}`||P.substitute(this.messages.untitledFeatureTemplate,{id:F[V]})};Q._handleDelete=function(){const {messages:F,messagesCommon:O}=this;this._prompt={title:F.deleteWarningTitle,message:F.deleteWarningMessage,options:[{label:F.keepFeature,type:"neutral",action:()=>this._prompt=null},{label:O.delete,type:"positive",action:()=>{this.viewModel.deleteFeatureFromWorkflow();
this._prompt=null}}]}};Q._handleSave=function(){this.viewModel.activeWorkflow.commit()};Q._handleAttachmentAdd=function(){const {_attachments:F}=this,{activeWorkflow:O}=this.viewModel;F.addAttachment().then(()=>O.previous())};Q._handleAttachmentUpdate=function(){const {_attachments:F}=this,{activeWorkflow:O}=this.viewModel;F.updateAttachment().then(()=>O.previous())};Q._handleAttachmentDelete=function(){const {messages:F,messagesCommon:O}=this;this._prompt={title:F.deleteAttachmentWarningTitle,message:F.deleteAttachmentWarningMessage,
options:[{label:F.keepAttachment,type:"neutral",action:()=>this._prompt=null},{label:O.delete,type:"positive",action:()=>{const {_attachments:V}=this,{activeWorkflow:M}=this.viewModel;V.deleteAttachment(V.viewModel.activeAttachmentInfo).then(()=>{M.previous();this._prompt=null})}}]}};Q._handleAdd=function(){this.viewModel.canCreate&&this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};Q._handleEdit=function(){this.viewModel.canUpdate&&this.viewModel.startUpdateWorkflowAtFeatureSelection()};
Q._handleDone=function(){this.viewModel.cancelWorkflow({force:!0})};Q._handleBack=function(){const {messages:F}=this,O=this._assertActiveCreateOrUpdateWorklow(),{stepId:V,data:M,type:T}=O,S=()=>{O.hasPreviousStep?O.previous({cancelCurrentStep:!0}):this.viewModel.cancelWorkflow({force:!0})};"editing-new-feature"===V||"editing-existing-feature"===V&&M.edits.modified?this._prompt={title:"create"===T?F.cancelAddTitle:F.cancelEditTitle,message:"create"===T?F.cancelAddWarningMessage:F.cancelEditWarningMessage,
options:[{label:"create"===T?F.continueAdding:F.continueEditing,type:"neutral",action:()=>this._prompt=null},{label:"create"===T?F.discardFeature:F.discardEdits,type:"negative",action:()=>{S();this._prompt=null}}]}:S()};Q._assertActiveCreateWorkflow=function(){if("create"===this.viewModel.activeWorkflow.type)return this.viewModel.activeWorkflow;throw Error("Expected activeWorkflow to be a CreateWorkflow");};Q._assertActiveUpdateWorkflow=function(){if("update"===this.viewModel.activeWorkflow.type)return this.viewModel.activeWorkflow;
throw Error("Expected activeWorkflow to be an UpdateWorkflow");};Q._assertActiveCreateOrUpdateWorklow=function(){switch(this.viewModel.activeWorkflow.type){case "create":case "update":return this.viewModel.activeWorkflow}throw Error("Expected activeWorkflow to be either CreateWorkflow or UpdateWorkflow");};return J}(C.HandleOwnerMixin(e));l.__decorate([y.property()],m.prototype,"_attachments",void 0);l.__decorate([g.aliasOf("viewModel.activeWorkflow")],m.prototype,"activeWorkflow",void 0);l.__decorate([g.aliasOf("viewModel.allowedWorkflows")],
m.prototype,"allowedWorkflows",void 0);l.__decorate([y.property()],m.prototype,"headingLevel",void 0);l.__decorate([y.property()],m.prototype,"iconClass",void 0);l.__decorate([y.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],m.prototype,"label",void 0);l.__decorate([g.aliasOf("viewModel.layerInfos")],m.prototype,"layerInfos",void 0);l.__decorate([y.property(),B.messageBundle("esri/widgets/Editor/t9n/Editor")],m.prototype,"messages",void 0);l.__decorate([y.property(),B.messageBundle("esri/t9n/common")],
m.prototype,"messagesCommon",void 0);l.__decorate([y.property(),B.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],m.prototype,"messagesTemplates",void 0);l.__decorate([g.aliasOf("viewModel.snappingOptions")],m.prototype,"snappingOptions",void 0);l.__decorate([y.property()],m.prototype,"supportingWidgetDefaults",void 0);l.__decorate([g.aliasOf("viewModel.view")],m.prototype,"view",void 0);l.__decorate([y.property(),f.vmEvent(["workflow-cancel","workflow-commit"])],m.prototype,
"viewModel",void 0);l.__decorate([n.accessibleHandler()],m.prototype,"_handleDelete",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleAttachmentAdd",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleAttachmentUpdate",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleAttachmentDelete",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleAdd",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleEdit",null);l.__decorate([n.accessibleHandler()],
m.prototype,"_handleDone",null);l.__decorate([n.accessibleHandler()],m.prototype,"_handleBack",null);return m=l.__decorate([t.subclass("esri.widgets.Editor")],m)});